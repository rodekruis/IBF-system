import{Aa as $C,Ba as at,Ca as af,Da as qC,Ea as XC,Fa as JC,G as nc,Ga as xt,H as rc,Ha as KC,I as oc,J as ac,K as sc,L as Zp,M as jp,N as UC,O as zC,T as $p,U as HC,V as qp,W as Ke,Y as xi,Z as Di,_ as Zi,aa as ji,ba as Xp,ca as fo,d as Ca,da as Jp,e as OC,ea as Kp,f as MC,g as Ta,ga as Ze,h as kC,ha as Qp,ia as ef,ja as kt,k as Vp,ka as ci,la as lc,n as RC,o as kr,oa as tf,p as FC,pa as VC,qa as hr,r as Gp,ra as GC,sa as WC,t as Jt,ta as mo,u as YC,ua as nf,v as Oe,va as rf,w as Yv,wa as ZC,x as BC,ya as jC,z as Wp,za as of}from"./chunk-2X7PTNSY.js";import{$b as Ov,Ab as Vt,Bb as Gt,C as fC,Cb as D,Db as x,Eb as X,Fb as Yp,Gb as Bp,Hb as EC,Ib as Ye,L as Jl,Lb as oe,Ma as ot,Mb as B,Na as Kl,Nb as bC,Oa as gC,Ob as xC,P as kp,Pb as tc,Qa as yC,Qb as ho,Ra as T,Sb as Up,T as Et,Tb as zp,U as va,Ub as Hp,Vb as ic,Wa as SC,Wb as M,Xb as be,Y as fe,Yb as ne,Za as P,Zb as Sa,_b as DC,ac as Mv,bc as kv,cb as ce,da as bt,db as ga,dc as NC,ea as ge,eb as Rp,ec as wC,fa as ye,fb as CC,fc as Lt,g as Yt,ga as mC,gc as IC,hb as se,hc as PC,ic as Rv,ja as _C,jc as Fv,kc as Y,l as uC,lc as Z,mc as Je,na as Oi,nc as LC,oa as Av,p as dC,pc as AC,qc as po,ra as vC,sb as TC,tb as Fp,ub as W,v as hC,vb as ya,wb as bi,xb as Ql,yb as re,z as pC,zb as ec}from"./chunk-IZSDXEDD.js";import{a as me,b as Tt,d as Lv,e as cC,f as Xl,g as dt}from"./chunk-2R6CW7ES.js";var Vu=cC((G_,AD)=>{(function(e,n){typeof G_=="object"&&typeof AD<"u"?n(G_):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis<"u"?globalThis:e||self,n(e.leaflet={}))})(G_,function(e){"use strict";var n="1.9.4";function t(r){var a,c,h,_;for(c=1,h=arguments.length;c<h;c++){_=arguments[c];for(a in _)r[a]=_[a]}return r}var i=Object.create||function(){function r(){}return function(a){return r.prototype=a,new r}}();function o(r,a){var c=Array.prototype.slice;if(r.bind)return r.bind.apply(r,c.call(arguments,1));var h=c.call(arguments,2);return function(){return r.apply(a,h.length?h.concat(c.call(arguments)):arguments)}}var s=0;function l(r){return"_leaflet_id"in r||(r._leaflet_id=++s),r._leaflet_id}function u(r,a,c){var h,_,y,N;return N=function(){h=!1,_&&(y.apply(c,_),_=!1)},y=function(){h?_=arguments:(r.apply(c,arguments),setTimeout(N,a),h=!0)},y}function d(r,a,c){var h=a[1],_=a[0],y=h-_;return r===h&&c?r:((r-_)%y+y)%y+_}function f(){return!1}function p(r,a){if(a===!1)return r;var c=Math.pow(10,a===void 0?6:a);return Math.round(r*c)/c}function m(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function g(r){return m(r).split(/\s+/)}function v(r,a){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?i(r.options):{});for(var c in a)r.options[c]=a[c];return r.options}function C(r,a,c){var h=[];for(var _ in r)h.push(encodeURIComponent(c?_.toUpperCase():_)+"="+encodeURIComponent(r[_]));return(!a||a.indexOf("?")===-1?"?":"&")+h.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function b(r,a){return r.replace(E,function(c,h){var _=a[h];if(_===void 0)throw new Error("No value provided for variable "+c);return typeof _=="function"&&(_=_(a)),_})}var S=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function I(r,a){for(var c=0;c<r.length;c++)if(r[c]===a)return c;return-1}var z="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function j(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var k=0;function De(r){var a=+new Date,c=Math.max(0,16-(a-k));return k=a+c,window.setTimeout(r,c)}var $=window.requestAnimationFrame||j("RequestAnimationFrame")||De,yt=window.cancelAnimationFrame||j("CancelAnimationFrame")||j("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function He(r,a,c){if(c&&$===De)r.call(a);else return $.call(window,o(r,a))}function ct(r){r&&yt.call(window,r)}var Ee={__proto__:null,extend:t,create:i,bind:o,get lastId(){return s},stamp:l,throttle:u,wrapNum:d,falseFn:f,formatNum:p,trim:m,splitWords:g,setOptions:v,getParamString:C,template:b,isArray:S,indexOf:I,emptyImageUrl:z,requestFn:$,cancelFn:yt,requestAnimFrame:He,cancelAnimFrame:ct};function $t(){}$t.extend=function(r){var a=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=a.__super__=this.prototype,h=i(c);h.constructor=a,a.prototype=h;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(a[_]=this[_]);return r.statics&&t(a,r.statics),r.includes&&(Hi(r.includes),t.apply(null,[h].concat(r.includes))),t(h,r),delete h.statics,delete h.includes,h.options&&(h.options=c.options?i(c.options):{},t(h.options,r.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var y=0,N=h._initHooks.length;y<N;y++)h._initHooks[y].call(this)}},a},$t.include=function(r){var a=this.prototype.options;return t(this.prototype,r),r.options&&(this.prototype.options=a,this.mergeOptions(r.options)),this},$t.mergeOptions=function(r){return t(this.prototype.options,r),this},$t.addInitHook=function(r){var a=Array.prototype.slice.call(arguments,1),c=typeof r=="function"?r:function(){this[r].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function Hi(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=S(r)?r:[r];for(var a=0;a<r.length;a++)r[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var At={on:function(r,a,c){if(typeof r=="object")for(var h in r)this._on(h,r[h],a);else{r=g(r);for(var _=0,y=r.length;_<y;_++)this._on(r[_],a,c)}return this},off:function(r,a,c){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var h in r)this._off(h,r[h],a);else{r=g(r);for(var _=arguments.length===1,y=0,N=r.length;y<N;y++)_?this._off(r[y]):this._off(r[y],a,c)}return this},_on:function(r,a,c,h){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(r,a,c)===!1){c===this&&(c=void 0);var _={fn:a,ctx:c};h&&(_.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(_)}},_off:function(r,a,c){var h,_,y;if(this._events&&(h=this._events[r],!!h)){if(arguments.length===1){if(this._firingCount)for(_=0,y=h.length;_<y;_++)h[_].fn=f;delete this._events[r];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var N=this._listens(r,a,c);if(N!==!1){var O=h[N];this._firingCount&&(O.fn=f,this._events[r]=h=h.slice()),h.splice(N,1)}}},fire:function(r,a,c){if(!this.listens(r,c))return this;var h=t({},a,{type:r,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var _=this._events[r];if(_){this._firingCount=this._firingCount+1||1;for(var y=0,N=_.length;y<N;y++){var O=_[y],U=O.fn;O.once&&this.off(r,U,O.ctx),U.call(O.ctx||this,h)}this._firingCount--}}return c&&this._propagateEvent(h),this},listens:function(r,a,c,h){typeof r!="string"&&console.warn('"string" type argument expected');var _=a;typeof a!="function"&&(h=!!a,_=void 0,c=void 0);var y=this._events&&this._events[r];if(y&&y.length&&this._listens(r,_,c)!==!1)return!0;if(h){for(var N in this._eventParents)if(this._eventParents[N].listens(r,a,c,h))return!0}return!1},_listens:function(r,a,c){if(!this._events)return!1;var h=this._events[r]||[];if(!a)return!!h.length;c===this&&(c=void 0);for(var _=0,y=h.length;_<y;_++)if(h[_].fn===a&&h[_].ctx===c)return _;return!1},once:function(r,a,c){if(typeof r=="object")for(var h in r)this._on(h,r[h],a,!0);else{r=g(r);for(var _=0,y=r.length;_<y;_++)this._on(r[_],a,c,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[l(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[l(r)],this},_propagateEvent:function(r){for(var a in this._eventParents)this._eventParents[a].fire(r.type,t({layer:r.target,propagatedFrom:r.target},r),!0)}};At.addEventListener=At.on,At.removeEventListener=At.clearAllEventListeners=At.off,At.addOneTimeEventListener=At.once,At.fireEvent=At.fire,At.hasEventListeners=At.listens;var Vi=$t.extend(At);function Pe(r,a,c){this.x=c?Math.round(r):r,this.y=c?Math.round(a):a}var Gi=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};Pe.prototype={clone:function(){return new Pe(this.x,this.y)},add:function(r){return this.clone()._add(Se(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(Se(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Pe(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Pe(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Gi(this.x),this.y=Gi(this.y),this},distanceTo:function(r){r=Se(r);var a=r.x-this.x,c=r.y-this.y;return Math.sqrt(a*a+c*c)},equals:function(r){return r=Se(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=Se(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function Se(r,a,c){return r instanceof Pe?r:S(r)?new Pe(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new Pe(r.x,r.y):new Pe(r,a,c)}function qe(r,a){if(r)for(var c=a?[r,a]:r,h=0,_=c.length;h<_;h++)this.extend(c[h])}qe.prototype={extend:function(r){var a,c;if(!r)return this;if(r instanceof Pe||typeof r[0]=="number"||"x"in r)a=c=Se(r);else if(r=F(r),a=r.min,c=r.max,!a||!c)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=c.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(r){return Se((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return Se(this.min.x,this.max.y)},getTopRight:function(){return Se(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var a,c;return typeof r[0]=="number"||r instanceof Pe?r=Se(r):r=F(r),r instanceof qe?(a=r.min,c=r.max):a=c=r,a.x>=this.min.x&&c.x<=this.max.x&&a.y>=this.min.y&&c.y<=this.max.y},intersects:function(r){r=F(r);var a=this.min,c=this.max,h=r.min,_=r.max,y=_.x>=a.x&&h.x<=c.x,N=_.y>=a.y&&h.y<=c.y;return y&&N},overlaps:function(r){r=F(r);var a=this.min,c=this.max,h=r.min,_=r.max,y=_.x>a.x&&h.x<c.x,N=_.y>a.y&&h.y<c.y;return y&&N},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var a=this.min,c=this.max,h=Math.abs(a.x-c.x)*r,_=Math.abs(a.y-c.y)*r;return F(Se(a.x-h,a.y-_),Se(c.x+h,c.y+_))},equals:function(r){return r?(r=F(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function F(r,a){return!r||r instanceof qe?r:new qe(r,a)}function Q(r,a){if(r)for(var c=a?[r,a]:r,h=0,_=c.length;h<_;h++)this.extend(c[h])}Q.prototype={extend:function(r){var a=this._southWest,c=this._northEast,h,_;if(r instanceof H)h=r,_=r;else if(r instanceof Q){if(h=r._southWest,_=r._northEast,!h||!_)return this}else return r?this.extend(G(r)||A(r)):this;return!a&&!c?(this._southWest=new H(h.lat,h.lng),this._northEast=new H(_.lat,_.lng)):(a.lat=Math.min(h.lat,a.lat),a.lng=Math.min(h.lng,a.lng),c.lat=Math.max(_.lat,c.lat),c.lng=Math.max(_.lng,c.lng)),this},pad:function(r){var a=this._southWest,c=this._northEast,h=Math.abs(a.lat-c.lat)*r,_=Math.abs(a.lng-c.lng)*r;return new Q(new H(a.lat-h,a.lng-_),new H(c.lat+h,c.lng+_))},getCenter:function(){return new H((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new H(this.getNorth(),this.getWest())},getSouthEast:function(){return new H(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof H||"lat"in r?r=G(r):r=A(r);var a=this._southWest,c=this._northEast,h,_;return r instanceof Q?(h=r.getSouthWest(),_=r.getNorthEast()):h=_=r,h.lat>=a.lat&&_.lat<=c.lat&&h.lng>=a.lng&&_.lng<=c.lng},intersects:function(r){r=A(r);var a=this._southWest,c=this._northEast,h=r.getSouthWest(),_=r.getNorthEast(),y=_.lat>=a.lat&&h.lat<=c.lat,N=_.lng>=a.lng&&h.lng<=c.lng;return y&&N},overlaps:function(r){r=A(r);var a=this._southWest,c=this._northEast,h=r.getSouthWest(),_=r.getNorthEast(),y=_.lat>a.lat&&h.lat<c.lat,N=_.lng>a.lng&&h.lng<c.lng;return y&&N},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,a){return r?(r=A(r),this._southWest.equals(r.getSouthWest(),a)&&this._northEast.equals(r.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function A(r,a){return r instanceof Q?r:new Q(r,a)}function H(r,a,c){if(isNaN(r)||isNaN(a))throw new Error("Invalid LatLng object: ("+r+", "+a+")");this.lat=+r,this.lng=+a,c!==void 0&&(this.alt=+c)}H.prototype={equals:function(r,a){if(!r)return!1;r=G(r);var c=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return c<=(a===void 0?1e-9:a)},toString:function(r){return"LatLng("+p(this.lat,r)+", "+p(this.lng,r)+")"},distanceTo:function(r){return w.distance(this,G(r))},wrap:function(){return w.wrapLatLng(this)},toBounds:function(r){var a=180*r/40075017,c=a/Math.cos(Math.PI/180*this.lat);return A([this.lat-a,this.lng-c],[this.lat+a,this.lng+c])},clone:function(){return new H(this.lat,this.lng,this.alt)}};function G(r,a,c){return r instanceof H?r:S(r)&&typeof r[0]!="object"?r.length===3?new H(r[0],r[1],r[2]):r.length===2?new H(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new H(r.lat,"lng"in r?r.lng:r.lon,r.alt):a===void 0?null:new H(r,a,c)}var de={latLngToPoint:function(r,a){var c=this.projection.project(r),h=this.scale(a);return this.transformation._transform(c,h)},pointToLatLng:function(r,a){var c=this.scale(a),h=this.transformation.untransform(r,c);return this.projection.unproject(h)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var a=this.projection.bounds,c=this.scale(r),h=this.transformation.transform(a.min,c),_=this.transformation.transform(a.max,c);return new qe(h,_)},infinite:!1,wrapLatLng:function(r){var a=this.wrapLng?d(r.lng,this.wrapLng,!0):r.lng,c=this.wrapLat?d(r.lat,this.wrapLat,!0):r.lat,h=r.alt;return new H(c,a,h)},wrapLatLngBounds:function(r){var a=r.getCenter(),c=this.wrapLatLng(a),h=a.lat-c.lat,_=a.lng-c.lng;if(h===0&&_===0)return r;var y=r.getSouthWest(),N=r.getNorthEast(),O=new H(y.lat-h,y.lng-_),U=new H(N.lat-h,N.lng-_);return new Q(O,U)}},w=t({},de,{wrapLng:[-180,180],R:6371e3,distance:function(r,a){var c=Math.PI/180,h=r.lat*c,_=a.lat*c,y=Math.sin((a.lat-r.lat)*c/2),N=Math.sin((a.lng-r.lng)*c/2),O=y*y+Math.cos(h)*Math.cos(_)*N*N,U=2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O));return this.R*U}}),V=6378137,q={R:V,MAX_LATITUDE:85.0511287798,project:function(r){var a=Math.PI/180,c=this.MAX_LATITUDE,h=Math.max(Math.min(c,r.lat),-c),_=Math.sin(h*a);return new Pe(this.R*r.lng*a,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(r){var a=180/Math.PI;return new H((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*a,r.x*a/this.R)},bounds:function(){var r=V*Math.PI;return new qe([-r,-r],[r,r])}()};function ue(r,a,c,h){if(S(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=a,this._c=c,this._d=h}ue.prototype={transform:function(r,a){return this._transform(r.clone(),a)},_transform:function(r,a){return a=a||1,r.x=a*(this._a*r.x+this._b),r.y=a*(this._c*r.y+this._d),r},untransform:function(r,a){return a=a||1,new Pe((r.x/a-this._b)/this._a,(r.y/a-this._d)/this._c)}};function Ne(r,a,c,h){return new ue(r,a,c,h)}var Ve=t({},w,{code:"EPSG:3857",projection:q,transformation:function(){var r=.5/(Math.PI*q.R);return Ne(r,.5,-r,.5)}()}),ut=t({},Ve,{code:"EPSG:900913"});function zt(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function nn(r,a){var c="",h,_,y,N,O,U;for(h=0,y=r.length;h<y;h++){for(O=r[h],_=0,N=O.length;_<N;_++)U=O[_],c+=(_?"L":"M")+U.x+" "+U.y;c+=a?Ie.svg?"z":"x":""}return c||"M0 0"}var qt=document.documentElement.style,R="ActiveXObject"in window,J=R&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),ie=so("webkit"),le=so("android"),we=so("android 2")||so("android 3"),ke=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),St=le&&so("Google")&&ke<537&&!("AudioNode"in window),Ge=!!window.opera,Ot=!te&&so("chrome"),Xt=so("gecko")&&!ie&&!Ge&&!R,Cn=!Ot&&so("safari"),Is=so("phantom"),Mo="OTransition"in qt,Nn=navigator.platform.indexOf("Win")===0,Ul=R&&"transition"in qt,nv="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!we,uS="MozPerspective"in qt,mN=!window.L_DISABLE_3D&&(Ul||nv||uS)&&!Mo&&!Is,Xu=typeof orientation<"u"||so("mobile"),_N=Xu&&ie,vN=Xu&&nv,dS=!window.PointerEvent&&window.MSPointerEvent,hS=!!(window.PointerEvent||dS),pS="ontouchstart"in window||!!window.TouchEvent,gN=!window.L_NO_TOUCH&&(pS||hS),yN=Xu&&Ge,SN=Xu&&Xt,CN=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,TN=function(){var r=!1;try{var a=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",f,a),window.removeEventListener("testPassiveEventSupport",f,a)}catch{}return r}(),EN=function(){return!!document.createElement("canvas").getContext}(),rv=!!(document.createElementNS&&zt("svg").createSVGRect),bN=!!rv&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),xN=!rv&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var a=r.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),DN=navigator.platform.indexOf("Mac")===0,NN=navigator.platform.indexOf("Linux")===0;function so(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var Ie={ie:R,ielt9:J,edge:te,webkit:ie,android:le,android23:we,androidStock:St,opera:Ge,chrome:Ot,gecko:Xt,safari:Cn,phantom:Is,opera12:Mo,win:Nn,ie3d:Ul,webkit3d:nv,gecko3d:uS,any3d:mN,mobile:Xu,mobileWebkit:_N,mobileWebkit3d:vN,msPointer:dS,pointer:hS,touch:gN,touchNative:pS,mobileOpera:yN,mobileGecko:SN,retina:CN,passiveEvents:TN,canvas:EN,svg:rv,vml:xN,inlineSvg:bN,mac:DN,linux:NN},fS=Ie.msPointer?"MSPointerDown":"pointerdown",mS=Ie.msPointer?"MSPointerMove":"pointermove",_S=Ie.msPointer?"MSPointerUp":"pointerup",vS=Ie.msPointer?"MSPointerCancel":"pointercancel",ov={touchstart:fS,touchmove:mS,touchend:_S,touchcancel:vS},gS={touchstart:ON,touchmove:vp,touchend:vp,touchcancel:vp},zl={},yS=!1;function wN(r,a,c){return a==="touchstart"&&AN(),gS[a]?(c=gS[a].bind(this,c),r.addEventListener(ov[a],c,!1),c):(console.warn("wrong event specified:",a),f)}function IN(r,a,c){if(!ov[a]){console.warn("wrong event specified:",a);return}r.removeEventListener(ov[a],c,!1)}function PN(r){zl[r.pointerId]=r}function LN(r){zl[r.pointerId]&&(zl[r.pointerId]=r)}function SS(r){delete zl[r.pointerId]}function AN(){yS||(document.addEventListener(fS,PN,!0),document.addEventListener(mS,LN,!0),document.addEventListener(_S,SS,!0),document.addEventListener(vS,SS,!0),yS=!0)}function vp(r,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var c in zl)a.touches.push(zl[c]);a.changedTouches=[a],r(a)}}function ON(r,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&rn(a),vp(r,a)}function MN(r){var a={},c,h;for(h in r)c=r[h],a[h]=c&&c.bind?c.bind(r):c;return r=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var kN=200;function RN(r,a){r.addEventListener("dblclick",a);var c=0,h;function _(y){if(y.detail!==1){h=y.detail;return}if(!(y.pointerType==="mouse"||y.sourceCapabilities&&!y.sourceCapabilities.firesTouchEvents)){var N=xS(y);if(!(N.some(function(U){return U instanceof HTMLLabelElement&&U.attributes.for})&&!N.some(function(U){return U instanceof HTMLInputElement||U instanceof HTMLSelectElement}))){var O=Date.now();O-c<=kN?(h++,h===2&&a(MN(y))):h=1,c=O}}}return r.addEventListener("click",_),{dblclick:a,simDblclick:_}}function FN(r,a){r.removeEventListener("dblclick",a.dblclick),r.removeEventListener("click",a.simDblclick)}var av=Sp(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ju=Sp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),CS=Ju==="webkitTransition"||Ju==="OTransition"?Ju+"End":"transitionend";function TS(r){return typeof r=="string"?document.getElementById(r):r}function Ku(r,a){var c=r.style[a]||r.currentStyle&&r.currentStyle[a];if((!c||c==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(r,null);c=h?h[a]:null}return c==="auto"?null:c}function Dt(r,a,c){var h=document.createElement(r);return h.className=a||"",c&&c.appendChild(h),h}function ti(r){var a=r.parentNode;a&&a.removeChild(r)}function gp(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Hl(r){var a=r.parentNode;a&&a.lastChild!==r&&a.appendChild(r)}function Vl(r){var a=r.parentNode;a&&a.firstChild!==r&&a.insertBefore(r,a.firstChild)}function sv(r,a){if(r.classList!==void 0)return r.classList.contains(a);var c=yp(r);return c.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(c)}function rt(r,a){if(r.classList!==void 0)for(var c=g(a),h=0,_=c.length;h<_;h++)r.classList.add(c[h]);else if(!sv(r,a)){var y=yp(r);lv(r,(y?y+" ":"")+a)}}function _i(r,a){r.classList!==void 0?r.classList.remove(a):lv(r,m((" "+yp(r)+" ").replace(" "+a+" "," ")))}function lv(r,a){r.className.baseVal===void 0?r.className=a:r.className.baseVal=a}function yp(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function cr(r,a){"opacity"in r.style?r.style.opacity=a:"filter"in r.style&&YN(r,a)}function YN(r,a){var c=!1,h="DXImageTransform.Microsoft.Alpha";try{c=r.filters.item(h)}catch{if(a===1)return}a=Math.round(a*100),c?(c.Enabled=a!==100,c.Opacity=a):r.style.filter+=" progid:"+h+"(opacity="+a+")"}function Sp(r){for(var a=document.documentElement.style,c=0;c<r.length;c++)if(r[c]in a)return r[c];return!1}function Ps(r,a,c){var h=a||new Pe(0,0);r.style[av]=(Ie.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(c?" scale("+c+")":"")}function Ti(r,a){r._leaflet_pos=a,Ie.any3d?Ps(r,a):(r.style.left=a.x+"px",r.style.top=a.y+"px")}function Ls(r){return r._leaflet_pos||new Pe(0,0)}var Qu,ed,cv;if("onselectstart"in document)Qu=function(){Xe(window,"selectstart",rn)},ed=function(){Ht(window,"selectstart",rn)};else{var td=Sp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Qu=function(){if(td){var r=document.documentElement.style;cv=r[td],r[td]="none"}},ed=function(){td&&(document.documentElement.style[td]=cv,cv=void 0)}}function uv(){Xe(window,"dragstart",rn)}function dv(){Ht(window,"dragstart",rn)}var Cp,hv;function pv(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(Tp(),Cp=r,hv=r.style.outlineStyle,r.style.outlineStyle="none",Xe(window,"keydown",Tp))}function Tp(){Cp&&(Cp.style.outlineStyle=hv,Cp=void 0,hv=void 0,Ht(window,"keydown",Tp))}function ES(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function fv(r){var a=r.getBoundingClientRect();return{x:a.width/r.offsetWidth||1,y:a.height/r.offsetHeight||1,boundingClientRect:a}}var BN={__proto__:null,TRANSFORM:av,TRANSITION:Ju,TRANSITION_END:CS,get:TS,getStyle:Ku,create:Dt,remove:ti,empty:gp,toFront:Hl,toBack:Vl,hasClass:sv,addClass:rt,removeClass:_i,setClass:lv,getClass:yp,setOpacity:cr,testProp:Sp,setTransform:Ps,setPosition:Ti,getPosition:Ls,get disableTextSelection(){return Qu},get enableTextSelection(){return ed},disableImageDrag:uv,enableImageDrag:dv,preventOutline:pv,restoreOutline:Tp,getSizedParentNode:ES,getScale:fv};function Xe(r,a,c,h){if(a&&typeof a=="object")for(var _ in a)_v(r,_,a[_],c);else{a=g(a);for(var y=0,N=a.length;y<N;y++)_v(r,a[y],c,h)}return this}var lo="_leaflet_events";function Ht(r,a,c,h){if(arguments.length===1)bS(r),delete r[lo];else if(a&&typeof a=="object")for(var _ in a)vv(r,_,a[_],c);else if(a=g(a),arguments.length===2)bS(r,function(O){return I(a,O)!==-1});else for(var y=0,N=a.length;y<N;y++)vv(r,a[y],c,h);return this}function bS(r,a){for(var c in r[lo]){var h=c.split(/\d/)[0];(!a||a(h))&&vv(r,h,null,null,c)}}var mv={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function _v(r,a,c,h){var _=a+l(c)+(h?"_"+l(h):"");if(r[lo]&&r[lo][_])return this;var y=function(O){return c.call(h||r,O||window.event)},N=y;!Ie.touchNative&&Ie.pointer&&a.indexOf("touch")===0?y=wN(r,a,y):Ie.touch&&a==="dblclick"?y=RN(r,y):"addEventListener"in r?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?r.addEventListener(mv[a]||a,y,Ie.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(y=function(O){O=O||window.event,yv(r,O)&&N(O)},r.addEventListener(mv[a],y,!1)):r.addEventListener(a,N,!1):r.attachEvent("on"+a,y),r[lo]=r[lo]||{},r[lo][_]=y}function vv(r,a,c,h,_){_=_||a+l(c)+(h?"_"+l(h):"");var y=r[lo]&&r[lo][_];if(!y)return this;!Ie.touchNative&&Ie.pointer&&a.indexOf("touch")===0?IN(r,a,y):Ie.touch&&a==="dblclick"?FN(r,y):"removeEventListener"in r?r.removeEventListener(mv[a]||a,y,!1):r.detachEvent("on"+a,y),r[lo][_]=null}function As(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function gv(r){return _v(r,"wheel",As),this}function id(r){return Xe(r,"mousedown touchstart dblclick contextmenu",As),r._leaflet_disable_click=!0,this}function rn(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Os(r){return rn(r),As(r),this}function xS(r){if(r.composedPath)return r.composedPath();for(var a=[],c=r.target;c;)a.push(c),c=c.parentNode;return a}function DS(r,a){if(!a)return new Pe(r.clientX,r.clientY);var c=fv(a),h=c.boundingClientRect;return new Pe((r.clientX-h.left)/c.x-a.clientLeft,(r.clientY-h.top)/c.y-a.clientTop)}var UN=Ie.linux&&Ie.chrome?window.devicePixelRatio:Ie.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function NS(r){return Ie.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/UN:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function yv(r,a){var c=a.relatedTarget;if(!c)return!0;try{for(;c&&c!==r;)c=c.parentNode}catch{return!1}return c!==r}var zN={__proto__:null,on:Xe,off:Ht,stopPropagation:As,disableScrollPropagation:gv,disableClickPropagation:id,preventDefault:rn,stop:Os,getPropagationPath:xS,getMousePosition:DS,getWheelDelta:NS,isExternalTarget:yv,addListener:Xe,removeListener:Ht},wS=Vi.extend({run:function(r,a,c,h){this.stop(),this._el=r,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=Ls(r),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=He(this._animate,this),this._step()},_step:function(r){var a=+new Date-this._startTime,c=this._duration*1e3;a<c?this._runFrame(this._easeOut(a/c),r):(this._runFrame(1),this._complete())},_runFrame:function(r,a){var c=this._startPos.add(this._offset.multiplyBy(r));a&&c._round(),Ti(this._el,c),this.fire("step")},_complete:function(){ct(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),Ct=Vi.extend({options:{crs:Ve,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,a){a=v(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(G(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ju&&Ie.any3d&&!Ie.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xe(this._proxy,CS,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,a,c){if(a=a===void 0?this._zoom:this._limitZoom(a),r=this._limitCenter(G(r),a,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=t({animate:c.animate},c.zoom),c.pan=t({animate:c.animate,duration:c.duration},c.pan));var h=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,a,c.zoom):this._tryAnimatedPan(r,c.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(r,a,c.pan&&c.pan.noMoveStart),this},setZoom:function(r,a){return this._loaded?this.setView(this.getCenter(),r,{zoom:a}):(this._zoom=r,this)},zoomIn:function(r,a){return r=r||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,a)},zoomOut:function(r,a){return r=r||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,a)},setZoomAround:function(r,a,c){var h=this.getZoomScale(a),_=this.getSize().divideBy(2),y=r instanceof Pe?r:this.latLngToContainerPoint(r),N=y.subtract(_).multiplyBy(1-1/h),O=this.containerPointToLatLng(_.add(N));return this.setView(O,a,{zoom:c})},_getBoundsCenterZoom:function(r,a){a=a||{},r=r.getBounds?r.getBounds():A(r);var c=Se(a.paddingTopLeft||a.padding||[0,0]),h=Se(a.paddingBottomRight||a.padding||[0,0]),_=this.getBoundsZoom(r,!1,c.add(h));if(_=typeof a.maxZoom=="number"?Math.min(a.maxZoom,_):_,_===1/0)return{center:r.getCenter(),zoom:_};var y=h.subtract(c).divideBy(2),N=this.project(r.getSouthWest(),_),O=this.project(r.getNorthEast(),_),U=this.unproject(N.add(O).divideBy(2).add(y),_);return{center:U,zoom:_}},fitBounds:function(r,a){if(r=A(r),!r.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(r,a);return this.setView(c.center,c.zoom,a)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,a){return this.setView(r,this._zoom,{pan:a})},panBy:function(r,a){if(r=Se(r).round(),a=a||{},!r.x&&!r.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new wS,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){rt(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,c,a.duration||.25,a.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,a,c){if(c=c||{},c.animate===!1||!Ie.any3d)return this.setView(r,a,c);this._stop();var h=this.project(this.getCenter()),_=this.project(r),y=this.getSize(),N=this._zoom;r=G(r),a=a===void 0?N:a;var O=Math.max(y.x,y.y),U=O*this.getZoomScale(N,a),K=_.distanceTo(h)||1,ve=1.42,Re=ve*ve;function ht(Ei){var Mp=Ei?-1:1,Iw=Ei?U:O,Pw=U*U-O*O+Mp*Re*Re*K*K,Lw=2*Iw*Re*K,Pv=Pw/Lw,lC=Math.sqrt(Pv*Pv+1)-Pv,Aw=lC<1e-9?-18:Math.log(lC);return Aw}function Tn(Ei){return(Math.exp(Ei)-Math.exp(-Ei))/2}function Wi(Ei){return(Math.exp(Ei)+Math.exp(-Ei))/2}function dr(Ei){return Tn(Ei)/Wi(Ei)}var wn=ht(0);function ql(Ei){return O*(Wi(wn)/Wi(wn+ve*Ei))}function xw(Ei){return O*(Wi(wn)*dr(wn+ve*Ei)-Tn(wn))/Re}function Dw(Ei){return 1-Math.pow(1-Ei,1.5)}var Nw=Date.now(),aC=(ht(1)-wn)/ve,ww=c.duration?1e3*c.duration:1e3*aC*.8;function sC(){var Ei=(Date.now()-Nw)/ww,Mp=Dw(Ei)*aC;Ei<=1?(this._flyToFrame=He(sC,this),this._move(this.unproject(h.add(_.subtract(h).multiplyBy(xw(Mp)/K)),N),this.getScaleZoom(O/ql(Mp),N),{flyTo:!0})):this._move(r,a)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),sC.call(this),this},flyToBounds:function(r,a){var c=this._getBoundsCenterZoom(r,a);return this.flyTo(c.center,c.zoom,a)},setMaxBounds:function(r){return r=A(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var a=this.options.minZoom;return this.options.minZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var a=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&a!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,a){this._enforcingBounds=!0;var c=this.getCenter(),h=this._limitCenter(c,this._zoom,A(r));return c.equals(h)||this.panTo(h,a),this._enforcingBounds=!1,this},panInside:function(r,a){a=a||{};var c=Se(a.paddingTopLeft||a.padding||[0,0]),h=Se(a.paddingBottomRight||a.padding||[0,0]),_=this.project(this.getCenter()),y=this.project(r),N=this.getPixelBounds(),O=F([N.min.add(c),N.max.subtract(h)]),U=O.getSize();if(!O.contains(y)){this._enforcingBounds=!0;var K=y.subtract(O.getCenter()),ve=O.extend(y).getSize().subtract(U);_.x+=K.x<0?-ve.x:ve.x,_.y+=K.y<0?-ve.y:ve.y,this.panTo(this.unproject(_),a),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=t({animate:!1,pan:!0},r===!0?{animate:!0}:r);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),h=a.divideBy(2).round(),_=c.divideBy(2).round(),y=h.subtract(_);return!y.x&&!y.y?this:(r.animate&&r.pan?this.panBy(y):(r.pan&&this._rawPanBy(y),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=t({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=o(this._handleGeolocationResponse,this),c=o(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,c,r):navigator.geolocation.getCurrentPosition(a,c,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var a=r.code,c=r.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var a=r.coords.latitude,c=r.coords.longitude,h=new H(a,c),_=h.toBounds(r.coords.accuracy*2),y=this._locateOptions;if(y.setView){var N=this.getBoundsZoom(_);this.setView(h,y.maxZoom?Math.min(N,y.maxZoom):N)}var O={latlng:h,bounds:_,timestamp:r.timestamp};for(var U in r.coords)typeof r.coords[U]=="number"&&(O[U]=r.coords[U]);this.fire("locationfound",O)}},addHandler:function(r,a){if(!a)return this;var c=this[r]=new a(this);return this._handlers.push(c),this.options[r]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ti(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ct(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)ti(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,a){var c="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),h=Dt("div",c,a||this._mapPane);return r&&(this._panes[r]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),a=this.unproject(r.getBottomLeft()),c=this.unproject(r.getTopRight());return new Q(a,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,a,c){r=A(r),c=Se(c||[0,0]);var h=this.getZoom()||0,_=this.getMinZoom(),y=this.getMaxZoom(),N=r.getNorthWest(),O=r.getSouthEast(),U=this.getSize().subtract(c),K=F(this.project(O,h),this.project(N,h)).getSize(),ve=Ie.any3d?this.options.zoomSnap:1,Re=U.x/K.x,ht=U.y/K.y,Tn=a?Math.max(Re,ht):Math.min(Re,ht);return h=this.getScaleZoom(Tn,h),ve&&(h=Math.round(h/(ve/100))*(ve/100),h=a?Math.ceil(h/ve)*ve:Math.floor(h/ve)*ve),Math.max(_,Math.min(y,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Pe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,a){var c=this._getTopLeftPoint(r,a);return new qe(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,a){var c=this.options.crs;return a=a===void 0?this._zoom:a,c.scale(r)/c.scale(a)},getScaleZoom:function(r,a){var c=this.options.crs;a=a===void 0?this._zoom:a;var h=c.zoom(r*c.scale(a));return isNaN(h)?1/0:h},project:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(G(r),a)},unproject:function(r,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(Se(r),a)},layerPointToLatLng:function(r){var a=Se(r).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(r){var a=this.project(G(r))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(G(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(A(r))},distance:function(r,a){return this.options.crs.distance(G(r),G(a))},containerPointToLayerPoint:function(r){return Se(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return Se(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var a=this.containerPointToLayerPoint(Se(r));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(r)))},mouseEventToContainerPoint:function(r){return DS(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var a=this._container=TS(r);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xe(a,"scroll",this._onScroll,this),this._containerId=l(a)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ie.any3d,rt(r,"leaflet-container"+(Ie.touch?" leaflet-touch":"")+(Ie.retina?" leaflet-retina":"")+(Ie.ielt9?" leaflet-oldie":"")+(Ie.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=Ku(r,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ti(this._mapPane,new Pe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(rt(r.markerPane,"leaflet-zoom-hide"),rt(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,a,c){Ti(this._mapPane,new Pe(0,0));var h=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var _=this._zoom!==a;this._moveStart(_,c)._move(r,a)._moveEnd(_),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(r,a){return r&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(r,a,c,h){a===void 0&&(a=this._zoom);var _=this._zoom!==a;return this._zoom=a,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),h?c&&c.pinch&&this.fire("zoom",c):((_||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ct(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){Ti(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[l(this._container)]=this;var a=r?Ht:Xe;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),Ie.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ct(this._resizeRequest),this._resizeRequest=He(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,a){for(var c=[],h,_=a==="mouseout"||a==="mouseover",y=r.target||r.srcElement,N=!1;y;){if(h=this._targets[l(y)],h&&(a==="click"||a==="preclick")&&this._draggableMoved(h)){N=!0;break}if(h&&h.listens(a,!0)&&(_&&!yv(y,r)||(c.push(h),_))||y===this._container)break;y=y.parentNode}return!c.length&&!N&&!_&&this.listens(a,!0)&&(c=[this]),c},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var a=r.target||r.srcElement;if(!(!this._loaded||a._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(a))){var c=r.type;c==="mousedown"&&pv(a),this._fireDOMEvent(r,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,a,c){if(r.type==="click"){var h=t({},r);h.type="preclick",this._fireDOMEvent(h,h.type,c)}var _=this._findEventTargets(r,a);if(c){for(var y=[],N=0;N<c.length;N++)c[N].listens(a,!0)&&y.push(c[N]);_=y.concat(_)}if(_.length){a==="contextmenu"&&rn(r);var O=_[0],U={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var K=O.getLatLng&&(!O._radius||O._radius<=10);U.containerPoint=K?this.latLngToContainerPoint(O.getLatLng()):this.mouseEventToContainerPoint(r),U.layerPoint=this.containerPointToLayerPoint(U.containerPoint),U.latlng=K?O.getLatLng():this.layerPointToLatLng(U.layerPoint)}for(N=0;N<_.length;N++)if(_[N].fire(a,U,!0),U.originalEvent._stopped||_[N].options.bubblingMouseEvents===!1&&I(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,a=this._handlers.length;r<a;r++)this._handlers[r].disable()},whenReady:function(r,a){return this._loaded?r.call(a||this,{target:this}):this.on("load",r,a),this},_getMapPanePos:function(){return Ls(this._mapPane)||new Pe(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,a){var c=r&&a!==void 0?this._getNewPixelOrigin(r,a):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,a){var c=this.getSize()._divideBy(2);return this.project(r,a)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,a,c){var h=this._getNewPixelOrigin(c,a);return this.project(r,a)._subtract(h)},_latLngBoundsToNewLayerBounds:function(r,a,c){var h=this._getNewPixelOrigin(c,a);return F([this.project(r.getSouthWest(),a)._subtract(h),this.project(r.getNorthWest(),a)._subtract(h),this.project(r.getSouthEast(),a)._subtract(h),this.project(r.getNorthEast(),a)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,a,c){if(!c)return r;var h=this.project(r,a),_=this.getSize().divideBy(2),y=new qe(h.subtract(_),h.add(_)),N=this._getBoundsOffset(y,c,a);return Math.abs(N.x)<=1&&Math.abs(N.y)<=1?r:this.unproject(h.add(N),a)},_limitOffset:function(r,a){if(!a)return r;var c=this.getPixelBounds(),h=new qe(c.min.add(r),c.max.add(r));return r.add(this._getBoundsOffset(h,a))},_getBoundsOffset:function(r,a,c){var h=F(this.project(a.getNorthEast(),c),this.project(a.getSouthWest(),c)),_=h.min.subtract(r.min),y=h.max.subtract(r.max),N=this._rebound(_.x,-y.x),O=this._rebound(_.y,-y.y);return new Pe(N,O)},_rebound:function(r,a){return r+a>0?Math.round(r-a)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(a))},_limitZoom:function(r){var a=this.getMinZoom(),c=this.getMaxZoom(),h=Ie.any3d?this.options.zoomSnap:1;return h&&(r=Math.round(r/h)*h),Math.max(a,Math.min(c,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){_i(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,a){var c=this._getCenterOffset(r)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,a),!0)},_createAnimProxy:function(){var r=this._proxy=Dt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(a){var c=av,h=this._proxy.style[c];Ps(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),h===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ti(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),a=this.getZoom();Ps(this._proxy,this.project(r,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,a,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(a),_=this._getCenterOffset(r)._divideBy(1-1/h);return c.animate!==!0&&!this.getSize().contains(_)?!1:(He(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(r,a,!0)},this),!0)},_animateZoom:function(r,a,c,h){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=a,rt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:a,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&_i(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function HN(r,a){return new Ct(r,a)}var Or=$t.extend({options:{position:"topright"},initialize:function(r){v(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var a=this._map;return a&&a.removeControl(this),this.options.position=r,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var a=this._container=this.onAdd(r),c=this.getPosition(),h=r._controlCorners[c];return rt(a,"leaflet-control"),c.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ti(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),nd=function(r){return new Or(r)};Ct.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},a="leaflet-",c=this._controlContainer=Dt("div",a+"control-container",this._container);function h(_,y){var N=a+_+" "+a+y;r[_+y]=Dt("div",N,c)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)ti(this._controlCorners[r]);ti(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var IS=Or.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,a,c,h){return c<h?-1:h<c?1:0}},initialize:function(r,a,c){v(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in r)this._addLayer(r[h],h);for(h in a)this._addLayer(a[h],h,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Or.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,a){return this._addLayer(r,a),this._map?this._update():this},addOverlay:function(r,a){return this._addLayer(r,a,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var a=this._getLayer(l(r));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){rt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(rt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):_i(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return _i(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",a=this._container=Dt("div",r),c=this.options.collapsed;a.setAttribute("aria-haspopup",!0),id(a),gv(a);var h=this._section=Dt("section",r+"-list");c&&(this._map.on("click",this.collapse,this),Xe(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Dt("a",r+"-toggle",a);_.href="#",_.title="Layers",_.setAttribute("role","button"),Xe(_,{keydown:function(y){y.keyCode===13&&this._expandSafely()},click:function(y){rn(y),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=Dt("div",r+"-base",h),this._separator=Dt("div",r+"-separator",h),this._overlaysList=Dt("div",r+"-overlays",h),a.appendChild(h)},_getLayer:function(r){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&l(this._layers[a].layer)===r)return this._layers[a]},_addLayer:function(r,a,c){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:a,overlay:c}),this.options.sortLayers&&this._layers.sort(o(function(h,_){return this.options.sortFunction(h.layer,_.layer,h.name,_.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;gp(this._baseLayersList),gp(this._overlaysList),this._layerControlInputs=[];var r,a,c,h,_=0;for(c=0;c<this._layers.length;c++)h=this._layers[c],this._addItem(h),a=a||h.overlay,r=r||!h.overlay,_+=h.overlay?0:1;return this.options.hideSingleBase&&(r=r&&_>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=a&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var a=this._getLayer(l(r.target)),c=a.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;c&&this._map.fire(c,a)},_createRadioElement:function(r,a){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(a?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=c,h.firstChild},_addItem:function(r){var a=document.createElement("label"),c=this._map.hasLayer(r.layer),h;r.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=c):h=this._createRadioElement("leaflet-base-layers_"+l(this),c),this._layerControlInputs.push(h),h.layerId=l(r.layer),Xe(h,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+r.name;var y=document.createElement("span");a.appendChild(y),y.appendChild(h),y.appendChild(_);var N=r.overlay?this._overlaysList:this._baseLayersList;return N.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,a,c,h=[],_=[];this._handlingClick=!0;for(var y=r.length-1;y>=0;y--)a=r[y],c=this._getLayer(a.layerId).layer,a.checked?h.push(c):a.checked||_.push(c);for(y=0;y<_.length;y++)this._map.hasLayer(_[y])&&this._map.removeLayer(_[y]);for(y=0;y<h.length;y++)this._map.hasLayer(h[y])||this._map.addLayer(h[y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,a,c,h=this._map.getZoom(),_=r.length-1;_>=0;_--)a=r[_],c=this._getLayer(a.layerId).layer,a.disabled=c.options.minZoom!==void 0&&h<c.options.minZoom||c.options.maxZoom!==void 0&&h>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Xe(r,"click",rn),this.expand();var a=this;setTimeout(function(){Ht(r,"click",rn),a._preventClick=!1})}}),VN=function(r,a,c){return new IS(r,a,c)},Sv=Or.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var a="leaflet-control-zoom",c=Dt("div",a+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,a+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,a+"-out",c,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,a,c,h,_){var y=Dt("a",c,h);return y.innerHTML=r,y.href="#",y.title=a,y.setAttribute("role","button"),y.setAttribute("aria-label",a),id(y),Xe(y,"click",Os),Xe(y,"click",_,this),Xe(y,"click",this._refocusOnMap,this),y},_updateDisabled:function(){var r=this._map,a="leaflet-disabled";_i(this._zoomInButton,a),_i(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(rt(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(rt(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Sv,this.addControl(this.zoomControl))});var GN=function(r){return new Sv(r)},PS=Or.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var a="leaflet-control-scale",c=Dt("div",a),h=this.options;return this._addScales(h,a+"-line",c),r.on(h.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),c},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,a,c){r.metric&&(this._mScale=Dt("div",a,c)),r.imperial&&(this._iScale=Dt("div",a,c))},_update:function(){var r=this._map,a=r.getSize().y/2,c=r.distance(r.containerPointToLatLng([0,a]),r.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(c)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var a=this._getRoundNum(r),c=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,c,a/r)},_updateImperial:function(r){var a=r*3.2808399,c,h,_;a>5280?(c=a/5280,h=this._getRoundNum(c),this._updateScale(this._iScale,h+" mi",h/c)):(_=this._getRoundNum(a),this._updateScale(this._iScale,_+" ft",_/a))},_updateScale:function(r,a,c){r.style.width=Math.round(this.options.maxWidth*c)+"px",r.innerHTML=a},_getRoundNum:function(r){var a=Math.pow(10,(Math.floor(r)+"").length-1),c=r/a;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,a*c}}),WN=function(r){return new PS(r)},ZN='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Cv=Or.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ie.inlineSvg?ZN+" ":"")+"Leaflet</a>"},initialize:function(r){v(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Dt("div","leaflet-control-attribution"),id(this._container);for(var a in r._layers)r._layers[a].getAttribution&&this.addAttribution(r._layers[a].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var a in this._attributions)this._attributions[a]&&r.push(a);var c=[];this.options.prefix&&c.push(this.options.prefix),r.length&&c.push(r.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new Cv().addTo(this)});var jN=function(r){return new Cv(r)};Or.Layers=IS,Or.Zoom=Sv,Or.Scale=PS,Or.Attribution=Cv,nd.layers=VN,nd.zoom=GN,nd.scale=WN,nd.attribution=jN;var co=$t.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});co.addTo=function(r,a){return r.addHandler(a,this),this};var $N={Events:At},LS=Ie.touch?"touchstart mousedown":"mousedown",ma=Vi.extend({options:{clickTolerance:3},initialize:function(r,a,c,h){v(this,h),this._element=r,this._dragStartTarget=a||r,this._preventOutline=c},enable:function(){this._enabled||(Xe(this._dragStartTarget,LS,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ma._dragging===this&&this.finishDrag(!0),Ht(this._dragStartTarget,LS,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!sv(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){ma._dragging===this&&this.finishDrag();return}if(!(ma._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(ma._dragging=this,this._preventOutline&&pv(this._element),uv(),Qu(),!this._moving)){this.fire("down");var a=r.touches?r.touches[0]:r,c=ES(this._element);this._startPoint=new Pe(a.clientX,a.clientY),this._startPos=Ls(this._element),this._parentScale=fv(c);var h=r.type==="mousedown";Xe(document,h?"mousemove":"touchmove",this._onMove,this),Xe(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var a=r.touches&&r.touches.length===1?r.touches[0]:r,c=new Pe(a.clientX,a.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,rn(r),this._moved||(this.fire("dragstart"),this._moved=!0,rt(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),rt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),Ti(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){_i(document.body,"leaflet-dragging"),this._lastTarget&&(_i(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ht(document,"mousemove touchmove",this._onMove,this),Ht(document,"mouseup touchend touchcancel",this._onUp,this),dv(),ed();var a=this._moved&&this._moving;this._moving=!1,ma._dragging=!1,a&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function AS(r,a,c){var h,_=[1,4,2,8],y,N,O,U,K,ve,Re,ht;for(y=0,ve=r.length;y<ve;y++)r[y]._code=Ms(r[y],a);for(O=0;O<4;O++){for(Re=_[O],h=[],y=0,ve=r.length,N=ve-1;y<ve;N=y++)U=r[y],K=r[N],U._code&Re?K._code&Re||(ht=Ep(K,U,Re,a,c),ht._code=Ms(ht,a),h.push(ht)):(K._code&Re&&(ht=Ep(K,U,Re,a,c),ht._code=Ms(ht,a),h.push(ht)),h.push(U));r=h}return r}function OS(r,a){var c,h,_,y,N,O,U,K,ve;if(!r||r.length===0)throw new Error("latlngs not passed");ur(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Re=G([0,0]),ht=A(r),Tn=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Tn<1700&&(Re=Tv(r));var Wi=r.length,dr=[];for(c=0;c<Wi;c++){var wn=G(r[c]);dr.push(a.project(G([wn.lat-Re.lat,wn.lng-Re.lng])))}for(O=U=K=0,c=0,h=Wi-1;c<Wi;h=c++)_=dr[c],y=dr[h],N=_.y*y.x-y.y*_.x,U+=(_.x+y.x)*N,K+=(_.y+y.y)*N,O+=N*3;O===0?ve=dr[0]:ve=[U/O,K/O];var ql=a.unproject(Se(ve));return G([ql.lat+Re.lat,ql.lng+Re.lng])}function Tv(r){for(var a=0,c=0,h=0,_=0;_<r.length;_++){var y=G(r[_]);a+=y.lat,c+=y.lng,h++}return G([a/h,c/h])}var qN={__proto__:null,clipPolygon:AS,polygonCenter:OS,centroid:Tv};function MS(r,a){if(!a||!r.length)return r.slice();var c=a*a;return r=KN(r,c),r=JN(r,c),r}function kS(r,a,c){return Math.sqrt(rd(r,a,c,!0))}function XN(r,a,c){return rd(r,a,c)}function JN(r,a){var c=r.length,h=typeof Uint8Array<"u"?Uint8Array:Array,_=new h(c);_[0]=_[c-1]=1,Ev(r,_,a,0,c-1);var y,N=[];for(y=0;y<c;y++)_[y]&&N.push(r[y]);return N}function Ev(r,a,c,h,_){var y=0,N,O,U;for(O=h+1;O<=_-1;O++)U=rd(r[O],r[h],r[_],!0),U>y&&(N=O,y=U);y>c&&(a[N]=1,Ev(r,a,c,h,N),Ev(r,a,c,N,_))}function KN(r,a){for(var c=[r[0]],h=1,_=0,y=r.length;h<y;h++)QN(r[h],r[_])>a&&(c.push(r[h]),_=h);return _<y-1&&c.push(r[y-1]),c}var RS;function FS(r,a,c,h,_){var y=h?RS:Ms(r,c),N=Ms(a,c),O,U,K;for(RS=N;;){if(!(y|N))return[r,a];if(y&N)return!1;O=y||N,U=Ep(r,a,O,c,_),K=Ms(U,c),O===y?(r=U,y=K):(a=U,N=K)}}function Ep(r,a,c,h,_){var y=a.x-r.x,N=a.y-r.y,O=h.min,U=h.max,K,ve;return c&8?(K=r.x+y*(U.y-r.y)/N,ve=U.y):c&4?(K=r.x+y*(O.y-r.y)/N,ve=O.y):c&2?(K=U.x,ve=r.y+N*(U.x-r.x)/y):c&1&&(K=O.x,ve=r.y+N*(O.x-r.x)/y),new Pe(K,ve,_)}function Ms(r,a){var c=0;return r.x<a.min.x?c|=1:r.x>a.max.x&&(c|=2),r.y<a.min.y?c|=4:r.y>a.max.y&&(c|=8),c}function QN(r,a){var c=a.x-r.x,h=a.y-r.y;return c*c+h*h}function rd(r,a,c,h){var _=a.x,y=a.y,N=c.x-_,O=c.y-y,U=N*N+O*O,K;return U>0&&(K=((r.x-_)*N+(r.y-y)*O)/U,K>1?(_=c.x,y=c.y):K>0&&(_+=N*K,y+=O*K)),N=r.x-_,O=r.y-y,h?N*N+O*O:new Pe(_,y)}function ur(r){return!S(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function YS(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ur(r)}function BS(r,a){var c,h,_,y,N,O,U,K;if(!r||r.length===0)throw new Error("latlngs not passed");ur(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var ve=G([0,0]),Re=A(r),ht=Re.getNorthWest().distanceTo(Re.getSouthWest())*Re.getNorthEast().distanceTo(Re.getNorthWest());ht<1700&&(ve=Tv(r));var Tn=r.length,Wi=[];for(c=0;c<Tn;c++){var dr=G(r[c]);Wi.push(a.project(G([dr.lat-ve.lat,dr.lng-ve.lng])))}for(c=0,h=0;c<Tn-1;c++)h+=Wi[c].distanceTo(Wi[c+1])/2;if(h===0)K=Wi[0];else for(c=0,y=0;c<Tn-1;c++)if(N=Wi[c],O=Wi[c+1],_=N.distanceTo(O),y+=_,y>h){U=(y-h)/_,K=[O.x-U*(O.x-N.x),O.y-U*(O.y-N.y)];break}var wn=a.unproject(Se(K));return G([wn.lat+ve.lat,wn.lng+ve.lng])}var ew={__proto__:null,simplify:MS,pointToSegmentDistance:kS,closestPointOnSegment:XN,clipSegment:FS,_getEdgeIntersection:Ep,_getBitCode:Ms,_sqClosestPointOnSegment:rd,isFlat:ur,_flat:YS,polylineCenter:BS},bv={project:function(r){return new Pe(r.lng,r.lat)},unproject:function(r){return new H(r.y,r.x)},bounds:new qe([-180,-90],[180,90])},xv={R:6378137,R_MINOR:6356752314245179e-9,bounds:new qe([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var a=Math.PI/180,c=this.R,h=r.lat*a,_=this.R_MINOR/c,y=Math.sqrt(1-_*_),N=y*Math.sin(h),O=Math.tan(Math.PI/4-h/2)/Math.pow((1-N)/(1+N),y/2);return h=-c*Math.log(Math.max(O,1e-10)),new Pe(r.lng*a*c,h)},unproject:function(r){for(var a=180/Math.PI,c=this.R,h=this.R_MINOR/c,_=Math.sqrt(1-h*h),y=Math.exp(-r.y/c),N=Math.PI/2-2*Math.atan(y),O=0,U=.1,K;O<15&&Math.abs(U)>1e-7;O++)K=_*Math.sin(N),K=Math.pow((1-K)/(1+K),_/2),U=Math.PI/2-2*Math.atan(y*K)-N,N+=U;return new H(N*a,r.x*a/c)}},tw={__proto__:null,LonLat:bv,Mercator:xv,SphericalMercator:q},iw=t({},w,{code:"EPSG:3395",projection:xv,transformation:function(){var r=.5/(Math.PI*xv.R);return Ne(r,.5,-r,.5)}()}),US=t({},w,{code:"EPSG:4326",projection:bv,transformation:Ne(1/180,1,-1/180,.5)}),nw=t({},de,{projection:bv,transformation:Ne(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,a){var c=a.lng-r.lng,h=a.lat-r.lat;return Math.sqrt(c*c+h*h)},infinite:!0});de.Earth=w,de.EPSG3395=iw,de.EPSG3857=Ve,de.EPSG900913=ut,de.EPSG4326=US,de.Simple=nw;var Mr=Vi.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[l(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[l(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var a=r.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var c=this.getEvents();a.on(c,this),this.once("remove",function(){a.off(c,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var a=l(r);return this._layers[a]?this:(this._layers[a]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var a=l(r);return this._layers[a]?(this._loaded&&r.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return l(r)in this._layers},eachLayer:function(r,a){for(var c in this._layers)r.call(a,this._layers[c]);return this},_addLayers:function(r){r=r?S(r)?r:[r]:[];for(var a=0,c=r.length;a<c;a++)this.addLayer(r[a])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[l(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var a=l(r);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,a=-1/0,c=this._getZoomSpan();for(var h in this._zoomBoundLayers){var _=this._zoomBoundLayers[h].options;r=_.minZoom===void 0?r:Math.min(r,_.minZoom),a=_.maxZoom===void 0?a:Math.max(a,_.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=r===1/0?void 0:r,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Gl=Mr.extend({initialize:function(r,a){v(this,a),this._layers={};var c,h;if(r)for(c=0,h=r.length;c<h;c++)this.addLayer(r[c])},addLayer:function(r){var a=this.getLayerId(r);return this._layers[a]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var a=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(r){var a=typeof r=="number"?r:this.getLayerId(r);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var a=Array.prototype.slice.call(arguments,1),c,h;for(c in this._layers)h=this._layers[c],h[r]&&h[r].apply(h,a);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,a){for(var c in this._layers)r.call(a,this._layers[c]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return l(r)}}),rw=function(r,a){return new Gl(r,a)},ko=Gl.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Gl.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Gl.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Q;for(var a in this._layers){var c=this._layers[a];r.extend(c.getBounds?c.getBounds():c.getLatLng())}return r}}),ow=function(r,a){return new ko(r,a)},Wl=$t.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){v(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,a){var c=this._getIconUrl(r);if(!c){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(c,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(h,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(r,a){var c=this.options,h=c[a+"Size"];typeof h=="number"&&(h=[h,h]);var _=Se(h),y=Se(a==="shadow"&&c.shadowAnchor||c.iconAnchor||_&&_.divideBy(2,!0));r.className="leaflet-marker-"+a+" "+(c.className||""),y&&(r.style.marginLeft=-y.x+"px",r.style.marginTop=-y.y+"px"),_&&(r.style.width=_.x+"px",r.style.height=_.y+"px")},_createImg:function(r,a){return a=a||document.createElement("img"),a.src=r,a},_getIconUrl:function(r){return Ie.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function aw(r){return new Wl(r)}var od=Wl.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof od.imagePath!="string"&&(od.imagePath=this._detectIconPath()),(this.options.imagePath||od.imagePath)+Wl.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var a=function(c,h,_){var y=h.exec(c);return y&&y[_]};return r=a(r,/^url\((['"])?(.+)\1\)$/,2),r&&a(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Dt("div","leaflet-default-icon-path",document.body),a=Ku(r,"background-image")||Ku(r,"backgroundImage");if(document.body.removeChild(r),a=this._stripUrl(a),a)return a;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),zS=co.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new ma(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),rt(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&_i(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var a=this._marker,c=a._map,h=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,y=Ls(a._icon),N=c.getPixelBounds(),O=c.getPixelOrigin(),U=F(N.min._subtract(O).add(_),N.max._subtract(O).subtract(_));if(!U.contains(y)){var K=Se((Math.max(U.max.x,y.x)-U.max.x)/(N.max.x-U.max.x)-(Math.min(U.min.x,y.x)-U.min.x)/(N.min.x-U.min.x),(Math.max(U.max.y,y.y)-U.max.y)/(N.max.y-U.max.y)-(Math.min(U.min.y,y.y)-U.min.y)/(N.min.y-U.min.y)).multiplyBy(h);c.panBy(K,{animate:!1}),this._draggable._newPos._add(K),this._draggable._startPos._add(K),Ti(a._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=He(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(ct(this._panRequest),this._panRequest=He(this._adjustPan.bind(this,r)))},_onDrag:function(r){var a=this._marker,c=a._shadow,h=Ls(a._icon),_=a._map.layerPointToLatLng(h);c&&Ti(c,h),a._latlng=_,r.latlng=_,r.oldLatLng=this._oldLatLng,a.fire("move",r).fire("drag",r)},_onDragEnd:function(r){ct(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),bp=Mr.extend({options:{icon:new od,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,a){v(this,a),this._latlng=G(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var a=this._latlng;return this._latlng=G(r),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=r.icon.createIcon(this._icon),h=!1;c!==this._icon&&(this._icon&&this._removeIcon(),h=!0,r.title&&(c.title=r.title),c.tagName==="IMG"&&(c.alt=r.alt||"")),rt(c,a),r.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(c,"focus",this._panOnFocus,this);var _=r.icon.createShadow(this._shadow),y=!1;_!==this._shadow&&(this._removeShadow(),y=!0),_&&(rt(_,a),_.alt=""),this._shadow=_,r.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&y&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ht(this._icon,"focus",this._panOnFocus,this),ti(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ti(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&Ti(this._icon,r),this._shadow&&Ti(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(rt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),zS)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new zS(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&cr(this._icon,r),this._shadow&&cr(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var a=this.options.icon.options,c=a.iconSize?Se(a.iconSize):Se(0,0),h=a.iconAnchor?Se(a.iconAnchor):Se(0,0);r.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:c.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function sw(r,a){return new bp(r,a)}var _a=Mr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return v(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),xp=_a.extend({options:{fill:!0,radius:10},initialize:function(r,a){v(this,a),this._latlng=G(r),this._radius=this.options.radius},setLatLng:function(r){var a=this._latlng;return this._latlng=G(r),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var a=r&&r.radius||this._radius;return _a.prototype.setStyle.call(this,r),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,a=this._radiusY||r,c=this._clickTolerance(),h=[r+c,a+c];this._pxBounds=new qe(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function lw(r,a){return new xp(r,a)}var Dv=xp.extend({initialize:function(r,a,c){if(typeof a=="number"&&(a=t({},c,{radius:a})),v(this,a),this._latlng=G(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Q(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:_a.prototype.setStyle,_project:function(){var r=this._latlng.lng,a=this._latlng.lat,c=this._map,h=c.options.crs;if(h.distance===w.distance){var _=Math.PI/180,y=this._mRadius/w.R/_,N=c.project([a+y,r]),O=c.project([a-y,r]),U=N.add(O).divideBy(2),K=c.unproject(U).lat,ve=Math.acos((Math.cos(y*_)-Math.sin(a*_)*Math.sin(K*_))/(Math.cos(a*_)*Math.cos(K*_)))/_;(isNaN(ve)||ve===0)&&(ve=y/Math.cos(Math.PI/180*a)),this._point=U.subtract(c.getPixelOrigin()),this._radius=isNaN(ve)?0:U.x-c.project([K,r-ve]).x,this._radiusY=U.y-N.y}else{var Re=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(Re).x}this._updateBounds()}});function cw(r,a,c){return new Dv(r,a,c)}var Ro=_a.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,a){v(this,a),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var a=1/0,c=null,h=rd,_,y,N=0,O=this._parts.length;N<O;N++)for(var U=this._parts[N],K=1,ve=U.length;K<ve;K++){_=U[K-1],y=U[K];var Re=h(r,_,y,!0);Re<a&&(a=Re,c=h(r,_,y))}return c&&(c.distance=Math.sqrt(a)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return BS(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,a){return a=a||this._defaultShape(),r=G(r),a.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Q,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return ur(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var a=[],c=ur(r),h=0,_=r.length;h<_;h++)c?(a[h]=G(r[h]),this._bounds.extend(a[h])):a[h]=this._convertLatLngs(r[h]);return a},_project:function(){var r=new qe;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),a=new Pe(r,r);this._rawPxBounds&&(this._pxBounds=new qe([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(r,a,c){var h=r[0]instanceof H,_=r.length,y,N;if(h){for(N=[],y=0;y<_;y++)N[y]=this._map.latLngToLayerPoint(r[y]),c.extend(N[y]);a.push(N)}else for(y=0;y<_;y++)this._projectLatlngs(r[y],a,c)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,c,h,_,y,N,O,U;for(c=0,_=0,y=this._rings.length;c<y;c++)for(U=this._rings[c],h=0,N=U.length;h<N-1;h++)O=FS(U[h],U[h+1],r,h,!0),O&&(a[_]=a[_]||[],a[_].push(O[0]),(O[1]!==U[h+1]||h===N-2)&&(a[_].push(O[1]),_++))}},_simplifyPoints:function(){for(var r=this._parts,a=this.options.smoothFactor,c=0,h=r.length;c<h;c++)r[c]=MS(r[c],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,a){var c,h,_,y,N,O,U=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(c=0,y=this._parts.length;c<y;c++)for(O=this._parts[c],h=0,N=O.length,_=N-1;h<N;_=h++)if(!(!a&&h===0)&&kS(r,O[_],O[h])<=U)return!0;return!1}});function uw(r,a){return new Ro(r,a)}Ro._flat=YS;var Zl=Ro.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return OS(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var a=Ro.prototype._convertLatLngs.call(this,r),c=a.length;return c>=2&&a[0]instanceof H&&a[0].equals(a[c-1])&&a.pop(),a},_setLatLngs:function(r){Ro.prototype._setLatLngs.call(this,r),ur(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ur(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,a=this.options.weight,c=new Pe(a,a);if(r=new qe(r.min.subtract(c),r.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,_=this._rings.length,y;h<_;h++)y=AS(this._rings[h],r,!0),y.length&&this._parts.push(y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var a=!1,c,h,_,y,N,O,U,K;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(y=0,U=this._parts.length;y<U;y++)for(c=this._parts[y],N=0,K=c.length,O=K-1;N<K;O=N++)h=c[N],_=c[O],h.y>r.y!=_.y>r.y&&r.x<(_.x-h.x)*(r.y-h.y)/(_.y-h.y)+h.x&&(a=!a);return a||Ro.prototype._containsPoint.call(this,r,!0)}});function dw(r,a){return new Zl(r,a)}var Fo=ko.extend({initialize:function(r,a){v(this,a),this._layers={},r&&this.addData(r)},addData:function(r){var a=S(r)?r:r.features,c,h,_;if(a){for(c=0,h=a.length;c<h;c++)_=a[c],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var y=this.options;if(y.filter&&!y.filter(r))return this;var N=Dp(r,y);return N?(N.feature=Ip(r),N.defaultOptions=N.options,this.resetStyle(N),y.onEachFeature&&y.onEachFeature(r,N),this.addLayer(N)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=t({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(a){this._setLayerStyle(a,r)},this)},_setLayerStyle:function(r,a){r.setStyle&&(typeof a=="function"&&(a=a(r.feature)),r.setStyle(a))}});function Dp(r,a){var c=r.type==="Feature"?r.geometry:r,h=c?c.coordinates:null,_=[],y=a&&a.pointToLayer,N=a&&a.coordsToLatLng||Nv,O,U,K,ve;if(!h&&!c)return null;switch(c.type){case"Point":return O=N(h),HS(y,r,O,a);case"MultiPoint":for(K=0,ve=h.length;K<ve;K++)O=N(h[K]),_.push(HS(y,r,O,a));return new ko(_);case"LineString":case"MultiLineString":return U=Np(h,c.type==="LineString"?0:1,N),new Ro(U,a);case"Polygon":case"MultiPolygon":return U=Np(h,c.type==="Polygon"?1:2,N),new Zl(U,a);case"GeometryCollection":for(K=0,ve=c.geometries.length;K<ve;K++){var Re=Dp({geometry:c.geometries[K],type:"Feature",properties:r.properties},a);Re&&_.push(Re)}return new ko(_);case"FeatureCollection":for(K=0,ve=c.features.length;K<ve;K++){var ht=Dp(c.features[K],a);ht&&_.push(ht)}return new ko(_);default:throw new Error("Invalid GeoJSON object.")}}function HS(r,a,c,h){return r?r(a,c):new bp(c,h&&h.markersInheritOptions&&h)}function Nv(r){return new H(r[1],r[0],r[2])}function Np(r,a,c){for(var h=[],_=0,y=r.length,N;_<y;_++)N=a?Np(r[_],a-1,c):(c||Nv)(r[_]),h.push(N);return h}function wv(r,a){return r=G(r),r.alt!==void 0?[p(r.lng,a),p(r.lat,a),p(r.alt,a)]:[p(r.lng,a),p(r.lat,a)]}function wp(r,a,c,h){for(var _=[],y=0,N=r.length;y<N;y++)_.push(a?wp(r[y],ur(r[y])?0:a-1,c,h):wv(r[y],h));return!a&&c&&_.length>0&&_.push(_[0].slice()),_}function jl(r,a){return r.feature?t({},r.feature,{geometry:a}):Ip(a)}function Ip(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Iv={toGeoJSON:function(r){return jl(this,{type:"Point",coordinates:wv(this.getLatLng(),r)})}};bp.include(Iv),Dv.include(Iv),xp.include(Iv),Ro.include({toGeoJSON:function(r){var a=!ur(this._latlngs),c=wp(this._latlngs,a?1:0,!1,r);return jl(this,{type:(a?"Multi":"")+"LineString",coordinates:c})}}),Zl.include({toGeoJSON:function(r){var a=!ur(this._latlngs),c=a&&!ur(this._latlngs[0]),h=wp(this._latlngs,c?2:a?1:0,!0,r);return a||(h=[h]),jl(this,{type:(c?"Multi":"")+"Polygon",coordinates:h})}}),Gl.include({toMultiPoint:function(r){var a=[];return this.eachLayer(function(c){a.push(c.toGeoJSON(r).geometry.coordinates)}),jl(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(r){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(r);var c=a==="GeometryCollection",h=[];return this.eachLayer(function(_){if(_.toGeoJSON){var y=_.toGeoJSON(r);if(c)h.push(y.geometry);else{var N=Ip(y);N.type==="FeatureCollection"?h.push.apply(h,N.features):h.push(N)}}}),c?jl(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function VS(r,a){return new Fo(r,a)}var hw=VS,Pp=Mr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,a,c){this._url=r,this._bounds=A(a),v(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(rt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ti(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&Hl(this._image),this},bringToBack:function(){return this._map&&Vl(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=A(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",a=this._image=r?this._url:Dt("img");if(rt(a,"leaflet-image-layer"),this._zoomAnimated&&rt(a,"leaflet-zoom-animated"),this.options.className&&rt(a,this.options.className),a.onselectstart=f,a.onmousemove=f,a.onload=o(this.fire,this,"load"),a.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(r){var a=this._map.getZoomScale(r.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Ps(this._image,c,a)},_reset:function(){var r=this._image,a=new qe(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=a.getSize();Ti(r,a.min),r.style.width=c.x+"px",r.style.height=c.y+"px"},_updateOpacity:function(){cr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),pw=function(r,a,c){return new Pp(r,a,c)},GS=Pp.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",a=this._image=r?this._url:Dt("video");if(rt(a,"leaflet-image-layer"),this._zoomAnimated&&rt(a,"leaflet-zoom-animated"),this.options.className&&rt(a,this.options.className),a.onselectstart=f,a.onmousemove=f,a.onloadeddata=o(this.fire,this,"load"),r){for(var c=a.getElementsByTagName("source"),h=[],_=0;_<c.length;_++)h.push(c[_].src);this._url=c.length>0?h:[a.src];return}S(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var y=0;y<this._url.length;y++){var N=Dt("source");N.src=this._url[y],a.appendChild(N)}}});function fw(r,a,c){return new GS(r,a,c)}var WS=Pp.extend({_initImage:function(){var r=this._image=this._url;rt(r,"leaflet-image-layer"),this._zoomAnimated&&rt(r,"leaflet-zoom-animated"),this.options.className&&rt(r,this.options.className),r.onselectstart=f,r.onmousemove=f}});function mw(r,a,c){return new WS(r,a,c)}var uo=Mr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,a){r&&(r instanceof H||S(r))?(this._latlng=G(r),v(this,a)):(v(this,r),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&cr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&cr(this._container,1),this.bringToFront(),this.options.interactive&&(rt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(cr(this._container,0),this._removeTimeout=setTimeout(o(ti,void 0,this._container),200)):ti(this._container),this.options.interactive&&(_i(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=G(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Hl(this._container),this},bringToBack:function(){return this._map&&Vl(this._container),this},_prepareOpen:function(r){var a=this._source;if(!a._map)return!1;if(a instanceof ko){a=null;var c=this._source._layers;for(var h in c)if(c[h]._map){a=c[h];break}if(!a)return!1;this._source=a}if(!r)if(a.getCenter)r=a.getCenter();else if(a.getLatLng)r=a.getLatLng();else if(a.getBounds)r=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")r.innerHTML=a;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),a=Se(this.options.offset),c=this._getAnchor();this._zoomAnimated?Ti(this._container,r.add(c)):a=a.add(r).add(c);var h=this._containerBottom=-a.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=h+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(r,a,c,h){var _=a;return _ instanceof r||(_=new r(h).setContent(a)),c&&_.setLatLng(c),_}}),Mr.include({_initOverlay:function(r,a,c,h){var _=c;return _ instanceof r?(v(_,h),_._source=this):(_=a&&!h?a:new r(h,this),_.setContent(c)),_}});var Lp=uo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,uo.prototype.openOn.call(this,r)},onAdd:function(r){uo.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _a||this._source.on("preclick",As))},onRemove:function(r){uo.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _a||this._source.off("preclick",As))},getEvents:function(){var r=uo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",a=this._container=Dt("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=Dt("div",r+"-content-wrapper",a);if(this._contentNode=Dt("div",r+"-content",c),id(a),gv(this._contentNode),Xe(a,"contextmenu",As),this._tipContainer=Dt("div",r+"-tip-container",a),this._tip=Dt("div",r+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=Dt("a",r+"-close-button",a);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',Xe(h,"click",function(_){rn(_),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,a=r.style;a.width="",a.whiteSpace="nowrap";var c=r.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),a.width=c+1+"px",a.whiteSpace="",a.height="";var h=r.offsetHeight,_=this.options.maxHeight,y="leaflet-popup-scrolled";_&&h>_?(a.height=_+"px",rt(r,y)):_i(r,y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),c=this._getAnchor();Ti(this._container,a.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,a=parseInt(Ku(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+a,h=this._containerWidth,_=new Pe(this._containerLeft,-c-this._containerBottom);_._add(Ls(this._container));var y=r.layerPointToContainerPoint(_),N=Se(this.options.autoPanPadding),O=Se(this.options.autoPanPaddingTopLeft||N),U=Se(this.options.autoPanPaddingBottomRight||N),K=r.getSize(),ve=0,Re=0;y.x+h+U.x>K.x&&(ve=y.x+h-K.x+U.x),y.x-ve-O.x<0&&(ve=y.x-O.x),y.y+c+U.y>K.y&&(Re=y.y+c-K.y+U.y),y.y-Re-O.y<0&&(Re=y.y-O.y),(ve||Re)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([ve,Re]))}},_getAnchor:function(){return Se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),_w=function(r,a){return new Lp(r,a)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(r,a,c){return this._initOverlay(Lp,r,a,c).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),Mr.include({bindPopup:function(r,a){return this._popup=this._initOverlay(Lp,this._popup,r,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof ko||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){Os(r);var a=r.layer||r.target;if(this._popup._source===a&&!(a instanceof _a)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=a,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Ap=uo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){uo.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){uo.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=uo.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",a=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Dt("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var a,c,h=this._map,_=this._container,y=h.latLngToContainerPoint(h.getCenter()),N=h.layerPointToContainerPoint(r),O=this.options.direction,U=_.offsetWidth,K=_.offsetHeight,ve=Se(this.options.offset),Re=this._getAnchor();O==="top"?(a=U/2,c=K):O==="bottom"?(a=U/2,c=0):O==="center"?(a=U/2,c=K/2):O==="right"?(a=0,c=K/2):O==="left"?(a=U,c=K/2):N.x<y.x?(O="right",a=0,c=K/2):(O="left",a=U+(ve.x+Re.x)*2,c=K/2),r=r.subtract(Se(a,c,!0)).add(ve).add(Re),_i(_,"leaflet-tooltip-right"),_i(_,"leaflet-tooltip-left"),_i(_,"leaflet-tooltip-top"),_i(_,"leaflet-tooltip-bottom"),rt(_,"leaflet-tooltip-"+O),Ti(_,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&cr(this._container,r)},_animateZoom:function(r){var a=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(a)},_getAnchor:function(){return Se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),vw=function(r,a){return new Ap(r,a)};Ct.include({openTooltip:function(r,a,c){return this._initOverlay(Ap,r,a,c).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),Mr.include({bindTooltip:function(r,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ap,this._tooltip,r,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var a=r?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[a](c),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof ko||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&(Xe(a,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Xe(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var a=typeof r.getElement=="function"&&r.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var a=r.latlng,c,h;this._tooltip.options.sticky&&r.originalEvent&&(c=this._map.mouseEventToContainerPoint(r.originalEvent),h=this._map.containerPointToLayerPoint(c),a=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(a)}});var ZS=Wl.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var a=r&&r.tagName==="DIV"?r:document.createElement("div"),c=this.options;if(c.html instanceof Element?(gp(a),a.appendChild(c.html)):a.innerHTML=c.html!==!1?c.html:"",c.bgPos){var h=Se(c.bgPos);a.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function gw(r){return new ZS(r)}Wl.Default=od;var ad=Mr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ie.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){v(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),ti(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Hl(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Vl(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Pe?r:new Pe(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var a=this.getPane().children,c=-r(-1/0,1/0),h=0,_=a.length,y;h<_;h++)y=a[h].style.zIndex,a[h]!==this._container&&y&&(c=r(c,+y));isFinite(c)&&(this.options.zIndex=c+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ie.ielt9){cr(this._container,this.options.opacity);var r=+new Date,a=!1,c=!1;for(var h in this._tiles){var _=this._tiles[h];if(!(!_.current||!_.loaded)){var y=Math.min(1,(r-_.loaded)/200);cr(_.el,y),y<1?a=!0:(_.active?c=!0:this._onOpaqueTile(_),_.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),a&&(ct(this._fadeFrame),this._fadeFrame=He(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Dt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,a=this.options.maxZoom;if(r!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===r?(this._levels[c].el.style.zIndex=a-Math.abs(r-c),this._onUpdateLevel(c)):(ti(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var h=this._levels[r],_=this._map;return h||(h=this._levels[r]={},h.el=Dt("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=a,h.origin=_.project(_.unproject(_.getPixelOrigin()),r).round(),h.zoom=r,this._setZoomTransform(h,_.getCenter(),_.getZoom()),f(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var r,a,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)a=this._tiles[r],a.retain=a.current;for(r in this._tiles)if(a=this._tiles[r],a.current&&!a.active){var h=a.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var a in this._tiles)this._tiles[a].coords.z===r&&this._removeTile(a)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)ti(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,a,c,h){var _=Math.floor(r/2),y=Math.floor(a/2),N=c-1,O=new Pe(+_,+y);O.z=+N;var U=this._tileCoordsToKey(O),K=this._tiles[U];return K&&K.active?(K.retain=!0,!0):(K&&K.loaded&&(K.retain=!0),N>h?this._retainParent(_,y,N,h):!1)},_retainChildren:function(r,a,c,h){for(var _=2*r;_<2*r+2;_++)for(var y=2*a;y<2*a+2;y++){var N=new Pe(_,y);N.z=c+1;var O=this._tileCoordsToKey(N),U=this._tiles[O];if(U&&U.active){U.retain=!0;continue}else U&&U.loaded&&(U.retain=!0);c+1<h&&this._retainChildren(_,y,c+1,h)}},_resetView:function(r){var a=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var a=this.options;return a.minNativeZoom!==void 0&&r<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<r?a.maxNativeZoom:r},_setView:function(r,a,c,h){var _=Math.round(a);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var y=this.options.updateWhenZooming&&_!==this._tileZoom;(!h||y)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(r),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(r,a)},_setZoomTransforms:function(r,a){for(var c in this._levels)this._setZoomTransform(this._levels[c],r,a)},_setZoomTransform:function(r,a,c){var h=this._map.getZoomScale(c,r.zoom),_=r.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(a,c)).round();Ie.any3d?Ps(r.el,_,h):Ti(r.el,_)},_resetGrid:function(){var r=this._map,a=r.options.crs,c=this._tileSize=this.getTileSize(),h=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,a.wrapLng[0]],h).x/c.x),Math.ceil(r.project([0,a.wrapLng[1]],h).x/c.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([a.wrapLat[0],0],h).y/c.x),Math.ceil(r.project([a.wrapLat[1],0],h).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var a=this._map,c=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),h=a.getZoomScale(c,this._tileZoom),_=a.project(r,this._tileZoom).floor(),y=a.getSize().divideBy(h*2);return new qe(_.subtract(y),_.add(y))},_update:function(r){var a=this._map;if(a){var c=this._clampZoom(a.getZoom());if(r===void 0&&(r=a.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(r),_=this._pxBoundsToTileRange(h),y=_.getCenter(),N=[],O=this.options.keepBuffer,U=new qe(_.getBottomLeft().subtract([O,-O]),_.getTopRight().add([O,-O]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var K in this._tiles){var ve=this._tiles[K].coords;(ve.z!==this._tileZoom||!U.contains(new Pe(ve.x,ve.y)))&&(this._tiles[K].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(r,c);return}for(var Re=_.min.y;Re<=_.max.y;Re++)for(var ht=_.min.x;ht<=_.max.x;ht++){var Tn=new Pe(ht,Re);if(Tn.z=this._tileZoom,!!this._isValidTile(Tn)){var Wi=this._tiles[this._tileCoordsToKey(Tn)];Wi?Wi.current=!0:N.push(Tn)}}if(N.sort(function(wn,ql){return wn.distanceTo(y)-ql.distanceTo(y)}),N.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var dr=document.createDocumentFragment();for(ht=0;ht<N.length;ht++)this._addTile(N[ht],dr);this._level.el.appendChild(dr)}}}},_isValidTile:function(r){var a=this._map.options.crs;if(!a.infinite){var c=this._globalTileRange;if(!a.wrapLng&&(r.x<c.min.x||r.x>c.max.x)||!a.wrapLat&&(r.y<c.min.y||r.y>c.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(r);return A(this.options.bounds).overlaps(h)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var a=this._map,c=this.getTileSize(),h=r.scaleBy(c),_=h.add(c),y=a.unproject(h,r.z),N=a.unproject(_,r.z);return[y,N]},_tileCoordsToBounds:function(r){var a=this._tileCoordsToNwSe(r),c=new Q(a[0],a[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var a=r.split(":"),c=new Pe(+a[0],+a[1]);return c.z=+a[2],c},_removeTile:function(r){var a=this._tiles[r];a&&(ti(a.el),delete this._tiles[r],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){rt(r,"leaflet-tile");var a=this.getTileSize();r.style.width=a.x+"px",r.style.height=a.y+"px",r.onselectstart=f,r.onmousemove=f,Ie.ielt9&&this.options.opacity<1&&cr(r,this.options.opacity)},_addTile:function(r,a){var c=this._getTilePos(r),h=this._tileCoordsToKey(r),_=this.createTile(this._wrapCoords(r),o(this._tileReady,this,r));this._initTile(_),this.createTile.length<2&&He(o(this._tileReady,this,r,null,_)),Ti(_,c),this._tiles[h]={el:_,coords:r,current:!0},a.appendChild(_),this.fire("tileloadstart",{tile:_,coords:r})},_tileReady:function(r,a,c){a&&this.fire("tileerror",{error:a,tile:c,coords:r});var h=this._tileCoordsToKey(r);c=this._tiles[h],c&&(c.loaded=+new Date,this._map._fadeAnimated?(cr(c.el,0),ct(this._fadeFrame),this._fadeFrame=He(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),a||(rt(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ie.ielt9||!this._map._fadeAnimated?He(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var a=new Pe(this._wrapX?d(r.x,this._wrapX):r.x,this._wrapY?d(r.y,this._wrapY):r.y);return a.z=r.z,a},_pxBoundsToTileRange:function(r){var a=this.getTileSize();return new qe(r.min.unscaleBy(a).floor(),r.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function yw(r){return new ad(r)}var $l=ad.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,a){this._url=r,a=v(this,a),a.detectRetina&&Ie.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,a){return this._url===r&&a===void 0&&(a=!0),this._url=r,a||this.redraw(),this},createTile:function(r,a){var c=document.createElement("img");return Xe(c,"load",o(this._tileOnLoad,this,a,c)),Xe(c,"error",o(this._tileOnError,this,a,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(r),c},getTileUrl:function(r){var a={r:Ie.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-r.y;this.options.tms&&(a.y=c),a["-y"]=c}return b(this._url,t(a,this.options))},_tileOnLoad:function(r,a){Ie.ielt9?setTimeout(o(r,this,null,a),0):r(null,a)},_tileOnError:function(r,a,c){var h=this.options.errorTileUrl;h&&a.getAttribute("src")!==h&&(a.src=h),r(c,a)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,a=this.options.maxZoom,c=this.options.zoomReverse,h=this.options.zoomOffset;return c&&(r=a-r),r+h},_getSubdomain:function(r){var a=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var r,a;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(a=this._tiles[r].el,a.onload=f,a.onerror=f,!a.complete)){a.src=z;var c=this._tiles[r].coords;ti(a),delete this._tiles[r],this.fire("tileabort",{tile:a,coords:c})}},_removeTile:function(r){var a=this._tiles[r];if(a)return a.el.setAttribute("src",z),ad.prototype._removeTile.call(this,r)},_tileReady:function(r,a,c){if(!(!this._map||c&&c.getAttribute("src")===z))return ad.prototype._tileReady.call(this,r,a,c)}});function jS(r,a){return new $l(r,a)}var $S=$l.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,a){this._url=r;var c=t({},this.defaultWmsParams);for(var h in a)h in this.options||(c[h]=a[h]);a=v(this,a);var _=a.detectRetina&&Ie.retina?2:1,y=this.getTileSize();c.width=y.x*_,c.height=y.y*_,this.wmsParams=c},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,$l.prototype.onAdd.call(this,r)},getTileUrl:function(r){var a=this._tileCoordsToNwSe(r),c=this._crs,h=F(c.project(a[0]),c.project(a[1])),_=h.min,y=h.max,N=(this._wmsVersion>=1.3&&this._crs===US?[_.y,_.x,y.y,y.x]:[_.x,_.y,y.x,y.y]).join(","),O=$l.prototype.getTileUrl.call(this,r);return O+C(this.wmsParams,O,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+N},setParams:function(r,a){return t(this.wmsParams,r),a||this.redraw(),this}});function Sw(r,a){return new $S(r,a)}$l.WMS=$S,jS.wms=Sw;var Yo=Mr.extend({options:{padding:.1},initialize:function(r){v(this,r),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),rt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,a){var c=this._map.getZoomScale(a,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,a),y=h.multiplyBy(-c).add(_).subtract(this._map._getNewPixelOrigin(r,a));Ie.any3d?Ps(this._container,y,c):Ti(this._container,y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,a=this._map.getSize(),c=this._map.containerPointToLayerPoint(a.multiplyBy(-r)).round();this._bounds=new qe(c,c.add(a.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),qS=Yo.extend({options:{tolerance:0},getEvents:function(){var r=Yo.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Yo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Xe(r,"mousemove",this._onMouseMove,this),Xe(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xe(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){ct(this._redrawRequest),delete this._ctx,ti(this._container),Ht(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var a in this._layers)r=this._layers[a],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yo.prototype._update.call(this);var r=this._bounds,a=this._container,c=r.getSize(),h=Ie.retina?2:1;Ti(a,r.min),a.width=h*c.x,a.height=h*c.y,a.style.width=c.x+"px",a.style.height=c.y+"px",Ie.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Yo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[l(r)]=r;var a=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var a=r._order,c=a.next,h=a.prev;c?c.prev=h:this._drawLast=h,h?h.next=c:this._drawFirst=c,delete r._order,delete this._layers[l(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var a=r.options.dashArray.split(/[, ]+/),c=[],h,_;for(_=0;_<a.length;_++){if(h=Number(a[_]),isNaN(h))return;c.push(h)}r.options._dashArray=c}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||He(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var a=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new qe,this._redrawBounds.extend(r._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(r._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var a=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,a=this._redrawBounds;if(this._ctx.save(),a){var c=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)r=h.layer,(!a||r._pxBounds&&r._pxBounds.intersects(a))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,a){if(this._drawing){var c,h,_,y,N=r._parts,O=N.length,U=this._ctx;if(O){for(U.beginPath(),c=0;c<O;c++){for(h=0,_=N[c].length;h<_;h++)y=N[c][h],U[h?"lineTo":"moveTo"](y.x,y.y);a&&U.closePath()}this._fillStroke(U,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var a=r._point,c=this._ctx,h=Math.max(Math.round(r._radius),1),_=(Math.max(Math.round(r._radiusY),1)||h)/h;_!==1&&(c.save(),c.scale(1,_)),c.beginPath(),c.arc(a.x,a.y/_,h,0,Math.PI*2,!1),_!==1&&c.restore(),this._fillStroke(c,r)}},_fillStroke:function(r,a){var c=a.options;c.fill&&(r.globalAlpha=c.fillOpacity,r.fillStyle=c.fillColor||c.color,r.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(r.setLineDash&&r.setLineDash(a.options&&a.options._dashArray||[]),r.globalAlpha=c.opacity,r.lineWidth=c.weight,r.strokeStyle=c.color,r.lineCap=c.lineCap,r.lineJoin=c.lineJoin,r.stroke())},_onClick:function(r){for(var a=this._map.mouseEventToLayerPoint(r),c,h,_=this._drawFirst;_;_=_.next)c=_.layer,c.options.interactive&&c._containsPoint(a)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(c))&&(h=c);this._fireEvent(h?[h]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,a)}},_handleMouseOut:function(r){var a=this._hoveredLayer;a&&(_i(this._container,"leaflet-interactive"),this._fireEvent([a],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,a){if(!this._mouseHoverThrottled){for(var c,h,_=this._drawFirst;_;_=_.next)c=_.layer,c.options.interactive&&c._containsPoint(a)&&(h=c);h!==this._hoveredLayer&&(this._handleMouseOut(r),h&&(rt(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,a,c){this._map._fireDOMEvent(a,c||a.type,r)},_bringToFront:function(r){var a=r._order;if(a){var c=a.next,h=a.prev;if(c)c.prev=h;else return;h?h.next=c:c&&(this._drawFirst=c),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(r)}},_bringToBack:function(r){var a=r._order;if(a){var c=a.next,h=a.prev;if(h)h.next=c;else return;c?c.prev=h:h&&(this._drawLast=h),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(r)}}});function XS(r){return Ie.canvas?new qS(r):null}var sd=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Cw={_initContainer:function(){this._container=Dt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Yo.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var a=r._container=sd("shape");rt(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",r._path=sd("path"),a.appendChild(r._path),this._updateStyle(r),this._layers[l(r)]=r},_addPath:function(r){var a=r._container;this._container.appendChild(a),r.options.interactive&&r.addInteractiveTarget(a)},_removePath:function(r){var a=r._container;ti(a),r.removeInteractiveTarget(a),delete this._layers[l(r)]},_updateStyle:function(r){var a=r._stroke,c=r._fill,h=r.options,_=r._container;_.stroked=!!h.stroke,_.filled=!!h.fill,h.stroke?(a||(a=r._stroke=sd("stroke")),_.appendChild(a),a.weight=h.weight+"px",a.color=h.color,a.opacity=h.opacity,h.dashArray?a.dashStyle=S(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=h.lineCap.replace("butt","flat"),a.joinstyle=h.lineJoin):a&&(_.removeChild(a),r._stroke=null),h.fill?(c||(c=r._fill=sd("fill")),_.appendChild(c),c.color=h.fillColor||h.color,c.opacity=h.fillOpacity):c&&(_.removeChild(c),r._fill=null)},_updateCircle:function(r){var a=r._point.round(),c=Math.round(r._radius),h=Math.round(r._radiusY||c);this._setPath(r,r._empty()?"M0 0":"AL "+a.x+","+a.y+" "+c+","+h+" 0,"+65535*360)},_setPath:function(r,a){r._path.v=a},_bringToFront:function(r){Hl(r._container)},_bringToBack:function(r){Vl(r._container)}},Op=Ie.vml?sd:zt,ld=Yo.extend({_initContainer:function(){this._container=Op("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Op("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ti(this._container),Ht(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Yo.prototype._update.call(this);var r=this._bounds,a=r.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,c.setAttribute("width",a.x),c.setAttribute("height",a.y)),Ti(c,r.min),c.setAttribute("viewBox",[r.min.x,r.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(r){var a=r._path=Op("path");r.options.className&&rt(a,r.options.className),r.options.interactive&&rt(a,"leaflet-interactive"),this._updateStyle(r),this._layers[l(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){ti(r._path),r.removeInteractiveTarget(r._path),delete this._layers[l(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var a=r._path,c=r.options;a&&(c.stroke?(a.setAttribute("stroke",c.color),a.setAttribute("stroke-opacity",c.opacity),a.setAttribute("stroke-width",c.weight),a.setAttribute("stroke-linecap",c.lineCap),a.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?a.setAttribute("stroke-dasharray",c.dashArray):a.removeAttribute("stroke-dasharray"),c.dashOffset?a.setAttribute("stroke-dashoffset",c.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),c.fill?(a.setAttribute("fill",c.fillColor||c.color),a.setAttribute("fill-opacity",c.fillOpacity),a.setAttribute("fill-rule",c.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(r,a){this._setPath(r,nn(r._parts,a))},_updateCircle:function(r){var a=r._point,c=Math.max(Math.round(r._radius),1),h=Math.max(Math.round(r._radiusY),1)||c,_="a"+c+","+h+" 0 1,0 ",y=r._empty()?"M0 0":"M"+(a.x-c)+","+a.y+_+c*2+",0 "+_+-c*2+",0 ";this._setPath(r,y)},_setPath:function(r,a){r._path.setAttribute("d",a)},_bringToFront:function(r){Hl(r._path)},_bringToBack:function(r){Vl(r._path)}});Ie.vml&&ld.include(Cw);function JS(r){return Ie.svg||Ie.vml?new ld(r):null}Ct.include({getRenderer:function(r){var a=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var a=this._paneRenderers[r];return a===void 0&&(a=this._createRenderer({pane:r}),this._paneRenderers[r]=a),a},_createRenderer:function(r){return this.options.preferCanvas&&XS(r)||JS(r)}});var KS=Zl.extend({initialize:function(r,a){Zl.prototype.initialize.call(this,this._boundsToLatLngs(r),a)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=A(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Tw(r,a){return new KS(r,a)}ld.create=Op,ld.pointsToPath=nn,Fo.geometryToLayer=Dp,Fo.coordsToLatLng=Nv,Fo.coordsToLatLngs=Np,Fo.latLngToCoords=wv,Fo.latLngsToCoords=wp,Fo.getFeature=jl,Fo.asFeature=Ip,Ct.mergeOptions({boxZoom:!0});var QS=co.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ht(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ti(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Qu(),uv(),this._startPoint=this._map.mouseEventToContainerPoint(r),Xe(document,{contextmenu:Os,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Dt("div","leaflet-zoom-box",this._container),rt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var a=new qe(this._point,this._startPoint),c=a.getSize();Ti(this._box,a.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(ti(this._box),_i(this._container,"leaflet-crosshair")),ed(),dv(),Ht(document,{contextmenu:Os,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var a=new Q(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",QS),Ct.mergeOptions({doubleClickZoom:!0});var eC=co.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var a=this._map,c=a.getZoom(),h=a.options.zoomDelta,_=r.originalEvent.shiftKey?c-h:c+h;a.options.doubleClickZoom==="center"?a.setZoom(_):a.setZoomAround(r.containerPoint,_)}});Ct.addInitHook("addHandler","doubleClickZoom",eC),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var tC=co.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new ma(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}rt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){_i(this._map._container,"leaflet-grab"),_i(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=A(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var a=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(a),this._prunePositions(a)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,a){return r-(r-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;r.x<a.min.x&&(r.x=this._viscousLimit(r.x,a.min.x)),r.y<a.min.y&&(r.y=this._viscousLimit(r.y,a.min.y)),r.x>a.max.x&&(r.x=this._viscousLimit(r.x,a.max.x)),r.y>a.max.y&&(r.y=this._viscousLimit(r.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,a=Math.round(r/2),c=this._initialWorldOffset,h=this._draggable._newPos.x,_=(h-a+c)%r+a-c,y=(h+a+c)%r-a-c,N=Math.abs(_+c)<Math.abs(y+c)?_:y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=N},_onDragEnd:function(r){var a=this._map,c=a.options,h=!c.inertia||r.noInertia||this._times.length<2;if(a.fire("dragend",r),h)a.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),y=(this._lastTime-this._times[0])/1e3,N=c.easeLinearity,O=_.multiplyBy(N/y),U=O.distanceTo([0,0]),K=Math.min(c.inertiaMaxSpeed,U),ve=O.multiplyBy(K/U),Re=K/(c.inertiaDeceleration*N),ht=ve.multiplyBy(-Re/2).round();!ht.x&&!ht.y?a.fire("moveend"):(ht=a._limitOffset(ht,a.options.maxBounds),He(function(){a.panBy(ht,{duration:Re,easeLinearity:N,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",tC),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var iC=co.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Xe(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ht(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,a=document.documentElement,c=r.scrollTop||a.scrollTop,h=r.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(h,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var a=this._panKeys={},c=this.keyCodes,h,_;for(h=0,_=c.left.length;h<_;h++)a[c.left[h]]=[-1*r,0];for(h=0,_=c.right.length;h<_;h++)a[c.right[h]]=[r,0];for(h=0,_=c.down.length;h<_;h++)a[c.down[h]]=[0,r];for(h=0,_=c.up.length;h<_;h++)a[c.up[h]]=[0,-1*r]},_setZoomDelta:function(r){var a=this._zoomKeys={},c=this.keyCodes,h,_;for(h=0,_=c.zoomIn.length;h<_;h++)a[c.zoomIn[h]]=r;for(h=0,_=c.zoomOut.length;h<_;h++)a[c.zoomOut[h]]=-r},_addHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ht(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var a=r.keyCode,c=this._map,h;if(a in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(h=this._panKeys[a],r.shiftKey&&(h=Se(h).multiplyBy(3)),c.options.maxBounds&&(h=c._limitOffset(Se(h),c.options.maxBounds)),c.options.worldCopyJump){var _=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(h)));c.panTo(_)}else c.panBy(h)}else if(a in this._zoomKeys)c.setZoom(c.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;Os(r)}}});Ct.addInitHook("addHandler","keyboard",iC),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var nC=co.extend({addHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ht(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var a=NS(r),c=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var h=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),h),Os(r)},_performZoom:function(){var r=this._map,a=r.getZoom(),c=this._map.options.zoomSnap||0;r._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,y=c?Math.ceil(_/c)*c:_,N=r._limitZoom(a+(this._delta>0?y:-y))-a;this._delta=0,this._startTime=null,N&&(r.options.scrollWheelZoom==="center"?r.setZoom(a+N):r.setZoomAround(this._lastMousePos,a+N))}});Ct.addInitHook("addHandler","scrollWheelZoom",nC);var Ew=600;Ct.mergeOptions({tapHold:Ie.touchNative&&Ie.safari&&Ie.mobile,tapTolerance:15});var rC=co.extend({addHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ht(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var a=r.touches[0];this._startPos=this._newPos=new Pe(a.clientX,a.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Xe(document,"touchend",rn),Xe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),Ew),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Ht(document,"touchend",rn),Ht(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Ht(document,"touchend touchcancel contextmenu",this._cancel,this),Ht(document,"touchmove",this._onMove,this)},_onMove:function(r){var a=r.touches[0];this._newPos=new Pe(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,a){var c=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});c._simulated=!0,a.target.dispatchEvent(c)}});Ct.addInitHook("addHandler","tapHold",rC),Ct.mergeOptions({touchZoom:Ie.touch,bounceAtZoomLimits:!0});var oC=co.extend({addHooks:function(){rt(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){_i(this._map._container,"leaflet-touch-zoom"),Ht(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var a=this._map;if(!(!r.touches||r.touches.length!==2||a._animatingZoom||this._zooming)){var c=a.mouseEventToContainerPoint(r.touches[0]),h=a.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(c.add(h)._divideBy(2))),this._startDist=c.distanceTo(h),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),rn(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var a=this._map,c=a.mouseEventToContainerPoint(r.touches[0]),h=a.mouseEventToContainerPoint(r.touches[1]),_=c.distanceTo(h)/this._startDist;if(this._zoom=a.getScaleZoom(_,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&_<1||this._zoom>a.getMaxZoom()&&_>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var y=c._add(h)._divideBy(2)._subtract(this._centerPoint);if(_===1&&y.x===0&&y.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(y),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),ct(this._animRequest);var N=o(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=He(N,this,!0),rn(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ct(this._animRequest),Ht(document,"touchmove",this._onTouchMove,this),Ht(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",oC),Ct.BoxZoom=QS,Ct.DoubleClickZoom=eC,Ct.Drag=tC,Ct.Keyboard=iC,Ct.ScrollWheelZoom=nC,Ct.TapHold=rC,Ct.TouchZoom=oC,e.Bounds=qe,e.Browser=Ie,e.CRS=de,e.Canvas=qS,e.Circle=Dv,e.CircleMarker=xp,e.Class=$t,e.Control=Or,e.DivIcon=ZS,e.DivOverlay=uo,e.DomEvent=zN,e.DomUtil=BN,e.Draggable=ma,e.Evented=Vi,e.FeatureGroup=ko,e.GeoJSON=Fo,e.GridLayer=ad,e.Handler=co,e.Icon=Wl,e.ImageOverlay=Pp,e.LatLng=H,e.LatLngBounds=Q,e.Layer=Mr,e.LayerGroup=Gl,e.LineUtil=ew,e.Map=Ct,e.Marker=bp,e.Mixin=$N,e.Path=_a,e.Point=Pe,e.PolyUtil=qN,e.Polygon=Zl,e.Polyline=Ro,e.Popup=Lp,e.PosAnimation=wS,e.Projection=tw,e.Rectangle=KS,e.Renderer=Yo,e.SVG=ld,e.SVGOverlay=WS,e.TileLayer=$l,e.Tooltip=Ap,e.Transformation=ue,e.Util=Ee,e.VideoOverlay=GS,e.bind=o,e.bounds=F,e.canvas=XS,e.circle=cw,e.circleMarker=lw,e.control=nd,e.divIcon=gw,e.extend=t,e.featureGroup=ow,e.geoJSON=VS,e.geoJson=hw,e.gridLayer=yw,e.icon=aw,e.imageOverlay=pw,e.latLng=G,e.latLngBounds=A,e.layerGroup=rw,e.map=HN,e.marker=sw,e.point=Se,e.polygon=dw,e.polyline=uw,e.popup=_w,e.rectangle=Tw,e.setOptions=v,e.stamp=l,e.svg=JS,e.svgOverlay=mw,e.tileLayer=jS,e.tooltip=vw,e.transformation=Ne,e.version=n,e.videoOverlay=fw;var bw=window.L;e.noConflict=function(){return window.L=bw,this},window.L=e})});var UD=cC((X_,BD)=>{(function(e,n){typeof X_=="object"&&typeof BD<"u"?n(X_):typeof define=="function"&&define.amd?define(["exports"],n):(e=e||self,n((e.Leaflet=e.Leaflet||{},e.Leaflet.markercluster={})))})(X_,function(e){"use strict";var n=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var o=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,o?this._withAnimation:this._noAnimation),this._markerCluster=o?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var o=i,s=this._zoom;if(i.__parent)for(;o.__parent._zoom>=s;)o=o.__parent;return this._currentShownBounds.contains(o.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,o):this._animationAddLayerNonAnimated(i,o)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,o){if(!L.Util.isArray(i))return this.addLayer(i);var s=this._featureGroup,l=this._nonPointGroup,u=this.options.chunkedLoading,d=this.options.chunkInterval,f=this.options.chunkProgress,p=i.length,m=0,g=!0,v;if(this._map){var C=new Date().getTime(),E=L.bind(function(){var S=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();m<p;m++){if(u&&m%200===0){var I=new Date().getTime()-S;if(I>d)break}if(v=i[m],v instanceof L.LayerGroup){g&&(i=i.slice(),g=!1),this._extractNonGroupLayers(v,i),p=i.length;continue}if(!v.getLatLng){l.addLayer(v),o||this.fire("layeradd",{layer:v});continue}if(!this.hasLayer(v)&&(this._addLayer(v,this._maxZoom),o||this.fire("layeradd",{layer:v}),v.__parent&&v.__parent.getChildCount()===2)){var z=v.__parent.getAllChildMarkers(),j=z[0]===v?z[1]:z[0];s.removeLayer(j)}}f&&f(m,p,new Date().getTime()-C),m===p?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(E,this.options.chunkDelay)},this);E()}else for(var b=this._needsClustering;m<p;m++){if(v=i[m],v instanceof L.LayerGroup){g&&(i=i.slice(),g=!1),this._extractNonGroupLayers(v,i),p=i.length;continue}if(!v.getLatLng){l.addLayer(v);continue}this.hasLayer(v)||b.push(v)}return this},removeLayers:function(i){var o,s,l=i.length,u=this._featureGroup,d=this._nonPointGroup,f=!0;if(!this._map){for(o=0;o<l;o++){if(s=i[o],s instanceof L.LayerGroup){f&&(i=i.slice(),f=!1),this._extractNonGroupLayers(s,i),l=i.length;continue}this._arraySplice(this._needsClustering,s),d.removeLayer(s),this.hasLayer(s)&&this._needsRemoving.push({layer:s,latlng:s._latlng}),this.fire("layerremove",{layer:s})}return this}if(this._unspiderfy){this._unspiderfy();var p=i.slice(),m=l;for(o=0;o<m;o++){if(s=p[o],s instanceof L.LayerGroup){this._extractNonGroupLayers(s,p),m=p.length;continue}this._unspiderfyLayer(s)}}for(o=0;o<l;o++){if(s=i[o],s instanceof L.LayerGroup){f&&(i=i.slice(),f=!1),this._extractNonGroupLayers(s,i),l=i.length;continue}if(!s.__parent){d.removeLayer(s),this.fire("layerremove",{layer:s});continue}this._removeLayer(s,!0,!0),this.fire("layerremove",{layer:s}),u.hasLayer(s)&&(u.removeLayer(s),s.clusterShow&&s.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var o=this._needsClustering.length-1;o>=0;o--)i.extend(this._needsClustering[o].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,o){var s=this._needsClustering.slice(),l=this._needsRemoving,u,d,f;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(s),d=s.length-1;d>=0;d--){for(u=!0,f=l.length-1;f>=0;f--)if(l[f].layer===s[d]){u=!1;break}u&&i.call(o,s[d])}this._nonPointGroup.eachLayer(i,o)},getLayers:function(){var i=[];return this.eachLayer(function(o){i.push(o)}),i},getLayer:function(i){var o=null;return i=parseInt(i,10),this.eachLayer(function(s){L.stamp(s)===i&&(o=s)}),o},hasLayer:function(i){if(!i)return!1;var o,s=this._needsClustering;for(o=s.length-1;o>=0;o--)if(s[o]===i)return!0;for(s=this._needsRemoving,o=s.length-1;o>=0;o--)if(s[o].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,o){var s=this._map;typeof o!="function"&&(o=function(){});var l=function(){(s.hasLayer(i)||s.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",l,this),this.off("animationend",l,this),s.hasLayer(i)?o():i.__parent._icon&&(this.once("spiderfied",o,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?o():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",l,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",l,this),this.on("animationend",l,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var o,s,l;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,o=0,s=this._needsRemoving.length;o<s;o++)l=this._needsRemoving[o],l.newlatlng=l.layer._latlng,l.layer._latlng=l.latlng;for(o=0,s=this._needsRemoving.length;o<s;o++)l=this._needsRemoving[o],this._removeLayer(l.layer,!0),l.layer._latlng=l.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),s=this._needsClustering,this._needsClustering=[],this.addLayers(s,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var o=i;o&&!o._icon;)o=o.__parent;return o||null},_arraySplice:function(i,o){for(var s=i.length-1;s>=0;s--)if(i[s]===o)return i.splice(s,1),!0},_removeFromGridUnclustered:function(i,o){for(var s=this._map,l=this._gridUnclustered,u=Math.floor(this._map.getMinZoom());o>=u&&l[o].removeObject(i,s.project(i.getLatLng(),o));o--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var o=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),o&&i.target.openPopup()}},_moveChild:function(i,o,s){i._latlng=o,this.removeLayer(i),i._latlng=s,this.addLayer(i)},_childMarkerDragEnd:function(i){var o=i.target.__dragStart;delete i.target.__dragStart,o&&this._moveChild(i.target,o,i.target._latlng)},_removeLayer:function(i,o,s){var l=this._gridClusters,u=this._gridUnclustered,d=this._featureGroup,f=this._map,p=Math.floor(this._map.getMinZoom());o&&this._removeFromGridUnclustered(i,this._maxZoom);var m=i.__parent,g=m._markers,v;for(this._arraySplice(g,i);m&&(m._childCount--,m._boundsNeedUpdate=!0,!(m._zoom<p));)o&&m._childCount<=1?(v=m._markers[0]===i?m._markers[1]:m._markers[0],l[m._zoom].removeObject(m,f.project(m._cLatLng,m._zoom)),u[m._zoom].addObject(v,f.project(v.getLatLng(),m._zoom)),this._arraySplice(m.__parent._childClusters,m),m.__parent._markers.push(v),v.__parent=m.__parent,m._icon&&(d.removeLayer(m),s||d.addLayer(v))):m._iconNeedsUpdate=!0,m=m.__parent;delete i.__parent},_isOrIsParent:function(i,o){for(;o;){if(i===o)return!0;o=o.parentNode}return!1},fire:function(i,o,s){if(o&&o.layer instanceof L.MarkerCluster){if(o.originalEvent&&this._isOrIsParent(o.layer._icon,o.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,o,s)},listens:function(i,o){return L.FeatureGroup.prototype.listens.call(this,i,o)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,o)},_defaultIconCreateFunction:function(i){var o=i.getChildCount(),s=" marker-cluster-";return o<10?s+="small":o<100?s+="medium":s+="large",new L.DivIcon({html:"<div><span>"+o+"</span></div>",className:"marker-cluster"+s,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,o=this.options.spiderfyOnMaxZoom,s=this.options.showCoverageOnHover,l=this.options.zoomToBoundsOnClick,u=this.options.spiderfyOnEveryZoom;(o||l||u)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),s&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var o=i.layer,s=o;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;s._childClusters.length===1;)s=s._childClusters[0];s._zoom===this._maxZoom&&s._childCount===o._childCount&&this.options.spiderfyOnMaxZoom?o.spiderfy():this.options.zoomToBoundsOnClick&&o.zoomToBounds(),this.options.spiderfyOnEveryZoom&&o.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var o=this._map;this._inZoomAnimation||(this._shownPolygon&&o.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),o.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,s=this.options.zoomToBoundsOnClick,l=this.options.spiderfyOnEveryZoom,u=this._map;(i||s||l)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),u.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),o=Math.floor(this._map.getMinZoom()),s=this.options.maxClusterRadius,l=s;typeof s!="function"&&(l=function(){return s}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var u=i;u>=o;u--)this._gridClusters[u]=new L.DistanceGrid(l(u)),this._gridUnclustered[u]=new L.DistanceGrid(l(u));this._topClusterLevel=new this._markerCluster(this,o-1)},_addLayer:function(i,o){var s=this._gridClusters,l=this._gridUnclustered,u=Math.floor(this._map.getMinZoom()),d,f;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);o>=u;o--){d=this._map.project(i.getLatLng(),o);var p=s[o].getNearObject(d);if(p){p._addChild(i),i.__parent=p;return}if(p=l[o].getNearObject(d),p){var m=p.__parent;m&&this._removeLayer(p,!1);var g=new this._markerCluster(this,o,p,i);s[o].addObject(g,this._map.project(g._cLatLng,o)),p.__parent=g,i.__parent=g;var v=g;for(f=o-1;f>m._zoom;f--)v=new this._markerCluster(this,f,v),s[f].addObject(v,this._map.project(p.getLatLng(),f));m._addChild(v),this._removeFromGridUnclustered(p,o);return}l[o].addObject(i,d)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var o=this._maxLat;return o!==void 0&&(i.getNorth()>=o&&(i._northEast.lat=1/0),i.getSouth()<=-o&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,o){if(o===i)this._featureGroup.addLayer(i);else if(o._childCount===2){o._addToMap();var s=o.getAllChildMarkers();this._featureGroup.removeLayer(s[0]),this._featureGroup.removeLayer(s[1])}else o._updateIcon()},_extractNonGroupLayers:function(i,o){var s=i.getLayers(),l=0,u;for(o=o||[];l<s.length;l++){if(u=s[l],u instanceof L.LayerGroup){this._extractNonGroupLayers(u,o);continue}o.push(u)}return o},_overrideMarkerIcon:function(i){var o=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return o}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,o){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,o){this._animationAddLayerNonAnimated(i,o)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,o){var s=this._getExpandedVisibleBounds(),l=this._featureGroup,u=Math.floor(this._map.getMinZoom()),d;this._ignoreMove=!0,this._topClusterLevel._recursively(s,i,u,function(f){var p=f._latlng,m=f._markers,g;for(s.contains(p)||(p=null),f._isSingleParent()&&i+1===o?(l.removeLayer(f),f._recursivelyAddChildrenToMap(null,o,s)):(f.clusterHide(),f._recursivelyAddChildrenToMap(p,o,s)),d=m.length-1;d>=0;d--)g=m[d],s.contains(g._latlng)||l.removeLayer(g)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(s,o),l.eachLayer(function(f){!(f instanceof L.MarkerCluster)&&f._icon&&f.clusterShow()}),this._topClusterLevel._recursively(s,i,o,function(f){f._recursivelyRestoreChildPositions(o)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(s,i,u,function(f){l.removeLayer(f),f.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,o){this._animationZoomOutSingle(this._topClusterLevel,i-1,o),this._topClusterLevel._recursivelyAddChildrenToMap(null,o,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,o){var s=this,l=this._featureGroup;l.addLayer(i),o!==i&&(o._childCount>2?(o._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(o.getLatLng())),i.clusterHide(),this._enqueue(function(){l.removeLayer(i),i.clusterShow(),s._animationEnd()})):(this._forceLayout(),s._animationStart(),s._animationZoomOutSingle(o,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,o,s){var l=this._getExpandedVisibleBounds(),u=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(l,u,o+1,s);var d=this;this._forceLayout(),i._recursivelyBecomeVisible(l,s),this._enqueue(function(){if(i._childCount===1){var f=i._markers[0];this._ignoreMove=!0,f.setLatLng(f.getLatLng()),this._ignoreMove=!1,f.clusterShow&&f.clusterShow()}else i._recursively(l,s,u,function(p){p._recursivelyRemoveChildrenFromMap(l,u,o+1)});d._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var t=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,o,s,l){L.Marker.prototype.initialize.call(this,s?s._cLatLng||s.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=o,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,s&&this._addChild(s),l&&this._addChild(l)},getAllChildMarkers:function(i,o){i=i||[];for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s].getAllChildMarkers(i,o);for(var l=this._markers.length-1;l>=0;l--)o&&this._markers[l].__dragStart||i.push(this._markers[l]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var o=this._childClusters.slice(),s=this._group._map,l=s.getBoundsZoom(this._bounds),u=this._zoom+1,d=s.getZoom(),f;o.length>0&&l>u;){u++;var p=[];for(f=0;f<o.length;f++)p=p.concat(o[f]._childClusters);o=p}l>u?this._group._map.setView(this._latlng,u):l<=d?this._group._map.setView(this._latlng,d+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,o){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(o||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(o||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,o=this._childClusters,s=0,l=0,u=this._childCount,d,f,p,m;if(u!==0){for(this._resetBounds(),d=0;d<i.length;d++)p=i[d]._latlng,this._bounds.extend(p),s+=p.lat,l+=p.lng;for(d=0;d<o.length;d++)f=o[d],f._boundsNeedUpdate&&f._recalculateBounds(),this._bounds.extend(f._bounds),p=f._wLatLng,m=f._childCount,s+=p.lat*m,l+=p.lng*m;this._latlng=this._wLatLng=new L.LatLng(s/u,l/u),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,o,s){this._recursively(i,this._group._map.getMinZoom(),s-1,function(l){var u=l._markers,d,f;for(d=u.length-1;d>=0;d--)f=u[d],f._icon&&(f._setPos(o),f.clusterHide())},function(l){var u=l._childClusters,d,f;for(d=u.length-1;d>=0;d--)f=u[d],f._icon&&(f._setPos(o),f.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,o,s,l){this._recursively(i,l,o,function(u){u._recursivelyAnimateChildrenIn(i,u._group._map.latLngToLayerPoint(u.getLatLng()).round(),s),u._isSingleParent()&&s-1===l?(u.clusterShow(),u._recursivelyRemoveChildrenFromMap(i,o,s)):u.clusterHide(),u._addToMap()})},_recursivelyBecomeVisible:function(i,o){this._recursively(i,this._group._map.getMinZoom(),o,null,function(s){s.clusterShow()})},_recursivelyAddChildrenToMap:function(i,o,s){this._recursively(s,this._group._map.getMinZoom()-1,o,function(l){if(o!==l._zoom)for(var u=l._markers.length-1;u>=0;u--){var d=l._markers[u];s.contains(d._latlng)&&(i&&(d._backupLatlng=d.getLatLng(),d.setLatLng(i),d.clusterHide&&d.clusterHide()),l._group._featureGroup.addLayer(d))}},function(l){l._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var o=this._markers.length-1;o>=0;o--){var s=this._markers[o];s._backupLatlng&&(s.setLatLng(s._backupLatlng),delete s._backupLatlng)}if(i-1===this._zoom)for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l]._restorePosition();else for(var u=this._childClusters.length-1;u>=0;u--)this._childClusters[u]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,o,s,l){var u,d;this._recursively(i,o-1,s-1,function(f){for(d=f._markers.length-1;d>=0;d--)u=f._markers[d],(!l||!l.contains(u._latlng))&&(f._group._featureGroup.removeLayer(u),u.clusterShow&&u.clusterShow())},function(f){for(d=f._childClusters.length-1;d>=0;d--)u=f._childClusters[d],(!l||!l.contains(u._latlng))&&(f._group._featureGroup.removeLayer(u),u.clusterShow&&u.clusterShow())})},_recursively:function(i,o,s,l,u){var d=this._childClusters,f=this._zoom,p,m;if(o<=f&&(l&&l(this),u&&f===s&&u(this)),f<o||f<s)for(p=d.length-1;p>=0;p--)m=d[p],m._boundsNeedUpdate&&m._recalculateBounds(),i.intersects(m._bounds)&&m._recursively(i,o,s,l,u)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,o){var s=this._getCoord(o.x),l=this._getCoord(o.y),u=this._grid,d=u[l]=u[l]||{},f=d[s]=d[s]||[],p=L.Util.stamp(i);this._objectPoint[p]=o,f.push(i)},updateObject:function(i,o){this.removeObject(i),this.addObject(i,o)},removeObject:function(i,o){var s=this._getCoord(o.x),l=this._getCoord(o.y),u=this._grid,d=u[l]=u[l]||{},f=d[s]=d[s]||[],p,m;for(delete this._objectPoint[L.Util.stamp(i)],p=0,m=f.length;p<m;p++)if(f[p]===i)return f.splice(p,1),m===1&&delete d[s],!0},eachObject:function(i,o){var s,l,u,d,f,p,m,g=this._grid;for(s in g){f=g[s];for(l in f)for(p=f[l],u=0,d=p.length;u<d;u++)m=i.call(o,p[u]),m&&(u--,d--)}},getNearObject:function(i){var o=this._getCoord(i.x),s=this._getCoord(i.y),l,u,d,f,p,m,g,v,C=this._objectPoint,E=this._sqCellSize,b=null;for(l=s-1;l<=s+1;l++)if(f=this._grid[l],f){for(u=o-1;u<=o+1;u++)if(p=f[u],p)for(d=0,m=p.length;d<m;d++)g=p[d],v=this._sqDist(C[L.Util.stamp(g)],i),(v<E||v<=E&&b===null)&&(E=v,b=g)}return b},_getCoord:function(i){var o=Math.floor(i/this._cellSize);return isFinite(o)?o:i},_sqDist:function(i,o){var s=o.x-i.x,l=o.y-i.y;return s*s+l*l}},function(){L.QuickHull={getDistant:function(i,o){var s=o[1].lat-o[0].lat,l=o[0].lng-o[1].lng;return l*(i.lat-o[0].lat)+s*(i.lng-o[0].lng)},findMostDistantPointFromBaseLine:function(i,o){var s=0,l=null,u=[],d,f,p;for(d=o.length-1;d>=0;d--){if(f=o[d],p=this.getDistant(f,i),p>0)u.push(f);else continue;p>s&&(s=p,l=f)}return{maxPoint:l,newPoints:u}},buildConvexHull:function(i,o){var s=[],l=this.findMostDistantPointFromBaseLine(i,o);return l.maxPoint?(s=s.concat(this.buildConvexHull([i[0],l.maxPoint],l.newPoints)),s=s.concat(this.buildConvexHull([l.maxPoint,i[1]],l.newPoints)),s):[i[0]]},getConvexHull:function(i){var o=!1,s=!1,l=!1,u=!1,d=null,f=null,p=null,m=null,g=null,v=null,C;for(C=i.length-1;C>=0;C--){var E=i[C];(o===!1||E.lat>o)&&(d=E,o=E.lat),(s===!1||E.lat<s)&&(f=E,s=E.lat),(l===!1||E.lng>l)&&(p=E,l=E.lng),(u===!1||E.lng<u)&&(m=E,u=E.lng)}s!==o?(v=f,g=d):(v=m,g=p);var b=[].concat(this.buildConvexHull([v,g],i),this.buildConvexHull([g,v],i));return b}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),o=[],s,l;for(l=i.length-1;l>=0;l--)s=i[l].getLatLng(),o.push(s);return L.QuickHull.getConvexHull(o)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),o=this._group,s=o._map,l=s.latLngToLayerPoint(this._latlng),u;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?u=this._group.options.spiderfyShapePositions(i.length,l):i.length>=this._circleSpiralSwitchover?u=this._generatePointsSpiral(i.length,l):(l.y+=10,u=this._generatePointsCircle(i.length,l)),this._animationSpiderfy(i,u)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,o){var s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),l=s/this._2PI,u=this._2PI/i,d=[],f,p;for(l=Math.max(l,35),d.length=i,f=0;f<i;f++)p=this._circleStartAngle+f*u,d[f]=new L.Point(o.x+l*Math.cos(p),o.y+l*Math.sin(p))._round();return d},_generatePointsSpiral:function(i,o){var s=this._group.options.spiderfyDistanceMultiplier,l=s*this._spiralLengthStart,u=s*this._spiralFootSeparation,d=s*this._spiralLengthFactor*this._2PI,f=0,p=[],m;for(p.length=i,m=i;m>=0;m--)m<i&&(p[m]=new L.Point(o.x+l*Math.cos(f),o.y+l*Math.sin(f))._round()),f+=u/l+m*5e-4,l+=d/f;return p},_noanimationUnspiderfy:function(){var i=this._group,o=i._map,s=i._featureGroup,l=this.getAllChildMarkers(null,!0),u,d;for(i._ignoreMove=!0,this.setOpacity(1),d=l.length-1;d>=0;d--)u=l[d],s.removeLayer(u),u._preSpiderfyLatlng&&(u.setLatLng(u._preSpiderfyLatlng),delete u._preSpiderfyLatlng),u.setZIndexOffset&&u.setZIndexOffset(0),u._spiderLeg&&(o.removeLayer(u._spiderLeg),delete u._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:l}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,o){var s=this._group,l=s._map,u=s._featureGroup,d=this._group.options.spiderLegPolylineOptions,f,p,m,g;for(s._ignoreMove=!0,f=0;f<i.length;f++)g=l.layerPointToLatLng(o[f]),p=i[f],m=new L.Polyline([this._latlng,g],d),l.addLayer(m),p._spiderLeg=m,p._preSpiderfyLatlng=p._latlng,p.setLatLng(g),p.setZIndexOffset&&p.setZIndexOffset(1e6),u.addLayer(p);this.setOpacity(.3),s._ignoreMove=!1,s.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,o){var s=this,l=this._group,u=l._map,d=l._featureGroup,f=this._latlng,p=u.latLngToLayerPoint(f),m=L.Path.SVG,g=L.extend({},this._group.options.spiderLegPolylineOptions),v=g.opacity,C,E,b,S,I,z;for(v===void 0&&(v=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),m?(g.opacity=0,g.className=(g.className||"")+" leaflet-cluster-spider-leg"):g.opacity=v,l._ignoreMove=!0,C=0;C<i.length;C++)E=i[C],z=u.layerPointToLatLng(o[C]),b=new L.Polyline([f,z],g),u.addLayer(b),E._spiderLeg=b,m&&(S=b._path,I=S.getTotalLength()+.1,S.style.strokeDasharray=I,S.style.strokeDashoffset=I),E.setZIndexOffset&&E.setZIndexOffset(1e6),E.clusterHide&&E.clusterHide(),d.addLayer(E),E._setPos&&E._setPos(p);for(l._forceLayout(),l._animationStart(),C=i.length-1;C>=0;C--)z=u.layerPointToLatLng(o[C]),E=i[C],E._preSpiderfyLatlng=E._latlng,E.setLatLng(z),E.clusterShow&&E.clusterShow(),m&&(b=E._spiderLeg,S=b._path,S.style.strokeDashoffset=0,b.setStyle({opacity:v}));this.setOpacity(.3),l._ignoreMove=!1,setTimeout(function(){l._animationEnd(),l.fire("spiderfied",{cluster:s,markers:i})},200)},_animationUnspiderfy:function(i){var o=this,s=this._group,l=s._map,u=s._featureGroup,d=i?l._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):l.latLngToLayerPoint(this._latlng),f=this.getAllChildMarkers(null,!0),p=L.Path.SVG,m,g,v,C,E,b;for(s._ignoreMove=!0,s._animationStart(),this.setOpacity(1),g=f.length-1;g>=0;g--)m=f[g],m._preSpiderfyLatlng&&(m.closePopup(),m.setLatLng(m._preSpiderfyLatlng),delete m._preSpiderfyLatlng,b=!0,m._setPos&&(m._setPos(d),b=!1),m.clusterHide&&(m.clusterHide(),b=!1),b&&u.removeLayer(m),p&&(v=m._spiderLeg,C=v._path,E=C.getTotalLength()+.1,C.style.strokeDashoffset=E,v.setStyle({opacity:0})));s._ignoreMove=!1,setTimeout(function(){var S=0;for(g=f.length-1;g>=0;g--)m=f[g],m._spiderLeg&&S++;for(g=f.length-1;g>=0;g--)m=f[g],m._spiderLeg&&(m.clusterShow&&m.clusterShow(),m.setZIndexOffset&&m.setZIndexOffset(0),S>1&&u.removeLayer(m),l.removeLayer(m._spiderLeg),delete m._spiderLeg);s._animationEnd(),s.fire("unspiderfied",{cluster:o,markers:f})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var o,s;for(o in i)for(s=i[o].__parent;s;)s._iconNeedsUpdate=!0,s=s.__parent},_refreshSingleMarkerModeMarkers:function(i){var o,s;for(o in i)s=i[o],this.hasLayer(s)&&s.setIcon(this._overrideMarkerIcon(s))}}),L.Marker.include({refreshIconOptions:function(i,o){var s=this.options.icon;return L.setOptions(s,i),this.setIcon(s),o&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),e.MarkerClusterGroup=n,e.MarkerCluster=t,Object.defineProperty(e,"__esModule",{value:!0})})});function Ow(e,n){e&1&&(D(0,"ion-toolbar",0)(1,"ion-title",1),M(2,"IBF DEMO - SIMULATED DATA"),x()())}var wk=(()=>{class e{constructor(){this.environmentConfiguration=xt.configuration}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-disclaimer-toolbar"]],standalone:!1,decls:1,vars:1,consts:[["color","ibf-primary",1,"disclaimer-toolbar"],["size","small",1,"ion-text-center"]],template:function(i,o){i&1&&se(0,Ow,3,0,"ion-toolbar",0),i&2&&re(o.environmentConfiguration==="stage"?0:-1)},dependencies:[rf,ZC],styles:[".disclaimer-toolbar[_ngcontent-%COMP%]{--min-height: 36px}.disclaimer-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:700}"]})}}return e})();var Bt=function(e){return e.activationLog="activation-Log",e.dashboard="dashboard",e.login="login",e}(Bt||{}),ft=function(e){return e.aboutTrigger="about-trigger",e.adminLevel="admin-level",e.aggregateInformation="aggregate-information",e.communityNotification="community-notification",e.dam="dam",e.eapAction="eap-action",e.eapSubmit="eap-submit",e.evacuationCenter="evacuation-center",e.exportView="export-view",e.glofasStation="glofas-station",e.healthSite="health-site",e.leadTime="lead-time",e.logOut="log-out",e.mapLayer="map-layer",e.mapLayerInformation="map-layer-information",e.mapMarker="map-marker",e.mapPlaceSelect="map-place-select",e.redCrossBranch="red-cross-branch",e.riverGauge="river-gauge",e.school="school",e.setTrigger="set-trigger",e.typhoonTrack="typhoon-track",e.watchIbfGuide="watch-ibf-guide",e.waterPoint="water-point",e}(ft||{});var Ea=function(e){return e.Admin="admin",e.LocalAdmin="local-admin",e.Operator="operator",e.PipelineUser="pipeline-user",e.Viewer="viewer",e}(Ea||{});var Rt=function(e){return e.drought="drought",e.flashFloods="flash-floods",e.floods="floods",e.malaria="malaria",e.typhoon="typhoon",e}(Rt||{});var sf=xt.configuration==="development",QC=500,eT="https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",tT='&copy; <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a target="_blank" href="https://carto.com/attributions">Carto</a>',In={iconSize:[28,42],iconAnchor:[24,42],popupAnchor:[0,-28],iconUrl:"assets/markers/glofas-station-default-marker.svg",iconRetinaUrl:"assets/markers/glofas-station-default-marker.svg"},iT=Tt(me({},In),{iconUrl:"assets/markers/dam-marker.svg",iconRetinaUrl:"assets/markers/dam-marker.svg"}),nT=Tt(me({},In),{iconUrl:"assets/markers/red-cross-marker.svg",iconRetinaUrl:"assets/markers/red-cross-marker.svg"}),rT=Tt(me({},In),{iconUrl:"assets/markers/health-center-marker.svg",iconRetinaUrl:"assets/markers/health-center-marker.svg"}),oT=Tt(me({},In),{iconUrl:"assets/markers/health-center-marker-exposed.svg",iconRetinaUrl:"assets/markers/health-center-marker-exposed.svg"}),aT=Tt(me({},In),{iconUrl:"assets/markers/water-point-marker.svg",iconRetinaUrl:"assets/markers/water-point-marker.svg"}),sT=Tt(me({},In),{iconUrl:"assets/markers/water-point-marker-exposed.svg",iconRetinaUrl:"assets/markers/water-point-marker-exposed.svg"}),lT=Tt(me({},In),{iconUrl:"assets/markers/evacuation-center-marker.svg",iconRetinaUrl:"assets/markers/evacuation-center-marker.svg"}),cT=Tt(me({},In),{iconUrl:"assets/markers/school-marker.svg",iconRetinaUrl:"assets/markers/school-marker.svg"}),uT=Tt(me({},In),{iconUrl:"assets/markers/school-marker-exposed.svg",iconRetinaUrl:"assets/markers/school-marker-exposed.svg"}),dT=Tt(me({},In),{iconUrl:"assets/markers/community-notification-marker.svg",iconRetinaUrl:"assets/markers/community-notification-marker.svg"}),hT=Tt(me({},In),{iconUrl:"assets/markers/river-gauge-marker.svg",iconRetinaUrl:"assets/markers/river-gauge-marker.svg"}),pT={center:[9,40],zoom:5,zoomControl:!1,layers:[]},fT={[Rt.floods]:{selectedTriggered:"/assets/icons/Flood_Selected_Triggered.svg",selectedNonTriggered:"/assets/icons/Flood_Selected_Non Triggered.svg",nonSelectedTriggered:"/assets/icons/Flood_Not Selected_Triggered.svg",nonSelectedNonTriggered:"/assets/icons/Flood_Not Selected_Non Triggered.svg",disabled:"/assets/icons/Flood_Disabled.svg"},[Rt.flashFloods]:{selectedTriggered:"/assets/icons/Flash Floods_Selected_Triggered.svg",selectedNonTriggered:"/assets/icons/Flash Floods_Selected_Non Triggered.svg",nonSelectedTriggered:"/assets/icons/Flash Floods_Not Selected_Triggered.svg",nonSelectedNonTriggered:"/assets/icons/Flash Floods_Not Selected_Non Triggered.svg",disabled:"/assets/icons/Flash Floods_Disabled.svg"},[Rt.malaria]:{selectedTriggered:"/assets/icons/Malaria_Selected_Triggered.svg",selectedNonTriggered:"/assets/icons/Malaria_Selected_Non Triggered.svg",nonSelectedTriggered:"/assets/icons/Malaria_Not Selected_Triggered.svg",nonSelectedNonTriggered:"/assets/icons/Malaria_Not Selected_Non Triggered.svg",disabled:"/assets/icons/Malaria_Disabled.svg"},[Rt.drought]:{selectedTriggered:"/assets/icons/Drought_Selected_Triggered.svg",selectedNonTriggered:"/assets/icons/Drought_Selected_Not Triggered.svg",nonSelectedTriggered:"/assets/icons/Drought_Not Selected_Triggered.svg",nonSelectedNonTriggered:"/assets/icons/Drought_Not Selected_Not Triggered.svg",disabled:"/assets/icons/Drought_Disabled.svg"},[Rt.typhoon]:{selectedTriggered:"/assets/icons/TyphoonHurricaneCyclone_Selected_Triggered.svg",selectedNonTriggered:"/assets/icons/TyphoonHurricaneCyclone_Selected_Not Triggered.svg",nonSelectedTriggered:"/assets/icons/TyphoonHurricaneCyclone_Not Selected_Triggered.svg",nonSelectedNonTriggered:"/assets/icons/TyphoonHurricaneCyclone_Not Selected_Not Triggered.svg",disabled:"/assets/icons/TyphoonHurricaneCyclone_Disabled.svg"}},Bv={token:"",email:"dunant@redcross.nl",firstName:"Henry",lastName:"Dunant",userRole:Ea.Viewer,countries:[],disasterTypes:[]};var on=function(e){return e[e.adminLevel1=1]="adminLevel1",e[e.adminLevel2=2]="adminLevel2",e[e.adminLevel3=3]="adminLevel3",e[e.adminLevel4=4]="adminLevel4",e}(on||{}),$i=function(e){return e.deepest="deepest",e.higher="higher",e.single="single",e}($i||{}),lf=class{};var cf=(()=>{class e{constructor(){this.tokenKey="jwt",this.jwtHelper=new KC}getToken(){return window.localStorage[this.tokenKey]}saveToken(t){window.localStorage[this.tokenKey]=t}destroyToken(){window.localStorage.removeItem(this.tokenKey)}decodeToken(t){return this.jwtHelper.decodeToken(t)}checkExpiry(t){return this.jwtHelper.isTokenExpired(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ui=(()=>{class e{constructor(t,i){this.jwtService=t,this.http=i,this.log=sf?console.log:()=>{}}showSecurity(t){return t?"\u{1F310}":"\u{1F510}"}createHeaders(t=!1){let i=new RC({"Content-Type":"application/json",Accept:"application/json","Cache-Control":"no-cache, no-store, must-revalidate, post-check=0, pre-check=0",Pragma:"no-cache",Expires:"0"});if(!t){let o=xt.apiToken||this.jwtService.getToken();if(o)return i.set("Authorization",`Token ${o}`)}return i}get(t,i=!0,o=null){let s=`${xt.apiUrl}/${t}`,l=this.showSecurity(i);return this.log(`ApiService GET: ${l} ${s}`),this.http.get(s,{headers:this.createHeaders(i),params:o}).pipe(kp(u=>{this.log(`ApiService GET: ${l} ${s}`,`
Response:`,u)}))}post(t,i,o=!1,s=null){let l=`${xt.apiUrl}/${t}`,u=this.showSecurity(o);return this.log(`ApiService POST: ${u} ${l}`,i),this.http.post(l,i,{headers:this.createHeaders(o),params:s}).pipe(kp(d=>{this.log(`ApiService POST: ${u} ${l}:`,i,`
Response:`,d)}))}put(t,i,o=!1,s=null){let l=`${xt.apiUrl}/${t}`,u=this.showSecurity(o);return this.log(`ApiService PUT: ${u} ${l}`,i),this.http.put(l,i,{headers:this.createHeaders(o),params:s}).pipe(kp(d=>{this.log(`ApiService PUT: ${u} ${l}:`,i,`
Response:`,d)}))}login(t,i){return this.log("ApiService : login()"),this.post("user/login",{email:t,password:i},!0)}changePassword(t){return this.log("ApiService : changePassword()"),this.post("user/change-password",{password:t})}getCountries(t,i){let o="country",s=new kr;return t&&(s=s.append("countryCodesISO3",t)),i&&(s=s.append("minimalInfo",String(i))),this.get(o,!1,s)}getTyphoonTrack(t,i){let o=new kr;return i&&(o=o.append("eventName",i)),this.get(`typhoon-track/${t}`,!1,o)}getPointData(t,i,o){let s=new kr;return o&&(s=s.append("disasterType",o)),this.get(`point-data/${i}/${t}`,!1,s)}getLastUploadDate(t,i){return this.get(`event/last-upload-date/${t}/${i}`,!1)}getAlertPerLeadTime(t,i,o){let s=new kr;return o&&(s=s.append("eventName",o)),this.get(`event/alerts/${t}/${i}`,!1,s)}getEvents(t,i){return this.get(`event/${t}/${i}`,!1)}getAlertAreas(t,i,o,s){let l=new kr;return s&&(l=l.append("eventName",s)),this.get(`event/alert-areas/${t}/${o.toString()}/${i}`,!1,l)}getAdminRegions(t,i,o,s=on.adminLevel1,l,u){let d=new kr;return l&&(d=d.append("eventName",l)),o&&(d=d.append("leadTime",o)),u&&(d=d.append("placeCodeParent",u)),this.get(`admin-areas/${t}/${i}/${s.toString()}`,!1,d)}getAggregatesData(t,i,o=on.adminLevel1,s,l,u){let d=new kr;return l&&(d=d.append("eventName",l)),s&&(d=d.append("leadTime",s)),u&&(d=d.append("placeCodeParent",u)),this.get(`admin-areas/aggregates/${t}/${i}/${o.toString()}`,!1,d)}getIndicators(t,i){return this.get(`metadata/indicators/${t}/${i}`,!1)}getAdminAreaData(t,i,o){return this.get(`admin-area-data/${t}/${i.toString()}/${o}`,!1)}getAdminAreaDynamicData(t,i,o,s,l,u){let d=new kr;return u&&(d=d.append("eventName",u)),o&&(d=d.append("leadTime",o)),this.get(`admin-area-dynamic-data/${t}/${i.toString()}/${s}/${l}`,!1,d)}getLayers(t,i){return this.get(`metadata/layers/${t}/${i}`,!1)}checkEapAction(t,i,o,s,l,u){return this.post("eap-actions/check",{action:t,countryCodeISO3:i,disasterType:o,status:s,placeCode:l,eventName:u||"no-name"},!1)}mock({countryCodeISO3:t},i,o,{disasterType:s}){let l={removeEvents:o,date:new Date,scenario:i?"trigger":"no-trigger"},u=new kr;return u=u.append("countryCodeISO3",t),u=u.append("disasterType",s),this.post("mock",l,!1,u)}getActivationLogs(t,i){let o=new kr;return t&&(o=o.append("countryCodeISO3",t)),i&&(o=o.append("disasterType",i)),this.get("event/activation-log",!1,o)}dismissCommunityNotification(t){return this.put(`point-data/community-notification/${t}`,{},!1)}setTrigger(t,i,o,s){return this.post("events/set-trigger",{eventPlaceCodeIds:t,countryCodeISO3:i,disasterType:o,noNotifications:s},!1)}static{this.\u0275fac=function(i){return new(i||e)(fe(cf),fe(FC))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var _T={401:"Email and/or password unknown"},Pn=(()=>{class e{constructor(t,i,o,s,l){this.apiService=t,this.jwtService=i,this.router=o,this.toastController=s,this.platformDetectionService=l,this.loggedIn=!1,this.authSubject=new Yt(null),this.getAuthSubscription=()=>this.authSubject.asObservable(),this.onLoginResponse=u=>{if(!u.user?.token)return;this.jwtService.saveToken(u.user.token);let d=this.getUserFromToken();if(this.authSubject.next(d),this.loggedIn=!0,this.userRole=d.userRole,this.redirectUrl){this.router.navigate([this.redirectUrl]),this.redirectUrl=null;return}this.router.navigate(["/"])},this.onLoginError=d=>dt(this,[d],function*({error:u}){let f=_T[u?.statusCode]||u?.message;(yield this.toastController.create({message:`Authentication Failed: ${f}`,duration:5e3})).present(),console.error("AuthService error: ",u)}),this.setDisplayName=u=>{u=u??Bv;let d=[u.firstName,u.middleName,u.lastName].filter(Boolean).join(" ");this.displayName=d},this.onPasswordChanged=()=>dt(this,null,function*(){(yield this.toastController.create({message:"Password changed successfully",duration:5e3})).present()}),this.onChangePasswordError=u=>dt(this,null,function*(){let d=_T[u?.statusCode]||u?.message;(yield this.toastController.create({message:`Authentication Failed: ${d}`,duration:5e3})).present(),console.error("AuthService error: ",u)}),this.checkLoggedInState(),this.authSubscription=this.getAuthSubscription().subscribe(this.setDisplayName)}ngOnDestroy(){this.authSubscription.unsubscribe()}checkLoggedInState(){if(this.platformDetectionService.isEmbeddedMode()){let i=Tt(me({},Bv),{countries:["PHL","UGA","KEN"],disasterTypes:["typhoon","floods","drought"],userRole:Ea.Viewer});this.authSubject.next(i);return}if(xt.apiToken)try{this.jwtService.saveToken(xt.apiToken);let i=this.getUserFromToken();if(i){this.authSubject.next(i),this.loggedIn=!0,this.userRole=i.userRole,this.router.url==="/login"&&this.router.navigate(["/"]);return}}catch(i){console.warn("Environment token is invalid:",i)}let t=this.getUserFromToken();this.authSubject.next(t)}isLoggedIn(){return this.platformDetectionService.isEmbeddedMode()||xt.apiToken?!0:(this.loggedIn=this.getUserFromToken()!==null,this.loggedIn)}getUserRole(){if(!this.userRole){let t=this.getUserFromToken();this.userRole=t?t.userRole:null}return this.userRole}getUserFromToken(){let t=this.jwtService.getToken();if(!t||this.jwtService.checkExpiry(t))return null;let o=this.jwtService.decodeToken(t),s={token:t,email:o.email,firstName:o.firstName,middleName:o.middleName,lastName:o.lastName,userRole:o.userRole,countries:o.countries,disasterTypes:o.disasterTypes};return this.userRole=s.userRole,s}login(t,i){return this.apiService.login(t,i).subscribe(this.onLoginResponse,this.onLoginError)}logout(){this.jwtService.destroyToken(),this.loggedIn=!1,this.authSubject.next(null),this.router.navigate(["/login"])}changePassword(t){return this.apiService.changePassword(t).subscribe(this.onPasswordChanged,this.onChangePasswordError)}static{this.\u0275fac=function(i){return new(i||e)(fe(ui),fe(cf),fe(Wp),fe(af),fe(JC))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Mw=["changePasswordForm"];function kw(e,n){e&1&&(D(0,"ion-note",10)(1,"small")(2,"strong"),M(3),Y(4,"translate"),x()()()),e&2&&(T(3),be(Z(4,1,"user-state.password-error")))}var gT=(()=>{class e{constructor(t,i){this.authService=t,this.popoverController=i,this.showDifferentPasswordMessage=!1,this.model={newPassword:"",confirmPassword:""}}onSubmit(){if(this.changePasswordForm.form.valid){if(this.model.confirmPassword!==this.model.newPassword){this.showDifferentPasswordMessage=!0;return}this.authService.changePassword(this.model.newPassword).add(()=>dt(this,null,function*(){this.changePasswordForm.resetForm(),yield this.popoverController.dismiss()}))}}onChange(){this.showDifferentPasswordMessage=!1}closePopover(){return dt(this,null,function*(){yield this.popoverController.dismiss()})}static{this.\u0275fac=function(i){return new(i||e)(P(Pn),P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-change-password-popover"]],viewQuery:function(i,o){if(i&1&&Up(Mw,5),i&2){let s;zp(s=Hp())&&(o.changePasswordForm=s.first)}},standalone:!1,decls:24,vars:16,consts:[["changePasswordForm","ngForm"],[1,"popover-window-card"],["color","fiveten-navy-900"],["name","close-circle","size","large",1,"popover-close-button",3,"click"],[1,"ion-padding-top","ion-text-center"],[1,"change-password-form",3,"ngSubmit"],["position","stacked"],["name","new-password","type","password","required","","autocomplete","new-password","minlength","4","clearInput","true","clearOnEdit","false",3,"ngModelChange","ionChange","ngModel"],["name","confirm-password","type","password","required","","autocomplete","new-password","minlength","4","clearInput","true","clearOnEdit","false",3,"ngModelChange","ionChange","ngModel"],[1,"validation-message","ion-margin-top"],["color","danger"],["type","submit","shape","round","color","fiveten-navy-900",3,"disabled"]],template:function(i,o){if(i&1){let s=Ye();D(0,"ion-card",1)(1,"ion-card-header",2)(2,"ion-icon",3),oe("click",function(){return ge(s),ye(o.closePopover())}),x(),D(3,"ion-card-title"),M(4),Y(5,"translate"),x()(),D(6,"ion-card-content",4)(7,"form",5,0),oe("ngSubmit",function(){return ge(s),ye(o.onSubmit())}),D(9,"ion-item")(10,"ion-label",6),M(11),Y(12,"translate"),x(),D(13,"ion-input",7),oe("ngModelChange",function(u){return ge(s),ye(o.model.newPassword=u)})("ionChange",function(){return ge(s),ye(o.onChange())}),x()(),D(14,"ion-item")(15,"ion-label",6),M(16),Y(17,"translate"),x(),D(18,"ion-input",8),oe("ngModelChange",function(u){return ge(s),ye(o.model.confirmPassword=u)})("ionChange",function(){return ge(s),ye(o.onChange())}),x()(),D(19,"div",9),se(20,kw,5,3,"ion-note",10),x(),D(21,"ion-button",11),M(22),Y(23,"translate"),x()()()()}if(i&2){let s=ic(8);T(4),be(Z(5,8,"user-state.password-change")),T(7),be(Z(12,10,"user-state.password-new")),T(2),W("ngModel",o.model.newPassword),T(3),be(Z(17,12,"user-state.password-confirm")),T(2),W("ngModel",o.model.confirmPassword),T(2),re(o.showDifferentPasswordMessage?20:-1),T(),W("disabled",!s.form.valid),T(),be(Z(23,14,"user-state.password-change"))}},dependencies:[sc,nc,rc,Zp,jp,ac,oc,Ke,xi,Di,Zi,ji,Ze,ef,kt,ci,tf,qp,Oe],styles:[".validation-message[_ngcontent-%COMP%]{min-height:36px}.change-password-form[_ngcontent-%COMP%]{width:100%}ion-input[_ngcontent-%COMP%]{border:none;background:transparent}ion-input[_ngcontent-%COMP%]     .native-input{box-shadow:none}.popover-window-card[_ngcontent-%COMP%]{border-color:var(--ion-color-fiveten-navy-900)}"],changeDetection:0})}}return e})();var uf,df="undefined",mf="constructor",_o="prototype",_f="function",vf="_dynInstFuncs",Vv="_isDynProxy",cc="_dynClass",Rw="_dynCls$",Gv="_dynInstChk",cd=Gv,ET="_dfOpts",yT="_unknown_",jv="__proto__",hf="_dyn"+jv,ST="__dynProto$Gbl",zv="_dynInstProto",pf="useBaseInst",Wv="setInstFuncs",Sf=Object,ud=Sf.getPrototypeOf,CT=Sf.getOwnPropertyNames;function Fw(){var e;return typeof globalThis!==df&&(e=globalThis),!e&&typeof self!==df&&(e=self),!e&&typeof window!==df&&(e=window),!e&&typeof global!==df&&(e=global),e||{}}var TT=Fw(),Zv=TT[ST]||(TT[ST]={o:(uf={},uf[Wv]=!0,uf[pf]=!0,uf),n:1e3});function Bo(e,n){return e&&Sf[_o].hasOwnProperty.call(e,n)}function ff(e){return e&&(e===Sf[_o]||e===Array[_o])}function $v(e){return ff(e)||e===Function[_o]}function Rs(e){var n;if(e){if(ud)return ud(e);var t=e[jv]||e[_o]||(e[mf]?e[mf][_o]:null);n=e[hf]||t,Bo(e,hf)||(delete e[zv],n=e[hf]=e[zv]||e[hf],e[zv]=t)}return n}function gf(e,n){var t=[];if(CT)t=CT(e);else for(var i in e)typeof i=="string"&&Bo(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function qv(e,n,t){return n!==mf&&typeof e[n]===_f&&(t||Bo(e,n))&&n!==jv&&n!==_o}function yf(e){throw new TypeError("DynamicProto: "+e)}function uc(){return Object.create?function(e){var n=Object.create;if(n)return n(e);if(e==null)return{};var t=typeof e;if(t!=="object"&&t!=="function")throw new TypeError("Object prototype may only be an Object:"+e);function i(){}return i.prototype=e,new i}(null):{}}function Yw(e){var n=uc();return gf(e,function(t){!n[t]&&qv(e,t,!1)&&(n[t]=e[t])}),n}function Xv(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function Bw(e,n,t,i){function o(d,f,p){var m=f[p];if(m[Vv]&&i){var g=d[vf]||{};g[cd]!==!1&&(m=(g[f[cc]]||{})[p]||m)}return function(){return m.apply(d,arguments)}}var s=uc();gf(t,function(d){s[d]=o(n,t,d)});for(var l=Rs(e),u=[];l&&!$v(l)&&!Xv(u,l);)gf(l,function(d){!s[d]&&qv(l,d,!ud)&&(s[d]=o(n,l,d))}),u.push(l),l=Rs(l);return s}function Uw(e,n,t,i){var o=null;if(e&&Bo(t,cc)){var s=e[vf]||uc();if(o=(s[t[cc]]||uc())[n],o||yf("Missing ["+n+"] "+_f),!o[Gv]&&s[cd]!==!1){for(var l=!Bo(e,n),u=Rs(e),d=[];l&&u&&!$v(u)&&!Xv(d,u);){var f=u[n];if(f){l=f===i;break}d.push(u),u=Rs(u)}try{l&&(e[n]=o),o[Gv]=1}catch{s[cd]=!1}}}return o}function zw(e,n,t){var i=n[e];return i===t&&(i=Rs(n)[e]),typeof i!==_f&&yf("["+e+"] is not a "+_f),i}function Hw(e,n,t,i,o){function s(d,f){var p=function(){var m=Uw(this,f,d,p)||zw(f,d,p);return m.apply(this,arguments)};return p[Vv]=1,p}if(!ff(e)){var l=t[vf]=t[vf]||uc();if(!ff(l)){var u=l[n]=l[n]||uc();l[cd]!==!1&&(l[cd]=!!o),ff(u)||gf(t,function(d){qv(t,d,!1)&&t[d]!==i[d]&&(u[d]=t[d],delete t[d],(!Bo(e,d)||e[d]&&!e[d][Vv])&&(e[d]=s(e,d)))})}}}function Vw(e,n){if(ud){for(var t=[],i=Rs(n);i&&!$v(i)&&!Xv(t,i);){if(i===e)return!0;t.push(i),i=Rs(i)}return!1}return!0}function Hv(e,n){return Bo(e,_o)?e.name||n||yT:((e||{})[mf]||{}).name||n||yT}function Be(e,n,t,i){Bo(e,_o)||yf("theClass is an invalid class definition.");var o=e[_o];Vw(o,n)||yf("["+Hv(e)+"] not in hierarchy of ["+Hv(n)+"]");var s=null;Bo(o,cc)?s=o[cc]:(s=Rw+Hv(e,"_")+"$"+Zv.n,Zv.n++,o[cc]=s);var l=Be[ET],u=!!l[pf];u&&i&&i[pf]!==void 0&&(u=!!i[pf]);var d=Yw(n),f=Bw(o,n,d,u);t(n,f);var p=!!ud&&!!l[Wv];p&&i&&(p=!!i[Wv]),Hw(o,s,n,d,p!==!1)}Be[ET]=Zv.o;var pr="function",Ln="object",An="undefined",ii="prototype",dd="hasOwnProperty";var Wn=Object,dc=Wn[ii],hc=Wn.assign,Cf=Wn.create,pc=Wn.defineProperty,vo=dc[dd];var bT=null;function fr(e){e===void 0&&(e=!0);var n=e===!1?null:bT;return n||(typeof globalThis!==An&&(n=globalThis),!n&&typeof self!==An&&(n=self),!n&&typeof window!==An&&(n=window),!n&&typeof global!==An&&(n=global),bT=n),n}function fc(e){throw new TypeError(e)}function mc(e){var n=Cf;if(n)return n(e);if(e==null)return{};var t=typeof e;t!==Ln&&t!==pr&&fc("Object prototype may only be an Object:"+e);function i(){}return i[ii]=e,new i}var aR=(fr()||{}).Symbol,sR=(fr()||{}).Reflect;var Ww=function(e){for(var n,t=1,i=arguments.length;t<i;t++){n=arguments[t];for(var o in n)dc[dd].call(n,o)&&(e[o]=n[o])}return e},vi=hc||Ww,Jv=function(e,n){return Jv=Wn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i[dd](o)&&(t[o]=i[o])},Jv(e,n)};function qi(e,n){typeof n!==pr&&n!==null&&fc("Class extends value "+String(n)+" is not a constructor or null"),Jv(e,n);function t(){this.constructor=e}e[ii]=n===null?mc(n):(t[ii]=n[ii],new t)}function Tf(e,n){for(var t=0,i=n.length,o=e.length;t<i;t++,o++)e[o]=n[t];return e}var Fr="initialize",hn="name",hd="getNotifyMgr",Yr="identifier",nt="push",Zn="isInitialized",go="config",Ef="instrumentationKey",Xi="logger",Me="length",Fs="time",Wt="processNext",bf="getProcessTelContext",Ys="addNotificationListener",Bs="removeNotificationListener",Kv="stopPollingInternalLogs",Us="onComplete",zs="getPlugin",_c="flush",pd="_extensions",Br="splice",jn="teardown",vc="messageId",ba="message",Ur="isAsync",gc="_doTeardown",Hs="update",$n="getNext",mr="diagLog",xa="setNextPlugin",Uo="createNew",xf="cookieCfg",zo="indexOf",yc="substring",Sc="userAgent",Ho="split",fd="setEnabled",Da="substr",Df="nodeType",yo="apply",zr="replace",Qv="enableDebugExceptions",eg="logInternalMessage",md="toLowerCase",Mi="call",So="type",Nf="handler",Vs="listeners",_d="isChildEvt",Gs="getCtx",Hr="setCtx",wf="complete",vd="traceId",If="spanId",gd="traceFlags",tg="version";var je="",ig="channels",ni="core",ng="createPerfMgr",yd="disabled",Cc="extensionConfig",xT="extensions",On="processTelemetry",_r="priority",Tc="eventsSent",Na="eventsDiscarded",Ec="eventsSendRequest",wa="perfEvent",Pf="errorToConsole",Sd="warnToConsole",Ws="getPerfMgr";var AT="toISOString",OT="endsWith",Zw="startsWith",DT="indexOf",NT="map",wT="reduce",og="trim",MT="toString",jw="__proto__",Lf="constructor",IT=pc,ag=Wn.freeze,OR=Wn.seal,PT=Wn.keys,lg=String[ii],$w=lg[og],qw=lg[OT],MR=lg[Zw],Xw=Date[ii],Jw=Xw[AT],Kw=Array.isArray,kT=dc[MT],RT=vo[MT],Qw=RT[Mi](Wn),eI=/-([a-z])/g,tI=/([^\w\d_$])/g,iI=/^(\d+[\w\d_$])/,Af=Object.getPrototypeOf;function cg(e){if(e){if(Af)return Af(e);var n=e[jw]||e[ii]||e[Lf];if(n)return n}return null}function Kt(e){return e===void 0||typeof e===An}function ee(e){return e===null||Kt(e)}function ug(e){return!ee(e)}function Of(e,n){return!!(e&&vo[Mi](e,n))}function pn(e){return!!(e&&typeof e===Ln)}function Le(e){return!!(e&&typeof e===pr)}function Zs(e){var n=e;return n&&xe(n)&&(n=n[zr](eI,function(t,i){return i.toUpperCase()}),n=n[zr](tI,"_"),n=n[zr](iI,function(t,i){return"_"+i})),n}function lt(e,n){if(e)for(var t in e)vo[Mi](e,t)&&n[Mi](e,t,e[t])}function Cd(e,n){var t=!1;return e&&n&&!(t=e===n)&&(t=qw?e[OT](n):nI(e,n)),t}function nI(e,n){var t=!1,i=n?n[Me]:0,o=e?e[Me]:0;if(i&&o&&o>=i&&!(t=e===n)){for(var s=o-1,l=i-1;l>=0;l--){if(e[s]!=n[l])return!1;s--}t=!0}return t}function ki(e,n){return e&&n?e[zo](n)!==-1:!1}var st=Kw||rI;function rI(e){return!!(e&&kT[Mi](e)==="[object Array]")}function js(e){return!!(e&&kT[Mi](e)==="[object Error]")}function xe(e){return typeof e=="string"}function Td(e){return typeof e=="number"}function FT(e){return typeof e=="boolean"}function sg(e){var n=!1;if(e&&typeof e=="object"){var t=Af?Af(e):cg(e);t?(t[Lf]&&vo[Mi](t,Lf)&&(t=t[Lf]),n=typeof t===pr&&RT[Mi](t)===Qw):n=!0}return n}function qn(e){if(e)return Jw?e[AT]():oI(e)}function oI(e){if(e&&e.getUTCFullYear){var n=function(t){var i=String(t);return i[Me]===1&&(i="0"+i),i};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function _e(e,n,t){var i=e[Me];try{for(var o=0;o<i&&!(o in e&&n[Mi](t||e,e[o],o,e)===-1);o++);}catch{}}function Ni(e,n,t){if(e){if(e[DT])return e[DT](n,t);var i=e[Me],o=t||0;try{for(var s=Math.max(o>=0?o:i-Math.abs(o),0);s<i;s++)if(s in e&&e[s]===n)return s}catch{}}return-1}function $s(e,n,t){var i;if(e){if(e[NT])return e[NT](n,t);var o=e[Me],s=t||e;i=new Array(o);try{for(var l=0;l<o;l++)l in e&&(i[l]=n[Mi](s,e[l],e))}catch{}}return i}function dg(e,n,t){var i;if(e){if(e[wT])return e[wT](n,t);var o=e[Me],s=0;if(arguments[Me]>=3)i=arguments[2];else{for(;s<o&&!(s in e);)s++;i=e[s++]}for(;s<o;)s in e&&(i=n(i,e[s],s,e)),s++}return i}function gi(e){return e&&(e=$w&&e[og]?e[og]():e[zr]?e[zr](/^\s+|(?=\s)\s+$/g,je):e),e}var LT=!{toString:null}.propertyIsEnumerable("toString"),rg=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Mn(e){var n=typeof e;if(n!==pr&&(n!==Ln||e===null)&&fc("objKeys called on non-object"),!LT&&PT)return PT(e);var t=[];for(var i in e)e&&vo[Mi](e,i)&&t[nt](i);if(LT)for(var o=rg[Me],s=0;s<o;s++)e&&vo[Mi](e,rg[s])&&t[nt](rg[s]);return t}function vr(e,n,t,i){if(IT)try{var o={enumerable:!0,configurable:!0};return t&&(o.get=t),i&&(o.set=i),IT(e,n,o),!0}catch{}return!1}function aI(e){return e}function bc(e){return ag&&lt(e,function(n,t){(st(t)||pn(t))&&ag(t)}),Co(e)}var Co=ag||aI;function Ji(){var e=Date;return e.now?e.now():new e().getTime()}function Qe(e){return js(e)?e[hn]:je}function _t(e,n,t,i,o){var s=t;return e&&(s=e[n],s!==t&&(!o||o(s))&&(!i||i(t))&&(s=t,e[n]=s)),s}function di(e,n,t){var i;return e?(i=e[n],!i&&ee(i)&&(i=Kt(t)?{}:t,e[n]=i)):i=Kt(t)?{}:t,i}function Xn(e,n){return ee(e)?n:e}function xc(e){return!!e}function ri(e){throw new Error(e)}function YT(e,n){var t=null,i=null;return Le(e)?t=e:i=e,function(){var o=arguments;if(t&&(i=t()),i)return i[n][yo](i,o)}}function hg(e,n,t){if(e&&n&&pn(e)&&pn(n)){var i=function(s){if(xe(s)){var l=n[s];Le(l)?(!t||t(s,!0,n,e))&&(e[s]=YT(n,s)):(!t||t(s,!1,n,e))&&(Of(e,s)&&delete e[s],vr(e,s,function(){return n[s]},function(u){n[s]=u})||(e[s]=l))}};for(var o in n)i(o)}return e}function Dc(e,n,t,i,o){e&&n&&t&&(o!==!1||Kt(e[n]))&&(e[n]=YT(t,i))}function Vo(e,n,t,i){return e&&n&&pn(e)&&st(t)&&_e(t,function(o){xe(o)&&Dc(e,o,n,o,i)}),e}function pg(e){return function(){function n(){var t=this;e&&lt(e,function(i,o){t[i]=o})}return n}()}function Mf(e){return e&&hc&&(e=Wn(hc({},e))),e}function Nc(e,n,t,i,o,s){var l=arguments,u=l[0]||{},d=l[Me],f=!1,p=1;for(d>0&&FT(u)&&(f=u,u=l[p]||{},p++),pn(u)||(u={});p<d;p++){var m=l[p],g=st(m),v=pn(m);for(var C in m){var E=g&&C in m||v&&vo[Mi](m,C);if(E){var b=m[C],S=void 0;if(f&&b&&((S=st(b))||sg(b))){var I=u[C];S?st(I)||(I=[]):sg(I)||(I={}),b=Nc(f,I,b)}b!==void 0&&(u[C]=b)}}}return u}function kf(e){var n={};return lt(e,function(t,i){n[t]=i,n[i]=t}),bc(n)}function fg(e){var n={};return lt(e,function(t,i){n[t]=i[1],n[i[0]]=i[1]}),bc(n)}var BT="window",sI="document",lI="documentMode",cI="navigator",uI="history",dI="location",hI="console",pI="performance",UT="JSON",fI="crypto",mI="msCrypto",_I="ReactNative",gg="msie",yg="trident/",zT="XMLHttpRequest",mg=null,_g=null,vI=!1,wc=null,vg=null;function HT(e,n){var t=!1;if(e){try{if(t=n in e,!t){var i=e[ii];i&&(t=n in i)}}catch{}if(!t)try{var o=new e;t=!Kt(o[n])}catch{}}return t}function oi(e){var n=fr();return n&&n[e]?n[e]:e===BT&&Go()?window:null}function Go(){return!!(typeof window===Ln&&window)}function Jn(){return Go()?window:oi(BT)}function Rf(){return!!(typeof document===Ln&&document)}function yi(){return Rf()?document:oi(sI)}function Sg(){return!!(typeof navigator===Ln&&navigator)}function En(){return Sg()?navigator:oi(cI)}function Ff(){return!!(typeof history===Ln&&history)}function Cg(){return Ff()?history:oi(uI)}function kn(e){if(e&&vI){var n=oi("__mockLocation");if(n)return n}return typeof location===Ln&&location?location:oi(dI)}function Tg(){return typeof console!==An?console:oi(hI)}function gr(){return oi(pI)}function Vr(){return!!(typeof JSON===Ln&&JSON||oi(UT)!==null)}function Ri(){return Vr()?JSON||oi(UT):null}function Eg(){return oi(fI)}function bg(){return oi(mI)}function xg(){var e=En();return e&&e.product?e.product===_I:!1}function Ic(){var e=En();if(e&&(e[Sc]!==_g||mg===null)){_g=e[Sc];var n=(_g||je)[md]();mg=ki(n,gg)||ki(n,yg)}return mg}function Pc(e){if(e===void 0&&(e=null),!e){var n=En()||{};e=n?(n[Sc]||je)[md]():je}var t=(e||je)[md]();if(ki(t,gg)){var i=yi()||{};return Math.max(parseInt(t[Ho](gg)[1]),i[lI]||0)}else if(ki(t,yg)){var o=parseInt(t[Ho](yg)[1]);if(o)return o+4}return null}function Ce(e){var n=Object[ii].toString[Mi](e),t=je;return n==="[object Error]"?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[hn]+"'":Vr()&&(t=Ri().stringify(e)),n+t}function Ia(){return vg===null&&(vg=Sg()&&!!En().sendBeacon),vg}function Yf(e){var n=!1;try{n=!!oi("fetch");var t=oi("Request");n&&e&&t&&(n=HT(t,"keepalive"))}catch{}return n}function Bf(){return wc===null&&(wc=typeof XDomainRequest!==An,wc&&qs()&&(wc=wc&&!HT(oi(zT),"withCredentials"))),wc}function qs(){var e=!1;try{var n=oi(zT);e=!!n}catch{}return e}var Dg=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],zf=null,Uf;function gI(e,n){return function(){var t=arguments,i=Ng(n);if(i){var o=i.listener;o&&o[e]&&o[e][yo](o,t)}}}function yI(){var e=oi("Microsoft");return e&&(zf=e.ApplicationInsights),zf}function Ng(e){var n=zf;return!n&&e.disableDbgExt!==!0&&(n=zf||yI()),n?n.ChromeDbgExt:null}function VT(e){if(!Uf){Uf={};for(var n=0;n<Dg[Me];n++)Uf[Dg[n]]=gI(Dg[n],e)}return Uf}var SI="AI (Internal): ",CI="AI: ",TI="AITR_";function GT(e){return e?'"'+e[zr](/\"/g,je)+'"':je}function WT(e,n){var t=Tg();if(t){var i="log";t[e]&&(i=e),Le(t[i])&&t[i](n)}}var Wo=function(){function e(n,t,i,o){i===void 0&&(i=!1);var s=this;s[vc]=n,s[ba]=(i?CI:SI)+n;var l=je;Vr()&&(l=Ri().stringify(o));var u=(t?" message:"+GT(t):je)+(o?" props:"+GT(l):je);s[ba]+=u}return e.dataType="MessageData",e}();function Gr(e,n){return(e||{})[Xi]||new Xs(n)}var Xs=function(){function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,i={},o,s,l,u;Be(e,this,function(d){p(n||{}),d.consoleLoggingLevel=function(){return o},d.telemetryLoggingLevel=function(){return s},d.maxInternalMessageLimit=function(){return l},d[Qv]=function(){return u},d.throwInternal=function(v,C,E,b,S){S===void 0&&(S=!1);var I=new Wo(C,E,S,b);if(u)throw Ce(I);var z=v===1?Pf:Sd;if(Kt(I[ba]))g("throw"+(v===1?"Critical":"Warning"),I);else{if(S){var j=+I[vc];!i[j]&&o>=v&&(d[z](I[ba]),i[j]=!0)}else o>=v&&d[z](I[ba]);f(v,I)}},d[Sd]=function(v){WT("warn",v),g("warning",v)},d[Pf]=function(v){WT("error",v),g("error",v)},d.resetInternalMessageCount=function(){t=0,i={}},d[eg]=f;function f(v,C){if(!m()){var E=!0,b=TI+C[vc];if(i[b]?E=!1:i[b]=!0,E&&(v<=s&&(d.queue[nt](C),t++,g(v===1?"error":"warn",C)),t===l)){var S="Internal events throttle limit per PageView reached for this app.",I=new Wo(23,S,!1);d.queue[nt](I),v===1?d[Pf](S):d[Sd](S)}}}function p(v){o=Xn(v.loggingLevelConsole,0),s=Xn(v.loggingLevelTelemetry,1),l=Xn(v.maxMessageLimit,25),u=Xn(v.enableDebug,Xn(v[Qv],!1))}function m(){return t>=l}function g(v,C){var E=Ng(n||{});E&&E[mr]&&E[mr](v,C)}})}return e.__ieDyn=1,e}();function wg(e){return e||new Xs}function ae(e,n,t,i,o,s){s===void 0&&(s=!1),wg(e).throwInternal(n,t,i,o,s)}function yr(e,n){wg(e)[Sd](n)}function Ig(e,n,t){wg(e)[eg](n,t)}var Lc="ctx",Lg="ParentContextKey",Ed="ChildrenContextKey",EI=null,bd=function(){function e(n,t,i){var o=this,s=!1;if(o.start=Ji(),o[hn]=n,o[Ur]=i,o[_d]=function(){return!1},Le(t)){var l;s=vr(o,"payload",function(){return!l&&Le(t)&&(l=t(),t=null),l})}o[Gs]=function(u){return u?u===e[Lg]||u===e[Ed]?o[u]:(o[Lc]||{})[u]:null},o[Hr]=function(u,d){if(u)if(u===e[Lg])o[u]||(o[_d]=function(){return!0}),o[u]=d;else if(u===e[Ed])o[u]=d;else{var f=o[Lc]=o[Lc]||{};f[u]=d}},o[wf]=function(){var u=0,d=o[Gs](e[Ed]);if(st(d))for(var f=0;f<d[Me];f++){var p=d[f];p&&(u+=p[Fs])}o[Fs]=Ji()-o.start,o.exTime=o[Fs]-u,o[wf]=function(){},!s&&Le(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}();var Ag=function(){function e(n){this.ctx={},Be(e,this,function(t){t.create=function(i,o,s){return new bd(i,o,s)},t.fire=function(i){i&&(i[wf](),n&&Le(n[wa])&&n[wa](i))},t[Hr]=function(i,o){if(i){var s=t[Lc]=t[Lc]||{};s[i]=o}},t[Gs]=function(i){return(t[Lc]||{})[i]}})}return e.__ieDyn=1,e}();var Pg="CoreUtils.doPerf";function Pa(e,n,t,i,o){if(e){var s=e;if(s[Ws]&&(s=s[Ws]()),s){var l=void 0,u=s[Gs](Pg);try{if(l=s.create(n(),i,o),l){if(u&&l[Hr]&&(l[Hr](bd[Lg],u),u[Gs]&&u[Hr])){var d=u[Gs](bd[Ed]);d||(d=[],u[Hr](bd[Ed],d)),d[nt](l)}return s[Hr](Pg,l),t(l)}}catch(f){l&&l[Hr]&&l[Hr]("exception",f)}finally{l&&s.fire(l),s[Hr](Pg,u)}}}return t()}function Og(){return EI}var ZT=4294967296,Js=4294967295,jT=!1,xd=123456789,Dd=987654321;function bI(e){e<0&&(e>>>=0),xd=123456789+e&Js,Dd=987654321-e&Js,jT=!0}function xI(){try{var e=Ji()&2147483647;bI((Math.random()*ZT^e)+e)}catch{}}function Ks(e){var n=0,t=Eg()||bg();return t&&t.getRandomValues&&(n=t.getRandomValues(new Uint32Array(1))[0]&Js),n===0&&Ic()&&(jT||xI(),n=Mg()&Js),n===0&&(n=Math.floor(ZT*Math.random()|0)),e||(n>>>=0),n}function Mg(e){Dd=36969*(Dd&65535)+(Dd>>16)&Js,xd=18e3*(xd&65535)+(xd>>16)&Js;var n=(Dd<<16)+(xd&65535)>>>0&Js|0;return e||(n>>>=0),n}function Zo(e){e===void 0&&(e=22);for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Ks()>>>0,i=0,o=je;o[Me]<e;)i++,o+=n.charAt(t&63),t>>>=6,i===5&&(t=(Ks()<<2&4294967295|t&3)>>>0,i=0);return o}var $T=pc,qT="2.8.18",DI="."+Zo(6),NI=0;function wI(e,n,t){if($T)try{return $T(e,n,{value:t,enumerable:!1,configurable:!0}),!0}catch{}return!1}function XT(e){return e[Df]===1||e[Df]===9||!+e[Df]}function II(e,n){var t=n[e.id];if(!t){t={};try{XT(n)&&(wI(n,e.id,t)||(n[e.id]=t))}catch{}}return t}function Ki(e,n){return n===void 0&&(n=!1),Zs(e+NI+++(n?"."+qT:je)+DI)}function Hf(e){var n={id:Ki("_aiData-"+(e||je)+"."+qT),accept:function(t){return XT(t)},get:function(t,i,o,s){var l=t[n.id];return l?l[Zs(i)]:(s&&(l=II(n,t),l[Zs(i)]=o),o)},kill:function(t,i){if(t&&t[i])try{delete t[i]}catch{}}};return n}var JT="toGMTString",KT="toUTCString",Bg="cookie",kg="expires",Fg="enabled",QT="isCookieUseDisabled",eE="disableCookiesUsage",La="_ckMgr",Vf=null,Rg=null,tE=null,Nd=yi(),iE={},Wf={};function PI(e,n){var t=Qs[La]||Wf[La];return t||(t=Qs[La]=Qs(e,n),Wf[La]=t),t}function Gf(e){return e?e.isEnabled():!0}function LI(e){var n=e[xf]=e[xf]||{};if(_t(n,"domain",e.cookieDomain,ug,ee),_t(n,"path",e.cookiePath||"/",null,ee),ee(n[Fg])){var t=void 0;Kt(e[QT])||(t=!e[QT]),Kt(e[eE])||(t=!e[eE]),n[Fg]=t}return n}function aE(e,n){return n&&e&&st(e.ignoreCookies)?e.ignoreCookies[zo](n)!==-1:!1}function AI(e,n){return n&&e&&st(e.blockedCookies)&&e.blockedCookies[zo](n)!==-1?!0:aE(e,n)}function el(e,n){var t;if(e)t=e.getCookieMgr();else if(n){var i=n[xf];i[La]?t=i[La]:t=Qs(n)}return t||(t=PI(n,(e||{})[Xi])),t}function Qs(e,n){var t,i=LI(e||Wf),o=i.path||"/",s=i.domain,l=i[Fg]!==!1,u=(t={isEnabled:function(){var d=l&&Yg(n),f=Wf[La];return d&&f&&u!==f&&(d=Gf(f)),d}},t[fd]=function(d){l=d!==!1},t.set=function(d,f,p,m,g){var v=!1;if(Gf(u)&&!AI(i,d)){var C={},E=gi(f||je),b=E[zo](";");if(b!==-1&&(E=gi(f[yc](0,b)),C=sE(f[yc](b+1))),_t(C,"domain",m||s,xc,Kt),!ee(p)){var S=Ic();if(Kt(C[kg])){var I=Ji(),z=I+p*1e3;if(z>0){var j=new Date;j.setTime(z),_t(C,kg,nE(j,S?JT:KT)||nE(j,S?JT:KT)||je,xc)}}S||_t(C,"max-age",je+p,null,Kt)}var k=kn();k&&k.protocol==="https:"&&(_t(C,"secure",null,null,Kt),Rg===null&&(Rg=!Ug((En()||{})[Sc])),Rg&&_t(C,"SameSite","None",null,Kt)),_t(C,"path",g||o,null,Kt);var De=i.setCookie||oE;De(d,rE(E,C)),v=!0}return v},t.get=function(d){var f=je;return Gf(u)&&!aE(i,d)&&(f=(i.getCookie||OI)(d)),f},t.del=function(d,f){var p=!1;return Gf(u)&&(p=u.purge(d,f)),p},t.purge=function(d,f){var p,m=!1;if(Yg(n)){var g=(p={},p.path=f||"/",p[kg]="Thu, 01 Jan 1970 00:00:01 GMT",p);Ic()||(g["max-age"]="0");var v=i.delCookie||oE;v(d,rE(je,g)),m=!0}return m},t);return u[La]=u,u}function Yg(e){if(Vf===null){Vf=!1;try{var n=Nd||{};Vf=n[Bg]!==void 0}catch(t){ae(e,2,68,"Cannot access document.cookie - "+Qe(t),{exception:Ce(t)})}}return Vf}function sE(e){var n={};if(e&&e[Me]){var t=gi(e)[Ho](";");_e(t,function(i){if(i=gi(i||je),i){var o=i[zo]("=");o===-1?n[i]=null:n[gi(i[yc](0,o))]=gi(i[yc](o+1))}})}return n}function nE(e,n){return Le(e[n])?e[n]():null}function rE(e,n){var t=e||je;return lt(n,function(i,o){t+="; "+i+(ee(o)?je:"="+o)}),t}function OI(e){var n=je;if(Nd){var t=Nd[Bg]||je;tE!==t&&(iE=sE(t),tE=t),n=gi(iE[e]||je)}return n}function oE(e,n){Nd&&(Nd[Bg]=e+"="+n)}function Ug(e){return xe(e)?!!(ki(e,"CPU iPhone OS 12")||ki(e,"iPad; CPU OS 12")||ki(e,"Macintosh; Intel Mac OS X 10_14")&&ki(e,"Version/")&&ki(e,"Safari")||ki(e,"Macintosh; Intel Mac OS X 10_14")&&Cd(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||ki(e,"Chrome/5")||ki(e,"Chrome/6")||ki(e,"UnrealEngine")&&!ki(e,"Chrome")||ki(e,"UCBrowser/12")||ki(e,"UCBrowser/11")):!1}var fE="on",lE="attachEvent",cE="addEventListener",uE="detachEvent",dE="removeEventListener",zg="events",Hg="visibilitychange",qf="pagehide";var mE="unload",_E="beforeunload",vE=Ki("aiEvtPageHide"),DF=Ki("aiEvtPageShow"),MI=/\.[\.]+/g,kI=/[\.]+$/,RI=1,Zf=Hf("events"),FI=/^([^.]*)(?:\.(.+)|)/;function hE(e){return e&&e[zr]?e[zr](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,je):e}function Vg(e,n){var t;if(n){var i=je;st(n)?(i=je,_e(n,function(s){s=hE(s),s&&(s[0]!=="."&&(s="."+s),i+=s)})):i=hE(n),i&&(i[0]!=="."&&(i="."+i),e=(e||je)+i)}var o=FI.exec(e||je)||[];return t={},t[So]=o[1],t.ns=(o[2]||je).replace(MI,".").replace(kI,je)[Ho](".").sort().join("."),t}function gE(e,n,t){t===void 0&&(t=!0);var i=Zf.get(e,zg,{},t),o=i[n];return o||(o=i[n]=[]),o}function yE(e,n,t,i){e&&n&&n[So]&&(e[dE]?e[dE](n[So],t,i):e[uE]&&e[uE](fE+n[So],t))}function YI(e,n,t,i){var o=!1;return e&&n&&n[So]&&t&&(e[cE]?(e[cE](n[So],t,i),o=!0):e[lE]&&(e[lE](fE+n[So],t),o=!0)),o}function pE(e,n,t,i){for(var o=n[Me];o--;){var s=n[o];s&&(!t.ns||t.ns===s.evtName.ns)&&(!i||i(s))&&(yE(e,s.evtName,s[Nf],s.capture),n[Br](o,1))}}function BI(e,n,t){if(n[So])pE(e,gE(e,n[So]),n,t);else{var i=Zf.get(e,zg,{});lt(i,function(o,s){pE(e,s,n,t)}),Mn(i)[Me]===0&&Zf.kill(e,zg)}}function Kn(e,n){var t;return n?(st(n)?t=[e].concat(n):t=[e,n],t=Vg("xx",t).ns[Ho](".")):t=e,t}function Sr(e,n,t,i,o){var s;o===void 0&&(o=!1);var l=!1;if(e)try{var u=Vg(n,i);if(l=YI(e,u,t,o),l&&Zf.accept(e)){var d=(s={guid:RI++,evtName:u},s[Nf]=t,s.capture=o,s);gE(e,u.type)[nt](d)}}catch{}return l}function Aa(e,n,t,i,o){if(o===void 0&&(o=!1),e)try{var s=Vg(n,i),l=!1;BI(e,s,function(u){return s.ns&&!t||u[Nf]===t?(l=!0,!0):!1}),l||yE(e,s,t,o)}catch{}}function SE(e,n,t){var i=!1,o=Jn();o&&(i=Sr(o,e,n,t),i=Sr(o.body,e,n,t)||i);var s=yi();return s&&(i=Sr(s,e,n,t)||i),i}function CE(e,n,t){var i=Jn();i&&(Aa(i,e,n,t),Aa(i.body,e,n,t));var o=yi();o&&Aa(o,e,n,t)}function jf(e,n,t,i){var o=!1;return n&&e&&e[Me]>0&&_e(e,function(s){s&&(!t||Ni(t,s)===-1)&&(o=SE(s,n,i)||o)}),o}function TE(e,n,t,i){var o=!1;return n&&e&&st(e)&&(o=jf(e,n,t,i),!o&&t&&t[Me]>0&&(o=jf(e,n,null,i))),o}function $f(e,n,t){e&&st(e)&&_e(e,function(i){i&&CE(i,n,t)})}function Gg(e,n,t){return TE([_E,mE,qf],e,n,t)}function Wg(e,n){$f([_E,mE,qf],e,n)}function wd(e,n,t){function i(l){var u=yi();e&&u&&u.visibilityState==="hidden"&&e(l)}var o=Kn(vE,t),s=jf([qf],e,n,o);return(!n||Ni(n,Hg)===-1)&&(s=jf([Hg],i,n,o)||s),!s&&n&&(s=wd(e,null,t)),s}function Zg(e,n){var t=Kn(vE,n);$f([qf],e,t),$f([Hg],null,t)}function Rn(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=je,t,i=0;i<4;i++)t=Ks(),n+=e[t&15]+e[t>>4&15]+e[t>>8&15]+e[t>>12&15]+e[t>>16&15]+e[t>>20&15]+e[t>>24&15]+e[t>>28&15];var o=e[8+(Ks()&3)|0];return n[Da](0,8)+n[Da](9,4)+"4"+n[Da](13,3)+o+n[Da](16,3)+n[Da](19,12)}var jg="00",HI="ff",bE="00000000000000000000000000000000",xE="0000000000000000";function Id(e,n,t){return e&&e[Me]===n&&e!==t?!!e.match(/^[\da-f]*$/i):!1}function EE(e,n,t){return Id(e,n)?e:t}function VI(e){(isNaN(e)||e<0||e>255)&&(e=1);for(var n=e.toString(16);n[Me]<2;)n="0"+n;return n}function Pd(e,n,t,i){var o;return o={},o[tg]=Id(i,2,HI)?i:jg,o[vd]=tl(e)?e:Rn(),o.spanId=il(n)?n:Rn()[Da](0,16),o.traceFlags=t>=0&&t<=255?t:1,o}function tl(e){return Id(e,32,bE)}function il(e){return Id(e,16,xE)}function Ld(e){if(e){var n=VI(e[gd]);Id(n,2)||(n="01");var t=e[tg]||jg;return t!=="00"&&t!=="ff"&&(t=jg),"".concat(t.toLowerCase(),"-").concat(EE(e.traceId,32,bE).toLowerCase(),"-").concat(EE(e.spanId,16,xE).toLowerCase(),"-").concat(n.toLowerCase())}return""}var GI=Hf("plugin");function jo(e){return GI.get(e,"state",{},!0)}function Xf(e,n){for(var t=[],i=null,o=e[$n](),s;o;){var l=o[zs]();if(l){i&&Le(i[xa])&&Le(l[On])&&i[xa](l);var u=!1;Le(l[Zn])?u=l[Zn]():(s=jo(l),u=s[Zn]),u||t[nt](l),i=l,o=o[$n]()}}_e(t,function(d){var f=e[ni]();d[Fr](e.getCfg(),f,n,e[$n]()),s=jo(d),!d[ni]&&!s[ni]&&(s[ni]=f),s[Zn]=!0,delete s[jn]})}function Jf(e){return e.sort(function(n,t){var i=0;if(t){var o=Le(t[On]);Le(n[On])?i=o?n[_r]-t[_r]:1:o&&(i=-1)}else i=n?1:-1;return i})}function DE(e){var n={};return{getName:function(){return n[hn]},setName:function(t){e&&e.setName(t),n[hn]=t},getTraceId:function(){return n[vd]},setTraceId:function(t){e&&e.setTraceId(t),tl(t)&&(n[vd]=t)},getSpanId:function(){return n[If]},setSpanId:function(t){e&&e.setSpanId(t),il(t)&&(n[If]=t)},getTraceFlags:function(){return n[gd]},setTraceFlags:function(t){e&&e.setTraceFlags(t),n[gd]=t}}}var WI="TelemetryPluginChain",NE="_hasRun",wE="_getTelCtx",IE=0;function ZI(e,n,t){for(;e;){if(e[zs]()===t)return e;e=e[$n]()}return To([t],n[go]||{},n)}function $g(e,n,t,i){var o=null,s=[];i!==null&&(o=i?ZI(e,t,i):e);var l={_next:d,ctx:{core:function(){return t},diagLog:function(){return Gr(t,n)},getCfg:function(){return n},getExtCfg:f,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(g){o=g},iterate:m,onComplete:u}};function u(g,v){for(var C=[],E=2;E<arguments.length;E++)C[E-2]=arguments[E];g&&s[nt]({func:g,self:Kt(v)?l.ctx:v,args:C})}function d(){var g=o;if(o=g?g[$n]():null,!g){var v=s;v&&v[Me]>0&&(_e(v,function(C){try{C.func[Mi](C.self,C.args)}catch(E){ae(t[Xi],2,73,"Unexpected Exception during onComplete - "+Ce(E))}}),s=[])}return g}function f(g,v,C){v===void 0&&(v={}),C===void 0&&(C=0);var E;if(n){var b=n[Cc];b&&g&&(E=b[g])}if(!E)E=v;else if(pn(v)&&C!==0){var S=Nc(!0,v,E);n&&C===2&&lt(v,function(I){if(ee(S[I])){var z=n[I];ee(z)||(S[I]=z)}}),E=S}return E}function p(g,v,C){C===void 0&&(C=!1);var E,b=f(g,null);return b&&!ee(b[v])?E=b[v]:n&&!ee(n[v])&&(E=n[v]),ee(E)?C:E}function m(g){for(var v;v=l._next();){var C=v[zs]();C&&g(C)}}return l}function an(e,n,t,i){var o=$g(e,n,t,i),s=o.ctx;function l(d){var f=o._next();return f&&f[On](d,s),!f}function u(d,f){return d===void 0&&(d=null),st(d)&&(d=To(d,n,t,f)),an(d||s[$n](),n,t,f)}return s[Wt]=l,s[Uo]=u,s}function Ac(e,n,t){var i=n[go]||{},o=$g(e,i,n,t),s=o.ctx;function l(d){var f=o._next();return f&&f.unload(s,d),!f}function u(d,f){return d===void 0&&(d=null),st(d)&&(d=To(d,i,n,f)),Ac(d||s[$n](),n,f)}return s[Wt]=l,s[Uo]=u,s}function Ad(e,n,t){var i=n[go]||{},o=$g(e,i,n,t),s=o.ctx;function l(d){return s.iterate(function(f){Le(f[Hs])&&f[Hs](s,d)})}function u(d,f){return d===void 0&&(d=null),st(d)&&(d=To(d,i,n,f)),Ad(d||s[$n](),n,f)}return s[Wt]=l,s[Uo]=u,s}function To(e,n,t,i){var o=null,s=!i;if(st(e)&&e[Me]>0){var l=null;_e(e,function(u){if(!s&&i===u&&(s=!0),s&&u&&Le(u[On])){var d=jI(u,n,t);o||(o=d),l&&l._setNext(d),l=d}})}return i&&!o?To([i],n,t):o}function jI(e,n,t){var i=null,o=Le(e[On]),s=Le(e[xa]),l;e?l=e[Yr]+"-"+e[_r]+"-"+IE++:l="Unknown-0-"+IE++;var u={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:p,unload:m,update:g,_id:l,_setNext:function(v){i=v}};function d(){var v;return e&&Le(e[wE])&&(v=e[wE]()),v||(v=an(u,n,t)),v}function f(v,C,E,b,S){var I=!1,z=e?e[Yr]:WI,j=v[NE];return j||(j=v[NE]={}),v.setNext(i),e&&Pa(v[ni](),function(){return z+":"+E},function(){j[l]=!0;try{var k=i?i._id:je;k&&(j[k]=!1),I=C(v)}catch($){var De=i?j[i._id]:!0;De&&(I=!0),(!i||!De)&&ae(v[mr](),1,73,"Plugin ["+z+"] failed during "+E+" - "+Ce($)+", run flags: "+Ce(j))}},b,S),I}function p(v,C){C=C||d();function E(b){if(!e||!o)return!1;var S=jo(e);return S[jn]||S[yd]?!1:(s&&e[xa](i),e[On](v,b),!0)}f(C,E,"processTelemetry",function(){return{item:v}},!v.sync)||C[Wt](v)}function m(v,C){function E(){var b=!1;if(e){var S=jo(e),I=e[ni]||S[ni];e&&(!I||I===v.core())&&!S[jn]&&(S[ni]=null,S[jn]=!0,S[Zn]=!1,e[jn]&&e[jn](v,C)===!0&&(b=!0))}return b}f(v,E,"unload",function(){},C[Ur])||v[Wt](C)}function g(v,C){function E(){var b=!1;if(e){var S=jo(e),I=e[ni]||S[ni];e&&(!I||I===v.core())&&!S[jn]&&e[Hs]&&e[Hs](v,C)===!0&&(b=!0)}return b}f(v,E,"update",function(){},!1)||v[Wt](C)}return Co(u)}var Od=500,$I="Channel has invalid priority - ";function PE(e,n,t){n&&st(n)&&n[Me]>0&&(n=n.sort(function(i,o){return i[_r]-o[_r]}),_e(n,function(i){i[_r]<Od&&ri($I+i[Yr])}),e[nt]({queue:Co(n),chain:To(n,t[go],t)}))}function LE(e,n){function t(){return an(null,n[go],n,null)}function i(f,p,m,g){var v=f?f[Me]+1:1;function C(){v--,v===0&&(g&&g(),g=null)}v>0&&_e(f,function(E){if(E&&E.queue[Me]>0){var b=E.chain,S=p[Uo](b);S[Us](C),m(S)}else v--}),C()}function o(f,p){var m=p||{reason:0};return i(e,f,function(g){g[Wt](m)},function(){f[Wt](m)}),!0}function s(f,p){var m=p||{reason:0,isAsync:!1};return i(e,f,function(g){g[Wt](m)},function(){f[Wt](m),u=!1}),!0}function l(f){var p=null;return e&&e[Me]>0&&_e(e,function(m){if(m&&m.queue[Me]>0&&(_e(m.queue,function(g){if(g[Yr]===f)return p=g,-1}),p))return-1}),p}var u=!1,d={identifier:"ChannelControllerPlugin",priority:Od,initialize:function(f,p,m,g){u=!0,_e(e,function(v){v&&v.queue[Me]>0&&Xf(an(v.chain,f,p),m)})},isInitialized:function(){return u},processTelemetry:function(f,p){i(e,p||t(),function(m){m[Wt](f)},function(){p[Wt](f)})},update:o,pause:function(){i(e,t(),function(f){f.iterate(function(p){p.pause&&p.pause()})},null)},resume:function(){i(e,t(),function(f){f.iterate(function(p){p.resume&&p.resume()})},null)},teardown:s,getChannel:l,flush:function(f,p,m,g){var v=1,C=!1,E=null;g=g||5e3;function b(){v--,C&&v===0&&(E&&(clearTimeout(E),E=null),p&&p(C),p=null)}return i(e,t(),function(S){S.iterate(function(I){if(I[_c]){v++;var z=!1;I[_c](f,function(){z=!0,b()},m)||z||(f&&E==null?E=setTimeout(function(){E=null,b()},g):b())}})},function(){C=!0,b()}),!0},_setQueue:function(f){e=f}};return d}function AE(e,n,t){var i=[];if(e&&_e(e,function(s){return PE(i,s,t)}),n){var o=[];_e(n,function(s){s[_r]>Od&&o[nt](s)}),PE(i,o,t)}return i}function Kf(){var e=[];function n(i){i&&e[nt](i)}function t(i,o){_e(e,function(s){try{s(i,o)}catch(l){ae(i[mr](),2,73,"Unexpected error calling unload handler - "+Ce(l))}}),e=[]}return{add:n,run:t}}var Oa="getPlugin",Wr=function(){function e(){var n=this,t,i,o,s,l;f(),Be(e,n,function(p){p[Fr]=function(m,g,v,C){d(m,g,C),t=!0},p[jn]=function(m,g){var v,C=p[ni];if(!C||m&&C!==m[ni]())return;var E,b=!1,S=m||Ac(null,C,o&&o[Oa]?o[Oa]():o),I=g||(v={reason:0},v[Ur]=!1,v);function z(){if(!b){b=!0,s.run(S,g);var j=l;l=[],_e(j,function(k){k.rm()}),E===!0&&S[Wt](I),f()}}return!p[gc]||p[gc](S,I,z)!==!0?z():E=!0,E},p[Hs]=function(m,g){var v=p[ni];if(!v||m&&v!==m[ni]())return;var C,E=!1,b=m||Ad(null,v,o&&o[Oa]?o[Oa]():o),S=g||{reason:0};function I(){E||(E=!0,d(b.getCfg(),b.core(),b[$n]()))}return!p._doUpdate||p._doUpdate(b,S,I)!==!0?I():C=!0,C},p._addHook=function(m){m&&(st(m)?l=l.concat(m):l[nt](m))},Dc(p,"_addUnloadCb",function(){return s},"add")}),n[mr]=function(p){return u(p)[mr]()},n[Zn]=function(){return t},n.setInitialized=function(p){t=p},n[xa]=function(p){o=p},n[Wt]=function(p,m){m?m[Wt](p):o&&Le(o[On])&&o[On](p,null)},n._getTelCtx=u;function u(p){p===void 0&&(p=null);var m=p;if(!m){var g=i||an(null,{},n[ni]);o&&o[Oa]?m=g[Uo](null,o[Oa]):m=g[Uo](null,o)}return m}function d(p,m,g){p&&_t(p,Cc,[],null,ee),!g&&m&&(g=m[bf]()[$n]());var v=o;o&&o[Oa]&&(v=o[Oa]()),n[ni]=m,i=an(g,p,m,v)}function f(){t=!1,n[ni]=null,i=null,o=null,l=[],s=Kf()}}return e.__ieDyn=1,e}();var OE=function(e){qi(n,e);function n(){var t=e.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var i,o;s(),Be(n,t,function(l,u){l.addTelemetryInitializer=function(d){var f={id:i++,fn:d};o[nt](f);var p={remove:function(){_e(o,function(m,g){if(m.id===f.id)return o[Br](g,1),-1})}};return p},l[On]=function(d,f){for(var p=!1,m=o[Me],g=0;g<m;++g){var v=o[g];if(v)try{if(v.fn[yo](null,[d])===!1){p=!0;break}}catch(C){ae(f[mr](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Qe(C),{exception:Ce(C)},!0)}}p||l[Wt](d,f)},l[gc]=function(){s()}});function s(){i=0,o=[]}return t}return n.__ieDyn=1,n}(Wr);var FE="Plugins must provide initialize method",ME="_notificationManager",kE="SDK is still unloading...",qI="SDK is not initialized",XI={loggingLevelConsole:1};function JI(e,n){return new Ag(n)}function KI(e,n,t){var i,o=[],s={};return _e(t,function(l){(ee(l)||ee(l[Fr]))&&ri(FE);var u=l[_r],d=l[Yr];l&&u&&(ee(s[u])?s[u]=d:yr(e,"Two extensions have same priority #"+u+" - "+s[u]+", "+d)),(!u||u<n)&&o[nt](l)}),i={all:t},i[ni]=o,i}function RE(e,n){var t=!1;return _e(n,function(i){if(i===e)return t=!0,-1}),t}function QI(){var e;return mc((e={},e[Ys]=function(n){},e[Bs]=function(n){},e[Tc]=function(n){},e[Na]=function(n,t){},e[Ec]=function(n,t){},e))}var YE=function(){function e(){var n,t,i,o,s,l,u,d,f,p,m,g,v,C,E,b,S,I,z,j,k=0,De=!1;Be(e,this,function($){He(),$[Zn]=function(){return t},$[Fr]=function(A,H,G,de){C&&ri(kE),$[Zn]()&&ri("Core should not be initialized more than once"),n=A||{},$[go]=n,ee(A[Ef])&&ri("Please provide instrumentation key"),o=de,$[ME]=de,Gi(),Se(),qe(),G&&($[Xi]=G);var w=di(n,xT,[]);f=[],f[nt].apply(f,Tf(Tf([],H,!1),w,!1)),g=di(n,ig,[]),Ee(null),(!v||v[Me]===0)&&ri("No "+ig+" available"),t=!0,$.releaseQueue()},$.getTransmissionControls=function(){var A=[];return v&&_e(v,function(H){A[nt](H.queue)}),Co(A)},$.track=function(A){A.iKey=A.iKey||n[Ef],A[Fs]=A[Fs]||qn(new Date),A.ver=A.ver||"4.0",!C&&$[Zn]()?ct()[Wt](A):i[nt](A)},$[bf]=ct,$[hd]=function(){return o||(o=QI(),$[ME]=o),o},$[Ys]=function(A){o&&o[Ys](A)},$[Bs]=function(A){o&&o[Bs](A)},$.getCookieMgr=function(){return u||(u=Qs(n,$[Xi])),u},$.setCookieMgr=function(A){u=A},$[Ws]=function(){if(!s&&!l&&Xn(n.enablePerfMgr)){var A=Xn(n[ng]);Le(A)&&(l=A($,$[hd]()))}return s||l||Og()},$.setPerfMgr=function(A){s=A},$.eventCnt=function(){return i[Me]},$.releaseQueue=function(){if(t&&i[Me]>0){var A=i;i=[],_e(A,function(H){ct()[Wt](H)})}},$.pollInternalLogs=function(A){return b=A||null,De=!1,k&&(clearInterval(k),k=null),yt(!0)};function yt(A){if(!k&&!De){var H=A||$[Xi]&&$[Xi].queue[Me]>0;if(H){var G=Xn(n.diagnosticLogInterval);(!G||!(G>0))&&(G=1e4),k=setInterval(function(){clearInterval(k),k=0,Vi()},G)}}return k}$[Kv]=function(){De=!0,k&&(clearInterval(k),k=0,Vi())},Vo($,function(){return E},["addTelemetryInitializer"]),$.unload=function(A,H,G){var de;A===void 0&&(A=!0),t||ri(qI),C&&ri(kE);var w=(de={reason:50},de[Ur]=A,de.flushComplete=!1,de),V=Ac(Hi(),$);V[Us](function(){He(),H&&H(w)},$);function q(ue){w.flushComplete=ue,C=!0,I.run(V,w),$[Kv](),V[Wt](w)}Vi(),Pe(A,q,6,G)||q(!1)},$[zs]=$t,$.addPlugin=function(A,H,G,de){if(!A){de&&de(!1),Q(FE);return}var w=$t(A[Yr]);if(w&&!H){de&&de(!1),Q("Plugin ["+A[Yr]+"] is already loaded!");return}var V={reason:16};function q(Ve){f[nt](A),V.added=[A],Ee(V),de&&de(!0)}if(w){var ue=[w.plugin],Ne={reason:2,isAsync:!!G};At(ue,Ne,function(Ve){Ve?(V.removed=ue,V.reason|=32,q(!0)):de&&de(!1)})}else q(!1)},$.evtNamespace=function(){return S},$[_c]=Pe,$.getTraceCtx=function(A){return j||(j=DE()),j},$.setTraceCtx=function(A){j=A||null},Dc($,"addUnloadCb",function(){return I},"add");function He(){t=!1,n=Nc(!0,{},XI),$[go]=n,$[Xi]=new Xs(n),$[pd]=[],E=new OE,i=[],o=null,s=null,l=null,u=null,d=null,p=null,f=[],m=null,g=null,v=null,C=!1,b=null,S=Ki("AIBaseCore",!0),I=Kf(),j=null}function ct(){var A=an(Hi(),n,$);return A[Us](yt),A}function Ee(A){var H=KI($[Xi],Od,f);p=H[ni],d=null;var G=H.all;if(v=Co(AE(g,G,$)),m){var de=Ni(G,m);de!==-1&&G[Br](de,1),de=Ni(p,m),de!==-1&&p[Br](de,1),m._setQueue(v)}else m=LE(v,$);G[nt](m),p[nt](m),$[pd]=Jf(G),m[Fr](n,$,G);var w=ct();Xf(w,G),$[pd]=Co(Jf(p||[])).slice(),A&&F(A)}function $t(A){var H,G=null,de=null;return _e($[pd],function(w){if(w[Yr]===A&&w!==m&&w!==E)return de=w,-1}),!de&&m&&(de=m.getChannel(A)),de&&(G=(H={plugin:de},H[fd]=function(w){jo(de)[yd]=!w},H.isEnabled=function(){var w=jo(de);return!w[jn]&&!w[yd]},H.remove=function(w,V){var q;w===void 0&&(w=!0);var ue=[de],Ne=(q={reason:1},q[Ur]=w,q);At(ue,Ne,function(Ve){Ve&&Ee({reason:32,removed:ue}),V&&V(Ve)})},H)),G}function Hi(){if(!d){var A=(p||[]).slice();Ni(A,E)===-1&&A[nt](E),d=To(Jf(A),n,$)}return d}function At(A,H,G){if(A&&A[Me]>0){var de=To(A,n,$),w=Ac(de,$);w[Us](function(){var V=!1,q=[];_e(f,function(Ne,Ve){RE(Ne,A)?V=!0:q[nt](Ne)}),f=q;var ue=[];g&&(_e(g,function(Ne,Ve){var ut=[];_e(Ne,function(zt){RE(zt,A)?V=!0:ut[nt](zt)}),ue[nt](ut)}),g=ue),G&&G(V),yt()}),w[Wt](H)}else G(!1)}function Vi(){if($[Xi]&&$[Xi].queue){var A=$[Xi].queue.slice(0);$[Xi].queue[Me]=0,_e(A,function(H){var G,de=(G={},G[hn]=b||"InternalMessageId: "+H[vc],G.iKey=Xn(n[Ef]),G.time=qn(new Date),G.baseType=Wo.dataType,G.baseData={message:H[ba]},G);$.track(de)})}}function Pe(A,H,G,de){return m?m[_c](A,H,G||6,de):(H&&H(!1),!0)}function Gi(){var A=Xn(n.disableDbgExt);A===!0&&z&&(o[Bs](z),z=null),o&&!z&&A!==!0&&(z=VT(n),o[Ys](z))}function Se(){var A=Xn(n.enablePerfMgr);!A&&l&&(l=null),A&&di(n,ng,JI)}function qe(){var A=di(n,Cc,{});A.NotificationManager=o}function F(A){var H=Ad(Hi(),$);H[Us](yt),(!$._updateHook||$._updateHook(H,A)!==!0)&&H[Wt](A)}function Q(A){var H=$[Xi];H?(ae(H,2,73,A),yt()):ri(A)}})}return e.__ieDyn=1,e}();function Qf(e,n,t,i){_e(e,function(o){if(o&&o[n])if(t)setTimeout(function(){return i(o)},0);else try{i(o)}catch{}})}var BE=function(){function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;Be(e,this,function(i){i[Ys]=function(o){i.listeners[nt](o)},i[Bs]=function(o){for(var s=Ni(i[Vs],o);s>-1;)i.listeners[Br](s,1),s=Ni(i[Vs],o)},i[Tc]=function(o){Qf(i[Vs],Tc,!0,function(s){s[Tc](o)})},i[Na]=function(o,s){Qf(i[Vs],Na,!0,function(l){l[Na](o,s)})},i[Ec]=function(o,s){Qf(i[Vs],Ec,s,function(l){l[Ec](o,s)})},i[wa]=function(o){o&&(t||!o[_d]())&&Qf(i[Vs],wa,!1,function(s){o[Ur]?setTimeout(function(){return s[wa](o)},0):s[wa](o)})}})}return e.__ieDyn=1,e}();var qg=function(e){qi(n,e);function n(){var t=e.call(this)||this;return Be(n,t,function(i,o){i[Fr]=function(u,d,f,p){o[Fr](u,d,f||new Xs(u),p||new BE(u))},i.track=function(u){Pa(i[Ws](),function(){return"AppInsightsCore:track"},function(){u===null&&(l(u),ri("Invalid telemetry item")),s(u),o.track(u)},function(){return{item:u}},!u.sync)};function s(u){ee(u[hn])&&(l(u),ri("telemetry name required"))}function l(u){var d=i[hd]();d&&d[Na]([u],2)}}),t}return n.__ieDyn=1,n}(YE);var UE="_aiHooks",zE=["req","rsp","hkErr","fnErr"];function Jg(e,n){if(e)for(var t=0;t<e[Me]&&!n(e[t],t);t++);}function Xg(e,n,t,i,o){o>=0&&o<=2&&Jg(e,function(s,l){var u=s.cbks,d=u[zE[o]];if(d){n.ctx=function(){var m=i[l]=i[l]||{};return m};try{d[yo](n.inst,t)}catch(m){var f=n.err;try{var p=u[zE[2]];p&&(n.err=m,p[yo](n.inst,t))}catch{}finally{n.err=f}}}})}function eP(e){return function(){var n,t=this,i=arguments,o=e.h,s=(n={},n[hn]=e.n,n.inst=t,n.ctx=null,n.set=f,n),l=[],u=d([s],i);s.evt=oi("event");function d(m,g){return Jg(g,function(v){m[nt](v)}),m}function f(m,g){i=d([],i),i[m]=g,u=d([s],i)}Xg(o,s,u,l,0);var p=e.f;if(p)try{s.rslt=p[yo](t,i)}catch(m){throw s.err=m,Xg(o,s,u,l,3),m}return Xg(o,s,u,l,1),s.rslt}}function Kg(e,n,t,i){var o=null;return e&&(Of(e,n)?o=e:t&&(o=Kg(cg(e),n,i,!1))),o}function Qg(e,n,t){return e?Md(e[ii],n,t,!1):null}function HE(e,n,t,i){var o=t&&t[UE];if(!o){o={i:0,n,f:t,h:[]};var s=eP(o);s[UE]=o,e[n]=s}var l={id:o.i,cbks:i,rm:function(){var u=this.id;Jg(o.h,function(d,f){if(d.id===u)return o.h[Br](f,1),1})}};return o.i++,o.h[nt](l),l}function Md(e,n,t,i,o){if(i===void 0&&(i=!0),e&&n&&t){var s=Kg(e,n,i,o);if(s){var l=s[n];if(typeof l===pr)return HE(s,n,l,t)}}return null}function Oc(e,n,t,i,o){if(e&&n&&t){var s=Kg(e,n,i,o)||e;if(s)return HE(s,n,s[n],t)}return null}var Zr="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Mc="sampleRate",kc="ProcessLegacy",kd="http.method",Ma="https://dc.services.visualstudio.com",$o="/v2/track",Si="not_specified",em="iKey";function nl(e){var n=null;if(Le(Event))n=new Event(e);else{var t=yi();t&&t.createEvent&&(n=t.createEvent("Event"),n.initEvent(e,!0,!0))}return n}var qo="split",Ue="length",Eo="toLowerCase",ka="ingestionendpoint",jr="toString",tm="removeItem",wi="name",Xo="message",VE="count";var Rd="stringify",Fd="pathname",e0="correlationHeaderExcludePatterns",Rc="indexOf";var rl="exceptions",Cr="parsedStack",fn="properties",mn="measurements",ol="sizeInBytes",bo="typeName",al="severityLevel",im="problemGroup",nm="isManual",t0="CreateFromInterface",sl="assembly",Ra="fileName",Yd="hasFullStack",Bd="level",ll="method",Fc="line",cl="duration",i0="receivedResponse",ul="substring",GE="sanitizeKeyAndAddUniqueness",WE="sanitizeException",ZE="sanitizeProperties",jE="sanitizeMeasurements";var Ud="";function Tr(e,n){return n===void 0&&(n=!1),e==null?n:e.toString()[Eo]()==="true"}function Qn(e){(isNaN(e)||e<0)&&(e=0),e=Math.round(e);var n=Ud+e%1e3,t=Ud+Math.floor(e/1e3)%60,i=Ud+Math.floor(e/(1e3*60))%60,o=Ud+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));return n=n[Ue]===1?"00"+n:n[Ue]===2?"0"+n:n,t=t[Ue]<2?"0"+t:t,i=i[Ue]<2?"0"+i:i,o=o[Ue]<2?"0"+o:o,(s>0?s+".":Ud)+o+":"+i+":"+t+"."+n}function n0(e,n,t,i,o){return!o&&xe(e)&&(e==="Script error."||e==="Script error")}var vt=fg({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]});var Yc=kf({LocalStorage:0,SessionStorage:1}),hP=kf({AI:0,AI_AND_W3C:1,W3C:2});var Fa=void 0,Ya=void 0,$E="";function r0(){return zd()?rm(Yc.LocalStorage):null}function rm(e){try{if(ee(fr()))return null;var n=new Date()[jr](),t=oi(e===Yc.LocalStorage?"localStorage":"sessionStorage"),i=$E+n;t.setItem(i,n);var o=t.getItem(i)!==n;if(t[tm](i),!o)return t}catch{}return null}function o0(){return Ba()?rm(Yc.SessionStorage):null}function a0(){Fa=!1,Ya=!1}function dl(e){$E=e||""}function s0(){Fa=zd(!0),Ya=Ba(!0)}function zd(e){return(e||Fa===void 0)&&(Fa=!!rm(Yc.LocalStorage)),Fa}function l0(e,n){var t=r0();if(t!==null)try{return t.getItem(n)}catch(i){Fa=!1,ae(e,2,1,"Browser failed read of local storage. "+Qe(i),{exception:Ce(i)})}return null}function c0(e,n,t){var i=r0();if(i!==null)try{return i.setItem(n,t),!0}catch(o){Fa=!1,ae(e,2,3,"Browser failed write to local storage. "+Qe(o),{exception:Ce(o)})}return!1}function u0(e,n){var t=r0();if(t!==null)try{return t[tm](n),!0}catch(i){Fa=!1,ae(e,2,5,"Browser failed removal of local storage item. "+Qe(i),{exception:Ce(i)})}return!1}function Ba(e){return(e||Ya===void 0)&&(Ya=!!rm(Yc.SessionStorage)),Ya}function Bc(e,n){var t=o0();if(t!==null)try{return t.getItem(n)}catch(i){Ya=!1,ae(e,2,2,"Browser failed read of session storage. "+Qe(i),{exception:Ce(i)})}return null}function Hd(e,n,t){var i=o0();if(i!==null)try{return i.setItem(n,t),!0}catch(o){Ya=!1,ae(e,2,4,"Browser failed write to session storage. "+Qe(o),{exception:Ce(o)})}return!1}function d0(e,n){var t=o0();if(t!==null)try{return t[tm](n),!0}catch(i){Ya=!1,ae(e,2,6,"Browser failed removal of session storage item. "+Qe(i),{exception:Ce(i)})}return!1}var Fn;function om(e,n,t){var i=n[Ue],o=h0(e,n);if(o[Ue]!==i){for(var s=0,l=o;t[l]!==void 0;)s++,l=o[ul](0,147)+p0(s);o=l}return o}function h0(e,n){var t;return n&&(n=gi(n[jr]()),n[Ue]>150&&(t=n[ul](0,150),ae(e,2,57,"name is too long.  It has been truncated to 150 characters.",{name:n},!0))),t||n}function gt(e,n,t){t===void 0&&(t=1024);var i;return n&&(t=t||1024,n=gi(n),n.toString()[Ue]>t&&(i=n[jr]()[ul](0,t),ae(e,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:n},!0))),i||n}function xo(e,n){return lm(e,n,2048,66)}function Uc(e,n){var t;return n&&n[Ue]>32768&&(t=n[ul](0,32768),ae(e,2,56,"message is too long, it has been truncated to 32768 characters.",{message:n},!0)),t||n}function am(e,n){var t;if(n){var i=""+n;i[Ue]>32768&&(t=i[ul](0,32768),ae(e,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:n},!0))}return t||n}function _n(e,n){if(n){var t={};lt(n,function(i,o){if(pn(o)&&Vr())try{o=Ri()[Rd](o)}catch(s){ae(e,2,49,"custom property is not valid",{exception:s},!0)}o=gt(e,o,8192),i=om(e,i,t),t[i]=o}),n=t}return n}function vn(e,n){if(n){var t={};lt(n,function(i,o){i=om(e,i,t),t[i]=o}),n=t}return n}function sm(e,n){return n&&lm(e,n,128,69)[jr]()}function lm(e,n,t,i){var o;return n&&(n=gi(n),n[Ue]>t&&(o=n[ul](0,t),ae(e,2,i,"input is too long, it has been truncated to "+t+" characters.",{data:n},!0))),o||n}function p0(e){var n="00"+e;return n.substr(n[Ue]-3)}var qE=(Fn={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},Fn[GE]=om,Fn.sanitizeKey=h0,Fn.sanitizeString=gt,Fn.sanitizeUrl=xo,Fn.sanitizeMessage=Uc,Fn[WE]=am,Fn[ZE]=_n,Fn[jE]=vn,Fn.sanitizeId=sm,Fn.sanitizeInput=lm,Fn.padNumber=p0,Fn.trim=gi,Fn);var XE=yi()||{},JE=0,pP=[null,null,null,null,null];function Vd(e){var n=JE,t=pP,i=t[n];return XE.createElement?t[n]||(i=t[n]=XE.createElement("a")):i={host:f0(e,!0)},i.href=e,n++,n>=t[Ue]&&(n=0),JE=n,i}function cm(e){var n,t=Vd(e);return t&&(n=t.href),n}function um(e,n){return e?e.toUpperCase()+" "+n:n}function f0(e,n){var t=dm(e,n)||"";if(t){var i=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(i!=null&&i[Ue]>3&&xe(i[2])&&i[2][Ue]>0)return i[2]+(i[3]||"")}return t}function dm(e,n){var t=null;if(e){var i=e.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(i!=null&&i[Ue]>2&&xe(i[2])&&i[2][Ue]>0&&(t=i[2]||"",n&&i[Ue]>2)){var o=(i[1]||"")[Eo](),s=i[3]||"";(o==="http"&&s===":80"||o==="https"&&s===":443")&&(s=""),t+=s}}return t}var mP=[Ma+$o,"https://breeze.aimon.applicationinsights.io"+$o,"https://dc-int.services.visualstudio.com"+$o];function hl(e){return Ni(mP,e[Eo]())!==-1}var Jo={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(e,n,t){if(!n||e&&e.disableCorrelationHeaders)return!1;if(e&&e[e0]){for(var i=0;i<e.correlationHeaderExcludePatterns[Ue];i++)if(e[e0][i].test(n))return!1}var o=Vd(n).host[Eo]();if(o&&(o[Rc](":443")!==-1||o[Rc](":80")!==-1)&&(o=(dm(n,!0)||"")[Eo]()),(!e||!e.enableCorsCorrelation)&&o&&o!==t)return!1;var s=e&&e.correlationHeaderDomains;if(s){var l;if(_e(s,function(f){var p=new RegExp(f.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));l=l||p.test(o)}),!l)return!1}var u=e&&e.correlationHeaderExcludedDomains;if(!u||u[Ue]===0)return!0;for(var i=0;i<u[Ue];i++){var d=new RegExp(u[i].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(d.test(o))return!1}return o&&o[Ue]>0},getCorrelationContext:function(e){if(e){var n=Jo.getCorrelationContextValue(e,vt[1]);if(n&&n!==Jo.correlationIdPrefix)return n}},getCorrelationContextValue:function(e,n){if(e)for(var t=e[qo](","),i=0;i<t[Ue];++i){var o=t[i][qo]("=");if(o[Ue]===2&&o[0]===n)return o[1]}}};function KE(e,n,t,i){var o,s=i,l=i;if(n&&n[Ue]>0){var u=Vd(n);if(o=u.host,!s)if(u[Fd]!=null){var d=u.pathname[Ue]===0?"/":u[Fd];d.charAt(0)!=="/"&&(d="/"+d),l=u[Fd],s=gt(e,t?t+" "+d:d)}else s=gt(e,n)}else o=i,s=i;return{target:o,name:s,data:l}}function zc(){var e=gr();if(e&&e.now&&e.timing){var n=e.now()+e.timing.navigationStart;if(n>0)return n}return Ji()}function Fi(e,n){var t=null;return e!==0&&n!==0&&!ee(e)&&!ee(n)&&(t=n-e),t}function pl(e,n){var t=e||{};return{getName:function(){return t[wi]},setName:function(i){n&&n.setName(i),t[wi]=i},getTraceId:function(){return t.traceID},setTraceId:function(i){n&&n.setTraceId(i),tl(i)&&(t.traceID=i)},getSpanId:function(){return t.parentID},setSpanId:function(i){n&&n.setSpanId(i),il(i)&&(t.parentID=i)},getTraceFlags:function(){return t.traceFlags},setTraceFlags:function(i){n&&n.setTraceFlags(i),t.traceFlags=i}}}var _P=";",vP="=";function m0(e){if(!e)return{};var n=e[qo](_P),t=dg(n,function(o,s){var l=s[qo](vP);if(l[Ue]===2){var u=l[0][Eo](),d=l[1];o[u]=d}return o},{});if(Mn(t)[Ue]>0){if(t.endpointsuffix){var i=t.location?t.location+".":"";t[ka]=t[ka]||"https://"+i+"dc."+t.endpointsuffix,Cd(t[ka],"/")&&(t[ka]=t[ka].slice(0,-1))}t[ka]=t[ka]||Ma}return t}var hm=function(){function e(n,t,i){var o=this,s=this;s.ver=1,s.sampleRate=100,s.tags={},s[wi]=gt(n,i)||Si,s.data=t,s.time=qn(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return e}();var er=function(){function e(n,t,i,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var s=this;s.ver=2,s[wi]=gt(n,t)||Si,s[fn]=_n(n,i),s[mn]=vn(n,o)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}();var gP="<no_method>",Hc="error",Yn="stack",v0="stackDetails",QE="errorSrc",g0="message",i1="description";function y0(e,n){var t=e;return t&&!xe(t)&&(JSON&&JSON[Rd]?(t=JSON[Rd](e),n&&(!t||t==="{}")&&(Le(e[jr])?t=e[jr]():t=""+e)):t=""+e+" - (Missing JSON.stringify)"),t||""}function n1(e,n){var t=e;return e&&(t&&!xe(t)&&(t=e[g0]||e[i1]||t),t&&!xe(t)&&(t=y0(t,!0)),e.filename&&(t=t+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),n&&n!=="String"&&n!=="Object"&&n!=="Error"&&(t||"")[Rc](n)===-1&&(t=n+": "+t),t||""}function yP(e){try{if(pn(e))return"hasFullStack"in e&&"typeName"in e}catch{}return!1}function SP(e){try{if(pn(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch{}return!1}function e1(e){return e&&e.src&&xe(e.src)&&e.obj&&st(e.obj)}function fl(e){var n=e||"";xe(n)||(xe(n[Yn])?n=n[Yn]:n=""+n);var t=n[qo](`
`);return{src:n,obj:t}}function CP(e){for(var n=[],t=e[qo](`
`),i=0;i<t[Ue];i++){var o=t[i];t[i+1]&&(o+="@"+t[i+1],i++),n.push(o)}return{src:e,obj:n}}function r1(e){var n=null;if(e)try{if(e[Yn])n=fl(e[Yn]);else if(e[Hc]&&e[Hc][Yn])n=fl(e[Hc][Yn]);else if(e.exception&&e.exception[Yn])n=fl(e.exception[Yn]);else if(e1(e))n=e;else if(e1(e[v0]))n=e[v0];else if(window&&window.opera&&e[g0])n=CP(e[Xo]);else if(e.reason&&e.reason[Yn])n=fl(e.reason[Yn]);else if(xe(e))n=fl(e);else{var t=e[g0]||e[i1]||"";xe(e[QE])&&(t&&(t+=`
`),t+=" from "+e[QE]),t&&(n=fl(t))}}catch(i){n=fl(i)}return n||{src:"",obj:null}}function TP(e){var n="";return e&&(e.obj?_e(e.obj,function(t){n+=t+`
`}):n=e.src||""),n}function EP(e){var n,t=e.obj;if(t&&t[Ue]>0){n=[];var i=0,o=0;_e(t,function(C){var E=C[jr]();if(S0.regex.test(E)){var b=new S0(E,i++);o+=b[ol],n.push(b)}});var s=32*1024;if(o>s)for(var l=0,u=n[Ue]-1,d=0,f=l,p=u;l<u;){var m=n[l][ol],g=n[u][ol];if(d+=m+g,d>s){var v=p-f+1;n.splice(f,v);break}f=l,p=u,l++,u--}}return n}function pm(e){var n="";if(e&&(n=e.typeName||e[wi]||"",!n))try{var t=/function (.{1,200})\(/,i=t.exec(e.constructor[jr]());n=i&&i[Ue]>1?i[1]:""}catch{}return n}function _0(e){if(e)try{if(!xe(e)){var n=pm(e),t=y0(e,!1);return(!t||t==="{}")&&(e[Hc]&&(e=e[Hc],n=pm(e)),t=y0(e,!0)),t[Rc](n)!==0&&n!=="String"?n+":"+t:t}}catch{}return""+(e||"")}var sn=function(){function e(n,t,i,o,s,l){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var u=this;u.ver=2,SP(t)?(u[rl]=t[rl]||[],u[fn]=t[fn],u[mn]=t[mn],t[al]&&(u[al]=t[al]),t.id&&(u.id=t.id),t[im]&&(u[im]=t[im]),ee(t[nm])||(u[nm]=t[nm])):(i||(i={}),u[rl]=[new t1(n,t,i)],u[fn]=_n(n,i),u[mn]=vn(n,o),s&&(u[al]=s),l&&(u.id=l))}return e.CreateAutoException=function(n,t,i,o,s,l,u,d){var f,p=pm(s||l||n);return f={},f[Xo]=n1(n,p),f.url=t,f.lineNumber=i,f.columnNumber=o,f.error=_0(s||l||n),f.evt=_0(l||n),f[bo]=p,f.stackDetails=r1(u||s||l),f.errorSrc=d,f},e.CreateFromInterface=function(n,t,i,o){var s=t[rl]&&$s(t[rl],function(u){return t1[t0](n,u)}),l=new e(n,vi(vi({},t),{exceptions:s}),i,o);return l},e.prototype.toInterface=function(){var n,t=this,i=t.exceptions,o=t.properties,s=t.measurements,l=t.severityLevel,u=t.problemGroup,d=t.id,f=t.isManual,p=i instanceof Array&&$s(i,function(m){return m.toInterface()})||void 0;return n={ver:"4.0"},n[rl]=p,n.severityLevel=l,n.properties=o,n.measurements=s,n.problemGroup=u,n.id=d,n.isManual=f,n},e.CreateSimpleException=function(n,t,i,o,s,l){var u;return{exceptions:[(u={},u[Yd]=!0,u.message=n,u.stack=s,u.typeName=t,u)]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=_0,e}();var t1=function(){function e(n,t,i){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(yP(t))o[bo]=t[bo],o[Xo]=t[Xo],o[Yn]=t[Yn],o[Cr]=t[Cr]||[],o[Yd]=t[Yd];else{var s=t,l=s&&s.evt;js(s)||(s=s[Hc]||l||s),o[bo]=gt(n,pm(s))||Si,o[Xo]=Uc(n,n1(t||s,o[bo]))||Si;var u=t[v0]||r1(t);o[Cr]=EP(u),st(o[Cr])&&$s(o[Cr],function(d){d[sl]=gt(n,d[sl]),d[Ra]=gt(n,d[Ra])}),o[Yn]=am(n,TP(u)),o.hasFullStack=st(o.parsedStack)&&o.parsedStack[Ue]>0,i&&(i[bo]=i[bo]||o[bo])}}return e.prototype.toInterface=function(){var n,t=this,i=t[Cr]instanceof Array&&$s(t[Cr],function(s){return s.toInterface()}),o=(n={id:t.id,outerId:t.outerId,typeName:t[bo],message:t[Xo],hasFullStack:t[Yd],stack:t[Yn]},n[Cr]=i||void 0,n);return o},e.CreateFromInterface=function(n,t){var i=t[Cr]instanceof Array&&$s(t[Cr],function(s){return S0[t0](s)})||t[Cr],o=new e(n,vi(vi({},t),{parsedStack:i}));return o},e}();var S0=function(){function e(n,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var i=this;if(i[ol]=0,typeof n=="string"){var o=n;i[Bd]=t,i[ll]=gP,i[sl]=gi(o),i[Ra]="",i[Fc]=0;var s=o.match(e.regex);s&&s[Ue]>=5&&(i[ll]=gi(s[2])||i[ll],i[Ra]=gi(s[4]),i[Fc]=parseInt(s[5])||0)}else i[Bd]=n[Bd],i[ll]=n[ll],i[sl]=n[sl],i[Ra]=n[Ra],i[Fc]=n[Fc],i[ol]=0;i.sizeInBytes+=i.method[Ue],i.sizeInBytes+=i.fileName[Ue],i.sizeInBytes+=i.assembly[Ue],i[ol]+=e.baseSize,i.sizeInBytes+=i.level.toString()[Ue],i.sizeInBytes+=i.line.toString()[Ue]}return e.CreateFromInterface=function(n){return new e(n,null)},e.prototype.toInterface=function(){var n=this;return{level:n[Bd],method:n[ll],assembly:n[sl],fileName:n[Ra],line:n[Fc]}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}();var o1=function(){function e(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return e}();var tr=function(){function e(n,t,i,o,s,l,u,d,f){this.aiDataContract={ver:1,metrics:1,properties:0};var p=this;p.ver=2;var m=new o1;m[VE]=o>0?o:void 0,m.max=isNaN(l)||l===null?void 0:l,m.min=isNaN(s)||s===null?void 0:s,m[wi]=gt(n,t)||Si,m.value=i,m.stdDev=isNaN(u)||u===null?void 0:u,p.metrics=[m],p[fn]=_n(n,d),p[mn]=vn(n,f)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}();var bn=function(){function e(n,t,i,o,s,l,u){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var d=this;d.ver=2,d.id=sm(n,u),d.url=xo(n,i),d[wi]=gt(n,t)||Si,isNaN(o)||(d[cl]=Qn(o)),d[fn]=_n(n,s),d[mn]=vn(n,l)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}();var ir=function(){function e(n,t,i,o,s,l,u,d,f,p,m,g){f===void 0&&(f="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var v=this;v.ver=2,v.id=t,v[cl]=Qn(s),v.success=l,v.resultCode=u+"",v.type=gt(n,f);var C=KE(n,i,d,o);v.data=xo(n,o)||C.data,v.target=gt(n,C.target),p&&(v.target="".concat(v.target," | ").concat(p)),v[wi]=gt(n,C[wi]),v[fn]=_n(n,m),v[mn]=vn(n,g)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}();var $r=function(){function e(n,t,i,o,s){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var l=this;l.ver=2,t=t||Si,l[Xo]=Uc(n,t),l[fn]=_n(n,o),l[mn]=vn(n,s),i&&(l[al]=i)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}();var qr=function(){function e(n,t,i,o,s,l,u){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var d=this;d.ver=2,d.url=xo(n,i),d[wi]=gt(n,t)||Si,d[fn]=_n(n,s),d[mn]=vn(n,l),u&&(d.domProcessing=u.domProcessing,d[cl]=u[cl],d.networkConnect=u.networkConnect,d.perfTotal=u.perfTotal,d[i0]=u[i0],d.sentRequest=u.sentRequest)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}();var Do=function(){function e(n,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=n,this.baseData=t}return e}();function za(e){var n="ai."+e+".";return function(t){return n+t}}var Gd=za("application"),Yi=za("device"),fm=za("location"),Vc=za("operation"),C0=za("session"),Ua=za("user"),ml=za("cloud"),Wd=za("internal"),Gc=function(e){qi(n,e);function n(){return e.call(this)||this}return n}(pg({applicationVersion:Gd("ver"),applicationBuild:Gd("build"),applicationTypeId:Gd("typeId"),applicationId:Gd("applicationId"),applicationLayer:Gd("layer"),deviceId:Yi("id"),deviceIp:Yi("ip"),deviceLanguage:Yi("language"),deviceLocale:Yi("locale"),deviceModel:Yi("model"),deviceFriendlyName:Yi("friendlyName"),deviceNetwork:Yi("network"),deviceNetworkName:Yi("networkName"),deviceOEMName:Yi("oemName"),deviceOS:Yi("os"),deviceOSVersion:Yi("osVersion"),deviceRoleInstance:Yi("roleInstance"),deviceRoleName:Yi("roleName"),deviceScreenResolution:Yi("screenResolution"),deviceType:Yi("type"),deviceMachineName:Yi("machineName"),deviceVMName:Yi("vmName"),deviceBrowser:Yi("browser"),deviceBrowserVersion:Yi("browserVersion"),locationIp:fm("ip"),locationCountry:fm("country"),locationProvince:fm("province"),locationCity:fm("city"),operationId:Vc("id"),operationName:Vc("name"),operationParentId:Vc("parentId"),operationRootId:Vc("rootId"),operationSyntheticSource:Vc("syntheticSource"),operationCorrelationVector:Vc("correlationVector"),sessionId:C0("id"),sessionIsFirst:C0("isFirst"),sessionIsNew:C0("isNew"),userAccountAcquisitionDate:Ua("accountAcquisitionDate"),userAccountId:Ua("accountId"),userAgent:Ua("userAgent"),userId:Ua("id"),userStoreRegion:Ua("storeRegion"),userAuthUserId:Ua("authUserId"),userAnonymousUserAcquisitionDate:Ua("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Ua("authUserAcquisitionDate"),cloudName:ml("name"),cloudRole:ml("role"),cloudRoleVer:ml("roleVer"),cloudRoleInstance:ml("roleInstance"),cloudEnvironment:ml("environment"),cloudLocation:ml("location"),cloudDeploymentUnit:ml("deploymentUnit"),internalNodeName:Wd("nodeName"),internalSdkVersion:Wd("sdkVersion"),internalAgentVersion:Wd("agentVersion"),internalSnippet:Wd("snippet"),internalSdkSrc:Wd("sdkSrc")}));function Er(e,n,t,i,o,s){var l;t=gt(i,t)||Si,(ee(e)||ee(n)||ee(t))&&ri("Input doesn't contain all required fields");var u="";e[em]&&(u=e[em],delete e[em]);var d=(l={},l[wi]=t,l.time=qn(new Date),l.iKey=u,l.ext=s||{},l.tags=[],l.data={},l.baseType=n,l.baseData=e,l);return ee(o)||lt(o,function(f,p){d.data[f]=p}),d}var a1=function(){function e(){}return e.create=Er,e}();var ln={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},Mt=new Gc;var Ha="AppInsightsPropertiesPlugin",Zd="AppInsightsChannelPlugin",T0="ApplicationInsightsAnalytics";var jd="toString",mm="disableExceptionTracking",$d="autoTrackPageVisitTime",_m="overridePageViewDuration",vm="enableUnhandledPromiseRejectionTracking",qd="samplingPercentage",Xd="isStorageUseDisabled",Jd="isBrowserLinkTrackingEnabled",gm="enableAutoRouteTracking",ym="namePrefix",Sm="disableFlushOnBeforeUnload";var Qi="core",Ko="dataType",Va="envelopeType",Bn="diagLog",Ga="track",Wc="trackPageView",Kd="trackPreviousPageVisit",Qo="sendPageViewInternal",Qd="sendPageViewPerformanceInternal",Zc="populatePageViewPerformanceEvent",Wa="href",E0="sendExceptionInternal",Cm="exception",jc="error",Tm="_onerror",Em="errorSrc",bm="lineNumber",xm="columnNumber",b0="message",Dm="CreateAutoException",eh="addTelemetryInitializer",No="duration",Za="length",Nm="isPerformanceTimingSupported",wm="getPerformanceTiming",$c="navigationStart",th="shouldCollectDuration",Im="isPerformanceTimingDataReady",s1="getEntriesByType",qc="responseStart",l1="requestStart",ih="loadEventEnd",Pm="responseEnd",nh="connectEnd",x0="pageVisitStartTime";var Lm=null;function wP(){if(Lm==null)try{Lm=!!(self&&self instanceof WorkerGlobalScope)}catch{Lm=!1}return Lm}var c1=function(){function e(n,t,i,o){Be(e,this,function(s){var l=null,u=[],d=!1,f;i&&(f=i.logger);function p(v){i&&i.flush(v)}function m(){l||(l=setTimeout(function(){l=null;var v=u.slice(0),C=!1;u=[],_e(v,function(E){E()?C=!0:u.push(E)}),u[Za]>0&&m(),C&&p(!0)},100))}function g(v){u.push(v),m()}s[Wc]=function(v,C){var E=v.name;if(ee(E)||typeof E!="string"){var b=yi();E=v.name=b&&b.title||""}var S=v.uri;if(ee(S)||typeof S!="string"){var I=kn();S=v.uri=I&&I[Wa]||""}if(!o[Nm]()){n[Qo](v,C),p(!0),wP()||ae(f,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var z=!1,j,k=o[wm]()[$c];k>0&&(j=Fi(k,+new Date),o[th](j)||(j=void 0));var De;!ee(C)&&!ee(C[No])&&(De=C[No]),(t||!isNaN(De))&&(isNaN(De)&&(C||(C={}),C[No]=j),n[Qo](v,C),p(!0),z=!0);var $=6e4;C||(C={}),g(function(){var yt=!1;try{if(o[Im]()){yt=!0;var He={name:E,uri:S};o[Zc](He),!He.isValid&&!z?(C[No]=j,n[Qo](v,C)):(z||(C[No]=He.durationMs,n[Qo](v,C)),d||(n[Qd](He,C),d=!0))}else k>0&&Fi(k,+new Date)>$&&(yt=!0,z||(C[No]=$,n[Qo](v,C)))}catch(ct){ae(f,1,38,"trackPageView failed on page load calculation: "+Qe(ct),{exception:Ce(ct)})}return yt})},s.teardown=function(v,C){if(l){clearTimeout(l),l=null;var E=u.slice(0),b=!1;u=[],_e(E,function(S){S()&&(b=!0)})}}})}return e.__ieDyn=1,e}();var IP=36e5,u1=["googlebot","adsbot-google","apis-google","mediapartners-google"];function h1(){var e=gr();return e&&!!e.timing}function PP(){var e=gr();return e&&e.getEntriesByType&&e.getEntriesByType("navigation")[Za]>0}function LP(){var e=gr(),n=e?e.timing:0;return n&&n.domainLookupStart>0&&n[$c]>0&&n[qc]>0&&n[l1]>0&&n[ih]>0&&n[Pm]>0&&n[nh]>0&&n.domLoading>0}function d1(){return h1()?gr().timing:null}function AP(){return PP()?gr()[s1]("navigation")[0]:null}function OP(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=En()||{},i=t.userAgent,o=!1;if(i)for(var s=0;s<u1[Za];s++)o=o||i.toLowerCase().indexOf(u1[s])!==-1;if(o)return!1;for(var s=0;s<e[Za];s++)if(e[s]<0||e[s]>=IP)return!1;return!0}var p1=function(){function e(n){var t=Gr(n);Be(e,this,function(i){i[Zc]=function(o){o.isValid=!1;var s=AP(),l=d1(),u=0,d=0,f=0,p=0,m=0;(s||l)&&(s?(u=s[No],d=s.startTime===0?s[nh]:Fi(s.startTime,s[nh]),f=Fi(s.requestStart,s[qc]),p=Fi(s[qc],s[Pm]),m=Fi(s.responseEnd,s[ih])):(u=Fi(l[$c],l[ih]),d=Fi(l[$c],l[nh]),f=Fi(l.requestStart,l[qc]),p=Fi(l[qc],l[Pm]),m=Fi(l.responseEnd,l[ih])),u===0?ae(t,2,10,"error calculating page view performance.",{total:u,network:d,request:f,response:p,dom:m}):i[th](u,d,f,p,m)?u<Math.floor(d)+Math.floor(f)+Math.floor(p)+Math.floor(m)?ae(t,2,8,"client performance math error.",{total:u,network:d,request:f,response:p,dom:m}):(o.durationMs=u,o.perfTotal=o[No]=Qn(u),o.networkConnect=Qn(d),o.sentRequest=Qn(f),o.receivedResponse=Qn(p),o.domProcessing=Qn(m),o.isValid=!0):ae(t,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:u,network:d,request:f,response:p,dom:m}))},i[wm]=d1,i[Nm]=h1,i[Im]=LP,i[th]=OP})}return e.__ieDyn=1,e}();var f1=function(){function e(n,t){var i="prevPageVisitData";Be(e,this,function(o){o[Kd]=function(d,f){try{var p=s(d,f);p&&t(p.pageName,p.pageUrl,p.pageVisitTime)}catch(m){yr(n,"Auto track page visit time failed, metric will not be collected: "+Ce(m))}};function s(d,f){var p=null;try{p=u(),l(d,f)}catch(m){yr(n,"Call to restart failed: "+Ce(m)),p=null}return p}function l(d,f){try{if(Ba()){Bc(n,i)!=null&&ri("Cannot call startPageVisit consecutively without first calling stopPageVisit");var p=new MP(d,f),m=Ri().stringify(p);Hd(n,i,m)}}catch(g){yr(n,"Call to start failed: "+Ce(g))}}function u(){var d=null;try{if(Ba()){var f=Ji(),p=Bc(n,i);p&&Vr()&&(d=Ri().parse(p),d.pageVisitTime=f-d[x0],d0(n,i))}}catch(m){yr(n,"Stop page visit timer failed: "+Ce(m)),d=null}return d}vr(o,"_logger",function(){return n}),vr(o,"pageVisitTimeTrackingHandler",function(){return t})})}return e.__ieDyn=1,e}();var MP=function(){function e(n,t){this[x0]=Ji(),this.pageName=n,this.pageUrl=t}return e}();var D0=function(){function e(n,t){var i=this,o={};i.start=function(s){typeof o[s]<"u"&&ae(n,2,62,"start was called more than once for this event without calling stop.",{name:s,key:s},!0),o[s]=+new Date},i.stop=function(s,l,u,d){var f=o[s];if(isNaN(f))ae(n,2,63,"stop was called without a corresponding start.",{name:s,key:s},!0);else{var p=+new Date,m=Fi(f,p);i.action(s,l,m,u,d)}delete o[s],o[s]=void 0}}return e}();var kP="event";function rh(e,n){e&&e.dispatchEvent&&n&&e.dispatchEvent(n)}function RP(e){if(e&&e.reason){var n=e.reason;return!xe(n)&&Le(n[jd])?n[jd]():Ce(n)}return e||""}var m1=6e4;function _1(e,n){return e=e||n,e<m1&&(e=m1),e}function v1(e){return e||(e={}),e.sessionRenewalMs=_1(e.sessionRenewalMs,30*60*1e3),e.sessionExpirationMs=_1(e.sessionExpirationMs,24*60*60*1e3),e[mm]=Tr(e[mm]),e[$d]=Tr(e[$d]),e[_m]=Tr(e[_m]),e[vm]=Tr(e[vm]),(isNaN(e[qd])||e[qd]<=0||e[qd]>=100)&&(e[qd]=100),e[Xd]=Tr(e[Xd]),e[Jd]=Tr(e[Jd]),e[gm]=Tr(e[gm]),e[ym]=e[ym]||"",e.enableDebug=Tr(e.enableDebug),e[Sm]=Tr(e[Sm]),e.disableFlushOnUnload=Tr(e.disableFlushOnUnload,e[Sm]),e}function FP(e){Kt(e[Xd])||(e[Xd]?a0():s0())}var Am=function(e){qi(n,e);function n(){var t=e.call(this)||this;t.identifier=T0,t.priority=180,t.autoRoutePVDelay=500;var i,o,s,l,u,d,f,p,m,g,v,C,E,b,S=0,I,z,j;return Be(n,t,function(k,De){var $=De._addHook;qe(),k.getCookieMgr=function(){return el(k[Qi])},k.processTelemetry=function(F,Q){k.processNext(F,Q)},k.trackEvent=function(F,Q){try{var A=Er(F,er[Ko],er[Va],k[Bn](),Q);k[Qi][Ga](A)}catch(H){Se(2,39,"trackTrace failed, trace will not be collected: "+Qe(H),{exception:Ce(H)})}},k.startTrackEvent=function(F){try{i.start(F)}catch(Q){Se(1,29,"startTrackEvent failed, event will not be collected: "+Qe(Q),{exception:Ce(Q)})}},k.stopTrackEvent=function(F,Q,A){try{i.stop(F,void 0,Q,A)}catch(H){Se(1,30,"stopTrackEvent failed, event will not be collected: "+Qe(H),{exception:Ce(H)})}},k.trackTrace=function(F,Q){try{var A=Er(F,$r[Ko],$r[Va],k[Bn](),Q);k[Qi][Ga](A)}catch(H){Se(2,39,"trackTrace failed, trace will not be collected: "+Qe(H),{exception:Ce(H)})}},k.trackMetric=function(F,Q){try{var A=Er(F,tr[Ko],tr[Va],k[Bn](),Q);k[Qi][Ga](A)}catch(H){Se(1,36,"trackMetric failed, metric will not be collected: "+Qe(H),{exception:Ce(H)})}},k[Wc]=function(F,Q){try{var A=F||{};s[Wc](A,vi(vi(vi({},A.properties),A.measurements),Q)),k.config[$d]&&u[Kd](A.name,A.uri)}catch(H){Se(1,37,"trackPageView failed, page view will not be collected: "+Qe(H),{exception:Ce(H)})}},k[Qo]=function(F,Q,A){var H=yi();H&&(F.refUri=F.refUri===void 0?H.referrer:F.refUri);var G=Er(F,bn[Ko],bn[Va],k[Bn](),Q,A);k[Qi][Ga](G),S=0},k[Qd]=function(F,Q,A){var H=Er(F,qr[Ko],qr[Va],k[Bn](),Q,A);k[Qi][Ga](H)},k.trackPageViewPerformance=function(F,Q){var A=F||{};try{l[Zc](A),k[Qd](A,Q)}catch(H){Se(1,37,"trackPageViewPerformance failed, page view will not be collected: "+Qe(H),{exception:Ce(H)})}},k.startTrackPage=function(F){try{if(typeof F!="string"){var Q=yi();F=Q&&Q.title||""}o.start(F)}catch(A){Se(1,31,"startTrackPage failed, page view may not be collected: "+Qe(A),{exception:Ce(A)})}},k.stopTrackPage=function(F,Q,A,H){try{if(typeof F!="string"){var G=yi();F=G&&G.title||""}if(typeof Q!="string"){var de=kn();Q=de&&de[Wa]||""}o.stop(F,Q,A,H),k.config[$d]&&u[Kd](F,Q)}catch(w){Se(1,32,"stopTrackPage failed, page view will not be collected: "+Qe(w),{exception:Ce(w)})}},k[E0]=function(F,Q,A){var H=F&&(F[Cm]||F[jc])||js(F)&&F||{name:F&&typeof F,message:F||Si};F=F||{};var G=new sn(k[Bn](),H,F.properties||Q,F.measurements,F.severityLevel,F.id).toInterface(),de=Er(G,sn[Ko],sn[Va],k[Bn](),Q,A);k[Qi][Ga](de)},k.trackException=function(F,Q){F&&!F[Cm]&&F[jc]&&(F[Cm]=F[jc]);try{k[E0](F,Q)}catch(A){Se(1,35,"trackException failed, exception will not be collected: "+Qe(A),{exception:Ce(A)})}},k[Tm]=function(F){var Q=F&&F[jc],A=F&&F.evt;try{if(!A){var H=Jn();H&&(A=H[kP])}var G=F&&F.url||(yi()||{}).URL,de=F[Em]||"window.onerror@"+G+":"+(F[bm]||0)+":"+(F[xm]||0),w={errorSrc:de,url:G,lineNumber:F[bm]||0,columnNumber:F[xm]||0,message:F[b0]};n0(F.message,F.url,F.lineNumber,F.columnNumber,F[jc])?$t(sn[Dm]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",G,F[bm]||0,F[xm]||0,Q,A,null,de),w):(F[Em]||(F[Em]=de),k.trackException({exception:F,severityLevel:3},w))}catch(q){var V=Q?Q.name+", "+Q[b0]:"null";Se(1,11,"_onError threw exception while logging error, error will not be collected: "+Qe(q),{exception:Ce(q),errorString:V})}},k[eh]=function(F){if(k[Qi])return k[Qi][eh](F);d||(d=[]),d.push(F)},k.initialize=function(F,Q,A,H){if(!k.isInitialized()){ee(Q)&&ri("Error initializing"),De.initialize(F,Q,A,H),F.storagePrefix&&dl(F.storagePrefix);try{j=Kn(Ki(k.identifier),Q.evtNamespace&&Q.evtNamespace()),d&&(_e(d,function(de){Q[eh](de)}),d=null);var G=yt(F);FP(G),l=new p1(k[Qi]),s=new c1(k,G[_m],k[Qi],l),u=new f1(k[Bn](),function(de,w,V){return ct(de,w,V)}),He(G,F),i=new D0(k[Bn](),"trackEvent"),i.action=function(de,w,V,q,ue){q||(q={}),ue||(ue={}),q.duration=V[jd](),k.trackEvent({name:de,properties:q,measurements:ue})},o=new D0(k[Bn](),"trackPageView"),o.action=function(de,w,V,q,ue){ee(q)&&(q={}),q.duration=V[jd]();var Ne={name:de,uri:w,properties:q,measurements:ue};k[Qo](Ne,q)},Go()&&(Hi(G),At(G))}catch(de){throw k.setInitialized(!1),de}}},k._doTeardown=function(F,Q){s&&s.teardown(F,Q),Aa(window,null,null,j),qe()};function yt(F){var Q=an(null,F,k[Qi]),A=k.identifier,H=v1(F),G=k.config=Q.getExtCfg(A);return H!==void 0&&lt(H,function(de,w){G[de]=Q.getConfig(A,de,w),G[de]===void 0&&(G=w)}),G}function He(F,Q){f=F[Jd]||Q[Jd],Ee()}function ct(F,Q,A){var H={PageName:F,PageUrl:Q};k.trackMetric({name:"PageVisitTime",average:A,max:A,min:A,sampleCount:1},H)}function Ee(){if(!p&&f){var F=["/browserLinkSignalR/","/__browserLink/"],Q=function(A){if(f&&A.baseType===ir[Ko]){var H=A.baseData;if(H){for(var G=0;G<F[Za];G++)if(H.target&&H.target.indexOf(F[G])>=0)return!1}}return!0};k[eh](Q),p=!0}}function $t(F,Q){var A=Er(F,sn[Ko],sn[Va],k[Bn](),Q);k[Qi][Ga](A)}function Hi(F){var Q=Jn(),A=kn(!0);v=F[mm],!v&&!C&&!F.autoExceptionInstrumented&&($(Oc(Q,"onerror",{ns:j,rsp:function(H,G,de,w,V,q){!v&&H.rslt!==!0&&k[Tm](sn[Dm](G,de,w,V,q,H.evt))}},!1)),C=!0),Gi(F,Q,A)}function At(F){var Q=Jn(),A=kn(!0);if(m=F[gm]===!0,Q&&m&&Ff()){var H=Cg();Le(H.pushState)&&Le(H.replaceState)&&typeof Event!==An&&Pe(F,Q,H,A)}}function Vi(){var F=null;if(k[Qi]&&k[Qi].getTraceCtx&&(F=k[Qi].getTraceCtx(!1)),!F){var Q=k[Qi].getPlugin(Ha);if(Q){var A=Q.plugin.context;A&&(F=pl(A.telemetryTrace))}}return F}function Pe(F,Q,A,H){var G=F[ym]||"";function de(){m&&rh(Q,nl(G+"locationchange"))}function w(){if(z?(I=z,z=H&&H[Wa]||""):z=H&&H[Wa]||"",m){var V=Vi();if(V){V.setTraceId(Rn());var q="_unknown_";H&&H.pathname&&(q=H.pathname+(H.hash||"")),V.setName(gt(k[Bn](),q))}setTimeout(function(ue){k[Wc]({refUri:ue,properties:{duration:0}})}.bind(k,I),k.autoRoutePVDelay)}}g||($(Oc(A,"pushState",{ns:j,rsp:function(){m&&(rh(Q,nl(G+"pushState")),rh(Q,nl(G+"locationchange")))}},!0)),$(Oc(A,"replaceState",{ns:j,rsp:function(){m&&(rh(Q,nl(G+"replaceState")),rh(Q,nl(G+"locationchange")))}},!0)),Sr(Q,G+"popstate",de,j),Sr(Q,G+"locationchange",w,j),g=!0)}function Gi(F,Q,A){E=F[vm]===!0,E&&!b&&($(Oc(Q,"onunhandledrejection",{ns:j,rsp:function(H,G){E&&H.rslt!==!0&&k[Tm](sn[Dm](RP(G),A?A[Wa]:"",0,0,G,H.evt))}},!1)),b=!0,F.autoUnhandledPromiseInstrumented=b)}function Se(F,Q,A,H,G){k[Bn]().throwInternal(F,Q,A,H,G)}function qe(){i=null,o=null,s=null,l=null,u=null,d=null,f=!1,p=!1,m=!1,g=!1,v=!1,C=!1,E=!1,b=!1,S=0;var F=kn(!0);I=F&&F[Wa]||"",z=null,j=null}vr(k,"_pageViewManager",function(){return s}),vr(k,"_pageViewPerformanceManager",function(){return l}),vr(k,"_pageVisitTimeManager",function(){return u}),vr(k,"_evtNamespace",function(){return"."+j})}),t}return n.Version="2.8.18",n.getDefaultConfig=v1,n}(Wr);var ja="duration";var Ii="tags",Om="deviceType",Un="data",wo="name",_l="traceID",et="length",$a="stringify",qa="measurements",br="dataType",Xa="envelopeType",ea="toString",oh="onLine",ah="isOnline",vl="enqueue",Ja="count",Mm="eventsLimitInMem",ta="push",sh="emitLineDelimitedJson",Ka="clear",gl="batchPayloads",Qa="markAsSent",yl="clearSent",lh="bufferOverride",Xc="BUFFER_KEY",es="SENT_BUFFER_KEY",Jc="MAX_BUFFER_SIZE",ia="namePrefix",km="maxBatchSizeInBytes",Sl="triggerSend",gn="diagLog",N0="onunloadDisableBeacon",Rm="isBeaconApiDisabled",Kc="_sender",Ut="_senderConfig",w0="enableSessionStorageBuffer",ts="_buffer",I0="samplingPercentage",ch="instrumentationKey",is="endpointUrl",P0="customHeaders",Qc="disableXhr",L0="onunloadDisableFetch",Fm="disableTelemetry",Ym="baseType",eu="sampleRate",A0="convertUndefined",g1="_xhrReadyStateChange",xr="_onError",Bm="_onPartialSuccess",uh="_onSuccess",dh="itemsAccepted",y1="itemsReceived",tu="isRetryDisabled",Um="setRequestHeader",O0="maxBatchInterval",M0="eventsSendRequest",k0="disableInstrumentationKeyValidation",zm="getSamplingScore",S1="getHashCodeScore";var R0="baseType",Qt="baseData",en="properties",C1="true";function Pi(e,n,t){return _t(e,n,t,xc)}function YP(e,n,t){var i=t[Ii]=t[Ii]||{},o=n.ext=n.ext||{},s=n[Ii]=n[Ii]||[],l=o.user;l&&(Pi(i,Mt.userAuthUserId,l.authId),Pi(i,Mt.userId,l.id||l.localId));var u=o.app;u&&Pi(i,Mt.sessionId,u.sesId);var d=o.device;d&&(Pi(i,Mt.deviceId,d.id||d.localId),Pi(i,Mt[Om],d.deviceClass),Pi(i,Mt.deviceIp,d.ip),Pi(i,Mt.deviceModel,d.model),Pi(i,Mt[Om],d[Om]));var f=n.ext.web;if(f){Pi(i,Mt.deviceLanguage,f.browserLang),Pi(i,Mt.deviceBrowserVersion,f.browserVer),Pi(i,Mt.deviceBrowser,f.browser);var p=t[Un]=t[Un]||{},m=p[Qt]=p[Qt]||{},g=m[en]=m[en]||{};Pi(g,"domain",f.domain),Pi(g,"isManual",f.isManual?C1:null),Pi(g,"screenRes",f.screenRes),Pi(g,"userConsent",f.userConsent?C1:null)}var v=o.os;v&&Pi(i,Mt.deviceOS,v[wo]);var C=o.trace;C&&(Pi(i,Mt.operationParentId,C.parentID),Pi(i,Mt.operationName,gt(e,C[wo])),Pi(i,Mt.operationId,C[_l]));for(var E={},b=s[et]-1;b>=0;b--){var S=s[b];lt(S,function(z,j){E[z]=j}),s.splice(b,1)}lt(s,function(z,j){E[z]=j});var I=vi(vi({},i),E);I[Mt.internalSdkVersion]||(I[Mt.internalSdkVersion]=gt(e,"javascript:".concat(BP.Version),64)),t[Ii]=Mf(I)}function ns(e,n,t){ee(e)||lt(e,function(i,o){Td(o)?t[i]=o:xe(o)?n[i]=o:Vr()&&(n[i]=Ri()[$a](o))})}function Cl(e,n){ee(e)||lt(e,function(t,i){e[t]=i||n})}function Tl(e,n,t,i){var o=new hm(e,i,n);Pi(o,"sampleRate",t[Mc]),(t[Qt]||{}).startTime&&(o.time=qn(t[Qt].startTime)),o.iKey=t.iKey;var s=t.iKey.replace(/-/g,"");return o[wo]=o[wo].replace("{0}",s),YP(e,t,o),t[Ii]=t[Ii]||[],Mf(o)}function El(e,n){ee(n[Qt])&&ae(e,1,46,"telemetryItem.baseData cannot be null.")}var BP={Version:"2.8.18"};function T1(e,n,t){El(e,n);var i=n[Qt][qa]||{},o=n[Qt][en]||{};ns(n[Un],o,i),ee(t)||Cl(o,t);var s=n[Qt];if(ee(s))return yr(e,"Invalid input for dependency data"),null;var l=s[en]&&s[en][kd]?s[en][kd]:"GET",u=new ir(e,s.id,s.target,s[wo],s[ja],s.success,s.responseCode,l,s.type,s.correlationContext,o,i),d=new Do(ir[br],u);return Tl(e,ir[Xa],n,d)}function F0(e,n,t){El(e,n);var i={},o={};n[R0]!==er[br]&&(i.baseTypeSource=n[R0]),n[R0]===er[br]?(i=n[Qt][en]||{},o=n[Qt][qa]||{}):n[Qt]&&ns(n[Qt],i,o),ns(n[Un],i,o),ee(t)||Cl(i,t);var s=n[Qt][wo],l=new er(e,s,i,o),u=new Do(er[br],l);return Tl(e,er[Xa],n,u)}function E1(e,n,t){El(e,n);var i=n[Qt][qa]||{},o=n[Qt][en]||{};ns(n[Un],o,i),ee(t)||Cl(o,t);var s=n[Qt],l=sn.CreateFromInterface(e,s,o,i),u=new Do(sn[br],l);return Tl(e,sn[Xa],n,u)}function b1(e,n,t){El(e,n);var i=n[Qt],o=i[en]||{},s=i[qa]||{};ns(n[Un],o,s),ee(t)||Cl(o,t);var l=new tr(e,i[wo],i.average,i.sampleCount,i.min,i.max,i.stdDev,o,s),u=new Do(tr[br],l);return Tl(e,tr[Xa],n,u)}function x1(e,n,t){El(e,n);var i,o=n[Qt];!ee(o)&&!ee(o[en])&&!ee(o[en][ja])?(i=o[en][ja],delete o[en][ja]):!ee(n[Un])&&!ee(n[Un][ja])&&(i=n[Un][ja],delete n[Un][ja]);var s=n[Qt],l;((n.ext||{}).trace||{})[_l]&&(l=n.ext.trace[_l]);var u=s.id||l,d=s[wo],f=s.uri,p=s[en]||{},m=s[qa]||{};if(ee(s.refUri)||(p.refUri=s.refUri),ee(s.pageType)||(p.pageType=s.pageType),ee(s.isLoggedIn)||(p.isLoggedIn=s.isLoggedIn[ea]()),!ee(s[en])){var g=s[en];lt(g,function(E,b){p[E]=b})}ns(n[Un],p,m),ee(t)||Cl(p,t);var v=new bn(e,d,f,i,p,m,u),C=new Do(bn[br],v);return Tl(e,bn[Xa],n,C)}function D1(e,n,t){El(e,n);var i=n[Qt],o=i[wo],s=i.uri||i.url,l=i[en]||{},u=i[qa]||{};ns(n[Un],l,u),ee(t)||Cl(l,t);var d=new qr(e,o,s,void 0,l,u,i),f=new Do(qr[br],d);return Tl(e,qr[Xa],n,f)}function N1(e,n,t){El(e,n);var i=n[Qt].message,o=n[Qt].severityLevel,s=n[Qt][en]||{},l=n[Qt][qa]||{};ns(n[Un],s,l),ee(t)||Cl(s,t);var u=new $r(e,i,o,s,l),d=new Do($r[br],u);return Tl(e,$r[Xa],n,d)}function w1(e,n){Aa(e,null,null,n)}function I1(e){var n,t=yi(),i=En(),o=!1,s=!0,l=Kn(Ki("OfflineListener"),e);try{if(d(Jn())&&(o=!0),t){var u=t.body||t;u.ononline&&d(u)&&(o=!0)}o&&i&&!ee(i[oh])&&(s=i[oh])}catch{o=!1}function d(v){var C=!1;return v&&(C=Sr(v,"online",f,l),C&&Sr(v,"offline",p,l)),C}function f(){s=!0}function p(){s=!1}function m(){var v=!0;return o?v=s:i&&!ee(i[oh])&&(v=i[oh]),v}function g(){var v=Jn();if(v&&o){if(w1(v,l),t){var C=t.body||t;Kt(C.ononline)||w1(C,l)}o=!1}}return n={},n[ah]=m,n.isListening=function(){return o},n.unload=g,n}var P1=function(){function e(n,t){var i=[],o=!1;this._get=function(){return i},this._set=function(s){return i=s,i},Be(e,this,function(s){s[vl]=function(l){if(s[Ja]()>=t[Mm]()){o||(ae(n,2,105,"Maximum in-memory buffer size reached: "+s[Ja](),!0),o=!0);return}i[ta](l)},s[Ja]=function(){return i[et]},s.size=function(){for(var l=i[et],u=0;u<i[et];u++)l+=i[u][et];return t[sh]()||(l+=2),l},s[Ka]=function(){i=[],o=!1},s.getItems=function(){return i.slice(0)},s[gl]=function(l){if(l&&l[et]>0){var u=t[sh]()?l.join(`
`):"["+l.join(",")+"]";return u}return null}})}return e.__ieDyn=1,e}(),L1=function(e){qi(n,e);function n(t,i){var o=e.call(this,t,i)||this;return Be(n,o,function(s,l){s[Qa]=function(u){l[Ka]()},s[yl]=function(u){}}),o}return n.__ieDyn=1,n}(P1);var A1=function(e){qi(n,e);function n(t,i){var o=e.call(this,t,i)||this,s=!1,l=i[lh]()||{getItem:Bc,setItem:Hd},u=l.getItem,d=l.setItem;return Be(n,o,function(f,p){var m=E(n[Xc]),g=E(n[es]),v=f._set(m.concat(g));v[et]>n[Jc]&&(v[et]=n[Jc]),b(n[es],[]),b(n[Xc],v),f[vl]=function(S){if(f[Ja]()>=n[Jc]){s||(ae(t,2,67,"Maximum buffer size reached: "+f[Ja](),!0),s=!0);return}p[vl](S),b(n[Xc],f._get())},f[Ka]=function(){p[Ka](),b(n[Xc],f._get()),b(n[es],[]),s=!1},f[Qa]=function(S){b(n[Xc],f._set(C(S,f._get())));var I=E(n[es]);I instanceof Array&&S instanceof Array&&(I=I.concat(S),I[et]>n[Jc]&&(ae(t,1,67,"Sent buffer reached its maximum size: "+I[et],!0),I[et]=n[Jc]),b(n[es],I))},f[yl]=function(S){var I=E(n[es]);I=C(S,I),b(n[es],I)};function C(S,I){var z=[];return _e(I,function(j){!Le(j)&&Ni(S,j)===-1&&z[ta](j)}),z}function E(S){var I=S;try{I=i[ia]&&i[ia]()?i[ia]()+"_"+I:I;var z=u(t,I);if(z){var j=Ri().parse(z);if(xe(j)&&(j=Ri().parse(j)),j&&st(j))return j}}catch(k){ae(t,1,42," storage key: "+I+", "+Qe(k),{exception:Ce(k)})}return[]}function b(S,I){var z=S;try{z=i[ia]&&i[ia]()?i[ia]()+"_"+z:z;var j=JSON[$a](I);d(t,z,j)}catch(k){d(t,z,JSON[$a]([])),ae(t,2,41," storage key: "+z+", "+Qe(k)+". Buffer cleared",{exception:Ce(k)})}}}),o}return n.BUFFER_KEY="AI_buffer",n.SENT_BUFFER_KEY="AI_sentBuffer",n.MAX_BUFFER_SIZE=2e3,n}(P1);var O1=function(){function e(n){Be(e,this,function(t){t.serialize=function(l){var u=i(l,"root");try{return Ri()[$a](u)}catch(d){ae(n,1,48,d&&Le(d[ea])?d[ea]():"Error serializing object",null,!0)}};function i(l,u){var d="__aiCircularRefCheck",f={};if(!l)return ae(n,1,48,"cannot serialize object because it is null or undefined",{name:u},!0),f;if(l[d])return ae(n,2,50,"Circular reference detected while serializing object",{name:u},!0),f;if(!l.aiDataContract){if(u==="measurements")f=s(l,"number",u);else if(u==="properties")f=s(l,"string",u);else if(u==="tags")f=s(l,"string",u);else if(st(l))f=o(l,u);else{ae(n,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:u},!0);try{Ri()[$a](l),f=l}catch(p){ae(n,1,48,p&&Le(p[ea])?p[ea]():"Error serializing object",null,!0)}}return f}return l[d]=!0,lt(l.aiDataContract,function(p,m){var g=Le(m)?m()&1:m&1,v=Le(m)?m()&4:m&4,C=m&2,E=l[p]!==void 0,b=pn(l[p])&&l[p]!==null;if(g&&!E&&!C)ae(n,1,24,"Missing required field specification. The field is required but not present on source",{field:p,name:u});else if(!v){var S=void 0;b?C?S=o(l[p],p):S=i(l[p],p):S=l[p],S!==void 0&&(f[p]=S)}}),delete l[d],f}function o(l,u){var d;if(l)if(!st(l))ae(n,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:u},!0);else{d=[];for(var f=0;f<l[et];f++){var p=l[f],m=i(p,u+"["+f+"]");d[ta](m)}}return d}function s(l,u,d){var f;return l&&(f={},lt(l,function(p,m){if(u==="string")m===void 0?f[p]="undefined":m===null?f[p]="null":m[ea]?f[p]=m[ea]():f[p]="invalid field: toString() is not defined.";else if(u==="number")if(m===void 0)f[p]="undefined";else if(m===null)f[p]="null";else{var g=parseFloat(m);isNaN(g)?f[p]="NaN":f[p]=g}else f[p]="invalid field: "+d+" is of unknown type.",ae(n,1,f[p],null,!0)})),f}})}return e.__ieDyn=1,e}();var UP=8,M1=function(){function e(){}return e.prototype.getHashCodeScore=function(n){var t=this.getHashCode(n)/e.INT_MAX_VALUE;return t*100},e.prototype.getHashCode=function(n){if(n==="")return 0;for(;n[et]<UP;)n=n.concat(n);for(var t=5381,i=0;i<n[et];++i)t=(t<<5)+t+n.charCodeAt(i),t=t&t;return Math.abs(t)},e.INT_MAX_VALUE=2147483647,e}();var k1=function(){function e(){var n=this,t=new M1,i=new Gc;n[zm]=function(o){var s=0;return o[Ii]&&o[Ii][i.userId]?s=t.getHashCodeScore(o[Ii][i.userId]):o.ext&&o.ext.user&&o.ext.user.id?s=t[S1](o.ext.user.id):o[Ii]&&o[Ii][i.operationId]?s=t.getHashCodeScore(o[Ii][i.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[_l]?s=t.getHashCodeScore(o.ext.telemetryTrace[_l]):s=Math.random()*100,s}}return e}();var R1=function(){function e(n,t){this.INT_MAX_VALUE=2147483647;var i=t||Gr(null);(n>100||n<0)&&(i.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:n},!0),n=100),this[eu]=n,this.samplingScoreGenerator=new k1}return e.prototype.isSampledIn=function(n){var t=this[eu],i=!1;return t==null||t>=100||n.baseType===tr[br]?!0:(i=this.samplingScoreGenerator[zm](n)<t,i)},e}();var na,zP=65e3;function Hm(e){try{return e.responseText}catch{}return null}function F1(){var e,n,t;return e={endpointUrl:function(){return Ma+$o}},e[sh]=function(){return!1},e[O0]=function(){return 15e3},e[km]=function(){return 102400},e[Fm]=function(){return!1},e[w0]=function(){return!0},e[lh]=function(){return!1},e[tu]=function(){return!1},e[Rm]=function(){return!0},e[Qc]=function(){return!1},e[L0]=function(){return!1},e[N0]=function(){return!1},e[ch]=function(){return n},e[ia]=function(){return n},e[I0]=function(){return 100},e[P0]=function(){return t},e[A0]=function(){return n},e[Mm]=function(){return 1e4},e.retryCodes=function(){return null},e}var HP=(na={},na[er.dataType]=F0,na[$r.dataType]=N1,na[bn.dataType]=x1,na[qr.dataType]=D1,na[sn.dataType]=E1,na[tr.dataType]=b1,na[ir.dataType]=T1,na),Y0=function(e){qi(n,e);function n(){var t=e.call(this)||this;t.priority=1001,t.identifier=Zd,t._senderConfig=F1();var i,o,s,l,u,d,f,p,m=0,g,v,C,E,b;return Be(n,t,function(S,I){de(),S.pause=function(){Gi(),l=!0},S.resume=function(){l&&(l=!1,o=null,S._buffer.size()>S._senderConfig[km]()&&S[Sl](!0,null,10),Pe())},S.flush=function(w,V,q){if(w===void 0&&(w=!0),!l){Gi();try{S[Sl](w,null,q||1)}catch(ue){ae(S[gn](),1,22,"flush failed, telemetry will not be collected: "+Qe(ue),{exception:Ce(ue)})}}},S.onunloadFlush=function(){if(!l)if((S._senderConfig[N0]()===!1||S[Ut][Rm]()===!1)&&Ia())try{S[Sl](!0,De,2)}catch(w){ae(S[gn](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Qe(w),{exception:Ce(w)})}else S.flush()},S.addHeader=function(w,V){p[w]=V},S.initialize=function(w,V,q,ue){S.isInitialized()&&ae(S[gn](),1,28,"Sender is already initialized"),I.initialize(w,V,q,ue);var Ne=S._getTelCtx(),Ve=S.identifier;d=new O1(V.logger),i=0,o=null,s=0,S[Kc]=null,f=0;var ut=S[gn]();E=Kn(Ki("Sender"),V.evtNamespace&&V.evtNamespace()),C=I1(E);var zt=F1();lt(zt,function(J,te){S[Ut][J]=function(){var ie=Ne.getConfig(Ve,J,te());return!ie&&J==="endpointUrl"&&(ie=te()),ie}}),b=S[Ut].retryCodes(),w.storagePrefix&&dl(w.storagePrefix);var nn=S[Ut][w0]()&&!!(S._senderConfig[lh]()||Ba());S[ts]=nn?new A1(ut,S[Ut]):new L1(ut,S[Ut]),S._sample=new R1(S[Ut][I0](),ut),G(w)||ae(ut,1,100,"Invalid Instrumentation key "+w[ch]),!hl(S._senderConfig.endpointUrl())&&S._senderConfig.customHeaders()&&S._senderConfig.customHeaders()[et]>0&&_e(S[Ut][P0](),function(J){t.addHeader(J.header,J.value)});var qt=S[Ut],R=null;!qt[Qc]()&&Bf()?R=F:!qt[Qc]()&&qs()&&(R=He),!R&&Yf()&&(R=Ee),g=R||He,!qt[Rm]()&&Ia()&&(R=yt),S[Kc]=R||He,!qt[L0]()&&Yf(!0)?v=ct:Ia()?v=yt:!qt[Qc]()&&Bf()?v=F:!qt[Qc]()&&qs()?v=He:v=g},S.processTelemetry=function(w,V){V=S._getTelCtx(V);var q=V[gn]();try{if(S[Ut][Fm]())return;if(!w){ae(q,1,7,"Cannot send empty telemetry");return}if(w.baseData&&!w[Ym]){ae(q,1,70,"Cannot send telemetry without baseData and baseType");return}if(w[Ym]||(w[Ym]="EventData"),!S[Kc]){ae(q,1,28,"Sender was not initialized");return}if(z(w))w[Mc]=S._sample[eu];else{ae(q,2,33,"Telemetry item was sampled out and not sent",{SampleRate:S._sample[eu]});return}var ue=S[Ut][A0]()||void 0,Ne=w.iKey||S[Ut][ch](),Ve=n.constructEnvelope(w,Ne,q,ue);if(!Ve){ae(q,1,47,"Unable to create an AppInsights envelope");return}var ut=!1;if(w[Ii]&&w[Ii][kc]&&(_e(w[Ii][kc],function(R){try{R&&R(Ve)===!1&&(ut=!0,yr(q,"Telemetry processor check returns false"))}catch(J){ae(q,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Qe(J),{exception:Ce(J)},!0)}}),delete w[Ii][kc]),ut)return;var zt=d.serialize(Ve),nn=S[ts],qt=nn.size();qt+zt[et]>S[Ut][km]()&&(!C||C[ah]())&&S[Sl](!0,null,10),nn[vl](zt),Pe()}catch(R){ae(q,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Qe(R),{exception:Ce(R)})}S.processNext(w,V)},S[g1]=function(w,V,q){w.readyState===4&&j(w.status,V,w.responseURL,q,qe(w),Hm(w)||w.response)},S[Sl]=function(w,V,q){if(w===void 0&&(w=!0),!l)try{var ue=S[ts];if(S[Ut][Fm]())ue[Ka]();else{if(ue[Ja]()>0){var Ne=ue.getItems();H(q||0,w),V?V.call(S,Ne,w):S[Kc](Ne,w)}s=+new Date}Gi()}catch(ut){var Ve=Pc();(!Ve||Ve>9)&&ae(S[gn](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+Qe(ut),{exception:Ce(ut)})}},S._doTeardown=function(w,V){S.onunloadFlush(),C.unload(),de()},S[xr]=function(w,V,q){ae(S[gn](),2,26,"Failed to send telemetry.",{message:V}),S._buffer&&S._buffer[yl](w)},S[Bm]=function(w,V){for(var q=[],ue=[],Ne=V.errors.reverse(),Ve=0,ut=Ne;Ve<ut.length;Ve++){var zt=ut[Ve],nn=w.splice(zt.index,1)[0];Se(zt.statusCode)?ue[ta](nn):q[ta](nn)}w[et]>0&&S[uh](w,V[dh]),q[et]>0&&S[xr](q,qe(null,["partial success",V[dh],"of",V.itemsReceived].join(" "))),ue[et]>0&&(At(ue),ae(S[gn](),2,40,"Partial success. Delivered: "+w[et]+", Failed: "+q[et]+". Will retry to send "+ue[et]+" our of "+V[y1]+" items"))},S[uh]=function(w,V){S._buffer&&S._buffer[yl](w)},S._xdrOnLoad=function(w,V){var q=Hm(w);if(w&&(q+""=="200"||q===""))i=0,S[uh](V,0);else{var ue=Hi(q);ue&&ue.itemsReceived&&ue.itemsReceived>ue[dh]&&!S[Ut][tu]()?S[Bm](V,ue):S[xr](V,Q(w))}};function z(w){return S._sample.isSampledIn(w)}function j(w,V,q,ue,Ne,Ve){var ut=null;if(S._appId||(ut=Hi(Ve),ut&&ut.appId&&(S._appId=ut.appId)),(w<200||w>=300)&&w!==0){if((w===301||w===307||w===308)&&!k(q)){S[xr](V,Ne);return}!S[Ut][tu]()&&Se(w)?(At(V),ae(S[gn](),2,40,". Response code "+w+". Will retry to send "+V[et]+" items.")):S[xr](V,Ne)}else if(C&&!C[ah]()){if(!S[Ut][tu]()){var zt=10;At(V,zt),ae(S[gn](),2,40,". Offline - Response Code: ".concat(w,". Offline status: ").concat(!C.isOnline(),". Will retry to send ").concat(V.length," items."))}}else k(q),w===206?(ut||(ut=Hi(Ve)),ut&&!S[Ut][tu]()?S[Bm](V,ut):S[xr](V,Ne)):(i=0,S[uh](V,ue))}function k(w){return f>=10?!1:!ee(w)&&w!==""&&w!==S[Ut][is]()?(S[Ut][is]=function(){return w},++f,!0):!1}function De(w,V){v?v(w,!1):yt(w,V)}function $(w){var V=En(),q=S[ts],ue=S[Ut][is](),Ne=S._buffer[gl](w),Ve=new Blob([Ne],{type:"text/plain;charset=UTF-8"}),ut=V.sendBeacon(ue,Ve);return ut&&(q[Qa](w),S._onSuccess(w,w[et])),ut}function yt(w,V){if(st(w)&&w[et]>0&&!$(w)){for(var q=[],ue=0;ue<w[et];ue++){var Ne=w[ue];$([Ne])||q[ta](Ne)}q[et]>0&&(g&&g(q,!0),ae(S[gn](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function He(w,V){var q=new XMLHttpRequest,ue=S[Ut][is]();try{q[Zr]=!0}catch{}q.open("POST",ue,V),q[Um]("Content-type","application/json"),hl(ue)&&q[Um](vt[6],vt[7]),_e(Mn(p),function(Ve){q[Um](Ve,p[Ve])}),q.onreadystatechange=function(){return S._xhrReadyStateChange(q,w,w[et])},q.onerror=function(Ve){return S[xr](w,qe(q),Ve)};var Ne=S._buffer[gl](w);q.send(Ne),S._buffer[Qa](w)}function ct(w,V){if(st(w)){for(var q=w[et],ue=0;ue<w[et];ue++)q+=w[ue][et];m+q<=zP?$t(w,!1):Ia()?yt(w,V):(g&&g(w,!0),ae(S[gn](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function Ee(w,V){$t(w,!0)}function $t(w,V){var q,ue=S[Ut][is](),Ne=S._buffer[gl](w),Ve=new Blob([Ne],{type:"application/json"}),ut=new Headers,zt=Ne[et],nn=!1,qt=!1;hl(ue)&&ut.append(vt[6],vt[7]),_e(Mn(p),function(te){ut.append(te,p[te])});var R=(q={method:"POST",headers:ut,body:Ve},q[Zr]=!0,q);V||(R.keepalive=!0,nn=!0,m+=zt);var J=new Request(ue,R);try{J[Zr]=!0}catch{}S._buffer[Qa](w);try{fetch(J).then(function(te){V||(m-=zt,zt=0),qt||(qt=!0,te.ok?te.text().then(function(ie){j(te.status,w,te.url,w[et],te.statusText,ie)}):S[xr](w,te.statusText))}).catch(function(te){V||(m-=zt,zt=0),qt||(qt=!0,S[xr](w,te.message))})}catch(te){qt||S[xr](w,Ce(te))}nn&&!qt&&(qt=!0,S._onSuccess(w,w[et]))}function Hi(w){try{if(w&&w!==""){var V=Ri().parse(w);if(V&&V.itemsReceived&&V.itemsReceived>=V[dh]&&V.itemsReceived-V.itemsAccepted===V.errors[et])return V}}catch(q){ae(S[gn](),1,43,"Cannot parse the response. "+Qe(q),{response:w})}return null}function At(w,V){if(V===void 0&&(V=1),!(!w||w[et]===0)){var q=S[ts];q[yl](w),i++;for(var ue=0,Ne=w;ue<Ne.length;ue++){var Ve=Ne[ue];q[vl](Ve)}Vi(V),Pe()}}function Vi(w){var V=10,q;if(i<=1)q=V;else{var ue=(Math.pow(2,i)-1)/2,Ne=Math.floor(Math.random()*ue*V)+1;Ne=w*Ne,q=Math.max(Math.min(Ne,3600),V)}var Ve=Ji()+q*1e3;o=Ve}function Pe(){if(!u&&!l){var w=o?Math.max(0,o-Ji()):0,V=Math.max(S[Ut][O0](),w);u=setTimeout(function(){u=null,S[Sl](!0,null,1)},V)}}function Gi(){clearTimeout(u),u=null,o=null}function Se(w){return ee(b)?w===401||w===408||w===429||w===500||w===502||w===503||w===504:b[et]&&Ni(b,w)>-1}function qe(w,V){return w?"XMLHttpRequest,Status:"+w.status+",Response:"+Hm(w)||w.response||"":V}function F(w,V){var q=S[ts],ue=Jn(),Ne=new XDomainRequest;Ne.onload=function(){return S._xdrOnLoad(Ne,w)},Ne.onerror=function(nn){return S[xr](w,Q(Ne),nn)};var Ve=ue&&ue.location&&ue.location.protocol||"";if(S[Ut][is]().lastIndexOf(Ve,0)!==0){ae(S[gn](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),q[Ka]();return}var ut=S[Ut][is]().replace(/^(https?:)/,"");Ne.open("POST",ut);var zt=q[gl](w);Ne.send(zt),q[Qa](w)}function Q(w,V){return w?"XDomainRequest,Response:"+Hm(w)||"":V}function A(){var w="getNotifyMgr";return S.core[w]?S.core[w]():S.core._notificationManager}function H(w,V){var q=A();if(q&&q[M0])try{q[M0](w,V)}catch(ue){ae(S[gn](),1,74,"send request notification failed: "+Qe(ue),{exception:Ce(ue)})}}function G(w){var V=ee(w[k0])?!1:w[k0];if(V)return!0;var q="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",ue=new RegExp(q);return ue.test(w[ch])}function de(){S[Kc]=null,S[ts]=null,S._appId=null,S._sample=null,p={},C=null,i=0,o=null,s=null,l=!1,u=null,d=null,f=0,m=0,g=null,v=null,E=null}}),t}return n.constructEnvelope=function(t,i,o,s){var l;i!==t.iKey&&!ee(i)?l=vi(vi({},t),{iKey:i}):l=t;var u=HP[l.baseType]||F0;return u(o,l,s)},n}(Wr);var B0="duration",rs="properties";var zn="requestUrl",iu="inst",Xr="length",Jr="traceID",Io="spanID",Hn="traceFlags",nu="context",os="aborted",ru="traceId",ou="spanId",Kr="core",Vm="includeCorrelationHeaders",U0="canIncludeCorrelationHeader",hh="getAbsoluteUrl",as="headers",Vn="requestHeaders",ph="appId",Gm="setRequestHeader",z0="trackDependencyDataInternal",Wm="distributedTracingMode",ra="startTime",bl="toLowerCase",Y1="enableRequestHeaderTracking",B1="enableAjaxErrorStatusText",U1="enableAjaxPerfTracking",z1="maxAjaxCallsPerView",H1="enableResponseHeaderTracking",V1="excludeRequestFromAutoTrackingPatterns",G1="addRequestContext",W1="disableAjaxTracking",Z1="disableFetchTracking",nr="status",oa="statusText",au="headerMap",fh="openDone",mh="sendDone",aa="requestSentTime",_h="abortDone",vh="getTraceId",gh="getTraceFlags",Po="method",yh="errorStatusText",Zm="stateChangeAttached",j1="responseText",xl="responseFinishedTime",Sh="CreateTrackItem",jm="response",H0="getAllResponseHeaders",Ch="getPartAProps",V0="getCorrelationContext",su="perfMark",$1="ajaxPerfLookupDelay",ss="name",Th="perfTiming";var q1="correlationContext",$m="ajaxTotalDuration",qm="eventTraceCtx";function X1(e,n,t){var i=0,o=e[n],s=e[t];return o&&s&&(i=Fi(o,s)),i}function Dl(e,n,t,i,o){var s=0,l=X1(t,i,o);return l&&(s=ls(e,n,Qn(l))),s}function ls(e,n,t){var i="ajaxPerf",o=0;if(e&&n&&t){var s=e[i]=e[i]||{};s[n]=t,o=1}return o}function VP(e,n){var t=e[Th],i=n[rs]||{},o=0,s="name",l="Start",u="End",d="domainLookup",f="connect",p="redirect",m="request",g="response",v="startTime",C=d+l,E=d+u,b=f+l,S=f+u,I=m+l,z=m+u,j=g+l,k=g+u,De=p+l,$=p=u,yt="transferSize",He="encodedBodySize",ct="decodedBodySize",Ee="serverTiming";if(t){o|=Dl(i,p,t,De,$),o|=Dl(i,d,t,C,E),o|=Dl(i,f,t,b,S),o|=Dl(i,m,t,I,z),o|=Dl(i,g,t,j,k),o|=Dl(i,"networkConnect",t,v,S),o|=Dl(i,"sentRequest",t,I,k);var $t=t[B0];$t||($t=X1(t,v,k)||0),o|=ls(i,B0,$t),o|=ls(i,"perfTotal",$t);var Hi=t[Ee];if(Hi){var At={};_e(Hi,function(Vi,Pe){var Gi=Zs(Vi[s]||""+Pe),Se=At[Gi]||{};lt(Vi,function(qe,F){(qe!==s&&xe(F)||Td(F))&&(Se[qe]&&(F=Se[qe]+";"+F),(F||!xe(F))&&(Se[qe]=F))}),At[Gi]=Se}),o|=ls(i,Ee,At)}o|=ls(i,yt,t[yt]),o|=ls(i,He,t[He]),o|=ls(i,ct,t[ct])}else e[su]&&(o|=ls(i,"missing",e.perfAttempts));o&&(n[rs]=i)}var GP=function(){function e(){var n=this;n[fh]=!1,n.setRequestHeaderDone=!1,n[mh]=!1,n[_h]=!1,n[Zm]=!1}return e}();var G0=function(){function e(n,t,i,o){var s,l=this,u=i,d="responseText";l[su]=null,l.completed=!1,l.requestHeadersSize=null,l[Vn]=null,l.responseReceivingDuration=null,l.callbackDuration=null,l[$m]=null,l[os]=0,l.pageUrl=null,l[zn]=null,l.requestSize=0,l[Po]=null,l[nr]=null,l[aa]=null,l.responseStartedTime=null,l[xl]=null,l.callbackFinishedTime=null,l.endTime=null,l.xhrMonitoringState=new GP,l.clientFailure=0,l[Jr]=n,l[Io]=t,l[Hn]=o?.getTraceFlags(),o?l[qm]=(s={},s[ru]=o[vh](),s[ou]=o.getSpanId(),s[Hn]=o[gh](),s):l[qm]=null,Be(e,l,function(f){f.getAbsoluteUrl=function(){return f[zn]?cm(f[zn]):null},f.getPathName=function(){return f[zn]?xo(u,um(f[Po],f[zn])):null},f[Sh]=function(p,m,g){var v;if(f.ajaxTotalDuration=Math.round(Fi(f.requestSentTime,f.responseFinishedTime)*1e3)/1e3,f[$m]<0)return null;var C=(v={id:"|"+f[Jr]+"."+f[Io],target:f[hh]()},v[ss]=f.getPathName(),v.type=p,v[ra]=null,v.duration=f[$m],v.success=+f[nr]>=200&&+f[nr]<400,v.responseCode=+f[nr],v[rs]={HttpMethod:f[Po]},v),E=C[rs];if(f[os]&&(E[os]=!0),f[aa]&&(C[ra]=new Date,C[ra].setTime(f[aa])),VP(f,C),m&&Mn(f.requestHeaders)[Xr]>0&&(E[Vn]=f[Vn]),g){var b=g();if(b){var S=b[q1];if(S&&(C.correlationContext=S),b[au]&&Mn(b.headerMap)[Xr]>0&&(E.responseHeaders=b[au]),f[yh])if(f[nr]>=400){var I=b.type;(I===""||I==="text")&&(E.responseText=b.responseText?b[oa]+" - "+b[d]:b[oa]),I==="json"&&(E.responseText=b.response?b[oa]+" - "+JSON.stringify(b[jm]):b[oa])}else f[nr]===0&&(E.responseText=b[oa]||"")}}return C},f[Ch]=function(){var p,m=null,g=f[qm];if(g&&(g[ru]||g[ou])){m={};var v=m[ln.TraceExt]=(p={},p[Jr]=g[ru],p.parentID=g[ou],p);ee(g[Hn])||(v[Hn]=g[Hn])}return m}})}return e.__ieDyn=1,e}();var J1="ai.ajxmn.",xh="diagLog",cs="_ajaxData",Nl="fetch",Eh="Failed to monitor XMLHttpRequest",ob=", monitoring data for this ajax call ",lu=ob+"may be incorrect.",K1=ob+"won't be sent.",Q1="Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",eb="Failed to add custom defined request context as configured call back may missing a null check.",tb="Failed to calculate the duration of the ",ib=0;function WP(){var e=fr();return!e||ee(e.Request)||ee(e.Request[ii])||ee(e[Nl])?null:e[Nl]}var Xm=null;function ZP(){if(Xm==null)try{Xm=!!(self&&self instanceof WorkerGlobalScope)}catch{Xm=!1}return Xm}function jP(e,n){var t,i=!1;if(qs()){var o=XMLHttpRequest[ii];i=!ee(o)&&!ee(o.open)&&!ee(o.send)&&!ee(o.abort)}var s=Pc();if(s&&s<9&&(i=!1),i)try{var l=new XMLHttpRequest,u={xh:[],i:(t={},t[n]={},t)};l[cs]=u;var d=XMLHttpRequest[ii].open;XMLHttpRequest[ii].open=d}catch(f){i=!1,Dh(e,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Ce(f)})}return i}var uu=function(e,n){return e&&n&&e[cs]?(e[cs].i||{})[n]:null},$P=function(e,n,t){if(e){var i=(e[cs]||{}).xh;i&&i.push({n,v:t})}},W0=function(e,n){var t=!1;if(e){var i=(e[cs]||{}).xh;i&&_e(i,function(o){if(o.n===n)return t=!0,-1})}return t};function Km(e,n){var t="";try{var i=uu(e,n);i&&i[zn]&&(t+="(url: '"+i[zn]+"')")}catch{}return t}function Dh(e,n,t,i,o){ae(e[xh](),1,n,t,i,o)}function sa(e,n,t,i,o){ae(e[xh](),2,n,t,i,o)}function bh(e,n,t){return function(i){Dh(e,n,t,{ajaxDiagnosticsMessage:Km(i[iu],e._ajaxDataId),exception:Ce(i.err)})}}function cu(e,n){return e&&n?e.indexOf(n):-1}function nb(e,n,t){var i={id:n,fn:t};return e.push(i),{remove:function(){_e(e,function(o,s){if(o.id===i.id)return e.splice(s,1),-1})}}}function ab(e,n,t,i){var o=!0;return _e(n,function(s,l){try{s.fn.call(null,t)===!1&&(o=!1)}catch(u){ae(e&&e.logger,1,64,"Dependency "+i+" [#"+l+"] failed: "+Qe(u),{exception:Ce(u)},!0)}}),o}function qP(e,n,t,i,o,s){var l=e[Xr];if(l>0){var u={core:n,xhr:i,input:o,init:s,traceId:t[Jr],spanId:t[Io],traceFlags:t[Hn],context:t[nu]||{},aborted:!!t[os]};ab(n,e,u,"listener"),t[Jr]=u[ru],t[Io]=u[ou],t[Hn]=u[Hn],t[nu]=u[nu]}}var Jm="*.blob.core.",sb=bc([Jm+"windows.net",Jm+"chinacloudapi.cn",Jm+"cloudapi.de",Jm+"usgovcloudapi.net"]),XP=[/https:\/\/[^\/]*(\.pipe\.aria|aria\.pipe|events\.data|collector\.azure)\.[^\/]+\/(OneCollector\/1|Collector\/3)\.0/i];function Z0(){var e={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!1,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:1,correlationHeaderExcludedDomains:sb,correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"],addRequestContext:void 0,addIntEndpoints:!0};return e}function rb(){var e=Z0();return lt(e,function(n){e[n]=void 0}),e}var j0=function(e){qi(n,e);function n(){var t=e.call(this)||this;t.identifier=n.identifier,t.priority=120;var i,o,s,l,u,d,f,p,m,g,v,C,E,b,S,I,z,j,k,De,$,yt,He,ct;return Be(n,t,function(Ee,$t){var Hi=$t._addHook;At(),Ee.initialize=function(R,J,te,ie){Ee.isInitialized()||($t.initialize(R,J,te,ie),De=Kn(Ki("ajax"),J&&J.evtNamespace&&J.evtNamespace()),Vi(R),F(),Se(),Pe())},Ee._doTeardown=function(){At()},Ee.trackDependencyData=function(R,J){qt(ct,Ee[Kr],null,R,J)},Ee[Vm]=function(R,J,te,ie){var le=Ee._currentWindowHost||s;if(qP(He,Ee[Kr],R,ie,J,te),J||J===""){if(Jo[U0](l,R[hh](),le)){te||(te={});var we=new Headers(te[as]||(J instanceof Request?J[as]||{}:{}));if(g){var ke="|"+R[Jr]+"."+R[Io];we.set(vt[3],ke),u&&(R[Vn][vt[3]]=ke)}var St=l[ph]||p&&p[ph]();if(St&&(we.set(vt[0],vt[2]+St),u&&(R[Vn][vt[0]]=vt[2]+St)),m){var Ge=R[Hn];ee(Ge)&&(Ge=1);var Ot=Ld(Pd(R[Jr],R[Io],Ge));we.set(vt[4],Ot),u&&(R[Vn][vt[4]]=Ot)}te[as]=we}return te}else if(ie){if(Jo[U0](l,R[hh](),le)){if(g)if(W0(ie,vt[3]))sa(Ee,71,"Unable to set ["+vt[3]+"] as it has already been set by another instance");else{var ke="|"+R[Jr]+"."+R[Io];ie[Gm](vt[3],ke),u&&(R[Vn][vt[3]]=ke)}var St=l[ph]||p&&p[ph]();if(St&&(W0(ie,vt[0])?sa(Ee,71,"Unable to set ["+vt[0]+"] as it has already been set by another instance"):(ie[Gm](vt[0],vt[2]+St),u&&(R[Vn][vt[0]]=vt[2]+St))),m){var Ge=R[Hn];if(ee(Ge)&&(Ge=1),W0(ie,vt[4]))sa(Ee,71,"Unable to set ["+vt[4]+"] as it has already been set by another instance");else{var Ot=Ld(Pd(R[Jr],R[Io],Ge));ie[Gm](vt[4],Ot),u&&(R[Vn][vt[4]]=Ot)}}}return ie}},Ee[z0]=function(R,J,te){if(E===-1||f<E){(l[Wm]===2||l[Wm]===1)&&typeof R.id=="string"&&R.id[R.id[Xr]-1]!=="."&&(R.id+="."),ee(R[ra])&&(R[ra]=new Date);var ie=Er(R,ir.dataType,ir.envelopeType,Ee[xh](),J,te);Ee[Kr].track(ie)}else f===E&&Dh(Ee,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++f},Ee.addDependencyListener=function(R){return nb(He,yt++,R)},Ee.addDependencyInitializer=function(R){return nb(ct,yt++,R)};function At(){var R=kn();i=!1,o=!1,s=R&&R.host&&R.host[bl](),l=n.getEmptyConfig(),u=!1,d=!1,f=0,p=null,m=!1,g=!1,v=null,C=!1,E=0,b=!1,S={},I=!1,z=!1,j=null,k=null,De=null,yt=0,He=[],ct=[],$=Ki("ajaxData"),Ee._ajaxDataId=$}function Vi(R){var J=an(null,R,Ee[Kr]);l=rb();var te=Z0();lt(te,function(we,ke){l[we]=J.getConfig(n.identifier,we,ke)});var ie=l[Wm];if(u=l[Y1],d=l[B1],C=l[U1],E=l[z1],b=l[H1],j=[].concat(l[V1]||[],l.addIntEndpoints!==!1?XP:[]),k=l[G1],g=ie===0||ie===1,m=ie===1||ie===2,C){var le=R.instrumentationKey||"unkwn";le[Xr]>5?v=J1+le.substring(le[Xr]-5)+".":v=J1+le+"."}I=!!l[W1],z=!!l[Z1]}function Pe(){var R=Ee[Kr].getPlugin(Ha);R&&(p=R.plugin[nu])}function Gi(R){var J=!0;return(R||l.ignoreHeaders)&&_e(l.ignoreHeaders,function(te){if(te[bl]()===R[bl]())return J=!1,-1}),J}function Se(){var R=WP();if(R){var J=fr(),te=R.polyfill;!z&&!i?(Hi(Md(J,Nl,{ns:De,req:function(ie,le,we){var ke;if(!z&&i&&!Q(null,le,we)&&!(te&&o)){var St=ie.ctx();ke=Ve(le,we);var Ge=Ee[Vm](ke,le,we);Ge!==we&&ie.set(1,Ge),St.data=ke}},rsp:function(ie,le){if(!z){var we=ie.ctx().data;we&&(ie.rslt=ie.rslt.then(function(ke){return zt(ie,(ke||{})[nr],le,ke,we,function(){var St={statusText:(ke||{})[oa],headerMap:null,correlationContext:nn(ke)};if(b&&ke){var Ge={};ke.headers.forEach(function(Ot,Xt){Gi(Xt)&&(Ge[Xt]=Ot)}),St[au]=Ge}return St}),ke}).catch(function(ke){throw zt(ie,0,le,null,we,null,{error:ke.message||Ce(ke)}),ke}))}},hkErr:bh(Ee,15,"Failed to monitor Window.fetch"+lu)},!0,ZP())),i=!0):te&&Hi(Md(J,Nl,{ns:De,req:function(ie,le,we){Q(null,le,we)}})),te&&(J[Nl].polyfill=te)}}function qe(R,J,te){Hi(Qg(R,J,te))}function F(){jP(Ee,$)&&!I&&!o&&(qe(XMLHttpRequest,"open",{ns:De,req:function(R,J,te,ie){if(!I){var le=R[iu],we=uu(le,$);!Q(le,te)&&A(le,we,!0)&&((!we||!we.xhrMonitoringState[fh])&&(we=G(le,J,te,ie)),de(le,we))}},hkErr:bh(Ee,15,Eh+".open"+lu)}),qe(XMLHttpRequest,"send",{ns:De,req:function(R,J){if(!I){var te=R[iu],ie=uu(te,$);A(te,ie)&&!ie.xhrMonitoringState[mh]&&(ue("xhr",ie),ie[aa]=zc(),Ee[Vm](ie,void 0,void 0,te),ie.xhrMonitoringState[mh]=!0)}},hkErr:bh(Ee,17,Eh+lu)}),qe(XMLHttpRequest,"abort",{ns:De,req:function(R){if(!I){var J=R[iu],te=uu(J,$);A(J,te)&&!te.xhrMonitoringState[_h]&&(te[os]=1,te.xhrMonitoringState[_h]=!0)}},hkErr:bh(Ee,13,Eh+".abort"+lu)}),qe(XMLHttpRequest,"setRequestHeader",{ns:De,req:function(R,J,te){if(!I){var ie=R[iu],le=uu(ie,$);le&&A(ie,le)&&($P(ie,J,te),u&&Gi(J)&&le&&(le[Vn][J]=te))}},hkErr:bh(Ee,71,Eh+".setRequestHeader"+lu)}),o=!0)}function Q(R,J,te){var ie=!1,le=((xe(J)?J:(J||{}).url||"")||"")[bl]();if(_e(j,function(St){var Ge=St;xe(St)&&(Ge=new RegExp(St)),ie||(ie=Ge.test(le))}),ie)return ie;var we=cu(le,"?"),ke=cu(le,"#");return(we===-1||ke!==-1&&ke<we)&&(we=ke),we!==-1&&(le=le.substring(0,we)),ee(R)?ee(J)||(ie=(typeof J=="object"?J[Zr]===!0:!1)||(te?te[Zr]===!0:!1)):ie=R[Zr]===!0||le[Zr]===!0,!ie&&le&&hl(le)&&(ie=!0),ie?S[le]||(S[le]=1):S[le]&&(ie=!0),ie}function A(R,J,te){var ie=!0,le=o;return ee(R)||(ie=te===!0||!ee(J)),le&&ie}function H(){var R=null;return Ee[Kr]&&Ee[Kr].getTraceCtx&&(R=Ee[Kr].getTraceCtx(!1)),!R&&p&&p.telemetryTrace&&(R=pl(p.telemetryTrace)),R}function G(R,J,te,ie){var le,we=H(),ke=we&&we[vh]()||Rn(),St=Rn().substr(0,16),Ge=R[cs]=R[cs]||{xh:[],i:{}},Ot=Ge.i=Ge.i||{},Xt=Ot[$]=Ot[$]||new G0(ke,St,Ee[xh](),(le=Ee.core)===null||le===void 0?void 0:le.getTraceCtx());return Xt[Hn]=we&&we[gh](),Xt[Po]=J,Xt[zn]=te,Xt.xhrMonitoringState[fh]=!0,Xt[Vn]={},Xt.async=ie,Xt[yh]=d,Xt}function de(R,J){J.xhrMonitoringState[Zm]=Sr(R,"readystatechange",function(){try{R&&R.readyState===4&&A(R,J)&&V(R)}catch(ie){var te=Ce(ie);(!te||cu(te[bl](),"c00c023f")===-1)&&Dh(Ee,16,Eh+" 'readystatechange' event handler"+lu,{ajaxDiagnosticsMessage:Km(R,$),exception:te})}},De)}function w(R){try{var J=R.responseType;if(J===""||J==="text")return R[j1]}catch{}return null}function V(R){var J=uu(R,$);J[xl]=zc(),J[nr]=R[nr];function te(ie,le){var we=le||{};we.ajaxDiagnosticsMessage=Km(R,$),ie&&(we.exception=Ce(ie)),sa(Ee,14,tb+"ajax call"+K1,we)}Ne("xmlhttprequest",J,function(){try{var ie=J[Sh]("Ajax",u,function(){var Ge={statusText:R[oa],headerMap:null,correlationContext:q(R),type:R.responseType,responseText:w(R),response:R[jm]};if(b){var Ot=R[H0]();if(Ot){var Xt=gi(Ot).split(/[\r\n]+/),Cn={};_e(Xt,function(Is){var Mo=Is.split(": "),Nn=Mo.shift(),Ul=Mo.join(": ");Gi(Nn)&&(Cn[Nn]=Ul)}),Ge[au]=Cn}}return Ge}),le=void 0;try{k&&(le=k({status:R[nr],xhr:R}))}catch{sa(Ee,104,eb)}if(ie){le!==void 0&&(ie[rs]=vi(vi({},ie.properties),le));var we=J[Ch]();qt(ct,Ee[Kr],J,ie,null,we)}else te(null,{requestSentTime:J[aa],responseFinishedTime:J[xl]})}finally{try{var ke=R[cs]||{i:{}},St=ke.i||{};St[$]&&(St[$]=null)}catch{}}},function(ie){te(ie,null)})}function q(R){try{var J=R[H0]();if(J!==null){var te=cu(J[bl](),vt[8]);if(te!==-1){var ie=R.getResponseHeader(vt[0]);return Jo[V0](ie)}}}catch(le){sa(Ee,18,Q1,{ajaxDiagnosticsMessage:Km(R,$),exception:Ce(le)})}}function ue(R,J){if(J[zn]&&v&&C){var te=gr();if(te&&Le(te.mark)){ib++;var ie=v+R+"#"+ib;te.mark(ie);var le=te.getEntriesByName(ie);le&&le[Xr]===1&&(J[su]=le[0])}}}function Ne(R,J,te,ie){var le=J[su],we=gr(),ke=l.maxAjaxPerfLookupAttempts,St=l[$1],Ge=J[zn],Ot=0;(function Xt(){try{if(we&&le){Ot++;for(var Cn=null,Is=we.getEntries(),Mo=Is[Xr]-1;Mo>=0;Mo--){var Nn=Is[Mo];if(Nn){if(Nn.entryType==="resource")Nn.initiatorType===R&&(cu(Nn[ss],Ge)!==-1||cu(Ge,Nn[ss])!==-1)&&(Cn=Nn);else if(Nn.entryType==="mark"&&Nn[ss]===le[ss]){J[Th]=Cn;break}if(Nn[ra]<le[ra]-1e3)break}}}!le||J[Th]||Ot>=ke||J.async===!1?(le&&Le(we.clearMarks)&&we.clearMarks(le[ss]),J.perfAttempts=Ot,te()):setTimeout(Xt,St)}catch(Ul){ie(Ul)}})()}function Ve(R,J){var te,ie=H(),le=ie&&ie[vh]()||Rn(),we=Rn().substr(0,16),ke=new G0(le,we,Ee[xh](),(te=Ee.core)===null||te===void 0?void 0:te.getTraceCtx());ke[Hn]=ie&&ie[gh](),ke[aa]=zc(),ke[yh]=d,R instanceof Request?ke[zn]=R?R.url:"":ke[zn]=R;var St="GET";J&&J[Po]?St=J[Po]:R&&R instanceof Request&&(St=R[Po]),ke[Po]=St;var Ge={};if(u){var Ot=new Headers((J?J[as]:0)||(R instanceof Request?R[as]||{}:{}));Ot.forEach(function(Xt,Cn){Gi(Cn)&&(Ge[Cn]=Xt)})}return ke[Vn]=Ge,ue(Nl,ke),ke}function ut(R){var J="";try{ee(R)||(xe(R)?J+="(url: '".concat(R,"')"):J+="(url: '".concat(R.url,"')"))}catch(te){Dh(Ee,15,"Failed to grab failed fetch diagnostics message",{exception:Ce(te)})}return J}function zt(R,J,te,ie,le,we,ke){if(!le)return;function St(Ge,Ot,Xt){var Cn=Xt||{};Cn.fetchDiagnosticsMessage=ut(te),Ot&&(Cn.exception=Ce(Ot)),sa(Ee,Ge,tb+"fetch call"+K1,Cn)}le[xl]=zc(),le[nr]=J,Ne(Nl,le,function(){var Ge=le[Sh]("Fetch",u,we),Ot;try{k&&(Ot=k({status:J,request:te,response:ie}))}catch{sa(Ee,104,eb)}if(Ge){Ot!==void 0&&(Ge[rs]=vi(vi({},Ge.properties),Ot));var Xt=le[Ch]();qt(ct,Ee[Kr],le,Ge,null,Xt)}else St(14,null,{requestSentTime:le[aa],responseFinishedTime:le[xl]})},function(Ge){St(18,Ge,null)})}function nn(R){if(R&&R[as])try{var J=R[as].get(vt[0]);return Jo[V0](J)}catch(te){sa(Ee,18,Q1,{fetchDiagnosticsMessage:ut(R),exception:Ce(te)})}}function qt(R,J,te,ie,le,we){var ke=!0,St=R[Xr];if(St>0){var Ge={item:ie,properties:le,sysProperties:we,context:te?te[nu]:null,aborted:te?!!te[os]:!1};ke=ab(J,R,Ge,"initializer")}ke&&Ee[z0](ie,le,we)}}),t}return n.prototype.processTelemetry=function(t,i){this.processNext(t,i)},n.prototype.addDependencyInitializer=function(t){return null},n.identifier="AjaxDependencyPlugin",n.getDefaultConfig=Z0,n.getEmptyConfig=rb,n}(Wr);var lb=function(){function e(){}return e}();var cb=function(){function e(){this.id="browser",this.deviceClass="Browser"}return e}();var du="sessionManager",wl="update",hu="isUserCookieSet",pu="isNewUser",Qm="getTraceCtx",Nh="telemetryTrace",e_="applySessionContext",t_="applyApplicationContext",i_="applyDeviceContext",n_="applyOperationContext",r_="applyUserContext",o_="applyOperatingSystemContxt",a_="applyLocationContext",s_="applyInternalContext",Qr="accountId",fu="sdkExtension",mu="getSessionId",Lo="namePrefix",_u="sessionCookiePostfix",vu="userCookiePostfix",us="idLength",ds="getNewId",Il="length",hs="automaticSession",ps="authenticatedId",gu="sessionExpirationMs",wh="sessionRenewalMs",eo="config",yu="acquisitionDate",Ih="renewalDate",Ph="cookieDomain",Su="join",Cu="cookieSeparator",l_="authUserCookieName";var JP="2.8.18",ub=function(){function e(n){this.sdkVersion=(n[fu]&&n[fu]()?n[fu]()+"_":"")+"javascript:"+JP}return e}();var db=function(){function e(){}return e}();var KP="ai_session",$0=function(){function e(){}return e}();var hb=function(){function e(n,t){var i=this,o,s,l=Gr(t),u=el(t);Be(e,i,function(d){n||(n={}),Le(n[gu])||(n[gu]=function(){return e.acquisitionSpan}),Le(n[wh])||(n[wh]=function(){return e.renewalSpan}),d[eo]=n;var f=d.config[_u]&&d[eo][_u]()?d.config[_u]():d.config[Lo]&&d[eo][Lo]()?d[eo][Lo]():"";o=function(){return KP+f},d[hs]=new $0,d[wl]=function(){var E=Ji(),b=!1,S=d[hs];S.id||(b=!p(S,E));var I=d.config[gu]();if(!b&&I>0){var z=d.config[wh](),j=E-S[yu],k=E-S[Ih];b=j<0||k<0,b=b||j>I,b=b||k>z}b?g(E):(!s||E-s>e.cookieUpdateInterval)&&v(S,E)},d.backup=function(){var E=d[hs];C(E.id,E[yu],E[Ih])};function p(E,b){var S=!1,I=u.get(o());if(I&&Le(I.split))S=m(E,I);else{var z=l0(l,o());z&&(S=m(E,z))}return S||!!E.id}function m(E,b){var S=!1,I=", session will be reset",z=b.split("|");if(z[Il]>=2)try{var j=+z[1]||0,k=+z[2]||0;isNaN(j)||j<=0?ae(l,2,27,"AI session acquisition date is 0"+I):isNaN(k)||k<=0?ae(l,2,27,"AI session renewal date is 0"+I):z[0]&&(E.id=z[0],E[yu]=j,E[Ih]=k,S=!0)}catch(De){ae(l,1,9,"Error parsing ai_session value ["+(b||"")+"]"+I+" - "+Qe(De),{exception:Ce(De)})}return S}function g(E){var b=d[eo]||{},S=(b[ds]?b[ds]():null)||Zo;d.automaticSession.id=S(b[us]?b[us]():22),d[hs][yu]=E,v(d[hs],E),zd()||ae(l,2,0,"Browser does not support local storage. Session durations will be inaccurate.")}function v(E,b){var S=E[yu];E[Ih]=b;var I=d[eo],z=I[wh](),j=S+I[gu]()-b,k=[E.id,S,b],De=0;j<z?De=j/1e3:De=z/1e3;var $=I[Ph]?I[Ph]():null;u.set(o(),k.join("|"),I[gu]()>0?De:null,$),s=b}function C(E,b,S){c0(l,o(),[E,b,S][Su]("|"))}})}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}();var pb=function(){function e(n,t,i,o){var s=this;s.traceID=n||Rn(),s.parentID=t;var l=kn();!i&&l&&l.pathname&&(i=l.pathname),s.name=gt(o,i)}return e}();function fb(e){return!(typeof e!="string"||!e||e.match(/,|;|=| |\|/))}var mb=function(){function e(n,t){this.isNewUser=!1,this.isUserCookieSet=!1;var i=Gr(t),o=el(t),s;Be(e,this,function(l){l[eo]=n;var u=l.config[vu]&&l[eo][vu]()?l[eo][vu]():"";s=function(){return e.userCookieName+u};var d=o.get(s());if(d){l[pu]=!1;var f=d.split(e[Cu]);f[Il]>0&&(l.id=f[0],l[hu]=!!l.id)}function p(){var S=n||{},I=(S[ds]?S[ds]():null)||Zo,z=I(S[us]?n[us]():22);return z}function m(S){var I=qn(new Date);l.accountAcquisitionDate=I,l[pu]=!0;var z=[S,I];return z}function g(S){var I=31536e3;l[hu]=o.set(s(),S,I)}if(!l.id){l.id=p();var v=m(l.id);g(v[Su](e[Cu]));var C=n[Lo]&&n[Lo]()?n[Lo]()+"ai_session":"ai_session";u0(i,C)}l[Qr]=n[Qr]?n[Qr]():void 0;var E=o.get(e[l_]);if(E){E=decodeURI(E);var b=E.split(e[Cu]);b[0]&&(l[ps]=b[0]),b[Il]>1&&b[1]&&(l[Qr]=b[1])}l.setAuthenticatedUserContext=function(S,I,z){z===void 0&&(z=!1);var j=!fb(S)||I&&!fb(I);if(j){ae(i,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}l[ps]=S;var k=l[ps];I&&(l[Qr]=I,k=[l[ps],l.accountId][Su](e[Cu])),z&&o.set(e[l_],encodeURI(k))},l.clearAuthenticatedUserContext=function(){l[ps]=null,l[Qr]=null,o.del(e[l_])},l[wl]=function(S){if(l.id!==S||!l[hu]){var I=S||p(),z=m(I);g(z[Su](e[Cu]))}}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}();var c_="ext",u_="tags";function Tu(e,n){e&&e[n]&&Mn(e[n])[Il]===0&&delete e[n]}var _b=function(){function e(n,t,i){var o=this,s=n.logger;this.appId=function(){return null},this[mu]=function(){return null},Be(e,this,function(l){if(l.application=new lb,l.internal=new ub(t),Go()){l[du]=new hb(t,n),l.device=new cb,l.location=new db,l.user=new mb(t,n);var u=void 0,d=void 0,f;i&&(u=i.getTraceId(),d=i.getSpanId(),f=i.getName()),l[Nh]=new pb(u,d,f,s),l.session=new $0}l[mu]=function(){var p=l.session,m=null;if(p&&xe(p.id))m=p.id;else{var g=(l[du]||{})[hs];m=g&&xe(g.id)?g.id:null}return m},l[e_]=function(p,m){_t(di(p.ext,ln.AppExt),"sesId",l[mu](),xe)},l[o_]=function(p,m){_t(p.ext,ln.OSExt,l.os)},l[t_]=function(p,m){var g=l.application;if(g){var v=di(p,u_);_t(v,Mt.applicationVersion,g.ver,xe),_t(v,Mt.applicationBuild,g.build,xe)}},l[i_]=function(p,m){var g=l.device;if(g){var v=di(di(p,c_),ln.DeviceExt);_t(v,"localId",g.id,xe),_t(v,"ip",g.ip,xe),_t(v,"model",g.model,xe),_t(v,"deviceClass",g.deviceClass,xe)}},l[s_]=function(p,m){var g=l.internal;if(g){var v=di(p,u_);_t(v,Mt.internalAgentVersion,g.agentVersion,xe),_t(v,Mt.internalSdkVersion,gt(s,g.sdkVersion,64),xe),(p.baseType===Wo.dataType||p.baseType===bn.dataType)&&(_t(v,Mt.internalSnippet,g.snippetVer,xe),_t(v,Mt.internalSdkSrc,g.sdkSrc,xe))}},l[a_]=function(p,m){var g=o.location;g&&_t(di(p,u_,[]),Mt.locationIp,g.ip,xe)},l[n_]=function(p,m){var g=l[Nh];if(g){var v=di(di(p,c_),ln.TraceExt,{traceID:void 0,parentID:void 0});_t(v,"traceID",g.traceID,xe,ee),_t(v,"name",g.name,xe,ee),_t(v,"parentID",g.parentID,xe,ee)}},l.applyWebContext=function(p,m){var g=o.web;g&&_t(di(p,c_),ln.WebExt,g)},l[r_]=function(p,m){var g=l.user;if(g){var v=di(p,u_,[]);_t(v,Mt.userAccountId,g[Qr],xe);var C=di(di(p,c_),ln.UserExt);_t(C,"id",g.id,xe),_t(C,"authId",g[ps],xe)}},l.cleanUp=function(p,m){var g=p.ext;g&&(Tu(g,ln.DeviceExt),Tu(g,ln.UserExt),Tu(g,ln.WebExt),Tu(g,ln.OSExt),Tu(g,ln.AppExt),Tu(g,ln.TraceExt))}})}return e.__ieDyn=1,e}();var QP=function(e){qi(n,e);function n(){var t=e.call(this)||this;t.priority=110,t.identifier=Ha;var i,o,s;return Be(n,t,function(l,u){d(),l.initialize=function(m,g,v,C){u.initialize(m,g,v,C),f(m)},l.processTelemetry=function(m,g){if(!ee(m)){g=l._getTelCtx(g),m.name===bn.envelopeType&&g.diagLog().resetInternalMessageCount();var v=l.context||{};v.session&&typeof l.context.session.id!="string"&&v[du]&&v[du][wl]();var C=v.user;if(C&&!C[hu]&&C[wl](v.user.id),p(m,g),C&&C[pu]){C[pu]=!1;var E=new Wo(72,(En()||{}).userAgent||"");Ig(g.diagLog(),1,E)}l.processNext(m,g)}},l._doTeardown=function(m,g){var v=(m||{}).core();if(v&&v[Qm]){var C=v[Qm](!1);C===o&&v.setTraceCtx(s)}d()};function d(){i=null,o=null,s=null}function f(m){var g=l.identifier,v=l.core,C=an(null,m,v),E=n.getDefaultConfig();i=i||{},lt(E,function(b,S){i[b]=function(){return C.getConfig(g,b,S())}}),m.storagePrefix&&dl(m.storagePrefix),s=v[Qm](!1),l.context=new _b(v,i,s),o=pl(l.context[Nh],s),v.setTraceCtx(o),l.context.appId=function(){var b=v.getPlugin(Zd);return b?b.plugin._appId:null},l._extConfig=i}function p(m,g){di(m,"tags",[]),di(m,"ext",{});var v=l.context;v[e_](m,g),v[t_](m,g),v[i_](m,g),v[n_](m,g),v[r_](m,g),v[o_](m,g),v.applyWebContext(m,g),v[a_](m,g),v[s_](m,g),v.cleanUp(m,g)}}),t}return n.getDefaultConfig=function(){var t,i,o=null,s=(t={instrumentationKey:function(){return i}},t[Qr]=function(){return o},t.sessionRenewalMs=function(){return 30*60*1e3},t.samplingPercentage=function(){return 100},t.sessionExpirationMs=function(){return 24*60*60*1e3},t[Ph]=function(){return o},t[fu]=function(){return o},t.isBrowserLinkTrackingEnabled=function(){return!1},t.appId=function(){return o},t[mu]=function(){return o},t[Lo]=function(){return i},t[_u]=function(){return i},t[vu]=function(){return i},t[us]=function(){return 22},t[ds]=function(){return o},t);return s},n}(Wr),q0=QP;var vb="AuthenticatedUserContext",Eu="track";var d_="snippet",gb="getCookieMgr",yb="startTrackPage",Sb="stopTrackPage",h_="flush",Cb="startTrackEvent",Tb="stopTrackEvent",X0="addTelemetryInitializer",TH=X0+"s",J0="pollInternalLogs",p_="getPlugin",f_="evtNamespace",Eb=Eu+"Event",bb=Eu+"Trace",xb=Eu+"Metric",Db=Eu+"PageView",Nb=Eu+"Exception",wb=Eu+"DependencyData",Ib="set"+vb,Pb="clear"+vb;var Lb="updateSnippetDefinitions",Ab="loadAppInsights",K0="endpointUrl";var Lh="diagnosticLogInterval";var Ob="disableFlushOnBeforeUnload",Mb="disableFlushOnUnload";var la="config",Dr="context",Ah="push",m_="version",fs="queue",__="connectionString",Q0="instrumentationKey",Oh="appInsights",ey="disableIkeyDeprecationMessage",ty="getTransmissionControls",bu="onunloadFlush",iy="addHousekeepingBeforeUnload",Mh="indexOf";var ny,kb=[d_,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"];var ry=function(){function e(n){var t=this,i,o,s,l,u,d,f;Be(e,this,function(p){S(),l=""+(n.sv||n[m_]||""),n[fs]=n[fs]||[],n[m_]=n[m_]||2;var m=n[la]||{};if(m[__]){var g=m0(m[__]),v=g.ingestionendpoint;m[K0]=v?v+$o:m[K0],m[Q0]=g.instrumentationkey||m[Q0]}p[Oh]=new Am,o=new q0,i=new j0,s=new Y0,f=new qg,p.core=f;var C=ee(m[ey])?!0:m[ey];!m[__]&&!C&&ae(f.logger,1,106,"Instrumentation key support will end soon, see aka.ms/IkeyMigrate"),p[d_]=n,p[la]=m,E(),p[h_]=function(I){I===void 0&&(I=!0),Pa(f,function(){return"AISKU.flush"},function(){_e(f[ty](),function(z){_e(z,function(j){j[h_](I)})})},null,I)},p[bu]=function(I){I===void 0&&(I=!0),_e(f[ty](),function(z){_e(z,function(j){j[bu]?j[bu]():j[h_](I)})})},p[Ab]=function(I,z,j){I===void 0&&(I=!1);function k(De){if(De){var $="";ee(l)||($+=l),I&&($+=".lg"),p[Dr]&&p[Dr].internal&&(p[Dr].internal.snippetVer=$||"-"),lt(p,function(yt,He){xe(yt)&&!Le(He)&&yt&&yt[0]!=="_"&&Ni(kb,yt)===-1&&(De[yt]=He)})}}return I&&p[la].extensions&&p[la].extensions.length>0&&ri("Extensions not allowed in legacy mode"),Pa(p.core,function(){return"AISKU.loadAppInsights"},function(){var De=[];De[Ah](s),De[Ah](o),De[Ah](i),De[Ah](p[Oh]),f.initialize(p[la],De,z,j),p[Dr]=o[Dr],ny&&p[Dr]&&(p[Dr].internal.sdkSrc=ny),k(p[d_]),p.emptyQueue(),p[J0](),p[iy](p)}),p},p[Lb]=function(I){hg(I,p,function(z){return z&&Ni(kb,z)===-1})},p.emptyQueue=function(){try{if(st(p.snippet[fs])){for(var I=p.snippet[fs].length,z=0;z<I;z++){var j=p.snippet[fs][z];j()}p.snippet[fs]=void 0,delete p.snippet[fs]}}catch(De){var k={};De&&Le(De.toString)&&(k.exception=De.toString())}},p[iy]=function(I){if(Go()||Rf()){var z=function(){if(I[bu](!1),Le(t.core[p_])){var De=t.core[p_](Ha);if(De){var $=De.plugin;$&&$[Dr]&&$[Dr]._sessionManager&&$[Dr]._sessionManager.backup()}}},j=!1,k=I.appInsights[la].disablePageUnloadEvents;d||(d=Kn(u,f[f_]&&f[f_]())),I.appInsights.config[Ob]||(Gg(z,k,d)&&(j=!0),wd(z,k,d)&&(j=!0),!j&&!xg()&&ae(I[Oh].core.logger,1,19,"Could not add handler for beforeunload and pagehide")),!j&&!I.appInsights.config[Mb]&&wd(z,k,d)}},p.getSender=function(){return s},p.unload=function(I,z,j){p[bu](I),d&&(Wg(null,d),Zg(null,d)),f.unload&&f.unload(I,z,j)},Vo(p,p[Oh],[gb,Eb,Db,"trackPageViewPerformance",Nb,"_onerror",bb,xb,yb,Sb,Cb,Tb]),Vo(p,b,[wb,"addDependencyListener","addDependencyInitializer"]),Vo(p,f,[X0,J0,"stopPollingInternalLogs",p_,"addPlugin",f_,"addUnloadCb","getTraceCtx"]),Vo(p,function(){var I=o[Dr];return I?I.user:null},[Ib,Pb]);function E(){p.config[Lh]=p.config[Lh]&&p[la][Lh]>0?p[la][Lh]:1e4}function b(){return i}function S(){u=Ki("AISKU"),d=null,i=null,o=null,s=null,l=null}})}return e.prototype.addDependencyInitializer=function(n){return null},e}();(function(){var e=null,n=!1,t=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var i=(document||{}).currentScript;i&&(e=i.src)}catch{}if(e)try{var o=e.toLowerCase();if(o){for(var s="",l=0;l<t.length;l++)if(o[Mh](t[l])!==-1){s="cdn"+(l+1),o[Mh]("/scripts/")===-1&&(o[Mh]("/next/")!==-1?s+="-next":o[Mh]("/beta/")!==-1&&(s+="-beta")),ny=s+(n?".mod":"");break}}}catch{}})();var Pl=function(e){return e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical",e}(Pl||{});var $e=(()=>{class e{constructor(t,i,o){this.apiService=t,this.authService=i,this.activatedRoute=o,this.countrySubject=new Yt(null),this.countries=[],this.onUserChange=s=>{s&&this.getCountriesByUser(s)},this.getCountrySubscription=()=>this.countrySubject.asObservable(),this.onCountriesByUser=s=>l=>{this.countries=l,this.filterCountriesByUser(s)},this.filterCountryByCountryCodeISO3=s=>l=>l.countryCodeISO3===s,this.filterCountryByUser=s=>l=>s.countries.includes(l.countryCodeISO3),this.selectCountry=s=>{this.countrySubject.next(this.countries.find(this.filterCountryByCountryCodeISO3(s)))},this.activatedRoute.queryParams.subscribe(s=>{s?.countryCodeISO3?this.apiService.getCountries(null,!0).subscribe(l=>{this.countries=l,this.selectCountry(s?.countryCodeISO3)}):this.authService.getAuthSubscription().subscribe(this.onUserChange)})}getCountriesByUser(t){this.apiService.getCountries(t.countries.join(",")).subscribe(this.onCountriesByUser(t))}getAllCountries(){return this.apiService.getCountries(null,!0)}filterCountriesByUser(t){t?.countries?(this.countries=this.countries.filter(this.filterCountryByUser(t)).sort((i,o)=>i.countryName>o.countryName?1:-1),this.countries.length>0&&this.selectCountry(this.countries[0].countryCodeISO3)):this.countries=[]}static{this.\u0275fac=function(i){return new(i||e)(fe(ui),fe(Pn),fe(BC))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ei=(()=>{class e{constructor(t){this.countryService=t,this.log=sf?console.log:()=>{},this.onCountryChange=i=>{this.country=i},this.telemetryInitializer=i=>{Object.assign(i.data,{configuration:xt.configuration,version:xt.ibfSystemVersion,apiUrl:xt.apiUrl,referrer:document.referrer,country:this.country?this.country.countryCodeISO3:null})},this.countryService.getCountrySubscription().subscribe(this.onCountryChange),!(!xt.applicationInsightsInstrumentationKey||!xt.applicationInsightsUrl)&&(this.applicationInsights=new ry({config:{connectionString:`InstrumentationKey=${xt.applicationInsightsInstrumentationKey};IngestionEndpoint=${xt.applicationInsightsUrl}`,instrumentationKey:xt.applicationInsightsInstrumentationKey,enableAutoRouteTracking:!0}}),this.isApplicationInsightsEnabled=!0,this.applicationInsights.loadAppInsights(),this.applicationInsights.addTelemetryInitializer(this.telemetryInitializer))}logPageView(t){this.isApplicationInsightsEnabled?this.applicationInsights.trackPageView({name:t}):this.log("analyticsService logPageView",t)}logError(t,i){this.displayOnConsole(t,i)}logEvent(t,i){this.isApplicationInsightsEnabled?this.applicationInsights.trackEvent({name:t},i):this.log("analyticsService logEvent",t,i)}logException(t,i){this.isApplicationInsightsEnabled?this.applicationInsights.trackException({exception:t,severityLevel:i}):this.displayOnConsole(t,i)}logTrace(t,i){this.isApplicationInsightsEnabled?this.applicationInsights.trackTrace({message:t},i):this.log("analyticsService logTrace",t,i)}displayOnConsole(t,i=Pl.Error){switch(i){case Pl.Critical:case Pl.Error:console.error(t);break;case Pl.Warning:console.warn(t);break;case Pl.Information:console.log(t);break}}static{this.\u0275fac=function(i){return new(i||e)(fe($e))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var eL=Math.pow(10,8)*24*60*60*1e3,ZH=-eL,v_=6048e5,Rb=864e5,oy=6e4,kh=36e5;var tL=3600;var Fb=tL*24,jH=Fb*7,iL=Fb*365.2425,nL=iL/12,$H=nL*3,ay=Symbol.for("constructDateFrom");function Bi(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&ay in e?e[ay](n):e instanceof Date?new e.constructor(n):new Date(n)}function We(e,n){return Bi(n||e,e)}var rL={};function ms(){return rL}function ca(e,n){let t=ms(),i=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,o=We(e,n?.in),s=o.getDay(),l=(s<i?7:0)+s-i;return o.setDate(o.getDate()-l),o.setHours(0,0,0,0),o}function Ll(e,n){return ca(e,Tt(me({},n),{weekStartsOn:1}))}function g_(e,n){let t=We(e,n?.in),i=t.getFullYear(),o=Bi(t,0);o.setFullYear(i+1,0,4),o.setHours(0,0,0,0);let s=Ll(o),l=Bi(t,0);l.setFullYear(i,0,4),l.setHours(0,0,0,0);let u=Ll(l);return t.getTime()>=s.getTime()?i+1:t.getTime()>=u.getTime()?i:i-1}function sy(e){let n=We(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Ao(e,...n){let t=Bi.bind(null,e||n.find(i=>typeof i=="object"));return n.map(t)}function ly(e,n){let t=We(e,n?.in);return t.setHours(0,0,0,0),t}function y_(e,n,t){let[i,o]=Ao(t?.in,e,n),s=ly(i),l=ly(o),u=+s-sy(s),d=+l-sy(l);return Math.round((u-d)/Rb)}function Yb(e,n){let t=g_(e,n),i=Bi(n?.in||e,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),Ll(i)}function Bb(e,n){let t,i=n?.in;return e.forEach(o=>{!i&&typeof o=="object"&&(i=Bi.bind(null,o));let s=We(o,i);(!t||t<s||isNaN(+s))&&(t=s)}),Bi(i,t||NaN)}function S_(e,n){let t=+We(e)-+We(n);return t<0?-1:t>0?1:t}function Ub(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function zb(e){return!(!Ub(e)&&typeof e!="number"||isNaN(+We(e)))}function Hb(e,n,t){let[i,o]=Ao(t?.in,e,n),s=i.getFullYear()-o.getFullYear(),l=i.getMonth()-o.getMonth();return s*12+l}function Gb(e,n,t){let[i,o]=Ao(t?.in,e,n),s=Vb(i,o),l=Math.abs(y_(i,o));i.setDate(i.getDate()-s*l);let u=+(Vb(i,o)===-s),d=s*(l-u);return d===0?0:d}function Vb(e,n){let t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Wb(e){return n=>{let i=(e?Math[e]:Math.trunc)(n);return i===0?0:i}}function Zb(e,n,t){let[i,o]=Ao(t?.in,e,n),s=(+i-+o)/kh;return Wb(t?.roundingMethod)(s)}function jb(e,n){let t=We(e,n?.in);return t.setHours(23,59,59,999),t}function $b(e,n){let t=We(e,n?.in),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function qb(e,n){let t=We(e,n?.in);return+jb(t,n)==+$b(t,n)}function Xb(e,n,t){let[i,o,s]=Ao(t?.in,e,e,n),l=S_(o,s),u=Math.abs(Hb(o,s));if(u<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-l*u);let d=S_(o,s)===-l;qb(i)&&u===1&&S_(i,s)===1&&(d=!1);let f=l*(u-+d);return f===0?0:f}function Jb(e,n){let t=We(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}var oL={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Kb=(e,n,t)=>{let i,o=oL[e];return typeof o=="string"?i=o:n===1?i=o.one:i=o.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function C_(e){return(n={})=>{let t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}var aL={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sL={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lL={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Qb={date:C_({formats:aL,defaultWidth:"full"}),time:C_({formats:sL,defaultWidth:"full"}),dateTime:C_({formats:lL,defaultWidth:"full"})};var cL={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ex=(e,n,t,i)=>cL[e];function xu(e){return(n,t)=>{let i=t?.context?String(t.context):"standalone",o;if(i==="formatting"&&e.formattingValues){let l=e.defaultFormattingWidth||e.defaultWidth,u=t?.width?String(t.width):l;o=e.formattingValues[u]||e.formattingValues[l]}else{let l=e.defaultWidth,u=t?.width?String(t.width):e.defaultWidth;o=e.values[u]||e.values[l]}let s=e.argumentCallback?e.argumentCallback(n):n;return o[s]}}var uL={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},dL={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},hL={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},pL={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fL={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mL={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_L=(e,n)=>{let t=Number(e),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},tx={ordinalNumber:_L,era:xu({values:uL,defaultWidth:"wide"}),quarter:xu({values:dL,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xu({values:hL,defaultWidth:"wide"}),day:xu({values:pL,defaultWidth:"wide"}),dayPeriod:xu({values:fL,defaultWidth:"wide",formattingValues:mL,defaultFormattingWidth:"wide"})};function Du(e){return(n,t={})=>{let i=t.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=n.match(o);if(!s)return null;let l=s[0],u=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(u)?gL(u,m=>m.test(l)):vL(u,m=>m.test(l)),f;f=e.valueCallback?e.valueCallback(d):d,f=t.valueCallback?t.valueCallback(f):f;let p=n.slice(l.length);return{value:f,rest:p}}}function vL(e,n){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function gL(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function ix(e){return(n,t={})=>{let i=n.match(e.matchPattern);if(!i)return null;let o=i[0],s=n.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=t.valueCallback?t.valueCallback(l):l;let u=n.slice(o.length);return{value:l,rest:u}}}var yL=/^(\d+)(th|st|nd|rd)?/i,SL=/\d+/i,CL={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},TL={any:[/^b/i,/^(a|c)/i]},EL={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},bL={any:[/1/i,/2/i,/3/i,/4/i]},xL={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},DL={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},NL={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},wL={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},IL={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},PL={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nx={ordinalNumber:ix({matchPattern:yL,parsePattern:SL,valueCallback:e=>parseInt(e,10)}),era:Du({matchPatterns:CL,defaultMatchWidth:"wide",parsePatterns:TL,defaultParseWidth:"any"}),quarter:Du({matchPatterns:EL,defaultMatchWidth:"wide",parsePatterns:bL,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Du({matchPatterns:xL,defaultMatchWidth:"wide",parsePatterns:DL,defaultParseWidth:"any"}),day:Du({matchPatterns:NL,defaultMatchWidth:"wide",parsePatterns:wL,defaultParseWidth:"any"}),dayPeriod:Du({matchPatterns:IL,defaultMatchWidth:"any",parsePatterns:PL,defaultParseWidth:"any"})};var cy={code:"en-US",formatDistance:Kb,formatLong:Qb,formatRelative:ex,localize:tx,match:nx,options:{weekStartsOn:0,firstWeekContainsDate:1}};function rx(e,n){let t=We(e,n?.in);return y_(t,Jb(t))+1}function ox(e,n){let t=We(e,n?.in),i=+Ll(t)-+Yb(t);return Math.round(i/v_)+1}function T_(e,n){let t=We(e,n?.in),i=t.getFullYear(),o=ms(),s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,l=Bi(n?.in||e,0);l.setFullYear(i+1,0,s),l.setHours(0,0,0,0);let u=ca(l,n),d=Bi(n?.in||e,0);d.setFullYear(i,0,s),d.setHours(0,0,0,0);let f=ca(d,n);return+t>=+u?i+1:+t>=+f?i:i-1}function ax(e,n){let t=ms(),i=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,o=T_(e,n),s=Bi(n?.in||e,0);return s.setFullYear(o,0,i),s.setHours(0,0,0,0),ca(s,n)}function sx(e,n){let t=We(e,n?.in),i=+ca(t,n)-+ax(t,n);return Math.round(i/v_)+1}function Nt(e,n){let t=e<0?"-":"",i=Math.abs(e).toString().padStart(n,"0");return t+i}var ua={y(e,n){let t=e.getFullYear(),i=t>0?t:1-t;return Nt(n==="yy"?i%100:i,n.length)},M(e,n){let t=e.getMonth();return n==="M"?String(t+1):Nt(t+1,2)},d(e,n){return Nt(e.getDate(),n.length)},a(e,n){let t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Nt(e.getHours()%12||12,n.length)},H(e,n){return Nt(e.getHours(),n.length)},m(e,n){return Nt(e.getMinutes(),n.length)},s(e,n){return Nt(e.getSeconds(),n.length)},S(e,n){let t=n.length,i=e.getMilliseconds(),o=Math.trunc(i*Math.pow(10,t-3));return Nt(o,n.length)}};var Nu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},uy={G:function(e,n,t){let i=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(i,{width:"abbreviated"});case"GGGGG":return t.era(i,{width:"narrow"});case"GGGG":default:return t.era(i,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){let i=e.getFullYear(),o=i>0?i:1-i;return t.ordinalNumber(o,{unit:"year"})}return ua.y(e,n)},Y:function(e,n,t,i){let o=T_(e,i),s=o>0?o:1-o;if(n==="YY"){let l=s%100;return Nt(l,2)}return n==="Yo"?t.ordinalNumber(s,{unit:"year"}):Nt(s,n.length)},R:function(e,n){let t=g_(e);return Nt(t,n.length)},u:function(e,n){let t=e.getFullYear();return Nt(t,n.length)},Q:function(e,n,t){let i=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return Nt(i,2);case"Qo":return t.ordinalNumber(i,{unit:"quarter"});case"QQQ":return t.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,n,t){let i=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return Nt(i,2);case"qo":return t.ordinalNumber(i,{unit:"quarter"});case"qqq":return t.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,n,t){let i=e.getMonth();switch(n){case"M":case"MM":return ua.M(e,n);case"Mo":return t.ordinalNumber(i+1,{unit:"month"});case"MMM":return t.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(i,{width:"wide",context:"formatting"})}},L:function(e,n,t){let i=e.getMonth();switch(n){case"L":return String(i+1);case"LL":return Nt(i+1,2);case"Lo":return t.ordinalNumber(i+1,{unit:"month"});case"LLL":return t.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(i,{width:"wide",context:"standalone"})}},w:function(e,n,t,i){let o=sx(e,i);return n==="wo"?t.ordinalNumber(o,{unit:"week"}):Nt(o,n.length)},I:function(e,n,t){let i=ox(e);return n==="Io"?t.ordinalNumber(i,{unit:"week"}):Nt(i,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):ua.d(e,n)},D:function(e,n,t){let i=rx(e);return n==="Do"?t.ordinalNumber(i,{unit:"dayOfYear"}):Nt(i,n.length)},E:function(e,n,t){let i=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(i,{width:"short",context:"formatting"});case"EEEE":default:return t.day(i,{width:"wide",context:"formatting"})}},e:function(e,n,t,i){let o=e.getDay(),s=(o-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(s);case"ee":return Nt(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(o,{width:"short",context:"formatting"});case"eeee":default:return t.day(o,{width:"wide",context:"formatting"})}},c:function(e,n,t,i){let o=e.getDay(),s=(o-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(s);case"cc":return Nt(s,n.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(o,{width:"narrow",context:"standalone"});case"cccccc":return t.day(o,{width:"short",context:"standalone"});case"cccc":default:return t.day(o,{width:"wide",context:"standalone"})}},i:function(e,n,t){let i=e.getDay(),o=i===0?7:i;switch(n){case"i":return String(o);case"ii":return Nt(o,n.length);case"io":return t.ordinalNumber(o,{unit:"day"});case"iii":return t.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(i,{width:"short",context:"formatting"});case"iiii":default:return t.day(i,{width:"wide",context:"formatting"})}},a:function(e,n,t){let o=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,n,t){let i=e.getHours(),o;switch(i===12?o=Nu.noon:i===0?o=Nu.midnight:o=i/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,n,t){let i=e.getHours(),o;switch(i>=17?o=Nu.evening:i>=12?o=Nu.afternoon:i>=4?o=Nu.morning:o=Nu.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let i=e.getHours()%12;return i===0&&(i=12),t.ordinalNumber(i,{unit:"hour"})}return ua.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):ua.H(e,n)},K:function(e,n,t){let i=e.getHours()%12;return n==="Ko"?t.ordinalNumber(i,{unit:"hour"}):Nt(i,n.length)},k:function(e,n,t){let i=e.getHours();return i===0&&(i=24),n==="ko"?t.ordinalNumber(i,{unit:"hour"}):Nt(i,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):ua.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):ua.s(e,n)},S:function(e,n){return ua.S(e,n)},X:function(e,n,t){let i=e.getTimezoneOffset();if(i===0)return"Z";switch(n){case"X":return cx(i);case"XXXX":case"XX":return Al(i);case"XXXXX":case"XXX":default:return Al(i,":")}},x:function(e,n,t){let i=e.getTimezoneOffset();switch(n){case"x":return cx(i);case"xxxx":case"xx":return Al(i);case"xxxxx":case"xxx":default:return Al(i,":")}},O:function(e,n,t){let i=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+lx(i,":");case"OOOO":default:return"GMT"+Al(i,":")}},z:function(e,n,t){let i=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+lx(i,":");case"zzzz":default:return"GMT"+Al(i,":")}},t:function(e,n,t){let i=Math.trunc(+e/1e3);return Nt(i,n.length)},T:function(e,n,t){return Nt(+e,n.length)}};function lx(e,n=""){let t=e>0?"-":"+",i=Math.abs(e),o=Math.trunc(i/60),s=i%60;return s===0?t+String(o):t+String(o)+n+Nt(s,2)}function cx(e,n){return e%60===0?(e>0?"-":"+")+Nt(Math.abs(e)/60,2):Al(e,n)}function Al(e,n=""){let t=e>0?"-":"+",i=Math.abs(e),o=Nt(Math.trunc(i/60),2),s=Nt(i%60,2);return t+o+n+s}var ux=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},dx=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},LL=(e,n)=>{let t=e.match(/(P+)(p+)?/)||[],i=t[1],o=t[2];if(!o)return ux(e,n);let s;switch(i){case"P":s=n.dateTime({width:"short"});break;case"PP":s=n.dateTime({width:"medium"});break;case"PPP":s=n.dateTime({width:"long"});break;case"PPPP":default:s=n.dateTime({width:"full"});break}return s.replace("{{date}}",ux(i,n)).replace("{{time}}",dx(o,n))},hx={p:dx,P:LL};var AL=/^D+$/,OL=/^Y+$/,ML=["D","DD","YY","YYYY"];function px(e){return AL.test(e)}function fx(e){return OL.test(e)}function mx(e,n,t){let i=kL(e,n,t);if(console.warn(i),ML.includes(e))throw new RangeError(i)}function kL(e,n,t){let i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${i} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var RL=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,FL=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,YL=/^'([^]*?)'?$/,BL=/''/g,UL=/[a-zA-Z]/;function _x(e,n,t){let i=ms(),o=t?.locale??i.locale??cy,s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,u=We(e,t?.in);if(!zb(u))throw new RangeError("Invalid time value");let d=n.match(FL).map(p=>{let m=p[0];if(m==="p"||m==="P"){let g=hx[m];return g(p,o.formatLong)}return p}).join("").match(RL).map(p=>{if(p==="''")return{isToken:!1,value:"'"};let m=p[0];if(m==="'")return{isToken:!1,value:zL(p)};if(uy[m])return{isToken:!0,value:p};if(m.match(UL))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});o.localize.preprocessor&&(d=o.localize.preprocessor(u,d));let f={firstWeekContainsDate:s,weekStartsOn:l,locale:o};return d.map(p=>{if(!p.isToken)return p.value;let m=p.value;(!t?.useAdditionalWeekYearTokens&&fx(m)||!t?.useAdditionalDayOfYearTokens&&px(m))&&mx(m,n,String(e));let g=uy[m[0]];return g(u,m,o.localize,f)}).join("")}function zL(e){let n=e.match(YL);return n?n[1].replace(BL,"'"):e}function E_(e,n){return+We(e)>+We(n)}function vx(e,n){return+We(e)<+We(n)}function gx(e,n){return+We(e)==+We(n)}function wu(e,n){let t=()=>Bi(n?.in,NaN),i=n?.additionalDigits??2,o=WL(e),s;if(o.date){let f=ZL(o.date,i);s=jL(f.restDateString,f.year)}if(!s||isNaN(+s))return t();let l=+s,u=0,d;if(o.time&&(u=$L(o.time),isNaN(u)))return t();if(o.timezone){if(d=qL(o.timezone),isNaN(d))return t()}else{let f=new Date(l+u),p=We(0,n?.in);return p.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),p.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),p}return We(l+u+d,n?.in)}var b_={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},HL=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,VL=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,GL=/^([+-])(\d{2})(?::?(\d{2}))?$/;function WL(e){let n={},t=e.split(b_.dateTimeDelimiter),i;if(t.length>2)return n;if(/:/.test(t[0])?i=t[0]:(n.date=t[0],i=t[1],b_.timeZoneDelimiter.test(n.date)&&(n.date=e.split(b_.timeZoneDelimiter)[0],i=e.substr(n.date.length,e.length))),i){let o=b_.timezone.exec(i);o?(n.time=i.replace(o[1],""),n.timezone=o[1]):n.time=i}return n}function ZL(e,n){let t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),i=e.match(t);if(!i)return{year:NaN,restDateString:""};let o=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?o:s*100,restDateString:e.slice((i[1]||i[2]).length)}}function jL(e,n){if(n===null)return new Date(NaN);let t=e.match(HL);if(!t)return new Date(NaN);let i=!!t[4],o=Rh(t[1]),s=Rh(t[2])-1,l=Rh(t[3]),u=Rh(t[4]),d=Rh(t[5])-1;if(i)return eA(n,u,d)?XL(n,u,d):new Date(NaN);{let f=new Date(0);return!KL(n,s,l)||!QL(n,o)?new Date(NaN):(f.setUTCFullYear(n,s,Math.max(o,l)),f)}}function Rh(e){return e?parseInt(e):1}function $L(e){let n=e.match(VL);if(!n)return NaN;let t=dy(n[1]),i=dy(n[2]),o=dy(n[3]);return tA(t,i,o)?t*kh+i*oy+o*1e3:NaN}function dy(e){return e&&parseFloat(e.replace(",","."))||0}function qL(e){if(e==="Z")return 0;let n=e.match(GL);if(!n)return 0;let t=n[1]==="+"?-1:1,i=parseInt(n[2]),o=n[3]&&parseInt(n[3])||0;return iA(i,o)?t*(i*kh+o*oy):NaN}function XL(e,n,t){let i=new Date(0);i.setUTCFullYear(e,0,4);let o=i.getUTCDay()||7,s=(n-1)*7+t+1-o;return i.setUTCDate(i.getUTCDate()+s),i}var JL=[31,null,31,30,31,30,31,31,30,31,30,31];function yx(e){return e%400===0||e%4===0&&e%100!==0}function KL(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(JL[n]||(yx(e)?29:28))}function QL(e,n){return n>=1&&n<=(yx(e)?366:365)}function eA(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function tA(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function iA(e,n){return n>=0&&n<=59}var da=class extends Error{},x_=class extends da{constructor(n){super(`Invalid DateTime: ${n.toMessage()}`)}},D_=class extends da{constructor(n){super(`Invalid Interval: ${n.toMessage()}`)}},N_=class extends da{constructor(n){super(`Invalid Duration: ${n.toMessage()}`)}},to=class extends da{},Iu=class extends da{constructor(n){super(`Invalid unit ${n}`)}},pi=class extends da{},io=class extends da{constructor(){super("Zone is an abstract class")}};var he="numeric",no="short",rr="long",_s={year:he,month:he,day:he},Fh={year:he,month:no,day:he},hy={year:he,month:no,day:he,weekday:no},Yh={year:he,month:rr,day:he},Bh={year:he,month:rr,day:he,weekday:rr},Uh={hour:he,minute:he},zh={hour:he,minute:he,second:he},Hh={hour:he,minute:he,second:he,timeZoneName:no},Vh={hour:he,minute:he,second:he,timeZoneName:rr},Gh={hour:he,minute:he,hourCycle:"h23"},Wh={hour:he,minute:he,second:he,hourCycle:"h23"},Zh={hour:he,minute:he,second:he,hourCycle:"h23",timeZoneName:no},jh={hour:he,minute:he,second:he,hourCycle:"h23",timeZoneName:rr},$h={year:he,month:he,day:he,hour:he,minute:he},qh={year:he,month:he,day:he,hour:he,minute:he,second:he},Xh={year:he,month:no,day:he,hour:he,minute:he},Jh={year:he,month:no,day:he,hour:he,minute:he,second:he},py={year:he,month:no,day:he,weekday:no,hour:he,minute:he},Kh={year:he,month:rr,day:he,hour:he,minute:he,timeZoneName:no},Qh={year:he,month:rr,day:he,hour:he,minute:he,second:he,timeZoneName:no},ep={year:he,month:rr,day:he,weekday:rr,hour:he,minute:he,timeZoneName:rr},tp={year:he,month:rr,day:he,weekday:rr,hour:he,minute:he,second:he,timeZoneName:rr};var or=class{get type(){throw new io}get name(){throw new io}get ianaName(){return this.name}get isUniversal(){throw new io}offsetName(n,t){throw new io}formatOffset(n,t){throw new io}offset(n){throw new io}equals(n){throw new io}get isValid(){throw new io}};var fy=null,Ol=class e extends or{static get instance(){return fy===null&&(fy=new e),fy}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(n,{format:t,locale:i}){return I_(n,t,i)}formatOffset(n,t){return vs(this.offset(n),t)}offset(n){return-new Date(n).getTimezoneOffset()}equals(n){return n.type==="system"}get isValid(){return!0}};var _y=new Map;function nA(e){let n=_y.get(e);return n===void 0&&(n=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),_y.set(e,n)),n}var rA={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function oA(e,n){let t=e.format(n).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,o,s,l,u,d,f,p]=i;return[l,o,s,u,d,f,p]}function aA(e,n){let t=e.formatToParts(n),i=[];for(let o=0;o<t.length;o++){let{type:s,value:l}=t[o],u=rA[s];s==="era"?i[u]=l:Ae(u)||(i[u]=parseInt(l,10))}return i}var my=new Map,xn=class e extends or{static create(n){let t=my.get(n);return t===void 0&&my.set(n,t=new e(n)),t}static resetCache(){my.clear(),_y.clear()}static isValidSpecifier(n){return this.isValidZone(n)}static isValidZone(n){if(!n)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:n}).format(),!0}catch{return!1}}constructor(n){super(),this.zoneName=n,this.valid=e.isValidZone(n)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(n,{format:t,locale:i}){return I_(n,t,i,this.name)}formatOffset(n,t){return vs(this.offset(n),t)}offset(n){if(!this.valid)return NaN;let t=new Date(n);if(isNaN(t))return NaN;let i=nA(this.name),[o,s,l,u,d,f,p]=i.formatToParts?aA(i,t):oA(i,t);u==="BC"&&(o=-Math.abs(o)+1);let g=Pu({year:o,month:s,day:l,hour:d===24?0:d,minute:f,second:p,millisecond:0}),v=+t,C=v%1e3;return v-=C>=0?C:1e3+C,(g-v)/(60*1e3)}equals(n){return n.type==="iana"&&n.name===this.name}get isValid(){return this.valid}};var Sx={};function sA(e,n={}){let t=JSON.stringify([e,n]),i=Sx[t];return i||(i=new Intl.ListFormat(e,n),Sx[t]=i),i}var vy=new Map;function gy(e,n={}){let t=JSON.stringify([e,n]),i=vy.get(t);return i===void 0&&(i=new Intl.DateTimeFormat(e,n),vy.set(t,i)),i}var yy=new Map;function lA(e,n={}){let t=JSON.stringify([e,n]),i=yy.get(t);return i===void 0&&(i=new Intl.NumberFormat(e,n),yy.set(t,i)),i}var Sy=new Map;function cA(e,n={}){let l=n,{base:t}=l,i=Lv(l,["base"]),o=JSON.stringify([e,i]),s=Sy.get(o);return s===void 0&&(s=new Intl.RelativeTimeFormat(e,n),Sy.set(o,s)),s}var ip=null;function uA(){return ip||(ip=new Intl.DateTimeFormat().resolvedOptions().locale,ip)}var Cy=new Map;function Cx(e){let n=Cy.get(e);return n===void 0&&(n=new Intl.DateTimeFormat(e).resolvedOptions(),Cy.set(e,n)),n}var Ty=new Map;function dA(e){let n=Ty.get(e);if(!n){let t=new Intl.Locale(e);n="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,"minimalDays"in n||(n=me(me({},Tx),n)),Ty.set(e,n)}return n}function hA(e){let n=e.indexOf("-x-");n!==-1&&(e=e.substring(0,n));let t=e.indexOf("-u-");if(t===-1)return[e];{let i,o;try{i=gy(e).resolvedOptions(),o=e}catch{let d=e.substring(0,t);i=gy(d).resolvedOptions(),o=d}let{numberingSystem:s,calendar:l}=i;return[o,s,l]}}function pA(e,n,t){return(t||n)&&(e.includes("-u-")||(e+="-u"),t&&(e+=`-ca-${t}`),n&&(e+=`-nu-${n}`)),e}function fA(e){let n=[];for(let t=1;t<=12;t++){let i=Fe.utc(2009,t,1);n.push(e(i))}return n}function mA(e){let n=[];for(let t=1;t<=7;t++){let i=Fe.utc(2016,11,13+t);n.push(e(i))}return n}function P_(e,n,t,i){let o=e.listingMode();return o==="error"?null:o==="en"?t(n):i(n)}function _A(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||Cx(e.locale).numberingSystem==="latn"}var Ey=class{constructor(n,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;let u=i,{padTo:o,floor:s}=u,l=Lv(u,["padTo","floor"]);if(!t||Object.keys(l).length>0){let d=me({useGrouping:!1},i);i.padTo>0&&(d.minimumIntegerDigits=i.padTo),this.inf=lA(n,d)}}format(n){if(this.inf){let t=this.floor?Math.floor(n):n;return this.inf.format(t)}else{let t=this.floor?Math.floor(n):Lu(n,3);return ai(t,this.padTo)}}},by=class{constructor(n,t,i){this.opts=i,this.originalZone=void 0;let o;if(this.opts.timeZone)this.dt=n;else if(n.zone.type==="fixed"){let l=-1*(n.offset/60),u=l>=0?`Etc/GMT+${l}`:`Etc/GMT${l}`;n.offset!==0&&xn.create(u).valid?(o=u,this.dt=n):(o="UTC",this.dt=n.offset===0?n:n.setZone("UTC").plus({minutes:n.offset}),this.originalZone=n.zone)}else n.zone.type==="system"?this.dt=n:n.zone.type==="iana"?(this.dt=n,o=n.zone.name):(o="UTC",this.dt=n.setZone("UTC").plus({minutes:n.offset}),this.originalZone=n.zone);let s=me({},this.opts);s.timeZone=s.timeZone||o,this.dtf=gy(t,s)}format(){return this.originalZone?this.formatToParts().map(({value:n})=>n).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let n=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?n.map(t=>{if(t.type==="timeZoneName"){let i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return Tt(me({},t),{value:i})}else return t}):n}resolvedOptions(){return this.dtf.resolvedOptions()}},xy=class{constructor(n,t,i){this.opts=me({style:"long"},i),!t&&L_()&&(this.rtf=cA(n,i))}format(n,t){return this.rtf?this.rtf.format(n,t):Ex(t,n,this.opts.numeric,this.opts.style!=="long")}formatToParts(n,t){return this.rtf?this.rtf.formatToParts(n,t):[]}},Tx={firstDay:1,minimalDays:4,weekend:[6,7]},It=class e{static fromOpts(n){return e.create(n.locale,n.numberingSystem,n.outputCalendar,n.weekSettings,n.defaultToEN)}static create(n,t,i,o,s=!1){let l=n||wt.defaultLocale,u=l||(s?"en-US":uA()),d=t||wt.defaultNumberingSystem,f=i||wt.defaultOutputCalendar,p=np(o)||wt.defaultWeekSettings;return new e(u,d,f,p,l)}static resetCache(){ip=null,vy.clear(),yy.clear(),Sy.clear(),Cy.clear(),Ty.clear()}static fromObject({locale:n,numberingSystem:t,outputCalendar:i,weekSettings:o}={}){return e.create(n,t,i,o)}constructor(n,t,i,o,s){let[l,u,d]=hA(n);this.locale=l,this.numberingSystem=t||u||null,this.outputCalendar=i||d||null,this.weekSettings=o,this.intl=pA(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=_A(this)),this.fastNumbersCached}listingMode(){let n=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return n&&t?"en":"intl"}clone(n){return!n||Object.getOwnPropertyNames(n).length===0?this:e.create(n.locale||this.specifiedLocale,n.numberingSystem||this.numberingSystem,n.outputCalendar||this.outputCalendar,np(n.weekSettings)||this.weekSettings,n.defaultToEN||!1)}redefaultToEN(n={}){return this.clone(Tt(me({},n),{defaultToEN:!0}))}redefaultToSystem(n={}){return this.clone(Tt(me({},n),{defaultToEN:!1}))}months(n,t=!1){return P_(this,n,Dy,()=>{let i=t?{month:n,day:"numeric"}:{month:n},o=t?"format":"standalone";return this.monthsCache[o][n]||(this.monthsCache[o][n]=fA(s=>this.extract(s,i,"month"))),this.monthsCache[o][n]})}weekdays(n,t=!1){return P_(this,n,Ny,()=>{let i=t?{weekday:n,year:"numeric",month:"long",day:"numeric"}:{weekday:n},o=t?"format":"standalone";return this.weekdaysCache[o][n]||(this.weekdaysCache[o][n]=mA(s=>this.extract(s,i,"weekday"))),this.weekdaysCache[o][n]})}meridiems(){return P_(this,void 0,()=>wy,()=>{if(!this.meridiemCache){let n={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Fe.utc(2016,11,13,9),Fe.utc(2016,11,13,19)].map(t=>this.extract(t,n,"dayperiod"))}return this.meridiemCache})}eras(n){return P_(this,n,Iy,()=>{let t={era:n};return this.eraCache[n]||(this.eraCache[n]=[Fe.utc(-40,1,1),Fe.utc(2017,1,1)].map(i=>this.extract(i,t,"era"))),this.eraCache[n]})}extract(n,t,i){let o=this.dtFormatter(n,t),s=o.formatToParts(),l=s.find(u=>u.type.toLowerCase()===i);return l?l.value:null}numberFormatter(n={}){return new Ey(this.intl,n.forceSimple||this.fastNumbers,n)}dtFormatter(n,t={}){return new by(n,this.intl,t)}relFormatter(n={}){return new xy(this.intl,this.isEnglish(),n)}listFormatter(n={}){return sA(this.intl,n)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||Cx(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:A_()?dA(this.locale):Tx}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(n){return this.locale===n.locale&&this.numberingSystem===n.numberingSystem&&this.outputCalendar===n.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}};var Ly=null,cn=class e extends or{static get utcInstance(){return Ly===null&&(Ly=new e(0)),Ly}static instance(n){return n===0?e.utcInstance:new e(n)}static parseSpecifier(n){if(n){let t=n.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new e(Ml(t[1],t[2]))}return null}constructor(n){super(),this.fixed=n}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${vs(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${vs(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(n,t){return vs(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(n){return n.type==="fixed"&&n.fixed===this.fixed}get isValid(){return!0}};var rp=class extends or{constructor(n){super(),this.zoneName=n}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function ro(e,n){let t;if(Ae(e)||e===null)return n;if(e instanceof or)return e;if(bx(e)){let i=e.toLowerCase();return i==="default"?n:i==="local"||i==="system"?Ol.instance:i==="utc"||i==="gmt"?cn.utcInstance:cn.parseSpecifier(i)||xn.create(e)}else return oo(e)?cn.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new rp(e)}var Oy={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},xx={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},vA=Oy.hanidec.replace(/[\[|\]]/g,"").split("");function Dx(e){let n=parseInt(e,10);if(isNaN(n)){n="";for(let t=0;t<e.length;t++){let i=e.charCodeAt(t);if(e[t].search(Oy.hanidec)!==-1)n+=vA.indexOf(e[t]);else for(let o in xx){let[s,l]=xx[o];i>=s&&i<=l&&(n+=i-s)}}return parseInt(n,10)}else return n}var Ay=new Map;function Nx(){Ay.clear()}function wr({numberingSystem:e},n=""){let t=e||"latn",i=Ay.get(t);i===void 0&&(i=new Map,Ay.set(t,i));let o=i.get(n);return o===void 0&&(o=new RegExp(`${Oy[t]}${n}`),i.set(n,o)),o}var wx=()=>Date.now(),Ix="system",Px=null,Lx=null,Ax=null,Ox=60,Mx,kx=null,wt=class{static get now(){return wx}static set now(n){wx=n}static set defaultZone(n){Ix=n}static get defaultZone(){return ro(Ix,Ol.instance)}static get defaultLocale(){return Px}static set defaultLocale(n){Px=n}static get defaultNumberingSystem(){return Lx}static set defaultNumberingSystem(n){Lx=n}static get defaultOutputCalendar(){return Ax}static set defaultOutputCalendar(n){Ax=n}static get defaultWeekSettings(){return kx}static set defaultWeekSettings(n){kx=np(n)}static get twoDigitCutoffYear(){return Ox}static set twoDigitCutoffYear(n){Ox=n%100}static get throwOnInvalid(){return Mx}static set throwOnInvalid(n){Mx=n}static resetCaches(){It.resetCache(),xn.resetCache(),Fe.resetCache(),Nx()}};var un=class{constructor(n,t){this.reason=n,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}};var Rx=[0,31,59,90,120,151,181,212,243,273,304,334],Fx=[0,31,60,91,121,152,182,213,244,274,305,335];function Ir(e,n){return new un("unit out of range",`you specified ${n} (of type ${typeof n}) as a ${e}, which is invalid`)}function O_(e,n,t){let i=new Date(Date.UTC(e,n-1,t));e<100&&e>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);let o=i.getUTCDay();return o===0?7:o}function Yx(e,n,t){return t+(Rl(e)?Fx:Rx)[n-1]}function Bx(e,n){let t=Rl(e)?Fx:Rx,i=t.findIndex(s=>s<n),o=n-t[i];return{month:i+1,day:o}}function M_(e,n){return(e-n+7)%7+1}function op(e,n=4,t=1){let{year:i,month:o,day:s}=e,l=Yx(i,o,s),u=M_(O_(i,o,s),t),d=Math.floor((l-u+14-n)/7),f;return d<1?(f=i-1,d=kl(f,n,t)):d>kl(i,n,t)?(f=i+1,d=1):f=i,me({weekYear:f,weekNumber:d,weekday:u},sp(e))}function My(e,n=4,t=1){let{weekYear:i,weekNumber:o,weekday:s}=e,l=M_(O_(i,1,n),t),u=gs(i),d=o*7+s-l-7+n,f;d<1?(f=i-1,d+=gs(f)):d>u?(f=i+1,d-=gs(i)):f=i;let{month:p,day:m}=Bx(f,d);return me({year:f,month:p,day:m},sp(e))}function k_(e){let{year:n,month:t,day:i}=e,o=Yx(n,t,i);return me({year:n,ordinal:o},sp(e))}function ky(e){let{year:n,ordinal:t}=e,{month:i,day:o}=Bx(n,t);return me({year:n,month:i,day:o},sp(e))}function Ry(e,n){if(!Ae(e.localWeekday)||!Ae(e.localWeekNumber)||!Ae(e.localWeekYear)){if(!Ae(e.weekday)||!Ae(e.weekNumber)||!Ae(e.weekYear))throw new to("Cannot mix locale-based week fields with ISO-based week fields");return Ae(e.localWeekday)||(e.weekday=e.localWeekday),Ae(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),Ae(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:n.getMinDaysInFirstWeek(),startOfWeek:n.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Ux(e,n=4,t=1){let i=ap(e.weekYear),o=ar(e.weekNumber,1,kl(e.weekYear,n,t)),s=ar(e.weekday,1,7);return i?o?s?!1:Ir("weekday",e.weekday):Ir("week",e.weekNumber):Ir("weekYear",e.weekYear)}function zx(e){let n=ap(e.year),t=ar(e.ordinal,1,gs(e.year));return n?t?!1:Ir("ordinal",e.ordinal):Ir("year",e.year)}function Fy(e){let n=ap(e.year),t=ar(e.month,1,12),i=ar(e.day,1,Au(e.year,e.month));return n?t?i?!1:Ir("day",e.day):Ir("month",e.month):Ir("year",e.year)}function Yy(e){let{hour:n,minute:t,second:i,millisecond:o}=e,s=ar(n,0,23)||n===24&&t===0&&i===0&&o===0,l=ar(t,0,59),u=ar(i,0,59),d=ar(o,0,999);return s?l?u?d?!1:Ir("millisecond",o):Ir("second",i):Ir("minute",t):Ir("hour",n)}function Ae(e){return typeof e>"u"}function oo(e){return typeof e=="number"}function ap(e){return typeof e=="number"&&e%1===0}function bx(e){return typeof e=="string"}function Vx(e){return Object.prototype.toString.call(e)==="[object Date]"}function L_(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function A_(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function Gx(e){return Array.isArray(e)?e:[e]}function By(e,n,t){if(e.length!==0)return e.reduce((i,o)=>{let s=[n(o),o];return i&&t(i[0],s[0])===i[0]?i:s},null)[1]}function Wx(e,n){return n.reduce((t,i)=>(t[i]=e[i],t),{})}function ys(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function np(e){if(e==null)return null;if(typeof e!="object")throw new pi("Week settings must be an object");if(!ar(e.firstDay,1,7)||!ar(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(n=>!ar(n,1,7)))throw new pi("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function ar(e,n,t){return ap(e)&&e>=n&&e<=t}function gA(e,n){return e-n*Math.floor(e/n)}function ai(e,n=2){let t=e<0,i;return t?i="-"+(""+-e).padStart(n,"0"):i=(""+e).padStart(n,"0"),i}function ha(e){if(!(Ae(e)||e===null||e===""))return parseInt(e,10)}function Ss(e){if(!(Ae(e)||e===null||e===""))return parseFloat(e)}function lp(e){if(!(Ae(e)||e===null||e==="")){let n=parseFloat("0."+e)*1e3;return Math.floor(n)}}function Lu(e,n,t=!1){let i=10**n;return(t?Math.trunc:Math.round)(e*i)/i}function Rl(e){return e%4===0&&(e%100!==0||e%400===0)}function gs(e){return Rl(e)?366:365}function Au(e,n){let t=gA(n-1,12)+1,i=e+(n-t)/12;return t===2?Rl(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Pu(e){let n=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(n=new Date(n),n.setUTCFullYear(e.year,e.month-1,e.day)),+n}function Hx(e,n,t){return-M_(O_(e,1,n),t)+n-1}function kl(e,n=4,t=1){let i=Hx(e,n,t),o=Hx(e+1,n,t);return(gs(e)-i+o)/7}function cp(e){return e>99?e:e>wt.twoDigitCutoffYear?1900+e:2e3+e}function I_(e,n,t,i=null){let o=new Date(e),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(s.timeZone=i);let l=me({timeZoneName:n},s),u=new Intl.DateTimeFormat(t,l).formatToParts(o).find(d=>d.type.toLowerCase()==="timezonename");return u?u.value:null}function Ml(e,n){let t=parseInt(e,10);Number.isNaN(t)&&(t=0);let i=parseInt(n,10)||0,o=t<0||Object.is(t,-0)?-i:i;return t*60+o}function Uy(e){let n=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(n))throw new pi(`Invalid unit value ${e}`);return n}function Ou(e,n){let t={};for(let i in e)if(ys(e,i)){let o=e[i];if(o==null)continue;t[n(i)]=Uy(o)}return t}function vs(e,n){let t=Math.trunc(Math.abs(e/60)),i=Math.trunc(Math.abs(e%60)),o=e>=0?"+":"-";switch(n){case"short":return`${o}${ai(t,2)}:${ai(i,2)}`;case"narrow":return`${o}${t}${i>0?`:${i}`:""}`;case"techie":return`${o}${ai(t,2)}${ai(i,2)}`;default:throw new RangeError(`Value format ${n} is out of range for property format`)}}function sp(e){return Wx(e,["hour","minute","second","millisecond"])}var yA=["January","February","March","April","May","June","July","August","September","October","November","December"],zy=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],SA=["J","F","M","A","M","J","J","A","S","O","N","D"];function Dy(e){switch(e){case"narrow":return[...SA];case"short":return[...zy];case"long":return[...yA];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Hy=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Vy=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],CA=["M","T","W","T","F","S","S"];function Ny(e){switch(e){case"narrow":return[...CA];case"short":return[...Vy];case"long":return[...Hy];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var wy=["AM","PM"],TA=["Before Christ","Anno Domini"],EA=["BC","AD"],bA=["B","A"];function Iy(e){switch(e){case"narrow":return[...bA];case"short":return[...EA];case"long":return[...TA];default:return null}}function Zx(e){return wy[e.hour<12?0:1]}function jx(e,n){return Ny(n)[e.weekday-1]}function $x(e,n){return Dy(n)[e.month-1]}function qx(e,n){return Iy(n)[e.year<0?0:1]}function Ex(e,n,t="always",i=!1){let o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(e)===-1;if(t==="auto"&&s){let m=e==="days";switch(n){case 1:return m?"tomorrow":`next ${o[e][0]}`;case-1:return m?"yesterday":`last ${o[e][0]}`;case 0:return m?"today":`this ${o[e][0]}`;default:}}let l=Object.is(n,-0)||n<0,u=Math.abs(n),d=u===1,f=o[e],p=i?d?f[1]:f[2]||f[1]:d?o[e][0]:e;return l?`${u} ${p} ago`:`in ${u} ${p}`}function Xx(e,n){let t="";for(let i of e)i.literal?t+=i.val:t+=n(i.val);return t}var xA={D:_s,DD:Fh,DDD:Yh,DDDD:Bh,t:Uh,tt:zh,ttt:Hh,tttt:Vh,T:Gh,TT:Wh,TTT:Zh,TTTT:jh,f:$h,ff:Xh,fff:Kh,ffff:ep,F:qh,FF:Jh,FFF:Qh,FFFF:tp},dn=class e{static create(n,t={}){return new e(n,t)}static parseFormat(n){let t=null,i="",o=!1,s=[];for(let l=0;l<n.length;l++){let u=n.charAt(l);u==="'"?(i.length>0&&s.push({literal:o||/^\s+$/.test(i),val:i}),t=null,i="",o=!o):o||u===t?i+=u:(i.length>0&&s.push({literal:/^\s+$/.test(i),val:i}),i=u,t=u)}return i.length>0&&s.push({literal:o||/^\s+$/.test(i),val:i}),s}static macroTokenToFormatOpts(n){return xA[n]}constructor(n,t){this.opts=t,this.loc=n,this.systemLoc=null}formatWithSystemDefault(n,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(n,me(me({},this.opts),t)).format()}dtFormatter(n,t={}){return this.loc.dtFormatter(n,me(me({},this.opts),t))}formatDateTime(n,t){return this.dtFormatter(n,t).format()}formatDateTimeParts(n,t){return this.dtFormatter(n,t).formatToParts()}formatInterval(n,t){return this.dtFormatter(n.start,t).dtf.formatRange(n.start.toJSDate(),n.end.toJSDate())}resolvedOptions(n,t){return this.dtFormatter(n,t).resolvedOptions()}num(n,t=0){if(this.opts.forceSimple)return ai(n,t);let i=me({},this.opts);return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(n)}formatDateTimeFromString(n,t){let i=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(v,C)=>this.loc.extract(n,v,C),l=v=>n.isOffsetFixed&&n.offset===0&&v.allowZ?"Z":n.isValid?n.zone.formatOffset(n.ts,v.format):"",u=()=>i?Zx(n):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),d=(v,C)=>i?$x(n,v):s(C?{month:v}:{month:v,day:"numeric"},"month"),f=(v,C)=>i?jx(n,v):s(C?{weekday:v}:{weekday:v,month:"long",day:"numeric"},"weekday"),p=v=>{let C=e.macroTokenToFormatOpts(v);return C?this.formatWithSystemDefault(n,C):v},m=v=>i?qx(n,v):s({era:v},"era"),g=v=>{switch(v){case"S":return this.num(n.millisecond);case"u":case"SSS":return this.num(n.millisecond,3);case"s":return this.num(n.second);case"ss":return this.num(n.second,2);case"uu":return this.num(Math.floor(n.millisecond/10),2);case"uuu":return this.num(Math.floor(n.millisecond/100));case"m":return this.num(n.minute);case"mm":return this.num(n.minute,2);case"h":return this.num(n.hour%12===0?12:n.hour%12);case"hh":return this.num(n.hour%12===0?12:n.hour%12,2);case"H":return this.num(n.hour);case"HH":return this.num(n.hour,2);case"Z":return l({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return l({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return l({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return n.zone.offsetName(n.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return n.zone.offsetName(n.ts,{format:"long",locale:this.loc.locale});case"z":return n.zoneName;case"a":return u();case"d":return o?s({day:"numeric"},"day"):this.num(n.day);case"dd":return o?s({day:"2-digit"},"day"):this.num(n.day,2);case"c":return this.num(n.weekday);case"ccc":return f("short",!0);case"cccc":return f("long",!0);case"ccccc":return f("narrow",!0);case"E":return this.num(n.weekday);case"EEE":return f("short",!1);case"EEEE":return f("long",!1);case"EEEEE":return f("narrow",!1);case"L":return o?s({month:"numeric",day:"numeric"},"month"):this.num(n.month);case"LL":return o?s({month:"2-digit",day:"numeric"},"month"):this.num(n.month,2);case"LLL":return d("short",!0);case"LLLL":return d("long",!0);case"LLLLL":return d("narrow",!0);case"M":return o?s({month:"numeric"},"month"):this.num(n.month);case"MM":return o?s({month:"2-digit"},"month"):this.num(n.month,2);case"MMM":return d("short",!1);case"MMMM":return d("long",!1);case"MMMMM":return d("narrow",!1);case"y":return o?s({year:"numeric"},"year"):this.num(n.year);case"yy":return o?s({year:"2-digit"},"year"):this.num(n.year.toString().slice(-2),2);case"yyyy":return o?s({year:"numeric"},"year"):this.num(n.year,4);case"yyyyyy":return o?s({year:"numeric"},"year"):this.num(n.year,6);case"G":return m("short");case"GG":return m("long");case"GGGGG":return m("narrow");case"kk":return this.num(n.weekYear.toString().slice(-2),2);case"kkkk":return this.num(n.weekYear,4);case"W":return this.num(n.weekNumber);case"WW":return this.num(n.weekNumber,2);case"n":return this.num(n.localWeekNumber);case"nn":return this.num(n.localWeekNumber,2);case"ii":return this.num(n.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(n.localWeekYear,4);case"o":return this.num(n.ordinal);case"ooo":return this.num(n.ordinal,3);case"q":return this.num(n.quarter);case"qq":return this.num(n.quarter,2);case"X":return this.num(Math.floor(n.ts/1e3));case"x":return this.num(n.ts);default:return p(v)}};return Xx(e.parseFormat(t),g)}formatDurationFromString(n,t){let i=d=>{switch(d[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=d=>f=>{let p=i(f);return p?this.num(d.get(p),f.length):f},s=e.parseFormat(t),l=s.reduce((d,{literal:f,val:p})=>f?d:d.concat(p),[]),u=n.shiftTo(...l.map(i).filter(d=>d));return Xx(s,o(u))}};var Kx=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function ku(...e){let n=e.reduce((t,i)=>t+i.source,"");return RegExp(`^${n}$`)}function Ru(...e){return n=>e.reduce(([t,i,o],s)=>{let[l,u,d]=s(n,o);return[me(me({},t),l),u||i,d]},[{},null,1]).slice(0,2)}function Fu(e,...n){if(e==null)return[null,null];for(let[t,i]of n){let o=t.exec(e);if(o)return i(o)}return[null,null]}function Qx(...e){return(n,t)=>{let i={},o;for(o=0;o<e.length;o++)i[e[o]]=ha(n[t+o]);return[i,null,t+o]}}var eD=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,DA=`(?:${eD.source}?(?:\\[(${Kx.source})\\])?)?`,Gy=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,tD=RegExp(`${Gy.source}${DA}`),Wy=RegExp(`(?:T${tD.source})?`),NA=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,wA=/(\d{4})-?W(\d\d)(?:-?(\d))?/,IA=/(\d{4})-?(\d{3})/,PA=Qx("weekYear","weekNumber","weekDay"),LA=Qx("year","ordinal"),AA=/(\d{4})-(\d\d)-(\d\d)/,iD=RegExp(`${Gy.source} ?(?:${eD.source}|(${Kx.source}))?`),OA=RegExp(`(?: ${iD.source})?`);function Mu(e,n,t){let i=e[n];return Ae(i)?t:ha(i)}function MA(e,n){return[{year:Mu(e,n),month:Mu(e,n+1,1),day:Mu(e,n+2,1)},null,n+3]}function Yu(e,n){return[{hours:Mu(e,n,0),minutes:Mu(e,n+1,0),seconds:Mu(e,n+2,0),milliseconds:lp(e[n+3])},null,n+4]}function up(e,n){let t=!e[n]&&!e[n+1],i=Ml(e[n+1],e[n+2]),o=t?null:cn.instance(i);return[{},o,n+3]}function dp(e,n){let t=e[n]?xn.create(e[n]):null;return[{},t,n+1]}var kA=RegExp(`^T?${Gy.source}$`),RA=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function FA(e){let[n,t,i,o,s,l,u,d,f]=e,p=n[0]==="-",m=d&&d[0]==="-",g=(v,C=!1)=>v!==void 0&&(C||v&&p)?-v:v;return[{years:g(Ss(t)),months:g(Ss(i)),weeks:g(Ss(o)),days:g(Ss(s)),hours:g(Ss(l)),minutes:g(Ss(u)),seconds:g(Ss(d),d==="-0"),milliseconds:g(lp(f),m)}]}var YA={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Zy(e,n,t,i,o,s,l){let u={year:n.length===2?cp(ha(n)):ha(n),month:zy.indexOf(t)+1,day:ha(i),hour:ha(o),minute:ha(s)};return l&&(u.second=ha(l)),e&&(u.weekday=e.length>3?Hy.indexOf(e)+1:Vy.indexOf(e)+1),u}var BA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function UA(e){let[,n,t,i,o,s,l,u,d,f,p,m]=e,g=Zy(n,o,i,t,s,l,u),v;return d?v=YA[d]:f?v=0:v=Ml(p,m),[g,new cn(v)]}function zA(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var HA=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,VA=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,GA=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Jx(e){let[,n,t,i,o,s,l,u]=e;return[Zy(n,o,i,t,s,l,u),cn.utcInstance]}function WA(e){let[,n,t,i,o,s,l,u]=e;return[Zy(n,u,t,i,o,s,l),cn.utcInstance]}var ZA=ku(NA,Wy),jA=ku(wA,Wy),$A=ku(IA,Wy),qA=ku(tD),nD=Ru(MA,Yu,up,dp),XA=Ru(PA,Yu,up,dp),JA=Ru(LA,Yu,up,dp),KA=Ru(Yu,up,dp);function rD(e){return Fu(e,[ZA,nD],[jA,XA],[$A,JA],[qA,KA])}function oD(e){return Fu(zA(e),[BA,UA])}function aD(e){return Fu(e,[HA,Jx],[VA,Jx],[GA,WA])}function sD(e){return Fu(e,[RA,FA])}var QA=Ru(Yu);function lD(e){return Fu(e,[kA,QA])}var eO=ku(AA,OA),tO=ku(iD),iO=Ru(Yu,up,dp);function cD(e){return Fu(e,[eO,nD],[tO,iO])}var uD="Invalid Duration",hD={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},nO=me({years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3}},hD),Pr=146097/400,Bu=146097/4800,rO=me({years:{quarters:4,months:12,weeks:Pr/7,days:Pr,hours:Pr*24,minutes:Pr*24*60,seconds:Pr*24*60*60,milliseconds:Pr*24*60*60*1e3},quarters:{months:3,weeks:Pr/28,days:Pr/4,hours:Pr*24/4,minutes:Pr*24*60/4,seconds:Pr*24*60*60/4,milliseconds:Pr*24*60*60*1e3/4},months:{weeks:Bu/7,days:Bu,hours:Bu*24,minutes:Bu*24*60,seconds:Bu*24*60*60,milliseconds:Bu*24*60*60*1e3}},hD),Fl=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],oO=Fl.slice(0).reverse();function Cs(e,n,t=!1){let i={values:t?n.values:me(me({},e.values),n.values||{}),loc:e.loc.clone(n.loc),conversionAccuracy:n.conversionAccuracy||e.conversionAccuracy,matrix:n.matrix||e.matrix};return new fi(i)}function pD(e,n){let t=n.milliseconds??0;for(let i of oO.slice(1))n[i]&&(t+=n[i]*e[i].milliseconds);return t}function dD(e,n){let t=pD(e,n)<0?-1:1;Fl.reduceRight((i,o)=>{if(Ae(n[o]))return i;if(i){let s=n[i]*t,l=e[o][i],u=Math.floor(s/l);n[o]+=u*t,n[i]-=u*l*t}return o},null),Fl.reduce((i,o)=>{if(Ae(n[o]))return i;if(i){let s=n[i]%1;n[i]-=s,n[o]+=s*e[i][o]}return o},null)}function aO(e){let n={};for(let[t,i]of Object.entries(e))i!==0&&(n[t]=i);return n}var fi=class e{constructor(n){let t=n.conversionAccuracy==="longterm"||!1,i=t?rO:nO;n.matrix&&(i=n.matrix),this.values=n.values,this.loc=n.loc||It.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=n.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(n,t){return e.fromObject({milliseconds:n},t)}static fromObject(n,t={}){if(n==null||typeof n!="object")throw new pi(`Duration.fromObject: argument expected to be an object, got ${n===null?"null":typeof n}`);return new e({values:Ou(n,e.normalizeUnit),loc:It.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(n){if(oo(n))return e.fromMillis(n);if(e.isDuration(n))return n;if(typeof n=="object")return e.fromObject(n);throw new pi(`Unknown duration argument ${n} of type ${typeof n}`)}static fromISO(n,t){let[i]=sD(n);return i?e.fromObject(i,t):e.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static fromISOTime(n,t){let[i]=lD(n);return i?e.fromObject(i,t):e.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static invalid(n,t=null){if(!n)throw new pi("need to specify a reason the Duration is invalid");let i=n instanceof un?n:new un(n,t);if(wt.throwOnInvalid)throw new N_(i);return new e({invalid:i})}static normalizeUnit(n){let t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[n&&n.toLowerCase()];if(!t)throw new Iu(n);return t}static isDuration(n){return n&&n.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(n,t={}){let i=Tt(me({},t),{floor:t.round!==!1&&t.floor!==!1});return this.isValid?dn.create(this.loc,i).formatDurationFromString(this,n):uD}toHuman(n={}){if(!this.isValid)return uD;let t=Fl.map(i=>{let o=this.values[i];return Ae(o)?null:this.loc.numberFormatter(Tt(me({style:"unit",unitDisplay:"long"},n),{unit:i.slice(0,-1)})).format(o)}).filter(i=>i);return this.loc.listFormatter(me({type:"conjunction",style:n.listStyle||"narrow"},n)).format(t)}toObject(){return this.isValid?me({},this.values):{}}toISO(){if(!this.isValid)return null;let n="P";return this.years!==0&&(n+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(n+=this.months+this.quarters*3+"M"),this.weeks!==0&&(n+=this.weeks+"W"),this.days!==0&&(n+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(n+="T"),this.hours!==0&&(n+=this.hours+"H"),this.minutes!==0&&(n+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(n+=Lu(this.seconds+this.milliseconds/1e3,3)+"S"),n==="P"&&(n+="T0S"),n}toISOTime(n={}){if(!this.isValid)return null;let t=this.toMillis();return t<0||t>=864e5?null:(n=Tt(me({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},n),{includeOffset:!1}),Fe.fromMillis(t,{zone:"UTC"}).toISOTime(n))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?pD(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(n){if(!this.isValid)return this;let t=e.fromDurationLike(n),i={};for(let o of Fl)(ys(t.values,o)||ys(this.values,o))&&(i[o]=t.get(o)+this.get(o));return Cs(this,{values:i},!0)}minus(n){if(!this.isValid)return this;let t=e.fromDurationLike(n);return this.plus(t.negate())}mapUnits(n){if(!this.isValid)return this;let t={};for(let i of Object.keys(this.values))t[i]=Uy(n(this.values[i],i));return Cs(this,{values:t},!0)}get(n){return this[e.normalizeUnit(n)]}set(n){if(!this.isValid)return this;let t=me(me({},this.values),Ou(n,e.normalizeUnit));return Cs(this,{values:t})}reconfigure({locale:n,numberingSystem:t,conversionAccuracy:i,matrix:o}={}){let l={loc:this.loc.clone({locale:n,numberingSystem:t}),matrix:o,conversionAccuracy:i};return Cs(this,l)}as(n){return this.isValid?this.shiftTo(n).get(n):NaN}normalize(){if(!this.isValid)return this;let n=this.toObject();return dD(this.matrix,n),Cs(this,{values:n},!0)}rescale(){if(!this.isValid)return this;let n=aO(this.normalize().shiftToAll().toObject());return Cs(this,{values:n},!0)}shiftTo(...n){if(!this.isValid)return this;if(n.length===0)return this;n=n.map(l=>e.normalizeUnit(l));let t={},i={},o=this.toObject(),s;for(let l of Fl)if(n.indexOf(l)>=0){s=l;let u=0;for(let f in i)u+=this.matrix[f][l]*i[f],i[f]=0;oo(o[l])&&(u+=o[l]);let d=Math.trunc(u);t[l]=d,i[l]=(u*1e3-d*1e3)/1e3}else oo(o[l])&&(i[l]=o[l]);for(let l in i)i[l]!==0&&(t[s]+=l===s?i[l]:i[l]/this.matrix[s][l]);return dD(this.matrix,t),Cs(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let n={};for(let t of Object.keys(this.values))n[t]=this.values[t]===0?0:-this.values[t];return Cs(this,{values:n},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(n){if(!this.isValid||!n.isValid||!this.loc.equals(n.loc))return!1;function t(i,o){return i===void 0||i===0?o===void 0||o===0:i===o}for(let i of Fl)if(!t(this.values[i],n.values[i]))return!1;return!0}};var Uu="Invalid Interval";function sO(e,n){return!e||!e.isValid?Ts.invalid("missing or invalid start"):!n||!n.isValid?Ts.invalid("missing or invalid end"):n<e?Ts.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${n.toISO()}`):null}var Ts=class e{constructor(n){this.s=n.start,this.e=n.end,this.invalid=n.invalid||null,this.isLuxonInterval=!0}static invalid(n,t=null){if(!n)throw new pi("need to specify a reason the Interval is invalid");let i=n instanceof un?n:new un(n,t);if(wt.throwOnInvalid)throw new D_(i);return new e({invalid:i})}static fromDateTimes(n,t){let i=zu(n),o=zu(t),s=sO(i,o);return s??new e({start:i,end:o})}static after(n,t){let i=fi.fromDurationLike(t),o=zu(n);return e.fromDateTimes(o,o.plus(i))}static before(n,t){let i=fi.fromDurationLike(t),o=zu(n);return e.fromDateTimes(o.minus(i),o)}static fromISO(n,t){let[i,o]=(n||"").split("/",2);if(i&&o){let s,l;try{s=Fe.fromISO(i,t),l=s.isValid}catch{l=!1}let u,d;try{u=Fe.fromISO(o,t),d=u.isValid}catch{d=!1}if(l&&d)return e.fromDateTimes(s,u);if(l){let f=fi.fromISO(o,t);if(f.isValid)return e.after(s,f)}else if(d){let f=fi.fromISO(i,t);if(f.isValid)return e.before(u,f)}}return e.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static isInterval(n){return n&&n.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(n="milliseconds"){return this.isValid?this.toDuration(n).get(n):NaN}count(n="milliseconds",t){if(!this.isValid)return NaN;let i=this.start.startOf(n,t),o;return t?.useLocaleWeeks?o=this.end.reconfigure({locale:i.locale}):o=this.end,o=o.startOf(n,t),Math.floor(o.diff(i,n).get(n))+(o.valueOf()!==this.end.valueOf())}hasSame(n){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,n):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(n){return this.isValid?this.s>n:!1}isBefore(n){return this.isValid?this.e<=n:!1}contains(n){return this.isValid?this.s<=n&&this.e>n:!1}set({start:n,end:t}={}){return this.isValid?e.fromDateTimes(n||this.s,t||this.e):this}splitAt(...n){if(!this.isValid)return[];let t=n.map(zu).filter(l=>this.contains(l)).sort((l,u)=>l.toMillis()-u.toMillis()),i=[],{s:o}=this,s=0;for(;o<this.e;){let l=t[s]||this.e,u=+l>+this.e?this.e:l;i.push(e.fromDateTimes(o,u)),o=u,s+=1}return i}splitBy(n){let t=fi.fromDurationLike(n);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:i}=this,o=1,s,l=[];for(;i<this.e;){let u=this.start.plus(t.mapUnits(d=>d*o));s=+u>+this.e?this.e:u,l.push(e.fromDateTimes(i,s)),i=s,o+=1}return l}divideEqually(n){return this.isValid?this.splitBy(this.length()/n).slice(0,n):[]}overlaps(n){return this.e>n.s&&this.s<n.e}abutsStart(n){return this.isValid?+this.e==+n.s:!1}abutsEnd(n){return this.isValid?+n.e==+this.s:!1}engulfs(n){return this.isValid?this.s<=n.s&&this.e>=n.e:!1}equals(n){return!this.isValid||!n.isValid?!1:this.s.equals(n.s)&&this.e.equals(n.e)}intersection(n){if(!this.isValid)return this;let t=this.s>n.s?this.s:n.s,i=this.e<n.e?this.e:n.e;return t>=i?null:e.fromDateTimes(t,i)}union(n){if(!this.isValid)return this;let t=this.s<n.s?this.s:n.s,i=this.e>n.e?this.e:n.e;return e.fromDateTimes(t,i)}static merge(n){let[t,i]=n.sort((o,s)=>o.s-s.s).reduce(([o,s],l)=>s?s.overlaps(l)||s.abutsStart(l)?[o,s.union(l)]:[o.concat([s]),l]:[o,l],[[],null]);return i&&t.push(i),t}static xor(n){let t=null,i=0,o=[],s=n.map(d=>[{time:d.s,type:"s"},{time:d.e,type:"e"}]),l=Array.prototype.concat(...s),u=l.sort((d,f)=>d.time-f.time);for(let d of u)i+=d.type==="s"?1:-1,i===1?t=d.time:(t&&+t!=+d.time&&o.push(e.fromDateTimes(t,d.time)),t=null);return e.merge(o)}difference(...n){return e.xor([this].concat(n)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:Uu}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(n=_s,t={}){return this.isValid?dn.create(this.s.loc.clone(t),n).formatInterval(this):Uu}toISO(n){return this.isValid?`${this.s.toISO(n)}/${this.e.toISO(n)}`:Uu}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Uu}toISOTime(n){return this.isValid?`${this.s.toISOTime(n)}/${this.e.toISOTime(n)}`:Uu}toFormat(n,{separator:t=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(n)}${t}${this.e.toFormat(n)}`:Uu}toDuration(n,t){return this.isValid?this.e.diff(this.s,n,t):fi.invalid(this.invalidReason)}mapEndpoints(n){return e.fromDateTimes(n(this.s),n(this.e))}};var Es=class{static hasDST(n=wt.defaultZone){let t=Fe.now().setZone(n).set({month:12});return!n.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(n){return xn.isValidZone(n)}static normalizeZone(n){return ro(n,wt.defaultZone)}static getStartOfWeek({locale:n=null,locObj:t=null}={}){return(t||It.create(n)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:n=null,locObj:t=null}={}){return(t||It.create(n)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:n=null,locObj:t=null}={}){return(t||It.create(n)).getWeekendDays().slice()}static months(n="long",{locale:t=null,numberingSystem:i=null,locObj:o=null,outputCalendar:s="gregory"}={}){return(o||It.create(t,i,s)).months(n)}static monthsFormat(n="long",{locale:t=null,numberingSystem:i=null,locObj:o=null,outputCalendar:s="gregory"}={}){return(o||It.create(t,i,s)).months(n,!0)}static weekdays(n="long",{locale:t=null,numberingSystem:i=null,locObj:o=null}={}){return(o||It.create(t,i,null)).weekdays(n)}static weekdaysFormat(n="long",{locale:t=null,numberingSystem:i=null,locObj:o=null}={}){return(o||It.create(t,i,null)).weekdays(n,!0)}static meridiems({locale:n=null}={}){return It.create(n).meridiems()}static eras(n="short",{locale:t=null}={}){return It.create(t,null,"gregory").eras(n)}static features(){return{relative:L_(),localeWeek:A_()}}};function fD(e,n){let t=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=t(n)-t(e);return Math.floor(fi.fromMillis(i).as("days"))}function lO(e,n,t){let i=[["years",(d,f)=>f.year-d.year],["quarters",(d,f)=>f.quarter-d.quarter+(f.year-d.year)*4],["months",(d,f)=>f.month-d.month+(f.year-d.year)*12],["weeks",(d,f)=>{let p=fD(d,f);return(p-p%7)/7}],["days",fD]],o={},s=e,l,u;for(let[d,f]of i)t.indexOf(d)>=0&&(l=d,o[d]=f(e,n),u=s.plus(o),u>n?(o[d]--,e=s.plus(o),e>n&&(u=e,o[d]--,e=s.plus(o))):e=u);return[e,o,u,l]}function mD(e,n,t,i){let[o,s,l,u]=lO(e,n,t),d=n-o,f=t.filter(m=>["hours","minutes","seconds","milliseconds"].indexOf(m)>=0);f.length===0&&(l<n&&(l=o.plus({[u]:1})),l!==o&&(s[u]=(s[u]||0)+d/(l-o)));let p=fi.fromObject(s,i);return f.length>0?fi.fromMillis(d,i).shiftTo(...f).plus(p):p}var cO="missing Intl.DateTimeFormat.formatToParts support";function Pt(e,n=t=>t){return{regex:e,deser:([t])=>n(Dx(t))}}var uO="\xA0",gD=`[ ${uO}]`,yD=new RegExp(gD,"g");function dO(e){return e.replace(/\./g,"\\.?").replace(yD,gD)}function _D(e){return e.replace(/\./g,"").replace(yD," ").toLowerCase()}function ao(e,n){return e===null?null:{regex:RegExp(e.map(dO).join("|")),deser:([t])=>e.findIndex(i=>_D(t)===_D(i))+n}}function vD(e,n){return{regex:e,deser:([,t,i])=>Ml(t,i),groups:n}}function R_(e){return{regex:e,deser:([n])=>n}}function hO(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function pO(e,n){let t=wr(n),i=wr(n,"{2}"),o=wr(n,"{3}"),s=wr(n,"{4}"),l=wr(n,"{6}"),u=wr(n,"{1,2}"),d=wr(n,"{1,3}"),f=wr(n,"{1,6}"),p=wr(n,"{1,9}"),m=wr(n,"{2,4}"),g=wr(n,"{4,6}"),v=b=>({regex:RegExp(hO(b.val)),deser:([S])=>S,literal:!0}),E=(b=>{if(e.literal)return v(b);switch(b.val){case"G":return ao(n.eras("short"),0);case"GG":return ao(n.eras("long"),0);case"y":return Pt(f);case"yy":return Pt(m,cp);case"yyyy":return Pt(s);case"yyyyy":return Pt(g);case"yyyyyy":return Pt(l);case"M":return Pt(u);case"MM":return Pt(i);case"MMM":return ao(n.months("short",!0),1);case"MMMM":return ao(n.months("long",!0),1);case"L":return Pt(u);case"LL":return Pt(i);case"LLL":return ao(n.months("short",!1),1);case"LLLL":return ao(n.months("long",!1),1);case"d":return Pt(u);case"dd":return Pt(i);case"o":return Pt(d);case"ooo":return Pt(o);case"HH":return Pt(i);case"H":return Pt(u);case"hh":return Pt(i);case"h":return Pt(u);case"mm":return Pt(i);case"m":return Pt(u);case"q":return Pt(u);case"qq":return Pt(i);case"s":return Pt(u);case"ss":return Pt(i);case"S":return Pt(d);case"SSS":return Pt(o);case"u":return R_(p);case"uu":return R_(u);case"uuu":return Pt(t);case"a":return ao(n.meridiems(),0);case"kkkk":return Pt(s);case"kk":return Pt(m,cp);case"W":return Pt(u);case"WW":return Pt(i);case"E":case"c":return Pt(t);case"EEE":return ao(n.weekdays("short",!1),1);case"EEEE":return ao(n.weekdays("long",!1),1);case"ccc":return ao(n.weekdays("short",!0),1);case"cccc":return ao(n.weekdays("long",!0),1);case"Z":case"ZZ":return vD(new RegExp(`([+-]${u.source})(?::(${i.source}))?`),2);case"ZZZ":return vD(new RegExp(`([+-]${u.source})(${i.source})?`),2);case"z":return R_(/[a-z_+-/]{1,256}?/i);case" ":return R_(/[^\S\n\r]/);default:return v(b)}})(e)||{invalidReason:cO};return E.token=e,E}var fO={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function mO(e,n,t){let{type:i,value:o}=e;if(i==="literal"){let d=/^\s+$/.test(o);return{literal:!d,val:d?" ":o}}let s=n[i],l=i;i==="hour"&&(n.hour12!=null?l=n.hour12?"hour12":"hour24":n.hourCycle!=null?n.hourCycle==="h11"||n.hourCycle==="h12"?l="hour12":l="hour24":l=t.hour12?"hour12":"hour24");let u=fO[l];if(typeof u=="object"&&(u=u[s]),u)return{literal:!1,val:u}}function _O(e){return[`^${e.map(t=>t.regex).reduce((t,i)=>`${t}(${i.source})`,"")}$`,e]}function vO(e,n,t){let i=e.match(n);if(i){let o={},s=1;for(let l in t)if(ys(t,l)){let u=t[l],d=u.groups?u.groups+1:1;!u.literal&&u.token&&(o[u.token.val[0]]=u.deser(i.slice(s,s+d))),s+=d}return[i,o]}else return[i,{}]}function gO(e){let n=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},t=null,i;return Ae(e.z)||(t=xn.create(e.z)),Ae(e.Z)||(t||(t=new cn(e.Z)),i=e.Z),Ae(e.q)||(e.M=(e.q-1)*3+1),Ae(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),Ae(e.u)||(e.S=lp(e.u)),[Object.keys(e).reduce((s,l)=>{let u=n(l);return u&&(s[u]=e[l]),s},{}),t,i]}var jy=null;function yO(){return jy||(jy=Fe.fromMillis(1555555555555)),jy}function SO(e,n){if(e.literal)return e;let t=dn.macroTokenToFormatOpts(e.val),i=Xy(t,n);return i==null||i.includes(void 0)?e:i}function $y(e,n){return Array.prototype.concat(...e.map(t=>SO(t,n)))}var hp=class{constructor(n,t){if(this.locale=n,this.format=t,this.tokens=$y(dn.parseFormat(t),n),this.units=this.tokens.map(i=>pO(i,n)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){let[i,o]=_O(this.units);this.regex=RegExp(i,"i"),this.handlers=o}}explainFromTokens(n){if(this.isValid){let[t,i]=vO(n,this.regex,this.handlers),[o,s,l]=i?gO(i):[null,null,void 0];if(ys(i,"a")&&ys(i,"H"))throw new to("Can't include meridiem when specifying 24-hour format");return{input:n,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:i,result:o,zone:s,specificOffset:l}}else return{input:n,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}};function qy(e,n,t){return new hp(e,t).explainFromTokens(n)}function SD(e,n,t){let{result:i,zone:o,specificOffset:s,invalidReason:l}=qy(e,n,t);return[i,o,s,l]}function Xy(e,n){if(!e)return null;let i=dn.create(n,e).dtFormatter(yO()),o=i.formatToParts(),s=i.resolvedOptions();return o.map(l=>mO(l,e,s))}var Jy="Invalid DateTime",CD=864e13;function pp(e){return new un("unsupported zone",`the zone "${e.name}" is not supported`)}function Ky(e){return e.weekData===null&&(e.weekData=op(e.c)),e.weekData}function Qy(e){return e.localWeekData===null&&(e.localWeekData=op(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function Yl(e,n){let t={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new Fe(Tt(me(me({},t),n),{old:t}))}function wD(e,n,t){let i=e-n*60*1e3,o=t.offset(i);if(n===o)return[i,n];i-=(o-n)*60*1e3;let s=t.offset(i);return o===s?[i,o]:[e-Math.min(o,s)*60*1e3,Math.max(o,s)]}function F_(e,n){e+=n*60*1e3;let t=new Date(e);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function B_(e,n,t){return wD(Pu(e),n,t)}function TD(e,n){let t=e.o,i=e.c.year+Math.trunc(n.years),o=e.c.month+Math.trunc(n.months)+Math.trunc(n.quarters)*3,s=Tt(me({},e.c),{year:i,month:o,day:Math.min(e.c.day,Au(i,o))+Math.trunc(n.days)+Math.trunc(n.weeks)*7}),l=fi.fromObject({years:n.years-Math.trunc(n.years),quarters:n.quarters-Math.trunc(n.quarters),months:n.months-Math.trunc(n.months),weeks:n.weeks-Math.trunc(n.weeks),days:n.days-Math.trunc(n.days),hours:n.hours,minutes:n.minutes,seconds:n.seconds,milliseconds:n.milliseconds}).as("milliseconds"),u=Pu(s),[d,f]=wD(u,t,e.zone);return l!==0&&(d+=l,f=e.zone.offset(d)),{ts:d,o:f}}function Hu(e,n,t,i,o,s){let{setZone:l,zone:u}=t;if(e&&Object.keys(e).length!==0||n){let d=n||u,f=Fe.fromObject(e,Tt(me({},t),{zone:d,specificOffset:s}));return l?f:f.setZone(u)}else return Fe.invalid(new un("unparsable",`the input "${o}" can't be parsed as ${i}`))}function Y_(e,n,t=!0){return e.isValid?dn.create(It.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(e,n):null}function eS(e,n){let t=e.c.year>9999||e.c.year<0,i="";return t&&e.c.year>=0&&(i+="+"),i+=ai(e.c.year,t?6:4),n?(i+="-",i+=ai(e.c.month),i+="-",i+=ai(e.c.day)):(i+=ai(e.c.month),i+=ai(e.c.day)),i}function ED(e,n,t,i,o,s){let l=ai(e.c.hour);return n?(l+=":",l+=ai(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!t)&&(l+=":")):l+=ai(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!t)&&(l+=ai(e.c.second),(e.c.millisecond!==0||!i)&&(l+=".",l+=ai(e.c.millisecond,3))),o&&(e.isOffsetFixed&&e.offset===0&&!s?l+="Z":e.o<0?(l+="-",l+=ai(Math.trunc(-e.o/60)),l+=":",l+=ai(Math.trunc(-e.o%60))):(l+="+",l+=ai(Math.trunc(e.o/60)),l+=":",l+=ai(Math.trunc(e.o%60)))),s&&(l+="["+e.zone.ianaName+"]"),l}var ID={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},CO={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},TO={ordinal:1,hour:0,minute:0,second:0,millisecond:0},PD=["year","month","day","hour","minute","second","millisecond"],EO=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],bO=["year","ordinal","hour","minute","second","millisecond"];function xO(e){let n={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!n)throw new Iu(e);return n}function bD(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return xO(e)}}function DO(e){if(fp===void 0&&(fp=wt.now()),e.type!=="iana")return e.offset(fp);let n=e.name,t=tS.get(n);return t===void 0&&(t=e.offset(fp),tS.set(n,t)),t}function xD(e,n){let t=ro(n.zone,wt.defaultZone);if(!t.isValid)return Fe.invalid(pp(t));let i=It.fromObject(n),o,s;if(Ae(e.year))o=wt.now();else{for(let d of PD)Ae(e[d])&&(e[d]=ID[d]);let l=Fy(e)||Yy(e);if(l)return Fe.invalid(l);let u=DO(t);[o,s]=B_(e,u,t)}return new Fe({ts:o,zone:t,loc:i,o:s})}function DD(e,n,t){let i=Ae(t.round)?!0:t.round,o=(l,u)=>(l=Lu(l,i||t.calendary?0:2,!0),n.loc.clone(t).relFormatter(t).format(l,u)),s=l=>t.calendary?n.hasSame(e,l)?0:n.startOf(l).diff(e.startOf(l),l).get(l):n.diff(e,l).get(l);if(t.unit)return o(s(t.unit),t.unit);for(let l of t.units){let u=s(l);if(Math.abs(u)>=1)return o(u,l)}return o(e>n?-0:0,t.units[t.units.length-1])}function ND(e){let n={},t;return e.length>0&&typeof e[e.length-1]=="object"?(n=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[n,t]}var fp,tS=new Map,Fe=class e{constructor(n){let t=n.zone||wt.defaultZone,i=n.invalid||(Number.isNaN(n.ts)?new un("invalid input"):null)||(t.isValid?null:pp(t));this.ts=Ae(n.ts)?wt.now():n.ts;let o=null,s=null;if(!i)if(n.old&&n.old.ts===this.ts&&n.old.zone.equals(t))[o,s]=[n.old.c,n.old.o];else{let u=oo(n.o)&&!n.old?n.o:t.offset(this.ts);o=F_(this.ts,u),i=Number.isNaN(o.year)?new un("invalid input"):null,o=i?null:o,s=i?null:u}this._zone=t,this.loc=n.loc||It.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=o,this.o=s,this.isLuxonDateTime=!0}static now(){return new e({})}static local(){let[n,t]=ND(arguments),[i,o,s,l,u,d,f]=t;return xD({year:i,month:o,day:s,hour:l,minute:u,second:d,millisecond:f},n)}static utc(){let[n,t]=ND(arguments),[i,o,s,l,u,d,f]=t;return n.zone=cn.utcInstance,xD({year:i,month:o,day:s,hour:l,minute:u,second:d,millisecond:f},n)}static fromJSDate(n,t={}){let i=Vx(n)?n.valueOf():NaN;if(Number.isNaN(i))return e.invalid("invalid input");let o=ro(t.zone,wt.defaultZone);return o.isValid?new e({ts:i,zone:o,loc:It.fromObject(t)}):e.invalid(pp(o))}static fromMillis(n,t={}){if(oo(n))return n<-CD||n>CD?e.invalid("Timestamp out of range"):new e({ts:n,zone:ro(t.zone,wt.defaultZone),loc:It.fromObject(t)});throw new pi(`fromMillis requires a numerical input, but received a ${typeof n} with value ${n}`)}static fromSeconds(n,t={}){if(oo(n))return new e({ts:n*1e3,zone:ro(t.zone,wt.defaultZone),loc:It.fromObject(t)});throw new pi("fromSeconds requires a numerical input")}static fromObject(n,t={}){n=n||{};let i=ro(t.zone,wt.defaultZone);if(!i.isValid)return e.invalid(pp(i));let o=It.fromObject(t),s=Ou(n,bD),{minDaysInFirstWeek:l,startOfWeek:u}=Ry(s,o),d=wt.now(),f=Ae(t.specificOffset)?i.offset(d):t.specificOffset,p=!Ae(s.ordinal),m=!Ae(s.year),g=!Ae(s.month)||!Ae(s.day),v=m||g,C=s.weekYear||s.weekNumber;if((v||p)&&C)throw new to("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(g&&p)throw new to("Can't mix ordinal dates with month/day");let E=C||s.weekday&&!v,b,S,I=F_(d,f);E?(b=EO,S=CO,I=op(I,l,u)):p?(b=bO,S=TO,I=k_(I)):(b=PD,S=ID);let z=!1;for(let ct of b){let Ee=s[ct];Ae(Ee)?z?s[ct]=S[ct]:s[ct]=I[ct]:z=!0}let j=E?Ux(s,l,u):p?zx(s):Fy(s),k=j||Yy(s);if(k)return e.invalid(k);let De=E?My(s,l,u):p?ky(s):s,[$,yt]=B_(De,f,i),He=new e({ts:$,zone:i,o:yt,loc:o});return s.weekday&&v&&n.weekday!==He.weekday?e.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${He.toISO()}`):He.isValid?He:e.invalid(He.invalid)}static fromISO(n,t={}){let[i,o]=rD(n);return Hu(i,o,t,"ISO 8601",n)}static fromRFC2822(n,t={}){let[i,o]=oD(n);return Hu(i,o,t,"RFC 2822",n)}static fromHTTP(n,t={}){let[i,o]=aD(n);return Hu(i,o,t,"HTTP",t)}static fromFormat(n,t,i={}){if(Ae(n)||Ae(t))throw new pi("fromFormat requires an input string and a format");let{locale:o=null,numberingSystem:s=null}=i,l=It.fromOpts({locale:o,numberingSystem:s,defaultToEN:!0}),[u,d,f,p]=SD(l,n,t);return p?e.invalid(p):Hu(u,d,i,`format ${t}`,n,f)}static fromString(n,t,i={}){return e.fromFormat(n,t,i)}static fromSQL(n,t={}){let[i,o]=cD(n);return Hu(i,o,t,"SQL",n)}static invalid(n,t=null){if(!n)throw new pi("need to specify a reason the DateTime is invalid");let i=n instanceof un?n:new un(n,t);if(wt.throwOnInvalid)throw new x_(i);return new e({invalid:i})}static isDateTime(n){return n&&n.isLuxonDateTime||!1}static parseFormatForOpts(n,t={}){let i=Xy(n,It.fromObject(t));return i?i.map(o=>o?o.val:null).join(""):null}static expandFormat(n,t={}){return $y(dn.parseFormat(n),It.fromObject(t)).map(o=>o.val).join("")}static resetCache(){fp=void 0,tS.clear()}get(n){return this[n]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Ky(this).weekYear:NaN}get weekNumber(){return this.isValid?Ky(this).weekNumber:NaN}get weekday(){return this.isValid?Ky(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?Qy(this).weekday:NaN}get localWeekNumber(){return this.isValid?Qy(this).weekNumber:NaN}get localWeekYear(){return this.isValid?Qy(this).weekYear:NaN}get ordinal(){return this.isValid?k_(this.c).ordinal:NaN}get monthShort(){return this.isValid?Es.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Es.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Es.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Es.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let n=864e5,t=6e4,i=Pu(this.c),o=this.zone.offset(i-n),s=this.zone.offset(i+n),l=this.zone.offset(i-o*t),u=this.zone.offset(i-s*t);if(l===u)return[this];let d=i-l*t,f=i-u*t,p=F_(d,l),m=F_(f,u);return p.hour===m.hour&&p.minute===m.minute&&p.second===m.second&&p.millisecond===m.millisecond?[Yl(this,{ts:d}),Yl(this,{ts:f})]:[this]}get isInLeapYear(){return Rl(this.year)}get daysInMonth(){return Au(this.year,this.month)}get daysInYear(){return this.isValid?gs(this.year):NaN}get weeksInWeekYear(){return this.isValid?kl(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?kl(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(n={}){let{locale:t,numberingSystem:i,calendar:o}=dn.create(this.loc.clone(n),n).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:o}}toUTC(n=0,t={}){return this.setZone(cn.instance(n),t)}toLocal(){return this.setZone(wt.defaultZone)}setZone(n,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if(n=ro(n,wt.defaultZone),n.equals(this.zone))return this;if(n.isValid){let o=this.ts;if(t||i){let s=n.offset(this.ts),l=this.toObject();[o]=B_(l,s,n)}return Yl(this,{ts:o,zone:n})}else return e.invalid(pp(n))}reconfigure({locale:n,numberingSystem:t,outputCalendar:i}={}){let o=this.loc.clone({locale:n,numberingSystem:t,outputCalendar:i});return Yl(this,{loc:o})}setLocale(n){return this.reconfigure({locale:n})}set(n){if(!this.isValid)return this;let t=Ou(n,bD),{minDaysInFirstWeek:i,startOfWeek:o}=Ry(t,this.loc),s=!Ae(t.weekYear)||!Ae(t.weekNumber)||!Ae(t.weekday),l=!Ae(t.ordinal),u=!Ae(t.year),d=!Ae(t.month)||!Ae(t.day),f=u||d,p=t.weekYear||t.weekNumber;if((f||l)&&p)throw new to("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&l)throw new to("Can't mix ordinal dates with month/day");let m;s?m=My(me(me({},op(this.c,i,o)),t),i,o):Ae(t.ordinal)?(m=me(me({},this.toObject()),t),Ae(t.day)&&(m.day=Math.min(Au(m.year,m.month),m.day))):m=ky(me(me({},k_(this.c)),t));let[g,v]=B_(m,this.o,this.zone);return Yl(this,{ts:g,o:v})}plus(n){if(!this.isValid)return this;let t=fi.fromDurationLike(n);return Yl(this,TD(this,t))}minus(n){if(!this.isValid)return this;let t=fi.fromDurationLike(n).negate();return Yl(this,TD(this,t))}startOf(n,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;let i={},o=fi.normalizeUnit(n);switch(o){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break;case"milliseconds":break}if(o==="weeks")if(t){let s=this.loc.getStartOfWeek(),{weekday:l}=this;l<s&&(i.weekNumber=this.weekNumber-1),i.weekday=s}else i.weekday=1;if(o==="quarters"){let s=Math.ceil(this.month/3);i.month=(s-1)*3+1}return this.set(i)}endOf(n,t){return this.isValid?this.plus({[n]:1}).startOf(n,t).minus(1):this}toFormat(n,t={}){return this.isValid?dn.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,n):Jy}toLocaleString(n=_s,t={}){return this.isValid?dn.create(this.loc.clone(t),n).formatDateTime(this):Jy}toLocaleParts(n={}){return this.isValid?dn.create(this.loc.clone(n),n).formatDateTimeParts(this):[]}toISO({format:n="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:o=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;let l=n==="extended",u=eS(this,l);return u+="T",u+=ED(this,l,t,i,o,s),u}toISODate({format:n="extended"}={}){return this.isValid?eS(this,n==="extended"):null}toISOWeekDate(){return Y_(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:n=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:o=!1,extendedZone:s=!1,format:l="extended"}={}){return this.isValid?(o?"T":"")+ED(this,l==="extended",t,n,i,s):null}toRFC2822(){return Y_(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Y_(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?eS(this,!0):null}toSQLTime({includeOffset:n=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let o="HH:mm:ss.SSS";return(t||n)&&(i&&(o+=" "),t?o+="z":n&&(o+="ZZ")),Y_(this,o,!0)}toSQL(n={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(n)}`:null}toString(){return this.isValid?this.toISO():Jy}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(n={}){if(!this.isValid)return{};let t=me({},this.c);return n.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(n,t="milliseconds",i={}){if(!this.isValid||!n.isValid)return fi.invalid("created by diffing an invalid DateTime");let o=me({locale:this.locale,numberingSystem:this.numberingSystem},i),s=Gx(t).map(fi.normalizeUnit),l=n.valueOf()>this.valueOf(),u=l?this:n,d=l?n:this,f=mD(u,d,s,o);return l?f.negate():f}diffNow(n="milliseconds",t={}){return this.diff(e.now(),n,t)}until(n){return this.isValid?Ts.fromDateTimes(this,n):this}hasSame(n,t,i){if(!this.isValid)return!1;let o=n.valueOf(),s=this.setZone(n.zone,{keepLocalTime:!0});return s.startOf(t,i)<=o&&o<=s.endOf(t,i)}equals(n){return this.isValid&&n.isValid&&this.valueOf()===n.valueOf()&&this.zone.equals(n.zone)&&this.loc.equals(n.loc)}toRelative(n={}){if(!this.isValid)return null;let t=n.base||e.fromObject({},{zone:this.zone}),i=n.padding?this<t?-n.padding:n.padding:0,o=["years","months","days","hours","minutes","seconds"],s=n.unit;return Array.isArray(n.unit)&&(o=n.unit,s=void 0),DD(t,this.plus(i),Tt(me({},n),{numeric:"always",units:o,unit:s}))}toRelativeCalendar(n={}){return this.isValid?DD(n.base||e.fromObject({},{zone:this.zone}),this,Tt(me({},n),{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...n){if(!n.every(e.isDateTime))throw new pi("min requires all arguments be DateTimes");return By(n,t=>t.valueOf(),Math.min)}static max(...n){if(!n.every(e.isDateTime))throw new pi("max requires all arguments be DateTimes");return By(n,t=>t.valueOf(),Math.max)}static fromFormatExplain(n,t,i={}){let{locale:o=null,numberingSystem:s=null}=i,l=It.fromOpts({locale:o,numberingSystem:s,defaultToEN:!0});return qy(l,n,t)}static fromStringExplain(n,t,i={}){return e.fromFormatExplain(n,t,i)}static buildFormatParser(n,t={}){let{locale:i=null,numberingSystem:o=null}=t,s=It.fromOpts({locale:i,numberingSystem:o,defaultToEN:!0});return new hp(s,n)}static fromFormatParser(n,t,i={}){if(Ae(n)||Ae(t))throw new pi("fromFormatParser requires an input string and a format parser");let{locale:o=null,numberingSystem:s=null}=i,l=It.fromOpts({locale:o,numberingSystem:s,defaultToEN:!0});if(!l.equals(t.locale))throw new pi(`fromFormatParser called with a locale of ${l}, but the format parser was created for ${t.locale}`);let{result:u,zone:d,specificOffset:f,invalidReason:p}=t.explainFromTokens(n);return p?e.invalid(p):Hu(u,d,i,`format ${t.format}`,n,f)}static get DATE_SHORT(){return _s}static get DATE_MED(){return Fh}static get DATE_MED_WITH_WEEKDAY(){return hy}static get DATE_FULL(){return Yh}static get DATE_HUGE(){return Bh}static get TIME_SIMPLE(){return Uh}static get TIME_WITH_SECONDS(){return zh}static get TIME_WITH_SHORT_OFFSET(){return Hh}static get TIME_WITH_LONG_OFFSET(){return Vh}static get TIME_24_SIMPLE(){return Gh}static get TIME_24_WITH_SECONDS(){return Wh}static get TIME_24_WITH_SHORT_OFFSET(){return Zh}static get TIME_24_WITH_LONG_OFFSET(){return jh}static get DATETIME_SHORT(){return $h}static get DATETIME_SHORT_WITH_SECONDS(){return qh}static get DATETIME_MED(){return Xh}static get DATETIME_MED_WITH_SECONDS(){return Jh}static get DATETIME_MED_WITH_WEEKDAY(){return py}static get DATETIME_FULL(){return Kh}static get DATETIME_FULL_WITH_SECONDS(){return Qh}static get DATETIME_HUGE(){return ep}static get DATETIME_HUGE_WITH_SECONDS(){return tp}};function zu(e){if(Fe.isDateTime(e))return e;if(e&&e.valueOf&&oo(e.valueOf()))return Fe.fromJSDate(e);if(e&&typeof e=="object")return Fe.fromObject(e);throw new pi(`Unknown datetime argument: ${e}, of type ${typeof e}`)}var U_=class{},Bl=function(e){return e.exposureLine="exposure-line",e.exposureSquare="exposure-square",e.gradient="gradient",e.line="line",e.square="square",e}(Bl||{});var si=function(e){return e.point="point",e.shape="shape",e.wms="wms",e}(si||{}),pe=function(e){return e.adminRegions="adminRegions",e.adminRegions1="adminRegions1",e.adminRegions2="adminRegions2",e.adminRegions3="adminRegions3",e.adminRegions4="adminRegions4",e.affectedPopulation="affected_population",e.buildings="buildings",e.communityNotifications="community_notifications",e.cropland="cropland",e.damSites="dams",e.droughtPhaseClassification="drought_phase_classification",e.evacuationCenters="evacuation_centers",e.female_head_hh="female_head_hh",e.flood_vulnerability_index="flood_vulnerability_index",e.floodExtent="flood_extent",e.forecastSeverity="forecast_severity",e.forecastTrigger="forecast_trigger",e.gauges="gauges",e.glofasStations="glofas_stations",e.grassland="grassland",e.healthSites="health_sites",e.hotspotGeneral="Hotspot_General",e.hotspotHealth="Hotspot_Health",e.hotspotNutrition="Hotspot_Nutrition",e.hotspotWater="Hotspot_Water",e.housesAffected="houses_affected",e.ipcForecastLong="IPC_forecast_long",e.ipcForecastShort="IPC_forecast_short",e.livestockBodyCondition="livestock_body_condition",e.malariaRisk="malaria_risk",e.malariaSuitableTemperature="malaria_suitable_temperature",e.motorizedTravelTimeToHealth="motorized_travel_time_to_health",e.population="population",e.population_affected="population_affected",e.population_affected_percentage="population_affected_percentage",e.population_over65="population_over65",e.population_u5="population_u5",e.population_u8="population_u8",e.populationTotal="populationTotal",e.potentialCases="potential_cases",e.potentialCases65="potential_cases_65",e.potentialCasesU5="potential_cases_U5",e.potentialCasesU9="potential_cases_U9",e.poverty_incidence="poverty_incidence",e.probWithin50Km="prob_within_50km",e.rainfall="rainfall",e.rainfallForecast="rainfall_forecast",e.redCrossBranches="red_cross_branches",e.roads="roads",e.roof_type="roof_type",e.schools="schools",e.totalHouses="total_houses",e.totalIdps="total_idps",e.travel_time_cities="travel_time_cities",e.trigger="trigger",e.typhoonTrack="typhoon_track",e.vegetationCondition="vegetation_condition",e.vulnerability_score="vulnerability_score",e.vulnerableGroup="vulnerable_group",e.vulnerableHousing="vulnerable_housing",e.walkingTravelTimeToHealth="walking_travel_time_to_health",e.wall_type="wall_type",e.waterpoints="waterpoints",e.windspeed="windspeed",e}(pe||{}),LD=[pe.buildings,pe.roads],bs=function(e){return e.adminRegions1="Admin Level 1",e.adminRegions2="Admin Level 2",e.adminRegions3="Admin Level 3",e.adminRegions4="Admin Level 4",e.cropland="Cropland",e.damSites="Dam Sites",e.evacuationCenters="Evacuation Centers",e.floodExtent="Flood extent",e.glofasStations="Glofas stations",e.grassland="Grassland",e.healthSites="Health Sites",e.population="Population",e.populationTotal="Total Population",e.rainfallExtent="Rainfall extent",e.redCrossBranches="Red Cross branches",e.typhoonTrack="Typhoon track",e.waterpoints="Waterpoints",e}(bs||{});var pt=function(e){return e.adminRegions="adminRegions",e.aggregates="aggregates",e.outline="outline",e.point="point",e.wms="wms",e}(pt||{});var Lr=function(e){return e.adminBoundaryPane="ibf-admin-boundaries",e.aggregatePane="ibf-aggregate",e.outline="outline",e.overlayPane="overlayPane",e.popupPane="popup",e.wmsPane="ibf-wms",e}(Lr||{});var tt=function(e){return e.adminArea="admin-area",e.adminArea2="admin-area2",e.adminArea3="admin-area3",e.event="event",e.national="national",e}(tt||{});var it=(()=>{class e{constructor(){this.disasterTypeSubject=new Yt(null),this.getDisasterTypeSubscription=()=>this.disasterTypeSubject.asObservable()}setDisasterType(t){this.disasterType=t,this.disasterTypeSubject.next(this.disasterType)}getCountryDisasterTypeSettings(t,i){return t?.countryDisasterSettings.find(o=>o.disasterType===i?.disasterType)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ui=function(e){return e.day0="0-day",e.day1="1-day",e.day2="2-day",e.day3="3-day",e.day4="4-day",e.day5="5-day",e.day6="6-day",e.day7="7-day",e.month0="0-month",e.month1="1-month",e.month2="2-month",e.month3="3-month",e.month4="4-month",e.month5="5-month",e.month6="6-month",e.month7="7-month",e.month8="8-month",e.month9="9-month",e.month10="10-month",e.month11="11-month",e.hour0="0-hour",e.hour1="1-hour",e.hour2="2-hour",e.hour3="3-hour",e.hour4="4-hour",e.hour5="5-hour",e.hour6="6-hour",e.hour7="7-hour",e.hour8="8-hour",e.hour9="9-hour",e.hour10="10-hour",e.hour11="11-hour",e.hour12="12-hour",e.hour13="13-hour",e.hour14="14-hour",e.hour15="15-hour",e.hour16="16-hour",e.hour17="17-hour",e.hour18="18-hour",e.hour19="19-hour",e.hour20="20-hour",e.hour21="21-hour",e.hour22="22-hour",e.hour23="23-hour",e.hour24="24-hour",e.hour25="25-hour",e.hour26="26-hour",e.hour27="27-hour",e.hour28="28-hour",e.hour29="29-hour",e.hour30="30-hour",e.hour31="31-hour",e.hour32="32-hour",e.hour33="33-hour",e.hour34="34-hour",e.hour35="35-hour",e.hour36="36-hour",e.hour37="37-hour",e.hour38="38-hour",e.hour39="39-hour",e.hour40="40-hour",e.hour41="41-hour",e.hour42="42-hour",e.hour43="43-hour",e.hour44="44-hour",e.hour45="45-hour",e.hour46="46-hour",e.hour47="47-hour",e.hour48="48-hour",e.hour49="49-hour",e.hour50="50-hour",e.hour51="51-hour",e.hour52="52-hour",e.hour53="53-hour",e.hour54="54-hour",e.hour55="55-hour",e.hour56="56-hour",e.hour57="57-hour",e.hour58="58-hour",e.hour59="59-hour",e.hour60="60-hour",e.hour61="61-hour",e.hour62="62-hour",e.hour63="63-hour",e.hour64="64-hour",e.hour65="65-hour",e.hour66="66-hour",e.hour67="67-hour",e.hour68="68-hour",e.hour69="69-hour",e.hour70="70-hour",e.hour71="71-hour",e.hour72="72-hour",e.hour73="73-hour",e.hour74="74-hour",e.hour75="75-hour",e.hour76="76-hour",e.hour77="77-hour",e.hour78="78-hour",e.hour79="79-hour",e.hour80="80-hour",e.hour81="81-hour",e.hour82="82-hour",e.hour83="83-hour",e.hour84="84-hour",e.hour85="85-hour",e.hour86="86-hour",e.hour87="87-hour",e.hour88="88-hour",e.hour89="89-hour",e.hour90="90-hour",e.hour91="91-hour",e.hour92="92-hour",e.hour93="93-hour",e.hour94="94-hour",e.hour95="95-hour",e.hour96="96-hour",e.hour97="97-hour",e.hour98="98-hour",e.hour99="99-hour",e.hour100="100-hour",e.hour101="101-hour",e.hour102="102-hour",e.hour103="103-hour",e.hour104="104-hour",e.hour105="105-hour",e.hour106="106-hour",e.hour107="107-hour",e.hour108="108-hour",e.hour109="109-hour",e.hour110="110-hour",e.hour111="111-hour",e.hour112="112-hour",e.hour113="113-hour",e.hour114="114-hour",e.hour115="115-hour",e.hour116="116-hour",e.hour117="117-hour",e.hour118="118-hour",e.hour119="119-hour",e.hour120="120-hour",e.hour121="121-hour",e.hour122="122-hour",e.hour123="123-hour",e.hour124="124-hour",e.hour125="125-hour",e.hour126="126-hour",e.hour127="127-hour",e.hour128="128-hour",e.hour129="129-hour",e.hour130="130-hour",e.hour131="131-hour",e.hour132="132-hour",e.hour133="133-hour",e.hour134="134-hour",e.hour135="135-hour",e.hour136="136-hour",e.hour137="137-hour",e.hour138="138-hour",e.hour139="139-hour",e.hour140="140-hour",e.hour141="141-hour",e.hour142="142-hour",e.hour143="143-hour",e.hour144="144-hour",e.hour145="145-hour",e.hour146="146-hour",e.hour147="147-hour",e.hour148="148-hour",e.hour149="149-hour",e.hour150="150-hour",e.hour151="151-hour",e.hour152="152-hour",e.hour153="153-hour",e.hour154="154-hour",e.hour155="155-hour",e.hour156="156-hour",e.hour157="157-hour",e.hour158="158-hour",e.hour159="159-hour",e.hour160="160-hour",e.hour161="161-hour",e.hour162="162-hour",e.hour163="163-hour",e.hour164="164-hour",e.hour165="165-hour",e.hour166="166-hour",e.hour167="167-hour",e.hour168="168-hour",e}(Ui||{}),Ar=function(e){return e["0-day"]="0",e["1-day"]="1",e["2-day"]="2",e["3-day"]="3",e["4-day"]="4",e["5-day"]="5",e["6-day"]="6",e["7-day"]="7",e["0-month"]="0",e["1-month"]="1",e["2-month"]="2",e["3-month"]="3",e["4-month"]="4",e["5-month"]="5",e["6-month"]="6",e["7-month"]="7",e["8-month"]="8",e["9-month"]="9",e["10-month"]="10",e["11-month"]="11",e["0-hour"]="0",e["1-hour"]="1",e["2-hour"]="2",e["3-hour"]="3",e["4-hour"]="4",e["5-hour"]="5",e["6-hour"]="6",e["7-hour"]="7",e["8-hour"]="8",e["9-hour"]="9",e["10-hour"]="10",e["11-hour"]="11",e["12-hour"]="12",e["13-hour"]="13",e["14-hour"]="14",e["15-hour"]="15",e["16-hour"]="16",e["17-hour"]="17",e["18-hour"]="18",e["19-hour"]="19",e["20-hour"]="20",e["21-hour"]="21",e["22-hour"]="22",e["23-hour"]="23",e["24-hour"]="24",e["25-hour"]="25",e["26-hour"]="26",e["27-hour"]="27",e["28-hour"]="28",e["29-hour"]="29",e["30-hour"]="30",e["31-hour"]="31",e["32-hour"]="32",e["33-hour"]="33",e["34-hour"]="34",e["35-hour"]="35",e["36-hour"]="36",e["37-hour"]="37",e["38-hour"]="38",e["39-hour"]="39",e["40-hour"]="40",e["41-hour"]="41",e["42-hour"]="42",e["43-hour"]="43",e["44-hour"]="44",e["45-hour"]="45",e["46-hour"]="46",e["47-hour"]="47",e["48-hour"]="48",e["49-hour"]="49",e["50-hour"]="50",e["51-hour"]="51",e["52-hour"]="52",e["53-hour"]="53",e["54-hour"]="54",e["55-hour"]="55",e["56-hour"]="56",e["57-hour"]="57",e["58-hour"]="58",e["59-hour"]="59",e["60-hour"]="60",e["61-hour"]="61",e["62-hour"]="62",e["63-hour"]="63",e["64-hour"]="64",e["65-hour"]="65",e["66-hour"]="66",e["67-hour"]="67",e["68-hour"]="68",e["69-hour"]="69",e["70-hour"]="70",e["71-hour"]="71",e["72-hour"]="72",e["73-hour"]="73",e["74-hour"]="74",e["75-hour"]="75",e["76-hour"]="76",e["77-hour"]="77",e["78-hour"]="78",e["79-hour"]="79",e["80-hour"]="80",e["81-hour"]="81",e["82-hour"]="82",e["83-hour"]="83",e["84-hour"]="84",e["85-hour"]="85",e["86-hour"]="86",e["87-hour"]="87",e["88-hour"]="88",e["89-hour"]="89",e["90-hour"]="90",e["91-hour"]="91",e["92-hour"]="92",e["93-hour"]="93",e["94-hour"]="94",e["95-hour"]="95",e["96-hour"]="96",e["97-hour"]="97",e["98-hour"]="98",e["99-hour"]="99",e["100-hour"]="100",e["101-hour"]="101",e["102-hour"]="102",e["103-hour"]="103",e["104-hour"]="104",e["105-hour"]="105",e["106-hour"]="106",e["107-hour"]="107",e["108-hour"]="108",e["109-hour"]="109",e["110-hour"]="110",e["111-hour"]="111",e["112-hour"]="112",e["113-hour"]="113",e["114-hour"]="114",e["115-hour"]="115",e["116-hour"]="116",e["117-hour"]="117",e["118-hour"]="118",e["119-hour"]="119",e["120-hour"]="120",e["121-hour"]="121",e["122-hour"]="122",e["123-hour"]="123",e["124-hour"]="124",e["125-hour"]="125",e["126-hour"]="126",e["127-hour"]="127",e["128-hour"]="128",e["129-hour"]="129",e["130-hour"]="130",e["131-hour"]="131",e["132-hour"]="132",e["133-hour"]="133",e["134-hour"]="134",e["135-hour"]="135",e["136-hour"]="136",e["137-hour"]="137",e["138-hour"]="138",e["139-hour"]="139",e["140-hour"]="140",e["141-hour"]="141",e["142-hour"]="142",e["143-hour"]="143",e["144-hour"]="144",e["145-hour"]="145",e["146-hour"]="146",e["147-hour"]="147",e["148-hour"]="148",e["149-hour"]="149",e["150-hour"]="150",e["151-hour"]="151",e["152-hour"]="152",e["153-hour"]="153",e["154-hour"]="154",e["155-hour"]="155",e["156-hour"]="156",e["157-hour"]="157",e["158-hour"]="158",e["159-hour"]="159",e["160-hour"]="160",e["161-hour"]="161",e["162-hour"]="162",e["163-hour"]="163",e["164-hour"]="164",e["165-hour"]="165",e["166-hour"]="166",e["167-hour"]="167",e["168-hour"]="168",e}(Ar||{}),yn=function(e){return e.day="day",e.month="month",e.hour="hour",e}(yn||{}),z_=function(e){return e.default="ccc dd",e.typhoon="dd ccc",e["flash-floods"]="dd ccc",e}(z_||{}),H_=function(e){return e.default="LLL yyyy",e.typhoon="ccc dd LLL",e["flash-floods"]="ccc dd LLL",e}(H_||{});var Zt=(()=>{class e{constructor(){this.placeCodeSubject=new Yt(null),this.placeCodeHoverSubject=new Yt(null),this.setPlaceCode=t=>{this.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChangeByPlaceCode),this.placeCodeSubject.next(t)},this.onPlaceCodeChangeByPlaceCode=t=>i=>{i&&t&&(t=i.placeCode===t.placeCode?null:t)},this.clearPlaceCode=()=>{this.placeCodeSubject.next(null)},this.setPlaceCodeHover=t=>{this.getPlaceCodeHoverSubscription().subscribe(this.onPlaceCodeHoverChangeByPlaceCode),this.placeCodeHoverSubject.next(t)},this.onPlaceCodeHoverChangeByPlaceCode=t=>i=>{i&&t&&(t=i.placeCode===t.placeCode?null:t)},this.clearPlaceCodeHover=()=>{this.placeCodeHoverSubject.next(null)}}getPlaceCodeSubscription(){return this.placeCodeSubject.asObservable()}getPlaceCodeHoverSubscription(){return this.placeCodeHoverSubject.asObservable()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var tn=(()=>{class e{constructor(t,i,o,s,l){if(this.countryService=t,this.disasterTypeService=i,this.eventService=o,this.apiService=s,this.placeCodeService=l,this.startingState={today:Fe.now(),timeStepButtons:[],activeLeadTime:null},this.state=this.startingState,this.timelineStateSubject=new Yt(this.startingState),this.isLoadingSubject=new Yt(!1),this.isLoading=this.isLoadingSubject.asObservable().pipe(fC(QC)),this.isInitialized=!1,this.onCountryChange=u=>{this.resetState(),this.country=u},this.onDisasterTypeChange=u=>{this.resetState(),this.disasterType=u},this.onInitialEventStateChange=u=>{this.eventState=u,this.country&&this.disasterType&&this.eventState&&this.loadTimeStepButtons()},this.onManualEventStateChange=u=>{this.eventState=u},this.leadTimeToLeadTimeButton=(u,d)=>{let f=u.leadTime,p=this.eventState.events.filter(E=>E.disasterSpecificProperties?.typhoonNoLandfallYet).map(E=>E.firstLeadTime).includes(f),m=Ar[f],g=this.alertsAllEvents?.[f]==="1"||u.forecastAlert,v=!p||p&&u.undefinedLeadTime,C=g&&v;this.state.timeStepButtons[d]={date:this.getLeadTimeDate(f,m,u.undefinedLeadTime),unit:f.split("-")[1],value:f,forecastAlert:C,trigger:C&&(u.trigger||this.alertsAllEvents[`${f}-forecastTrigger`]==="1"),active:!1,eventNames:u.eventNames}},this.onAlertPerLeadTime=u=>{this.alertsAllEvents=u,this.state.timeStepButtons=[],this.getVisibleLeadTimes().map(this.leadTimeToLeadTimeButton);let f,p;this.eventState.event?(f=this.eventState.event.firstTriggerLeadTime??this.eventState.event.firstLeadTime,p=this.eventState.event.eventName):this.eventState.events?.length==0&&(f=this.getFallbackNoTriggerLeadTime(this.disasterType.disasterType)),this.setTimelineState(f,p)},this.onLastUploadDate=u=>{u.timestamp||u.date?this.state.today=Fe.fromISO(u.timestamp||u.date):this.state.today=Fe.now(),this.isLoadingSubject.next(!0),this.apiService.getAlertPerLeadTime(this.country.countryCodeISO3,this.disasterType.disasterType,null).subscribe(this.onAlertPerLeadTime)},this.deactivateLeadTimeButton=u=>u.active=!1,this.isInitialized){console.warn("\u26A0\uFE0F TimelineService: Attempted multiple initialization - skipping");return}console.log("\u{1F504} TimelineService: Initializing subscriptions"),this.isInitialized=!0,this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onInitialEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onManualEventStateChange)}ngOnDestroy(){this.countrySubscription&&this.countrySubscription.unsubscribe(),this.disasterTypeSubscription&&this.disasterTypeSubscription.unsubscribe(),this.initialEventStateSubscription&&this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription&&this.manualEventStateSubscription.unsubscribe()}resetState(){this.alertsAllEvents=null,this.eventState=this.eventService.nullState,this.state=this.startingState}getTimelineStateSubscription(){return this.timelineStateSubject.asObservable()}getFallbackNoTriggerLeadTime(t){return t===Rt.floods?Ui.day1:t===Rt.flashFloods?Ui.hour1:null}loadTimeStepButtons(){this.country&&this.disasterType&&this.eventState&&this.apiService.getLastUploadDate(this.country.countryCodeISO3,this.disasterType.disasterType).subscribe(this.onLastUploadDate)}setTimelineState(t,i){this.placeCodeService.clearPlaceCode(),this.placeCodeService.clearPlaceCodeHover(),this.state.activeLeadTime=t,this.state.timeStepButtons.forEach(this.deactivateLeadTimeButton);let o=this.state.timeStepButtons.filter(s=>s.eventNames.includes(i)&&s.forecastAlert);for(let s of o)s.active=!0;this.timelineStateSubject.next(this.state),this.isLoadingSubject.next(!1)}getLeadTimeDate(t,i,o){if(!o){if(t.includes(yn.day))return this.state.today.plus({days:Number(i)});if(t.includes(yn.hour))return this.state.today.plus({hours:Number(i)});if(t.includes(yn.month))return this.state.today.plus({months:Number(i)})}}getVisibleLeadTimes(){let t=[],i=[],o=this.disasterType.minLeadTime,s=Number(this.disasterType.maxLeadTime.split("-")[0]);for(;Number(o.split("-")[0])<=s;)i.push(o),o=o.replace(o.split("-")[0],String(Number(o.split("-")[0])+1));for(let u of this.eventState.events){let d=u.duration||1,f=u.firstTriggerLeadTime||u.firstLeadTime;for(let p=0;p<d;p++){let m=`${String(Number(f.split("-")[0])+p)}-${u.firstLeadTime.split("-")[1]}`;if(!t.map(g=>g.leadTime).includes(m))m.includes(this.disasterType.leadTimeUnit)&&t.push({leadTime:m,eventNames:[u.eventName],forecastAlert:!0,trigger:u.alertLevel===Dn.TRIGGER,undefinedLeadTime:!1});else{let g=t.find(v=>v.leadTime===m);g.eventNames.push(u.eventName),g.trigger=g.trigger||u.alertLevel===Dn.TRIGGER}}}for(let u of i)!t.map(d=>d.leadTime).includes(u)&&this.filterVisibleLeadTimePerDisasterType(this.disasterType,u,t)&&t.push({leadTime:u,eventNames:[],forecastAlert:!1,trigger:!1,undefinedLeadTime:!1});t.sort((u,d)=>Number(Ar[u.leadTime])>Number(Ar[d.leadTime])?1:-1);let l=this.eventState?.events.filter(u=>u.disasterSpecificProperties?.typhoonNoLandfallYet);if(l)for(let u of l)t.push({leadTime:u.firstLeadTime,eventNames:[u.eventName],forecastAlert:!0,trigger:u.alertLevel===Dn.TRIGGER,undefinedLeadTime:!0});return t}getDateFromLeadTime(t){return this.getLeadTimeDate(t,Ar[t],!1).toISODate()}filterVisibleLeadTimePerDisasterType(t,i,o){return t.disasterType===Rt.typhoon?[Ui.hour0,Ui.hour24,Ui.hour48,Ui.hour72,Ui.hour96,Ui.hour120,Ui.hour144,Ui.hour168].includes(i)&&!o.map(s=>this.getDateFromLeadTime(s.leadTime)).includes(this.getDateFromLeadTime(i)):t.disasterType===Rt.flashFloods?[Ui.hour0,Ui.hour24,Ui.hour48].includes(i)&&!o.map(s=>this.getDateFromLeadTime(s.leadTime)).includes(this.getDateFromLeadTime(i)):!0}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(it),fe(ze),fe(ui),fe(Zt))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Sn=(()=>{class e{static loadAdminLevelLabels(t){let i={adminLevel1:"",adminLevel2:"",adminLevel3:"",adminLevel4:""};return t.adminRegionLabels[1]&&(i.adminLevel1=t.adminRegionLabels[1].plural),t.adminRegionLabels[2]&&(i.adminLevel2=t.adminRegionLabels[2].plural),t.adminRegionLabels[3]&&(i.adminLevel3=t.adminRegionLabels[3].plural),t.adminRegionLabels[4]&&(i.adminLevel4=t.adminRegionLabels[4].plural),i}constructor(t,i,o,s){this.countryService=t,this.disasterTypeService=i,this.eventService=o,this.timelineService=s,this.adminLevelSubject=new Yt(on.adminLevel1),this.oldAdminLevel=null,this.adminLevelButtonsSubject=new Yt([]),this.adminLevelLabel=new lf,this.activeLayerNames=[],this.onCountryChange=l=>{this.country=l},this.onDisasterTypeChange=l=>{this.disasterType=l,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType),this.activeLayerNames=[]},this.onInitialEventStateChange=l=>{this.eventState=l,this.activeLayerNames=[]},this.onTimelineStateChange=l=>{this.timelineState=l,this.country&&this.disasterType&&this.eventState&&this.timelineState&&this.processAdminLevel()},this.getAdminLevelSubscription=()=>this.adminLevelSubject.asObservable(),this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.eventService.getInitialEventStateSubscription().subscribe(this.onInitialEventStateChange),this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange)}processAdminLevel(){this.allCountryAdminLevels=Object.keys(this.country.adminRegionLabels).map(t=>Number(t)),this.setAdminLevel(this.countryDisasterSettings.defaultAdminLevel),this.adminLevelLabel=e.loadAdminLevelLabels(this.country),this.adminLevelButtons=this.allCountryAdminLevels.map(t=>({adminLevel:t,disabled:!this.countryDisasterSettings.adminLevels.includes(t),label:this.country.adminRegionLabels[t].plural,buttonTypeClass:this.getButtonTypeClass(t)})),this.adminLevelButtonsSubject.next(this.adminLevelButtons)}getAdminLevelButtonsSubscription(){return this.adminLevelButtonsSubject.asObservable()}setAdminLevel(t){this.adminLevel=t,this.adminLevelSubject.next(this.adminLevel)}zoomInAdminLevel(){let t=this.countryDisasterSettings.adminLevels;this.adminLevel<t[t.length-1]&&(this.adminLevel=this.adminLevel+1,this.adminLevelSubject.next(this.adminLevel))}zoomOutAdminLevel(){this.adminLevel>this.countryDisasterSettings.defaultAdminLevel&&(this.adminLevel=this.adminLevel-1,this.adminLevelSubject.next(this.adminLevel))}zoomToDefaultAdminLevel(){this.adminLevel=this.countryDisasterSettings.defaultAdminLevel,this.adminLevelSubject.next(this.adminLevel)}getButtonTypeClass(t){let i="breadcrumb-",o=this.allCountryAdminLevels?.length;return o===1?`${i}alone`:t===on.adminLevel1?`${i}start`:Number(t)===o?`${i}end`:`${i}middle`}getAdminLevelType(t){return this.countryDisasterSettings.adminLevels?.length===1?$i.single:this.isDeepestAdminLevel(t)?$i.deepest:$i.higher}isDeepestAdminLevel(t){return this.countryDisasterSettings.adminLevels[this.countryDisasterSettings.adminLevels.length-1]===this.adminLevel&&t?.adminLevel===this.adminLevel}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(it),fe(ze),fe(tn))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var lr=63710088e-1,KW={centimeters:lr*100,centimetres:lr*100,degrees:360/(2*Math.PI),feet:lr*3.28084,inches:lr*39.37,kilometers:lr/1e3,kilometres:lr/1e3,meters:lr,metres:lr,miles:lr/1609.344,millimeters:lr*1e3,millimetres:lr*1e3,nauticalmiles:lr/1852,radians:1,yards:lr*1.0936};function iS(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function nS(e,n,t){if(e!==null)for(var i,o,s,l,u,d,f,p=0,m=0,g,v=e.type,C=v==="FeatureCollection",E=v==="Feature",b=C?e.features.length:1,S=0;S<b;S++){f=C?e.features[S].geometry:E?e.geometry:e,g=f?f.type==="GeometryCollection":!1,u=g?f.geometries.length:1;for(var I=0;I<u;I++){var z=0,j=0;if(l=g?f.geometries[I]:f,l!==null){d=l.coordinates;var k=l.type;switch(p=t&&(k==="Polygon"||k==="MultiPolygon")?1:0,k){case null:break;case"Point":if(n(d,m,S,z,j)===!1)return!1;m++,z++;break;case"LineString":case"MultiPoint":for(i=0;i<d.length;i++){if(n(d[i],m,S,z,j)===!1)return!1;m++,k==="MultiPoint"&&z++}k==="LineString"&&z++;break;case"Polygon":case"MultiLineString":for(i=0;i<d.length;i++){for(o=0;o<d[i].length-p;o++){if(n(d[i][o],m,S,z,j)===!1)return!1;m++}k==="MultiLineString"&&z++,k==="Polygon"&&j++}k==="Polygon"&&z++;break;case"MultiPolygon":for(i=0;i<d.length;i++){for(j=0,o=0;o<d[i].length;o++){for(s=0;s<d[i][o].length-p;s++){if(n(d[i][o][s],m,S,z,j)===!1)return!1;m++}j++}z++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(nS(l.geometries[i],n,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function NO(e,n={}){if(e.bbox!=null&&n.recompute!==!0)return e.bbox;let t=[1/0,1/0,-1/0,-1/0];return nS(e,i=>{t[0]>i[0]&&(t[0]=i[0]),t[1]>i[1]&&(t[1]=i[1]),t[2]<i[0]&&(t[2]=i[0]),t[3]<i[1]&&(t[3]=i[1])}),t}var V_=NO;function mp(e){if(e.length>1&&iS(e[0])&&iS(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return mp(e[0]);throw new Error("coordinates must only contain numbers")}var OD=Xl(Vu(),1);var W_=function(e){return e.ifTrigger="if-trigger",e.no="no",e.yes="yes",e}(W_||{});var Li=function(e){return e.break0="break0",e.break1="break1",e.break2="break2",e.break3="break3",e.break4="break4",e.break5="break5",e}(Li||{});var wO=e=>e.sort((n,t)=>n-t),Gu=(e,n)=>{let t=wO(e),i=(t.length-1)*n,o=Math.floor(i),s=i-o;return t[o+1]!==void 0?t[o]+s*(t[o+1]-t[o]):t[o]},rS=e=>e.toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ");var Z_=[{id:"disaster-risk-reduction",label:"Disaster Risk Reduction",description:"Disaster Risk Reduction (DRR) is a systematic approach to identifying, assessing and reducing the risks of disaster.<br><br>It aims to reduce socio-economic vulnerabilities to disaster as well as dealing with the environmental and other hazards that trigger them.",icon:"Disaster risk reduction.svg"},{id:"shelter",label:"Shelter",description:"Shelter and Non-Food Items includes provision of shelter materials and non-food household item packages.<br><br>The theme also covers Camp Coordination and Camp Management.<br><br>Long-term/permanent reconstruction/rebuilding of housing is not covered by this area of focus.",icon:"Shelter.svg"},{id:"livelihood",label:"Livelihoods & Basic Needs",description:"Disasters can take a devastating toll on people's food security livelihoods and their basic needs.<br><br>They can increase people's socio-economic vulnerability and seriously impact their ability to recover, which in turn affects their ability to cope with future shocks and stresses.<br><br>These actions are aimed at protecting these needs as preparation for forecasted hazards.",icon:"Livelihood.svg"},{id:"health",label:"Health",description:"Health includes emergency medical services, equipment and supplies; reproductive health; psycho-social support; mobile medical clinics; and disease control and surveillance.",icon:"Health.svg"},{id:"wash",label:"WASH",description:"Water, Sanitation, and Hygiene includes emergency provision of safe drinking water, hygiene and sanitation services, environmental sanitation and water supply, as well as hygiene promotion campaigns.",icon:"Water-Sanitation-and-Hygiene.svg"},{id:"inclusion",label:"Protection, Gender and Inclusion",description:"People affected by disasters can have very different experiences.<br>A person's sex, gender identity, age, physical ability, race, nationality and many other factors can influence how they are vulnerable to, and affected by disasters, conflicts and crises. They can also affect how they respond and recover.<br><br>Emergencies can also make existing inequalities worse. This can be seen in the increase in incidences of sexual and gender-based violence (SGBV), violence against children and trafficking in human beings during and after emergencies.<br><ul><li><strong>Protection</strong> - addressing violence and keeping people safe from harm</li><li><strong>Gender and diversity</strong> - addressing discrimination and understanding people's different needs, risks and capacities</li><li><strong>Inclusion</strong> - actively addressing exclusion by meaningfully involving and engaging excluded people in our work</li></ul>",icon:"Gender.svg"},{id:"migration",label:"Migration",description:"Migration and displacement pose some of the biggest humanitarian challenges of our time.<br><br>These actions are aimed at supporting people on the move with saving lives and preventing suffering, help people cope with the risks and challenges of migration and work to protect and restore their dignity.",icon:"Internally-displaced.svg"}];var Ds=(()=>{class e{constructor(t,i,o,s,l,u,d){this.countryService=t,this.apiService=i,this.timelineService=o,this.disasterTypeService=s,this.adminLevelService=l,this.eventService=u,this.placeCodeService=d,this.alertAreaSubject=new Yt([]),this.onCountryChange=f=>{this.country=f},this.onDisasterTypeChange=f=>{this.disasterType=f,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onTimelineStateChange=f=>{this.timelineState=f},this.onEventStatusChange=f=>{this.eventState=f},this.onAdminLevelChange=()=>{this.placeCode?this.adminLevelService.getAdminLevelType(this.placeCode)!==$i.higher&&this.loadAlertAreas():this.loadAlertAreas()},this.onPlaceCodeChange=f=>{this.placeCode=f,this.loadAlertAreas()},this.processAlertAreas=f=>{this.alertAreas=f,this.alertAreas.sort((p,m)=>p.forecastSeverity===m.forecastSeverity?p.mainExposureValue>m.mainExposureValue?-1:1:p.forecastSeverity>m.forecastSeverity?-1:1),this.getActiveLeadtime()&&this.alertAreas.forEach(p=>{this.formatDates(p),this.filterEapActionsByMonth(p),p.eapActions.forEach(m=>{if(m.aofLabel=Z_.find(g=>g.id===m.aof).label,m?.month&&Object.keys(m.month).length){m.monthLong={};for(let g of Object.keys(m.month))m.monthLong[g]=Fe.utc(2022,m.month[g][this.currentRainSeasonName],1).monthLong}else m.month=null})}),this.alertAreaSubject.next(this.alertAreas)},this.formatDates=f=>{f.firstIssuedDate=Fe.fromISO(f.firstIssuedDate).toFormat("cccc, dd LLLL")},this.filterEapActionsByMonth=f=>{if(!this.countryDisasterSettings.showMonthlyEapActions)return;let p=this.getRegion(f);this.currentRainSeasonName=f.eventName.split("_")[0];let m=[];this.currentRainSeasonName&&(m=this.countryDisasterSettings.droughtSeasonRegions[p][this.currentRainSeasonName].actionMonths);let g=C=>m.includes(C.month[p][this.currentRainSeasonName]),v=C=>m.indexOf(C.month[p][this.currentRainSeasonName])<=m.indexOf(this.getCurrentMonth());f.eapActions=f.eapActions.filter(C=>g(C)&&v(C)).sort((C,E)=>{let b=C.month?.[p]?.[this.currentRainSeasonName],S=E.month?.[p]?.[this.currentRainSeasonName];return m.indexOf(b)-m.indexOf(S)})},this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.adminLevelService.getAdminLevelSubscription().subscribe(this.onAdminLevelChange),this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStatusChange),this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange)}loadAlertAreas(){if(this.country&&this.disasterType&&this.timelineState&&this.eventState){let t=this.placeCode?.adminLevel||this.countryDisasterSettings.defaultAdminLevel;if(t>this.countryDisasterSettings.defaultAdminLevel)this.apiService.getAlertAreas(this.country.countryCodeISO3,this.disasterType.disasterType,t,this.eventState.event?.eventName).subscribe(this.processAlertAreas);else if(this.eventState?.event)this.processAlertAreas(this.eventState.event.alertAreas);else if(this.eventState?.events.length){let i=this.eventState.events.flatMap(o=>o.alertAreas||[]);this.processAlertAreas(i)}else this.processAlertAreas([])}}getAlertAreas(){return this.alertAreaSubject.asObservable()}getRegion(t){let i="National";if(!this.countryDisasterSettings.droughtRegions)return i;let o=Object.keys(this.countryDisasterSettings.droughtRegions),s=l=>this.countryDisasterSettings.droughtRegions[l].includes(t.placeCode);for(let l of o)if(s(l))return l}checkEapAction(t,i,o,s){return this.apiService.checkEapAction(t,this.country.countryCodeISO3,this.disasterType.disasterType,i,o,s)}getCurrentMonth(){return this.timelineState.today.month}getActiveLeadtime(){return this.timelineState.activeLeadTime}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(ui),fe(tn),fe(it),fe(Sn),fe(ze),fe(Zt))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Oo=(()=>{class e{constructor(t,i,o,s,l,u,d,f){this.countryService=t,this.adminLevelService=i,this.timelineService=o,this.apiService=s,this.eventService=l,this.placeCodeService=u,this.disasterTypeService=d,this.alertAreaService=f,this.layerSubject=new Yt(null),this.layers=[],this.triggeredAreaColor="var(--ion-color-ibf-outline-red)",this.nonTriggeredAreaColor="var(--ion-color-ibf-no-alert-primary)",this.layerDataCache={},this.state={bounds:[[-20,-20],[20,20]],colorGradientNoAlert:["#F2F5FD","#D6E0FA","#A0B6EB","#3D66B4","#0E357B"],colorGradientAlert:["#F3F0FF","#C8BAF5","#A38CEC","#7B59E2","#4F22D7"],defaultFillColor:"#A0B6EB",strokeColor:"#969696",noDataColor:"#d3dae0",transparentColor:"transparent",defaultFillOpacity:.8,defaultWeight:1},this.onCountryChange=p=>{this.country=p},this.onDisasterTypeChange=p=>{this.disasterType=p},this.onAdminLevelChange=p=>{this.adminLevel=p},this.onTimelineStateChange=p=>{this.timelineState=p},this.onEventStateChange=p=>{this.eventState=p},this.onAlertAreasChange=p=>{this.alertAreas=p,this.loadLayers()},this.onPlaceCodeChange=p=>{this.placeCode=p},this.onLayerChange=p=>{p.forEach(m=>{let g=this.getActiveState(m);m.type===si.wms?this.loadWmsLayer(m,g,m.leadTimeDependent):m.name===pe.adminRegions1?this.loadAdminRegionLayer(g,on.adminLevel1):m.name===pe.adminRegions2?this.loadAdminRegionLayer(g,on.adminLevel2):m.name===pe.adminRegions3?this.loadAdminRegionLayer(g,on.adminLevel3):m.name===pe.adminRegions4?this.loadAdminRegionLayer(g,on.adminLevel4):m.name===pe.typhoonTrack?this.loadTyphoonTrackLayer(m,g):m.type===si.point&&this.loadPointDataLayer(m,g)})},this.addTyphoonTrackLayer=(p,m)=>{this.addLayer({name:pe.typhoonTrack,label:bs.typhoonTrack,type:si.point,group:pt.point,description:this.getPopoverText(p),active:this.adminLevelService.activeLayerNames.length?this.adminLevelService.activeLayerNames.includes(pe.typhoonTrack):!0,show:!0,data:m,viewCenter:!1,order:0})},this.loadPointDataLayer=(p,m)=>{this.country&&(m?this.apiService.getPointData(this.country.countryCodeISO3,p.name,this.disasterType.disasterType).subscribe(g=>{this.addPointDataLayer(p,g)}):this.addPointDataLayer(p,null))},this.addPointDataLayer=(p,m)=>{this.addLayer({name:p.name,label:p.label,type:si.point,group:pt.point,description:this.getPopoverText(p),active:this.adminLevelService.activeLayerNames.length?this.adminLevelService.activeLayerNames.includes(p.name):this.getActiveState(p),show:!0,data:m,viewCenter:!1,order:1})},this.filterNonAggregateLayers=p=>p.group!==pt.aggregates&&p.group!==pt.outline,this.removeAggregateLayers=()=>{this.layers=this.layers.filter(this.filterNonAggregateLayers)},this.getLayerIndexByName=p=>this.layers.findIndex(m=>m.name===p),this.getLayerByName=p=>{let m=this.getLayerIndexByName(p);return m!==-1?this.layers[m]:null},this.isLayerActive=(p,m)=>{if(p.group===pt.outline&&this.eventState?.events?.length>0)return!0;let g=m.active!=null,v=p.name===m.name,C=p.group===m.group,E=p.active;return g&&C&&(v?E=m.active:p.group&&(E=!1)),E},this.isLayerShown=(p,m)=>m.show==null||p.name!==m.name?p.show:m.show,this.updateLayer=p=>m=>{this.addLayer({name:p.name,label:p.label,type:p.type,description:p.description,active:this.adminLevelService.activeLayerNames.length?this.adminLevelService.activeLayerNames.includes(p.name):p.active,viewCenter:!1,data:m,wms:p.wms,colorProperty:p.group===pt.adminRegions?this.disasterType.mainExposureIndicator:p.colorProperty,colorBreaks:p.colorBreaks,numberFormatMap:p.numberFormatMap,legendColor:p.legendColor,group:p.group,order:p.order,unit:p.unit,dynamic:p.dynamic,show:p.show})},this.toggleLayer=p=>{if(!p){console.warn("toggleLayer called with undefined/null layer");return}p.active=!p.active,this.adminLevelService.activeLayerNames=[],this.updateLayers(p)},this.updateLayers=p=>{this.layers.forEach(m=>{if(m.name===p.name||m.group===pt.aggregates||m.group===pt.outline){let g=this.getLayerDataCacheKey(m.name);if(m.active=this.isLayerActive(m,p),m.show=this.isLayerShown(m,p),this.layerDataCache[g]){let v=this.layerDataCache[g];this.updateLayer(m)(v)}else m.active&&this.getLayerData(m).subscribe(v=>{this.layerDataCache[g]=v,this.updateLayer(m)(v)})}})},this.getLayerData=p=>{let m;if(p.name===pe.typhoonTrack)m=this.apiService.getTyphoonTrack(this.country.countryCodeISO3,this.eventState?.event?.eventName).pipe(Jl(1));else if(p.type===si.point)m=this.apiService.getPointData(this.country.countryCodeISO3,p.name,this.disasterType.disasterType).pipe(Jl(1));else if(p.name===pe.adminRegions)m=this.apiService.getAdminRegions(this.country.countryCodeISO3,this.disasterType.disasterType,this.timelineState.activeLeadTime,this.adminLevel,this.eventState?.event?.eventName,this.getPlaceCodeParent()).pipe(Jl(1));else if(p.group===pt.adminRegions){let g=Number(p.name.slice(-1));m=this.apiService.getAdminRegions(this.country.countryCodeISO3,this.disasterType.disasterType,this.timelineState.activeLeadTime,g,this.eventState?.event?.eventName,this.getPlaceCodeParent()).pipe(Jl(1))}else p.group===pt.aggregates||p.group===pt.outline?m=this.getCombineAdminRegionData(this.country.countryCodeISO3,this.disasterType.disasterType,this.adminLevel,p.name,p.dynamic,this.timelineState.activeLeadTime,this.eventState?.event?.eventName).pipe(Jl(1)):m=uC(null);return m},this.getAdminRegionFillColor=(p,m)=>{let g=this.state.defaultFillColor,v=this.eventState.events?.length?this.state.colorGradientAlert:this.state.colorGradientNoAlert;switch(!0){case p===null:g=this.state.noDataColor;break;case(p<=m[Li.break1]||!m[Li.break1]):g=v[0];break;case(p<=m[Li.break2]||!m[Li.break2]):g=v[1];break;case(p<=m[Li.break3]||!m[Li.break3]):g=v[2];break;case(p<=m[Li.break4]||!m[Li.break4]):g=v[3];break;case p>m[Li.break4]:g=v[4];break;default:g=this.state.defaultFillColor}return g},this.getAdminRegionFillOpacity=p=>{let m=this.state.defaultFillOpacity;return p.group===pt.adminRegions&&(m=0),m},this.getAdminRegionWeight=(p,m)=>{let g=p.name===pe.adminRegions?this.state.defaultWeight:p.group===pt.adminRegions?this.adminLevelLowerThanDefault(p.name)?3:.33:this.state.defaultWeight;if(this.placeCode){let v=this.alertAreas.find(C=>C.placeCode===m);this.placeCode.placeCode===m&&!v&&(g=3)}return g},this.adminLevelLowerThanDefault=p=>p.slice(-1)<String(this.adminLevel),this.getAdminRegionColor=p=>p.group===pt.adminRegions?this.state.strokeColor:this.state.transparentColor,this.getColorThreshold=(p,m,g)=>{if(g){let E={break0:0};return Object.keys(g).forEach(b=>{g[String(Number(b)+1)]&&(E[`break${b}`]=g[b].valueHigh)}),E}let v=p.features.map(E=>typeof E.properties[m]<"u"?E.properties[m]:E.properties.indicators?.[m]).filter((E,b,S)=>S.indexOf(E)===b);return{break0:Gu(v,0),break1:Gu(v,.2),break2:Gu(v,.4),break3:Gu(v,.6),break4:Gu(v,.8)}},this.setOutlineLayerStyle=p=>{let m=p.colorProperty;return g=>{let v=g?.properties?.placeCode,C=g?.properties?.placeCodeParent,E=this.getAreaByPlaceCode(v,C),b=typeof g.properties[m]<"u"?g.properties[m]:g.properties.indicators[m],S=this.getOutlineColor(b),I=this.getOutlineWeight(b,v,C,E);return{opacity:1,color:S,fillOpacity:0,weight:I}}},this.setAdminRegionStyle=p=>{let m=p.colorProperty,g=this.getColorThreshold(p.data,m,p.colorBreaks);return v=>{let C=v.properties.placeCode,E=typeof v.properties[m]<"u"?v.properties[m]:typeof v.properties.indicators<"u"?v.properties.indicators[m]:"undefined";if(E!=="undefined"){let b=this.getAdminRegionFillColor(E,g),S=this.getAdminRegionFillOpacity(p),I=this.getAdminRegionWeight(p,C),z=this.getAdminRegionColor(p);return{fillColor:b,fillOpacity:S,weight:I,color:z,className:`admin-boundary ${p.name}`}}}},this.setAdminRegionMouseOverStyle=(p,m)=>{let g=this.getAreaByPlaceCode(p,m);return g?g.alertLevel!==Dn.TRIGGER?{color:this.nonTriggeredAreaColor,weight:5}:{color:this.triggeredAreaColor,weight:5}:{color:this.layers.find(E=>E.name===pe.trigger).data.features.find(E=>E.properties.placeCode===p).properties.indicators[pe.trigger]?this.triggeredAreaColor:this.nonTriggeredAreaColor,weight:5}},this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.adminLevelService.getAdminLevelSubscription().subscribe(this.onAdminLevelChange),this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange),this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.alertAreaService.getAlertAreas().subscribe(this.onAlertAreasChange)}getPopoverText(t){return t.description?.[this.country.countryCodeISO3]?.[this.disasterType.disasterType]?t.description[this.country.countryCodeISO3][this.disasterType.disasterType]:""}loadLayers(){this.layers=[],this.layerSubject.next(null),this.country&&this.disasterType&&this.eventState&&this.timelineState&&this.adminLevel&&this.apiService.getLayers(this.country.countryCodeISO3,this.disasterType.disasterType).subscribe(this.onLayerChange)}loadTyphoonTrackLayer(t,i){this.country&&(i?this.apiService.getTyphoonTrack(this.country.countryCodeISO3,this.eventState?.event?.eventName).subscribe(o=>{this.addTyphoonTrackLayer(t,o)}):this.addTyphoonTrackLayer(t,null))}loadAdminRegionLayer(t,i){t&&i===this.adminLevel?this.apiService.getAdminRegions(this.country.countryCodeISO3,this.disasterType.disasterType,this.timelineState.activeLeadTime,i,this.eventState?.event?.eventName,this.getPlaceCodeParent()).subscribe(o=>{this.addAdminRegionLayer(o,i)}):this.addAdminRegionLayer(null,i)}addAdminRegionLayer(t,i){this.addLayer({name:`${pt.adminRegions}${i.toString()}`,label:`${pt.adminRegions}${i.toString()}`,group:pt.adminRegions,type:si.shape,description:"",active:this.adminLevel===i,show:!0,data:t,viewCenter:this.adminLevel===i,colorProperty:this.disasterType.mainExposureIndicator,order:0})}loadAggregateLayer(t){if(!(!this.country||!this.disasterType)&&t.countryDisasterTypes[this.country.countryCodeISO3][this.disasterType.disasterType]?.includes("map")){let i=this.adminLevelService.activeLayerNames.length?this.adminLevelService.activeLayerNames.includes(t.name):this.getActiveState(t);i&&this.timelineState?this.getCombineAdminRegionData(this.country.countryCodeISO3,this.disasterType.disasterType,this.adminLevel,t.name,t.dynamic,this.timelineState.activeLeadTime,this.eventState?.event?.eventName).subscribe(o=>{this.addAggregateLayer(t,o,i)}):this.addAggregateLayer(t,null,i)}}getActiveState(t){return t.active===W_.yes||t.active===W_.ifTrigger&&this.eventState?.events?.length>0}addAggregateLayer(t,i,o){this.addLayer({name:t.name,label:t.label,type:si.shape,description:this.getPopoverText(t),active:o,show:!0,data:i,viewCenter:!0,colorProperty:t.name,colorBreaks:t.colorBreaks,numberFormatMap:t.numberFormatMap,legendColor:this.eventState.events?.length?this.state.colorGradientAlert[2]:this.state.colorGradientNoAlert[2],group:t.name===pe.trigger?pt.outline:pt.aggregates,order:20+t.order,dynamic:t.dynamic,unit:t.unit})}loadWmsLayer(t,i,o){this.addLayer({name:t.name,label:t.label,type:si.wms,group:pt.wms,description:this.getPopoverText(t),active:i,show:!0,viewCenter:!1,data:null,legendColor:t.legendColor,order:10,wms:{url:xt.geoserverUrl,leadTimeDependent:o,format:"image/png",version:"1.1.0",attribution:"510 Global",crs:OD.CRS.EPSG4326,transparent:!0,viewparams:`countryCodeISO3:${this.country.countryCodeISO3}`}})}addLayer(t){let{name:i,viewCenter:o,data:s}=t,l=this.getLayerDataCacheKey(t.name);if(s&&(this.layerDataCache[l]=s),o&&s?.features?.length){let d=V_(s);this.state.bounds=mp(d)?[[d[1],d[0]],[d[3],d[2]]]:this.state.bounds}this.layerSubject.next(t);let u=this.getLayerIndexByName(i);u>=0?this.layers.splice(u,1,t):this.layers.push(t)}getLayerSubscription(){return this.layerSubject.asObservable()}getLayerDataCacheKey(t){return t===pe.waterpoints?`${this.country.countryCodeISO3}_${t}`:`${this.country.countryCodeISO3}_${this.disasterType.disasterType}_${this.timelineState.activeLeadTime}_${this.adminLevel.toString()}_${t}`}getPlaceCodeParent(t){t=t||this.placeCode;let i=this.adminLevelService.getAdminLevelType(t);return i===$i.single?null:i===$i.deepest?t?.placeCodeParent.placeCode:t?.placeCode}getCombineAdminRegionData(t,i,o,s,l,u,d){let f;l?f=this.apiService.getAdminAreaDynamicData(t,o,u,s,i,d):f=this.apiService.getAdminAreaData(t,o,s);let p=new U_;p.name=pe.adminRegions;let m=this.getLayerData(p);return pC(f,m).pipe(dC(([g,v])=>{let C=[];for(let E of v?.features||[]){let b=g.find(S=>{if(E.properties?.placeCode===S.placeCode)return S.value});E.properties.indicators={},E.properties.indicators[s]=b?b.value:null,C.push(E)}return v}))}getOutlineWeight(t,i,o,s){let l=t===1?3:.33;return this.placeCode&&![i,o].includes(this.placeCode.placeCode)&&s&&(l=l/3),l}getOutlineColor(t){return t===1?this.triggeredAreaColor:this.nonTriggeredAreaColor}getAreaByPlaceCode(t,i){return this.alertAreas.find(o=>o.placeCode===t)||this.alertAreas.find(o=>o.placeCode===i)}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(Sn),fe(tn),fe(ui),fe(ze),fe(Zt),fe(it),fe(Ds))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var $_=(()=>{class e{constructor(t,i,o,s){this.countryService=t,this.eventService=i,this.placeCodeService=o,this.disasterTypeService=s,this.breadcrumbsMapViewSubject=new Yt(null),this.aggregatesMapViewSubject=new Yt(null),this.onCountryChange=l=>{this.country=l},this.onDisasterTypeChange=l=>{this.disasterType=l,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onEventStateChange=l=>{this.eventState=l,this.updateBreadcrumbsMapView()},this.onPlacecodeChange=l=>{this.placeCode=l,this.updateBreadcrumbsMapView()},this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlacecodeChange)}setAggregatesMapView(t){this.aggregatesMapView=t,this.aggregatesMapViewSubject.next(this.aggregatesMapView)}setBreadcrumbsMapView(t){this.breadcrumbsMapView=t,this.breadcrumbsMapViewSubject.next(this.breadcrumbsMapView),this.setAggregatesMapView(t)}updateBreadcrumbsMapView(){if(!this.eventState?.event&&this.placeCode){this.setAggregatesMapView(tt.adminArea);return}if(!this.eventState?.event){this.setBreadcrumbsMapView(tt.national);return}if(this.eventState.event&&!this.placeCode){this.setBreadcrumbsMapView(tt.event);return}if(this.placeCode?.placeCodeParent?.placeCodeParent){this.setBreadcrumbsMapView(tt.adminArea3);return}if(this.placeCode?.placeCodeParent){this.setBreadcrumbsMapView(tt.adminArea2);return}if(this.placeCode){this.setBreadcrumbsMapView(tt.adminArea);return}this.setBreadcrumbsMapView(tt.national)}getBreadcrumbsMapViewSubscription(){return this.breadcrumbsMapViewSubject.asObservable()}getAggregatesMapViewSubscription(){return this.aggregatesMapViewSubject.asObservable()}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(ze),fe(Zt),fe(it))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var IO=(e,n)=>n.adminLevel;function PO(e,n){if(e&1){let t=Ye();D(0,"ion-button",6),oe("click",function(){ge(t);let o=B(2);return ye(o.clickBreadcrumbButton(o.mapViewEnum.national,o.currentMapView===o.mapViewEnum.national))}),M(1),Y(2,"translate"),x()}if(e&2){let t=B(2);bi("selected",t.currentMapView===t.mapViewEnum.national),W("ngClass",t.currentMapView===t.mapViewEnum.national?"breadcrumb-alone":"breadcrumb-start")("disabled",t.disableNationalView()),T(),ne(" ",Z(2,5,"breadcrumbs.national-view")," ")}}function LO(e,n){if(e&1){let t=Ye();D(0,"ion-button",7),oe("click",function(){ge(t);let o=B(2);return ye(o.clickBreadcrumbButton(o.mapViewEnum.event,o.currentMapView===o.mapViewEnum.event))}),M(1),x()}if(e&2){let t=B(2);bi("selected",t.currentMapView===t.mapViewEnum.event),W("ngClass",t.currentMapView===t.mapViewEnum.event?"breadcrumb-end":"breadcrumb-middle"),T(),ne(" ",t.eventState==null||t.eventState.event==null?null:t.eventState.event.eventName.split("_")[0]," ")}}function AO(e,n){if(e&1){let t=Ye();D(0,"ion-button",8),oe("click",function(){ge(t);let o=B(2);return ye(o.clickBreadcrumbButton(o.mapViewEnum.adminArea,o.currentMapView===o.mapViewEnum.adminArea))}),x()}if(e&2){let t=B(2);bi("selected",t.currentMapView===t.mapViewEnum.adminArea),W("ngClass",t.currentMapView===t.mapViewEnum.adminArea?"breadcrumb-end":"breadcrumb-middle")("innerHtml",t.currentMapView===t.mapViewEnum.adminArea?t.placeCode==null?null:t.placeCode.placeCodeName:t.currentMapView===t.mapViewEnum.adminArea2?t.placeCode==null||t.placeCode.placeCodeParent==null?null:t.placeCode.placeCodeParent.placeCodeName:t.placeCode==null||t.placeCode.placeCodeParent==null||t.placeCode.placeCodeParent.placeCodeParent==null?null:t.placeCode.placeCodeParent.placeCodeParent.placeCodeName,ot)}}function OO(e,n){if(e&1){let t=Ye();D(0,"ion-button",9),oe("click",function(){ge(t);let o=B(2);return ye(o.clickBreadcrumbButton(o.mapViewEnum.adminArea2,o.currentMapView===o.mapViewEnum.adminArea2))}),x()}if(e&2){let t=B(2);bi("selected",t.currentMapView===t.mapViewEnum.adminArea2),W("ngClass",t.currentMapView===t.mapViewEnum.adminArea2?"breadcrumb-end":"breadcrumb-middle")("innerHtml",t.currentMapView===t.mapViewEnum.adminArea2?t.placeCode==null?null:t.placeCode.placeCodeName:t.placeCode==null||t.placeCode.placeCodeParent==null?null:t.placeCode.placeCodeParent.placeCodeName,ot)}}function MO(e,n){if(e&1){let t=Ye();D(0,"ion-button",10),oe("click",function(){ge(t);let o=B(2);return ye(o.clickBreadcrumbButton(o.mapViewEnum.adminArea3,o.currentMapView===o.mapViewEnum.adminArea3))}),M(1),x()}if(e&2){let t=B(2);bi("selected",t.currentMapView===t.mapViewEnum.adminArea3),T(),ne(" ",t.placeCode==null?null:t.placeCode.placeCodeName," ")}}function kO(e,n){if(e&1&&(D(0,"div",0),se(1,PO,3,7,"ion-button",1)(2,LO,2,4,"ion-button",2)(3,AO,1,4,"ion-button",3)(4,OO,1,4,"ion-button",4)(5,MO,2,3,"ion-button",5),x()),e&2){let t=B();T(),re(t.showBreadcrumb(t.mapViewEnum.national)?1:-1),T(),re(t.showBreadcrumb(t.mapViewEnum.event)?2:-1),T(),re(t.showBreadcrumb(t.mapViewEnum.adminArea)?3:-1),T(),re(t.showBreadcrumb(t.mapViewEnum.adminArea2)?4:-1),T(),re(t.showBreadcrumb(t.mapViewEnum.adminArea3)?5:-1)}}function RO(e,n){if(e&1){let t=Ye();D(0,"ion-button",12),oe("click",function(){let o=ge(t).$implicit,s=B(2);return ye(s.clickAdminLevelButton(o.adminLevel))}),M(1),x()}if(e&2){let t=n.$implicit,i=B(2);bi("selected",i.isAdminLevelActive(t.adminLevel,t.disabled)),W("ngClass",t.buttonTypeClass)("disabled",t.disabled),T(),ne(" ",t.label," ")}}function FO(e,n){if(e&1&&(D(0,"div",0),Vt(1,RO,2,5,"ion-button",11,IO),Y(3,"async"),x()),e&2){let t=B();T(),Gt(Z(3,0,t.adminLevelButtons))}}var oS=[Rt.flashFloods,Rt.floods,Rt.drought],kD=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p,m){this.adminLevelService=t,this.mapService=i,this.analyticsService=o,this.eventService=s,this.placeCodeService=l,this.countryService=u,this.disasterTypeService=d,this.mapViewService=f,this.translate=p,this.changeDetectorRef=m,this.mapViewEnum=tt,this.adminLevel=on,this.onCountryChange=g=>{this.country=g},this.onDisasterTypeChange=g=>{this.disasterType=g,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onMapViewChange=g=>{this.currentMapView=g,this.changeDetectorRef.detectChanges()},this.onEventChange=g=>{this.eventState=g},this.onPlaceCodeChange=g=>{this.placeCode=g,this.changeDetectorRef.detectChanges()},this.isAdminLevelActive=(g,v)=>{let C=this.getAdminLevelLayer(g);return C?C.active&&!v:!1}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.mapViewSubscription=this.mapViewService.getBreadcrumbsMapViewSubscription().subscribe(this.onMapViewChange),this.eventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.adminLevelButtons=this.adminLevelService.getAdminLevelButtonsSubscription()}ngOnDestroy(){this.mapViewSubscription.unsubscribe(),this.eventStateSubscription.unsubscribe(),this.placeCodeSubscription.unsubscribe(),this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe()}clickAdminLevelButton(t){let i=this.getAdminLevelLayer(t);if(!i){console.warn(`No layer found for admin level: ${t}`);return}t!==this.adminLevelService.adminLevel?(this.adminLevelService.activeLayerNames=this.mapService.layers.filter(o=>o.active&&o.group!==pt.adminRegions).map(o=>o.name),this.placeCodeService.clearPlaceCode(),this.adminLevelService.setAdminLevel(t),this.analyticsService.logEvent(ft.adminLevel,{adminLevel:t,adminLevelState:i.active,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name})):this.mapService.toggleLayer(i)}getAdminLevelLabel(t){return this.adminLevelService.adminLevelLabel?String(this.adminLevelService.adminLevelLabel[on[t]]):`Admin Level ${on[t]}`}getAdminLevelLayerName(t){return`${pt.adminRegions}${on[t]}`}getAdminLevelLayer(t){let i=this.getAdminLevelLayerName(t);return this.mapService.getLayerByName(i)}useBreadcrumbs(t){return oS.includes(t?.disasterType)}clickBreadcrumbButton(t,i){if(!i){if(t===tt.adminArea2&&(this.adminLevelService.getAdminLevelType(this.placeCode)!==$i.deepest&&this.adminLevelService.zoomOutAdminLevel(),this.placeCodeService.setPlaceCode(this.placeCode.placeCodeParent)),t===tt.adminArea&&(this.currentMapView===tt.adminArea3?(this.adminLevelService.zoomOutAdminLevel(),this.placeCodeService.setPlaceCode(this.placeCode.placeCodeParent.placeCodeParent)):this.currentMapView===this.mapViewEnum.adminArea2&&(this.adminLevelService.getAdminLevelType(this.placeCode)!==$i.deepest&&this.adminLevelService.zoomOutAdminLevel(),this.placeCodeService.setPlaceCode(this.placeCode.placeCodeParent))),t===tt.event){this.adminLevelService.zoomToDefaultAdminLevel(),this.placeCodeService?.clearPlaceCode();return}if(t===tt.national){this.eventService?.resetEvents();return}}}showBreadcrumb(t){if(t===tt.national)return[tt.adminArea,tt.adminArea2,tt.adminArea3,tt.event,tt.national].includes(this.currentMapView);if(t===tt.event)return[tt.adminArea,tt.adminArea2,tt.adminArea3,tt.event].includes(this.currentMapView);if(t===tt.adminArea)return[tt.adminArea,tt.adminArea2,tt.adminArea3].includes(this.currentMapView);if(t===tt.adminArea2)return[tt.adminArea2,tt.adminArea3].includes(this.currentMapView);if(t===tt.adminArea3)return[tt.adminArea3].includes(this.currentMapView)}disableNationalView(){return this.eventState?.events?.length===1}static{this.\u0275fac=function(i){return new(i||e)(P(Sn),P(Oo),P(ei),P(ze),P(Zt),P($e),P(it),P($_),P(Jt),P(po))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-admin-level"]],standalone:!1,decls:2,vars:1,consts:[[1,"ion-margin-start","breadcrumbs-container"],["size","small","data-testid","breadcrumb-national-view",1,"breadcrumb",3,"ngClass","selected","disabled"],["size","small","data-testid","breadcrumb-event-view",1,"breadcrumb",3,"ngClass","selected"],["size","small","data-testid","breadcrumb-admin-area-view",1,"breadcrumb",3,"ngClass","selected","innerHtml"],["size","small","data-testid","breadcrumb-admin-area-2-view",1,"breadcrumb",3,"ngClass","selected","innerHtml"],["size","small","data-testid","breadcrumb-admin-area-3-view",1,"breadcrumb","breadcrumb-end",3,"selected"],["size","small","data-testid","breadcrumb-national-view",1,"breadcrumb",3,"click","ngClass","disabled"],["size","small","data-testid","breadcrumb-event-view",1,"breadcrumb",3,"click","ngClass"],["size","small","data-testid","breadcrumb-admin-area-view",1,"breadcrumb",3,"click","ngClass","innerHtml"],["size","small","data-testid","breadcrumb-admin-area-2-view",1,"breadcrumb",3,"click","ngClass","innerHtml"],["size","small","data-testid","breadcrumb-admin-area-3-view",1,"breadcrumb","breadcrumb-end",3,"click"],["size","small","fill","solid",1,"breadcrumb",3,"ngClass","selected","disabled"],["size","small","fill","solid",1,"breadcrumb",3,"click","ngClass","disabled"]],template:function(i,o){i&1&&se(0,kO,6,5,"div",0)(1,FO,4,2,"div",0),i&2&&re(o.useBreadcrumbs(o.disasterType)?0:1)},dependencies:[Ca,Ke,Ta,Oe],styles:[".breadcrumbs-container[_ngcontent-%COMP%]{margin-top:20px}.breadcrumb[_ngcontent-%COMP%]{font-size:12px;margin:0;--background: var(--ion-color-ibf-white);--border-color: var(--ion-color-ibf-no-alert-primary);--border-width: 2px;--border-style: solid;--color: var(--ion-color-ibf-no-alert-primary)}.breadcrumb.selected[_ngcontent-%COMP%]{--background: var(--ion-color-ibf-no-alert-primary);--color: var(--ion-color-ibf-white)}.breadcrumb-start[_ngcontent-%COMP%]{--border-width: 2px 0px 2px 2px;--border-radius: var(--breadcrumb-radius) 0 0 var(--breadcrumb-radius)}.breadcrumb-middle[_ngcontent-%COMP%]{--border-radius: 0;--border-width: 2px 0px 2px 2px}.breadcrumb-end[_ngcontent-%COMP%]{--border-radius: 0 var(--breadcrumb-radius) var(--breadcrumb-radius) 0}.breadcrumb-alone[_ngcontent-%COMP%]{--border-radius: var(--breadcrumb-radius)}"],changeDetection:0})}}return e})();var q_=class{},Dn=function(e){return e.NONE="none",e.WARNINGLOW="warning-low",e.WARNINGMEDIUM="warning-medium",e.WARNING="warning",e.TRIGGER="trigger",e}(Dn||{});var ze=(()=>{class e{constructor(t,i,o){this.apiService=t,this.countryService=i,this.disasterTypeService=o,this.nullState={events:null,event:null},this.state=this.nullState,this.initialEventStateSubject=new Yt(this.nullState),this.manualEventStateSubject=new Yt(this.nullState),this.onCountryChange=s=>{this.country=s},this.onDisasterTypeChange=s=>{this.resetState(),this.disasterType=s,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType),this.getEvents()},this.onGetDisasterTypeEvent=(s,l)=>u=>{s.alertLevel=u.some(({alertLevel:d})=>d!=Dn.NONE),l(s)},this.onEvents=s=>{this.apiService.getLastUploadDate(this.country.countryCodeISO3,this.disasterType.disasterType).subscribe(l=>{this.onLastUploadDate(l,s)})},this.onLastUploadDate=(s,l)=>{if(s.timestamp||s.date?this.today=Fe.fromISO(s.timestamp||s.date):this.today=Fe.now(),this.state.events=l,l.length)for(let u of this.state.events)u.firstIssuedDate=Fe.fromISO(u.firstIssuedDate).toFormat("cccc, dd LLLL"),u.userTriggerDate=Fe.fromISO(u.userTriggerDate).toFormat("cccc, dd LLLL"),u.firstLeadTimeLabel=Ar[u.firstLeadTime],u.timeUnit=u.firstLeadTime?.split("-")[1],u.firstLeadTimeDate=u.firstLeadTime?this.getFirstLeadTimeDate(u.firstLeadTime,u.timeUnit):null,u.firstTriggerLeadTimeDate=u.firstTriggerLeadTime?this.getFirstLeadTimeDate(u.firstTriggerLeadTime,u.timeUnit):null,u.duration=this.getEventDuration(u),u.nrAlertAreas=u.alertAreas?.length;if(this.sortEvents(),l.length===1)this.setEventInitially(l[0]);else if(this.skipNationalView(this.disasterType.disasterType)){let u=l.filter(f=>f.alertLevel===Dn.TRIGGER),d=u.length?u[0]:l[0];this.setEventInitially(d)}else this.setEventInitially(null);this.setAlertState()},this.setAlertState=()=>{let s=document.getElementById("app");s&&(this.state.events?.length?(s.classList.remove("no-alert"),s.classList.add("alert")):(s.classList.remove("alert"),s.classList.add("no-alert")))},this.isLastUploadDateLate=(s,l)=>{let d=l.leadTimeUnit===yn.day?"days":l.leadTimeUnit===yn.hour?"hours":l.leadTimeUnit===yn.month?"months":null,f=l.leadTimeUnit===yn.hour?6:1,p=Date.now();return(d==="hours"?Zb(p,s):d==="days"?Gb(p,s):d==="months"?Xb(p,s):null)>f+.1},this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}switchEvent(t){let i=this.state.events.find(o=>o.eventName===t);this.setEventManually(i)}resetEvents(){this.setEventInitially(null)}setEventInitially(t){this.state.event=t,this.initialEventStateSubject.next(this.state),this.setAlertState()}setEventManually(t){this.state.event=t,this.manualEventStateSubject.next(this.state),this.setAlertState()}getInitialEventStateSubscription(){return this.initialEventStateSubject.asObservable()}getManualEventStateSubscription(){return this.manualEventStateSubject.asObservable()}resetState(){this.state=this.nullState,this.resetEvents()}getEvents(){this.country&&this.disasterType&&this.apiService.getEvents(this.country.countryCodeISO3,this.disasterType.disasterType).subscribe(this.onEvents)}getTriggerByDisasterType(t,i,o){t&&i&&this.apiService.getEvents(t,i.disasterType).subscribe(this.onGetDisasterTypeEvent(i,o))}skipNationalView(t){return!oS.includes(t)}sortEvents(){this.state.events?.sort((t,i)=>{let o=t.disasterSpecificProperties?.typhoonNoLandfallYet?1:0,s=i.disasterSpecificProperties?.typhoonNoLandfallYet?1:0;return o!==s?o-s:this.leadTimeToNumber(t.firstLeadTime)>this.leadTimeToNumber(i.firstLeadTime)||this.leadTimeToNumber(t.firstLeadTime)===this.leadTimeToNumber(i.firstLeadTime)&&(t.duration>i.duration||t.duration===i.duration&&(t.firstIssuedDate>i.firstIssuedDate||t.firstIssuedDate===i.firstIssuedDate&&t.eventName>i.eventName))?1:-1})}leadTimeToNumber(t){return Number(t?.split("-")[0])}getEventDuration(t){if(this.disasterType.disasterType!==Rt.drought)return;let i=this.countryDisasterSettings?.droughtSeasonRegions;for(let o of Object.keys(i))if(t.eventName?.toLowerCase().includes(o.toLowerCase())){let s=Fe.fromISO(t.endDate).plus({months:Number(Ar[t.firstLeadTime])}).month;for(let l of Object.values(i[o])){let u=l.rainMonths;if(u.includes(s)){let d=u[u.length-1];return d>=s?d-s+1:12-s+d+1}}}}getFirstLeadTimeDate(t,i){let o=Number(Ar[t]),s=i===yn.month?this.today.plus({months:Number(o)}):i===yn.day?this.today.plus({days:Number(o)}):i===yn.hour?this.today.plus({hours:Number(o)}):null;if(i===yn.month)return s.toFormat("LLLL yyyy");if(i===yn.day)return s.toFormat("d LLLL yyyy");if(i===yn.hour)return s.toFormat("cccc, dd LLLL HH:00")}static{this.\u0275fac=function(i){return new(i||e)(fe(ui),fe($e),fe(it))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function BO(e,n){if(e&1&&X(0,"img",0),e&2){let t=n.$implicit;ho("src","assets/logos/",t,"",Kl)}}var RD=(()=>{class e{constructor(t,i){this.countryService=t,this.disasterTypeService=i}ngOnInit(){this.country=this.countryService.getCountrySubscription(),this.disasterType=this.disasterTypeService.getDisasterTypeSubscription()}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(it))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-logos"]],standalone:!1,decls:4,vars:4,consts:[["data-testid","logo-image",3,"src"]],template:function(i,o){if(i&1&&(Vt(0,BO,1,2,"img",0,ec),Y(2,"async"),Y(3,"async")),i&2){let s;Gt((s=Z(2,0,o.country))==null?null:s.countryLogos[(s=Z(3,2,o.disasterType))==null?null:s.disasterType])}},dependencies:[Ta],styles:["[_nghost-%COMP%]{display:flex}img[_ngcontent-%COMP%]{height:3rem;padding:2px}"]})}}return e})();var zO=e=>({active:e});function HO(e,n){if(e&1&&(D(0,"strong",3),M(1),x()),e&2){let t=B();W("ngClass",Lt(4,zO,t.disasterType==null?null:t.disasterType.alertLevel)),T(),DC(" ",t.showCountry?t.countryName:""," ",t.disasterType==null?null:t.disasterType.disasterType," ",t.activeTriggerMsg," ")}}function VO(e,n){if(e&1&&(D(0,"strong"),M(1),x()),e&2){let t=B();T(),ne(" ",t.showEnvironmentLabel(t.environmentConfiguration)," ")}}function GO(e,n){e&1&&(D(0,"div",4),X(1,"ion-icon",9),x())}function WO(e,n){if(e&1){let t=Ye();D(0,"ion-title",10),oe("click",function(){ge(t);let o=B();return ye(o.presentPopover())}),M(1),Y(2,"translate"),x(),D(3,"ion-title",11),oe("click",function(){ge(t);let o=B();return ye(o.presentPopover())}),M(4),x()}if(e&2){let t=B();T(),ne(" ",Z(2,2,"user-state.logged-in-as")," "),T(3),ne(" ",t.authService.displayName," ")}}function ZO(e,n){if(e&1){let t=Ye();D(0,"ion-button",12),oe("click",function(){ge(t);let o=B();return ye(o.doLogout())}),M(1),Y(2,"translate"),x()}e&2&&(T(),ne(" ",Z(2,1,"user-state.log-out")," "))}var zZ=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p){this.authService=t,this.loaderService=i,this.analyticsService=o,this.eventService=s,this.disasterTypeService=l,this.countryService=u,this.apiService=d,this.popoverController=f,this.translateService=p,this.showCountry=!0,this.environmentConfiguration=xt.configuration,this.onCountryChange=m=>{m&&(this.countryName=m.countryName)},this.onDisasterTypeChange=m=>{if(this.disasterType=m,this.disasterType){let g=this.disasterType.alertLevel?"yes":"no";this.activeTriggerMsg=this.translateService.instant(`dashboard-page.triggered-message.${g}`)}}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}ngOnChanges(t){}showEnvironmentLabel(t){return t==="production"?this.translateService.instant("login-page.environment-label.production"):t==="stage"?this.translateService.instant("login-page.environment-label.stage"):t}doLogout(){this.analyticsService.logEvent(ft.logOut,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.loaderService.setLoader("logout",!1),this.authService.logout(),window.location.reload()}presentPopover(){return dt(this,null,function*(){(yield this.popoverController.create({component:gT,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0})).present()})}static{this.\u0275fac=function(i){return new(i||e)(P(Pn),P(XC),P(ei),P(ze),P(it),P($e),P(ui),P(at),P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-user-state"]],inputs:{isLoggedIn:"isLoggedIn",showCountry:"showCountry"},standalone:!1,features:[bt],decls:16,vars:4,consts:[[1,"ion-justify-content-between","ion-align-items-center"],["size","medium","data-testid","heading-display-name-label",1,"font-[Montserrat]","uppercase"],["data-testid","heading-display-name-span"],[3,"ngClass"],[1,"inline-block","align-middle"],[1,"ion-align-items-center"],["lines","none"],[1,"ion-no-padding"],["data-testid","user-state-logout-button","size","small","shape","round","fill","outline","strong","true","color","fiveten-navy-900","data-test","logout-button",1,"user-state-log-out-button"],["src","/assets/icons/Alert_Title_Purple.svg","slot","start"],["size","small",1,"ion-no-padding",3,"click"],["size","small","data-testid","user-display-name",1,"ion-no-padding","cursor-pointer","font-bold","hover:underline",3,"click"],["data-testid","user-state-logout-button","size","small","shape","round","fill","outline","strong","true","color","fiveten-navy-900","data-test","logout-button",1,"user-state-log-out-button",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-grid")(1,"ion-row",0)(2,"div")(3,"ion-title",1)(4,"span",2),M(5," IBF PORTAL "),se(6,HO,2,6,"strong",3)(7,VO,2,1,"strong"),x(),se(8,GO,2,0,"div",4),x()(),D(9,"div",5)(10,"ion-row",5),X(11,"app-logos"),D(12,"ion-item",6)(13,"ion-col",7),se(14,WO,5,4),x()(),se(15,ZO,3,3,"ion-button",8),x()()()()),i&2&&(T(6),re(o.isLoggedIn?6:7),T(2),re(o.isLoggedIn&&(o.disasterType!=null&&o.disasterType.alertLevel)?8:-1),T(6),re(o.isLoggedIn?14:-1),T(),re(o.isLoggedIn?15:-1))},dependencies:[Ca,Ke,fo,Kp,Ze,kt,hr,rf,RD,Oe],styles:[".top-bar-button[_ngcontent-%COMP%]{height:40px;margin-top:0;margin-bottom:0;margin-left:0;padding-left:0}.active[_ngcontent-%COMP%]{background-color:var(--ion-color-ibf-primary-contrast);color:var(--ion-color-ibf-primary)}.user-state-log-out-button[_ngcontent-%COMP%]::part(native){border-color:var(--ion-color-fiveten-navy-300)}"]})}}return e})();var Wu=Xl(Vu(),1),zi=class{static mapToArray(n){let t=[];for(let i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}static handleEvent(n,t,i){0<t.observers.length&&n.run(()=>{t.emit(i)})}},sS=(()=>{class e{constructor(t,i){this.element=t,this.zone=i,this.DEFAULT_ZOOM=1,this.DEFAULT_CENTER=(0,Wu.latLng)(38.907192,-77.036871),this.DEFAULT_FPZ_OPTIONS={},this.fitBoundsOptions=this.DEFAULT_FPZ_OPTIONS,this.panOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomPanOptions=this.DEFAULT_FPZ_OPTIONS,this.options={},this.mapReady=new Oi,this.zoomChange=new Oi,this.centerChange=new Oi,this.onClick=new Oi,this.onDoubleClick=new Oi,this.onMouseDown=new Oi,this.onMouseUp=new Oi,this.onMouseMove=new Oi,this.onMouseOver=new Oi,this.onMouseOut=new Oi,this.onMapMove=new Oi,this.onMapMoveStart=new Oi,this.onMapMoveEnd=new Oi,this.onMapZoom=new Oi,this.onMapZoomStart=new Oi,this.onMapZoomEnd=new Oi}ngOnInit(){this.zone.runOutsideAngular(()=>{this.map=(0,Wu.map)(this.element.nativeElement,this.options),this.addMapEventListeners()}),this.center!=null&&this.zoom!=null&&this.setView(this.center,this.zoom),this.fitBounds!=null&&this.setFitBounds(this.fitBounds),this.maxBounds!=null&&this.setMaxBounds(this.maxBounds),this.minZoom!=null&&this.setMinZoom(this.minZoom),this.maxZoom!=null&&this.setMaxZoom(this.maxZoom),this.doResize(),this.mapReady.emit(this.map)}ngOnChanges(t){t.zoom&&t.center&&this.zoom!=null&&this.center!=null?this.setView(t.center.currentValue,t.zoom.currentValue):t.zoom?this.setZoom(t.zoom.currentValue):t.center&&this.setCenter(t.center.currentValue),t.fitBounds&&this.setFitBounds(t.fitBounds.currentValue),t.maxBounds&&this.setMaxBounds(t.maxBounds.currentValue),t.minZoom&&this.setMinZoom(t.minZoom.currentValue),t.maxZoom&&this.setMaxZoom(t.maxZoom.currentValue)}ngOnDestroy(){this.map!=null&&this.map.remove()}getMap(){return this.map}onResize(){this.delayResize()}addMapEventListeners(){let t=(o,s)=>{this.map.on(o,s)};t("click",o=>zi.handleEvent(this.zone,this.onClick,o)),t("dblclick",o=>zi.handleEvent(this.zone,this.onDoubleClick,o)),t("mousedown",o=>zi.handleEvent(this.zone,this.onMouseDown,o)),t("mouseup",o=>zi.handleEvent(this.zone,this.onMouseUp,o)),t("mouseover",o=>zi.handleEvent(this.zone,this.onMouseOver,o)),t("mouseout",o=>zi.handleEvent(this.zone,this.onMouseOut,o)),t("mousemove",o=>zi.handleEvent(this.zone,this.onMouseMove,o)),t("zoomstart",o=>zi.handleEvent(this.zone,this.onMapZoomStart,o)),t("zoom",o=>zi.handleEvent(this.zone,this.onMapZoom,o)),t("zoomend",o=>zi.handleEvent(this.zone,this.onMapZoomEnd,o)),t("movestart",o=>zi.handleEvent(this.zone,this.onMapMoveStart,o)),t("move",o=>zi.handleEvent(this.zone,this.onMapMove,o)),t("moveend",o=>zi.handleEvent(this.zone,this.onMapMoveEnd,o));let i=()=>{let o=this.map.getZoom();o!==this.zoom&&(this.zoom=o,zi.handleEvent(this.zone,this.zoomChange,o));let s=this.map.getCenter();(s!=null||this.center!=null)&&((s==null||this.center==null)&&s!==this.center||s.lat!==this.center.lat||s.lng!==this.center.lng)&&(this.center=s,zi.handleEvent(this.zone,this.centerChange,s))};t("moveend",i),t("zoomend",i)}doResize(){this.zone.runOutsideAngular(()=>{this.map!=null&&this.map.invalidateSize({})})}delayResize(){this.resizeTimer!=null&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.doResize.bind(this),200)}setView(t,i){this.map!=null&&t!=null&&i!=null&&this.map.setView(t,i,this.zoomPanOptions)}setZoom(t){this.map!=null&&t!=null&&this.map.setZoom(t,this.zoomOptions)}setCenter(t){this.map!=null&&t!=null&&this.map.panTo(t,this.panOptions)}setFitBounds(t){this.map!=null&&t!=null&&this.map.fitBounds(t,this.fitBoundsOptions)}setMaxBounds(t){this.map!=null&&t!=null&&this.map.setMaxBounds(t)}setMinZoom(t){this.map!=null&&t!=null&&this.map.setMinZoom(t)}setMaxZoom(t){this.map!=null&&t!=null&&this.map.setMaxZoom(t)}static{this.\u0275fac=function(i){return new(i||e)(P(vC),P(Av))}}static{this.\u0275dir=Rp({type:e,selectors:[["","leaflet",""]],hostBindings:function(i,o){i&1&&oe("resize",function(){return o.onResize()},!1,yC)},inputs:{fitBoundsOptions:[0,"leafletFitBoundsOptions","fitBoundsOptions"],panOptions:[0,"leafletPanOptions","panOptions"],zoomOptions:[0,"leafletZoomOptions","zoomOptions"],zoomPanOptions:[0,"leafletZoomPanOptions","zoomPanOptions"],options:[0,"leafletOptions","options"],zoom:[0,"leafletZoom","zoom"],center:[0,"leafletCenter","center"],fitBounds:[0,"leafletFitBounds","fitBounds"],maxBounds:[0,"leafletMaxBounds","maxBounds"],minZoom:[0,"leafletMinZoom","minZoom"],maxZoom:[0,"leafletMaxZoom","maxZoom"]},outputs:{mapReady:"leafletMapReady",zoomChange:"leafletZoomChange",centerChange:"leafletCenterChange",onClick:"leafletClick",onDoubleClick:"leafletDoubleClick",onMouseDown:"leafletMouseDown",onMouseUp:"leafletMouseUp",onMouseMove:"leafletMouseMove",onMouseOver:"leafletMouseOver",onMouseOut:"leafletMouseOut",onMapMove:"leafletMapMove",onMapMoveStart:"leafletMapMoveStart",onMapMoveEnd:"leafletMapMoveEnd",onMapZoom:"leafletMapZoom",onMapZoomStart:"leafletMapZoomStart",onMapZoomEnd:"leafletMapZoomEnd"},standalone:!1,features:[bt]})}}return e})(),aS=class{constructor(n){this.leafletDirective=n}init(){}getMap(){return this.leafletDirective.getMap()}},FD=(()=>{class e{constructor(t,i){this.zone=i,this.onAdd=new Oi,this.onRemove=new Oi,this.leafletDirective=new aS(t)}ngOnInit(){this.leafletDirective.init()}ngOnDestroy(){this.layer!=null&&(this.removeLayerEventListeners(this.layer),this.layer.remove())}ngOnChanges(t){if(t.layer){let i=t.layer.previousValue,o=t.layer.currentValue;this.zone.runOutsideAngular(()=>{i!=null&&(this.removeLayerEventListeners(i),i.remove()),o!=null&&(this.addLayerEventListeners(o),this.leafletDirective.getMap().addLayer(o))})}}addLayerEventListeners(t){this.onAddLayerHandler=i=>zi.handleEvent(this.zone,this.onAdd,i),t.on("add",this.onAddLayerHandler),this.onRemoveLayerHandler=i=>zi.handleEvent(this.zone,this.onRemove,i),t.on("remove",this.onRemoveLayerHandler)}removeLayerEventListeners(t){t.off("add",this.onAddLayerHandler),t.off("remove",this.onRemoveLayerHandler)}static{this.\u0275fac=function(i){return new(i||e)(P(sS),P(Av))}}static{this.\u0275dir=Rp({type:e,selectors:[["","leafletLayer",""]],inputs:{layer:[0,"leafletLayer","layer"]},outputs:{onAdd:"leafletLayerAdd",onRemove:"leafletLayerRemove"},standalone:!1,features:[bt]})}}return e})();var YD=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=ga({type:e})}static{this.\u0275inj=va({})}}return e})();var $O=Xl(Vu(),1),KZ=Xl(UD(),1);var zD=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=ga({type:e})}static{this.\u0275inj=va({})}}return e})();var HD=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=ga({type:e})}static{this.\u0275inj=va({imports:[Vp]})}}return e})();var VD=(()=>{class e{constructor(t,i,o,s){this.countryService=t,this.disasterTypeService=i,this.analyticsService=o,this.eventService=s,this.onCountryChange=l=>{this.country=l},this.onDisasterTypeChange=l=>{this.disasterType=l,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe()}ngOnChanges(t){}btnAction(){this.analyticsService.logEvent(ft.aboutTrigger,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.country&&this.disasterType&&window.open(this.countryDisasterSettings?.eapLink)}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(it),P(ei),P(ze))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-about-btn"]],inputs:{btnLabel:"btnLabel"},standalone:!1,features:[bt],decls:2,vars:1,consts:[["data-testid","chat-about-trigger","size","small","strong","true","expand","full","shape","round","fill","outline","color","fiveten-neutral-900",1,"about-btn-button",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-button",0),oe("click",function(){return o.btnAction()}),M(1),x()),i&2&&(T(),ne(" ",o.btnLabel,`
`))},dependencies:[Ke],styles:[".about-btn-button[_ngcontent-%COMP%]::part(native){background:var(--ion-color-fiveten-neutral-0);border-color:var(--ion-color-fiveten-navy-300)}"]})}}return e})();var Zu=(()=>{class e{constructor(t){this.popoverController=t}ngOnInit(){setTimeout(()=>dt(this,null,function*(){(yield this.popoverController.getTop())&&this.closePopover()}),1e4)}ngOnChanges(t){}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-action-result-popover"]],inputs:{message:"message"},standalone:!1,features:[bt],decls:14,vars:7,consts:[[1,"popover-window-card"],["color","ibf-primary"],[1,"ion-padding-top","ion-text-center"],["lines","none"],["lines","none",2,"width","100%"],[1,"ion-text-end",2,"width","100%"],["fill","clear",2,"text-transform","uppercase",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-card-title"),M(3),Y(4,"translate"),x()(),D(5,"ion-card-content",2)(6,"ion-item",3)(7,"span"),M(8),x()(),D(9,"ion-item",4)(10,"div",5)(11,"ion-button",6),oe("click",function(){return o.closePopover()}),M(12),Y(13,"translate"),x()()()()()),i&2&&(T(3),be(Z(4,3,"chat-component.common.save-actions.header")),T(5),ne(" ",o.message," "),T(4),ne(" ",Z(13,5,"chat-component.common.save-actions.prompt-button-label")," "))},dependencies:[Ke,xi,Di,Zi,ji,kt,Oe],encapsulation:2})}}return e})();var GD=(()=>{class e{constructor(t,i,o){this.countryService=t,this.disasterTypeService=i,this.router=o,this.onCountryChange=s=>{this.country=s},this.onDisasterTypeChange=s=>{this.disasterType=s},this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe()}goToPage(){let t=this.router.serializeUrl(this.router.createUrlTree(["/log"],{queryParams:{countryCodeISO3:this.country.countryCodeISO3,disasterType:this.disasterType.disasterType}}));window.open(t,"_blank")}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(it),P(Wp))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-activation-log-button"]],standalone:!1,decls:3,vars:3,consts:[["data-testid","activation-log-button","size","small","strong","true","expand","full","shape","round","fill","outline","color","fiveten-neutral-900",1,"activation-log-button",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-button",0),oe("click",function(){return o.goToPage()}),M(1),Y(2,"translate"),x()),i&2&&(T(),ne(" ",Z(2,1,"activation-page.page-title"),`
`))},dependencies:[Ke,Oe],styles:[".activation-log-button[_ngcontent-%COMP%]::part(native){background:var(--ion-color-fiveten-neutral-0);border-color:var(--ion-color-fiveten-navy-300)}"]})}}return e})();var WD=[{type:si.point,name:pe.waterpoints,label:bs.waterpoints,description:"waterpoints",active:!0,show:!0,viewCenter:!1,order:1},{type:si.point,name:pe.redCrossBranches,label:bs.redCrossBranches,description:"redCrossBranches",active:!0,show:!0,viewCenter:!1,order:2}];var ju=(()=>{class e{constructor(t){this.popoverController=t,this.layer=WD[0]}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-layer-control-info-popover"]],standalone:!1,decls:6,vars:2,consts:[[1,"popover-window-card"],["color","ibf-primary"],["name","close-circle","size","large","data-testid","close-matrix-icon",1,"popover-close-button",3,"click"],["data-testid","layer-info-title"],["data-testid","layer-info-content",1,"ion-padding-top",3,"innerHTML"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title",3),M(4),x()(),X(5,"ion-card-content",4),x()),i&2&&(T(4),ne(" ",o.layer.label," "),T(),W("innerHTML",o.layer.description,ot))},dependencies:[xi,Di,Zi,ji,Ze],encapsulation:2})}}return e})();var Gn=function(e){return e.decimal0="decimal0",e.decimal2="decimal2",e.perc="perc",e}(Gn||{});var $u=function(e){return e.Alert="alert",e.NoAlert="no-alert",e}($u||{}),J_=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p){if(this.countryService=t,this.adminLevelService=i,this.timelineService=o,this.apiService=s,this.mapService=l,this.disasterTypeService=u,this.eventService=d,this.alertAreaService=f,this.placeCodeService=p,this.indicatorSubject=new Yt([]),this.indicators=[],this.aggregates=[],this.isInitialized=!1,this.onCountryChange=m=>{this.country=m},this.onDisasterTypeChange=m=>{this.disasterType=m,this.country},this.onTimelineStateChange=m=>{this.timelineState=m},this.onAdminLevelChange=m=>{this.adminLevel=m},this.onEventStateChange=m=>{this.eventState=m},this.onPlaceCodeChange=m=>{this.placeCode=m},this.onAlertAreasChange=m=>{this.alertAreas=m,this.loadMetadataAndAggregates()},this.onIndicatorChange=m=>{this.indicators=m,this.mapService.removeAggregateLayers(),this.indicators.forEach(g=>{this.mapService.loadAggregateLayer(g)}),this.indicatorSubject.next(this.indicators),this.loadAggregateInformation()},this.onEachIndicatorByFeatureAndAggregate=(m,g)=>v=>{let C=m.records.find(I=>I.indicator===v.name);C&&(g[v.name]=C.value);let E=Number(g[pe.trigger]),b=Number(g[this.disasterType.mainExposureIndicator]),S=this.eventState.events.length>0;E===1||b>0&&S?g.areaStatus=$u.Alert:g.areaStatus=$u.NoAlert},this.onEachPlaceCode=m=>{let g={placeCode:m.placeCode,placeCodeParent:m.placeCodeParent};return this.indicators.forEach(this.onEachIndicatorByFeatureAndAggregate(m,g)),g},this.onAggregateData=m=>{let g=this.aggregateOnPlaceCode(m);this.aggregates=g.map(this.onEachPlaceCode),this.nrAlertAreas=this.aggregates.filter(v=>v.areaStatus===$u.Alert).length},this.aggregateReducer=(m,g,v,C)=>(E,b)=>{let S=0;return(C===null||C===b.placeCode)&&(S=(m?Number(b[v]):1)*(Number(b[g])||0)),E+S},this.isInitialized){console.warn("\u26A0\uFE0F AggregatesService: Attempted multiple initialization - skipping");return}console.log("\u{1F504} AggregatesService: Initializing subscriptions"),this.isInitialized=!0,this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.timelineSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.adminLevelSubscription=this.adminLevelService.getAdminLevelSubscription().subscribe(this.onAdminLevelChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.alertAreasSubscription=this.alertAreaService.getAlertAreas().subscribe(this.onAlertAreasChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange)}ngOnDestroy(){this.countrySubscription&&this.countrySubscription.unsubscribe(),this.timelineSubscription&&this.timelineSubscription.unsubscribe(),this.disasterTypeSubscription&&this.disasterTypeSubscription.unsubscribe(),this.adminLevelSubscription&&this.adminLevelSubscription.unsubscribe(),this.initialEventStateSubscription&&this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription&&this.manualEventStateSubscription.unsubscribe(),this.alertAreasSubscription&&this.alertAreasSubscription.unsubscribe(),this.placeCodeSubscription&&this.placeCodeSubscription.unsubscribe()}loadMetadataAndAggregates(){this.country&&this.disasterType&&this.eventState&&this.timelineState&&this.adminLevel&&this.apiService.getIndicators(this.country.countryCodeISO3,this.disasterType.disasterType).subscribe(this.onIndicatorChange)}getIndicators(){return this.indicatorSubject.asObservable()}loadAggregateInformation(){this.country&&this.disasterType&&this.timelineState&&this.adminLevel&&this.eventState&&this.apiService.getAggregatesData(this.country.countryCodeISO3,this.disasterType.disasterType,this.adminLevel,this.timelineState.activeLeadTime,this.eventState.event?.eventName,this.mapService.getPlaceCodeParent(this.placeCode)).subscribe(this.onAggregateData)}aggregateOnPlaceCode(t){let i=[];return t.forEach(o=>{i.map(s=>s.placeCode).includes(o.placeCode)?i.find(s=>s.placeCode===o.placeCode).records.push(o):i.push({placeCode:o.placeCode,placeCodeParent:o.placeCodeParent,records:[o]})}),i}getAggregate(t,i,o,s){let l;this.disasterType&&(l=this.getWeighingIndicatorName(i));let u=this.aggregates.filter(f=>f.areaStatus===$u.Alert).reduce(this.aggregateReducer(t,i,l,o),0),d;if(s===Gn.perc){let f=this.aggregates.reduce(this.aggregateReducer(!1,l,null,o),0);d=f===0?u:u/f}else d=u;return d}isAggregateNan(t,i,o){let s=this.aggregates;return i&&(s=this.aggregates.filter(l=>l.placeCode===i)),o&&(t=this.getWeighingIndicatorName(t)),s.every(l=>l[t]===null)}getWeighingIndicatorName(t){let i=this.indicators.find(o=>o.name===t).weightVar;return i||(i=this.indicators.find(o=>o.name===this.disasterType.mainExposureIndicator)?.name),i}static{this.\u0275fac=function(i){return new(i||e)(fe($e),fe(Sn),fe(tn),fe(ui),fe(Oo),fe(it),fe(ze),fe(Ds),fe(Zt))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var qu=(()=>{class e{constructor(){this.debugPrefix="\u{1F50D} [DEBUG]",this.initCounters=new Map,console.log(`${this.debugPrefix} Debug service initialized`)}logComponentInit(t,i){let s=(this.initCounters.get(t)||0)+1;this.initCounters.set(t,s);let l=s>3?" \u26A0\uFE0F MULTIPLE INITS!":"";console.log(`${this.debugPrefix} \u{1F680} ${t} - ngOnInit (${s}x)${l}`,i||""),s>5&&console.error(`${this.debugPrefix} \u{1F6A8} INFINITE LOOP DETECTED in ${t} - ${s} initializations!`)}logComponentDestroy(t){console.log(`${this.debugPrefix} \u{1F480} ${t} - ngOnDestroy`)}logComponentAfterViewInit(t,i){console.log(`${this.debugPrefix} \u{1F441}\uFE0F ${t} - ngAfterViewInit`,i||"")}logData(t,i,o){console.log(`${this.debugPrefix} \u{1F4CA} ${t} - ${i}:`,o)}logError(t,i){console.error(`${this.debugPrefix} \u274C ${t} - Error:`,i)}logRender(t,i){if(i){let o=i.getBoundingClientRect(),s=o.width>0&&o.height>0;console.log(`${this.debugPrefix} \u{1F3A8} ${t} - Rendered:`,{visible:s,width:o.width,height:o.height,display:getComputedStyle(i).display,visibility:getComputedStyle(i).visibility,opacity:getComputedStyle(i).opacity})}else console.log(`${this.debugPrefix} \u{1F3A8} ${t} - Rendered (no element)`)}logElementVisibility(t,i){let o=document.querySelector(i);o?this.logRender(t,o):console.log(`${this.debugPrefix} \u2753 ${t} - Element not found: ${i}`)}logDOMState(){console.log(`${this.debugPrefix} \u{1F30D} DOM State Analysis:`),this.logElementVisibility("DOM",'[data-testid="ibf-dashboard-interface"]'),this.logElementVisibility("DOM",".ibf-dashboard-left-column"),this.logElementVisibility("DOM",".ibf-dashboard-right-column"),this.logElementVisibility("DOM",'[data-testid="dashboard-top-bar"]'),this.logElementVisibility("DOM","app-chat"),this.logElementVisibility("DOM","app-timeline"),this.logElementVisibility("DOM","app-aggregates"),this.logElementVisibility("DOM","app-matrix"),this.logElementVisibility("DOM","app-map"),this.logElementVisibility("DOM",'[data-testid="dashboard-map-componenet"]'),this.logElementVisibility("DOM",".leaflet--map")}logCSSStyles(t,i){let o=document.querySelector(i);if(o){let s=getComputedStyle(o);console.log(`${this.debugPrefix} \u{1F3AD} ${t} - CSS for ${i}:`,{display:s.display,visibility:s.visibility,opacity:s.opacity,width:s.width,height:s.height,position:s.position,zIndex:s.zIndex,overflow:s.overflow,color:s.color,backgroundColor:s.backgroundColor})}}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function qO(e,n){e&1&&(D(0,"ion-content",3),M(1),Y(2,"translate"),x()),e&2&&(T(),ne(" ",Z(2,1,"disclaimer-approximate-component.message")," "))}var jD=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-disclaimer-approximate"]],standalone:!1,decls:4,vars:0,consts:[["fill","clear","shape","round","size","default","id","disclaimer-approximate-trigger"],["color","fiveten-navy-900","icon","information-circle-outline","slot","icon-only"],["data-testid","disclaimer-popover-layer","side","right","trigger","disclaimer-approximate-trigger","triggerAction","click","showBackdrop","false"],["data-testid","disclaimer-approximate-message",1,"ion-padding","font-size-12"]],template:function(i,o){i&1&&(D(0,"ion-button",0),X(1,"ion-icon",1),x(),D(2,"ion-popover",2),se(3,qO,3,3,"ng-template"),x())},dependencies:[Ke,Jp,Ze,jC,Oe],styles:["[_nghost-%COMP%]{margin:auto}ion-popover[_ngcontent-%COMP%]{--offset-x: 8px;--offset-y: -2px}"]})}}return e})();var Ns=(()=>{class e{constructor(t){this.locale=t}transform(t,i=Gn.decimal0){if(t==null||isNaN(t))return"";let o=i===Gn.perc?"percent":"decimal",s=t>100||i===Gn.perc?2:1,l=0,u="";return i!==Gn.perc&&t>0&&t<20&&(u="< ",t>10?l=20:t>0&&(l=10)),t=t>0?Math.max(t,l):0,`${u}${new Intl.NumberFormat(this.locale,{maximumSignificantDigits:s,style:o,notation:"compact"}).format(t)}`}static{this.\u0275fac=function(i){return new(i||e)(P(AC,16))}}static{this.\u0275pipe=CC({name:"compact",type:e,pure:!0})}}return e})();var JO=(e,n)=>n.name;function KO(e,n){e&1&&(D(0,"ion-col",8)(1,"ion-item",11),X(2,"app-disclaimer-approximate",12),x()())}function QO(e,n){if(e&1&&(D(0,"ion-label",20),M(1),Y(2,"compact"),Y(3,"translate"),x()),e&2){let t=B().$implicit,i=B();T(),Sa(" ",Z(3,5,Je(2,2,i.getAggregate(t.name,t.weightedAvg,t.numberFormatAggregate),t.numberFormatAggregate))," ",t.aggregateUnit," ")}}function eM(e,n){e&1&&(D(0,"ion-label",21),M(1),Y(2,"translate"),x()),e&2&&(T(),ne(" ",Z(2,1,"aggregates-component.default-value")," "))}function tM(e,n){if(e&1){let t=Ye();D(0,"ion-row",10)(1,"ion-col",13)(2,"ion-item",14)(3,"ion-thumbnail",15),X(4,"ion-img",16),x(),D(5,"ion-label",17),M(6),x()()(),D(7,"ion-col",18)(8,"ion-item",19),se(9,QO,4,7,"ion-label",20)(10,eM,3,3,"ion-label",21),x()(),D(11,"ion-col",22),Y(12,"translate"),D(13,"ion-item",23)(14,"ion-button",24),oe("click",function(){let o=ge(t).$implicit,s=B();return ye(s.moreInfo(o))})("keydown.enter",function(){let o=ge(t).$implicit,s=B();return ye(s.moreInfo(o))}),X(15,"ion-icon",25),x()()()()}if(e&2){let t=n.$implicit,i=B();T(4),ho("src","assets/icons/",t.icon,""),T(),W("title",t.label),T(),ne(" ",t.label," "),T(3),re(i.isAggregateNan(t.name,t.weightedAvg)?10:9),T(2),W("title",Z(12,6,"aggregates-component.more-information"))}}var b9=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p,m,g,v){this.countryService=t,this.disasterTypeService=i,this.aggregatesService=o,this.placeCodeService=s,this.eventService=l,this.adminLevelService=u,this.popoverController=d,this.changeDetectorRef=f,this.translateService=p,this.analyticsService=m,this.mapViewService=g,this.debugService=v,this.indicators=[],this.aggregatesPlaceCodes=[],this.onCountryChange=C=>{this.country=C},this.onDisasterTypeChange=C=>{this.disasterType=C,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onEventStateChange=C=>{this.eventState=C},this.onPlaceCodeChange=C=>{this.placeCode=C,this.changeDetectorRef.detectChanges()},this.onPlaceCodeHoverChange=C=>{this.placeCodeHover=C,this.changeDetectorRef.detectChanges()},this.onIndicatorChange=C=>{let E=b=>b.countryDisasterTypes[this.country.countryCodeISO3][this.disasterType.disasterType]?.includes("aggregate");this.indicators=C.filter(E)},this.debugService.logComponentInit("AggregatesComponent","Constructor called"),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange)}ngOnInit(){this.debugService.logComponentInit("AggregatesComponent","ngOnInit called"),this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.placeCodeHoverSubscription=this.placeCodeService.getPlaceCodeHoverSubscription().subscribe(this.onPlaceCodeHoverChange),this.indicatorSubscription=this.aggregatesService.getIndicators().subscribe(this.onIndicatorChange),this.mapView=this.mapViewService.getAggregatesMapViewSubscription()}ngOnDestroy(){this.indicatorSubscription.unsubscribe(),this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe(),this.placeCodeSubscription.unsubscribe(),this.placeCodeHoverSubscription.unsubscribe(),this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription.unsubscribe()}moreInfo(t){return dt(this,null,function*(){let i=yield this.popoverController.create({component:ju,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{layer:{label:t.label,description:this.getPopoverText(t)}}});this.analyticsService.logEvent(ft.aggregateInformation,{indicator:t.name,page:Bt.dashboard,isActiveTrigger:this.eventState.events?.length>0,component:this.constructor.name}),i.present()})}getPopoverText(t){return t.description?.[this.country.countryCodeISO3]?.[this.disasterType.disasterType]?t.description[this.country.countryCodeISO3][this.disasterType.disasterType]:""}getAggregate(t,i,o){return this.aggregatesService.getAggregate(i,t,this.getPlaceCodeValue(),o)}getAggregatesHeader(t){return this.disasterType?t===tt.national?this.placeCodeHover?{headerLabel:this.placeCodeHover.placeCodeName||this.placeCodeHover.placeCode,subHeaderLabel:`${this.translateService.instant("aggregates-component.predicted")} ${rS(this.disasterType.label)}`}:{headerLabel:this.translateService.instant("aggregates-component.national-view"),subHeaderLabel:`${this.getEventCount()?.toString()} ${this.translateService.instant("aggregates-component.predicted")} ${rS(this.disasterType.label)}${this.translateService.instant("aggregates-component.plural-suffix")}`}:t===tt.event?this.placeCodeHover?{headerLabel:this.placeCodeHover.placeCodeName,subHeaderLabel:this.getAdminAreaLabel("singular")}:{headerLabel:this.getEventNameString()||"",subHeaderLabel:`${this.getAreaCount()?.toString()} exposed ${this.getAdminAreaLabel()}`}:[tt.adminArea,tt.adminArea2,tt.adminArea3].includes(t)?this.placeCodeHover?{headerLabel:this.placeCodeHover.placeCodeName,subHeaderLabel:this.getAdminAreaLabel("singular")}:{headerLabel:this.placeCodeName(),subHeaderLabel:this.adminLevelService.getAdminLevelType(this.placeCode)===$i.higher?`${this.getAreaCount().toString()} exposed ${this.getAdminAreaLabel()}`:this.getAdminAreaLabel("singular")}:{headerLabel:t,subHeaderLabel:t}:{headerLabel:"",subHeaderLabel:""}}getEventNameString(){return this.placeCode?this.placeCode.eventName?.split("_")[0]:this.placeCodeHover?this.placeCodeHover.eventName?.split("_")[0]:this.eventState?.event?.eventName?.split("_")[0]}getAdminAreaLabel(t){return!this.country?.adminRegionLabels||!this.adminLevelService?.adminLevel?"":(t=t||(this.getAreaCount()===1?"singular":"plural"),this.country.adminRegionLabels[this.adminLevelService.adminLevel][t])}placeCodeName(){return this.placeCode?this.placeCode.placeCodeName:this.placeCodeHover?this.placeCodeHover.placeCodeName:""}getAreaCount(){return this.aggregatesService.nrAlertAreas??0}getEventCount(){return this.eventState?.events?.length??0}isAggregateNan(t,i){return this.aggregatesService.isAggregateNan(t,this.getPlaceCodeValue(),i)}getPlaceCodeValue(){let t=this.placeCode||this.placeCodeHover,i=this.adminLevelService.getAdminLevelType(t);return this.placeCodeHover?this.placeCodeHover.placeCode:i===$i.higher?null:t?t.placeCode:null}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(it),P(J_),P(Zt),P(ze),P(Sn),P(at),P(po),P(Jt),P(ei),P($_),P(qu))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-aggregates"]],standalone:!1,decls:18,vars:7,consts:[[1,"ion-no-padding"],[1,"component-title",2,"background","var(--ion-color-ibf-secondary)"],["size-xl","10","size-lg","9","size-md","12","size-sm","11","size-xs","11",1,"ion-no-padding"],["lines","none","color","ibf-secondary",1,"component-title-item"],[1,"ion-no-padding","ion-no-margin","ion-align-items-center"],["color","ibf-black","data-testid","aggregates-header-label",1,"ion-text-wrap"],["color","ibf-black","data-testid","aggregates-sub-header-label",1,"ion-text-wrap"],[3,"innerHTML"],["size-xl","2","size-lg","3","size-md","0","size-sm","1","size-xs","1"],["data-testid","aggregate-list"],["data-testid","aggregates-row",1,"ion-no-padding"],["data-testid","aggregates-header-info-icon","color","transparent","lines","none",1,"aggregate-item-information-icon","ion-no-padding","m-0","cursor-pointer"],["data-testid","aggregates-disclaimer"],["size-xl","6","size-lg","5","size-md","8","size-sm","9","size-xs","9"],["color","ibf-white","lines","full",1,"aggregate-item","ion-no-padding","font-size-12"],["slot","start",1,"m-0","h-10","w-10","bg-slate-100","p-2"],[1,"object-contain",3,"src"],[1,"aggregate-item-label","ion-no-margin","ion-text-wrap",3,"title"],["data-testid","aggregates-affected-number","size-xl","4","size-lg","4","size-md","4","size-sm","2","size-xs","2"],["color","ibf-white",1,"aggregate-item-value","ion-no-padding","font-size-12",2,"--inner-padding-end","4px"],["data-test","aggregate-number",1,"ion-text-right","m-0"],["data-test","aggregate-na",1,"ion-text-right","m-0"],["size-xl","2","size-lg","3","size-md","0","size-sm","1","size-xs","1",3,"title"],["data-testid","aggregates-info-icon","color","ibf-white",1,"aggregate-item-information-icon","ion-no-padding","m-0","cursor-pointer"],["fill","clear","shape","round","size","default",1,"m-auto",3,"click","keydown.enter"],["color","fiveten-navy-900","icon","information-circle-outline","slot","icon-only"]],template:function(i,o){i&1&&(D(0,"div")(1,"ion-grid",0)(2,"ion-row",1)(3,"ion-col",2)(4,"ion-item",3)(5,"ion-col",4)(6,"ion-label",5)(7,"ion-text")(8,"strong"),M(9),Y(10,"async"),x()()(),D(11,"ion-label",6),X(12,"ion-text",7),Y(13,"async"),x()()()(),se(14,KO,3,0,"ion-col",8),x(),D(15,"div",9),Vt(16,tM,16,8,"ion-row",10,JO),x()()()),i&2&&(T(9),be(o.getAggregatesHeader(Z(10,3,o.mapView)).headerLabel),T(3),W("innerHTML",o.getAggregatesHeader(Z(13,5,o.mapView)).subHeaderLabel,ot),T(2),re(o.indicators.length?14:-1),T(2),Gt(o.indicators))},dependencies:[Ke,fo,Kp,Ze,Qp,kt,ci,hr,mo,nf,jD,Ta,Oe,Ns],styles:[".component-title[_ngcontent-%COMP%]   .component-title-item[_ngcontent-%COMP%]{--inner-padding-end: 0;margin:4px}.component-title[_ngcontent-%COMP%]   .aggregate--title[_ngcontent-%COMP%]{width:100%;display:contents}.place-code-reset-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.aggregate-item[_ngcontent-%COMP%], .aggregate-item-value[_ngcontent-%COMP%], .aggregate-item-information-icon[_ngcontent-%COMP%]{--min-height: 2rem}.aggregate-item[_ngcontent-%COMP%], .aggregate-item[_ngcontent-%COMP%]::part(native), .aggregate-item-value[_ngcontent-%COMP%], .aggregate-item-value[_ngcontent-%COMP%]::part(native), .aggregate-item-information-icon[_ngcontent-%COMP%], .aggregate-item-information-icon[_ngcontent-%COMP%]::part(native){height:100%}.aggregate-item[_ngcontent-%COMP%]{--inner-padding-end: 0}.aggregate-item[_ngcontent-%COMP%]   .aggregate-item-label[_ngcontent-%COMP%]{line-height:1.2;white-space:normal;padding:0 4px}.aggregate-item-information-icon[_ngcontent-%COMP%]{--inner-padding-end: 0}"]})}}return e})();var iM=(e,n)=>n.id;function nM(e,n){if(e&1&&(D(0,"span"),M(1),x()),e&2){let t=B().$implicit;T(),Sa("",t.countChecked," / ",t.count,"")}}function rM(e,n){e&1&&(D(0,"span",21),M(1),Y(2,"translate"),x()),e&2&&(T(),ne(" ",Z(2,1,"areas-of-focus-summary-component.not-applicable"),""))}function oM(e,n){if(e&1){let t=Ye();D(0,"ion-row",12),Yp(1),D(2,"ion-col",13)(3,"ion-item",14)(4,"ion-thumbnail",15),X(5,"ion-img",16),x(),D(6,"ion-label",17),M(7),x()()(),D(8,"ion-col",18)(9,"ion-item",19)(10,"ion-label",20),se(11,nM,2,2,"span")(12,rM,3,3,"span",21),x()()(),D(13,"ion-col",10)(14,"ion-item",22)(15,"ion-button",23),oe("click",function(){let o=ge(t).$implicit,s=B(2);return ye(s.moreInfo(o))}),X(16,"ion-icon",24),x()()(),Bp(),x()}if(e&2){let t=n.$implicit;T(5),ho("src","assets/icons/",t.icon,""),T(2),ne(" ",t.label," "),T(4),re(t.count>0?11:12)}}function aM(e,n){if(e&1&&(D(0,"ion-row",0)(1,"ion-col",1)(2,"ion-item",2)(3,"ion-label",3)(4,"div",4),M(5),Y(6,"translate"),x(),D(7,"div",5),M(8),Y(9,"translate"),x()()()(),D(10,"ion-col",6)(11,"ion-item",7)(12,"ion-label",8)(13,"div",9),Y(14,"translate"),M(15),Y(16,"translate"),x()()()(),D(17,"ion-col",10),X(18,"ion-item",11),x()(),Vt(19,oM,17,4,"ion-row",12,iM)),e&2){let t=B();T(5),ne(" ",Z(6,4,"areas-of-focus-summary-component.title")," "),T(3),ne(" ",Z(9,6,"areas-of-focus-summary-component.aof-subtitle")," "),T(5),W("title",Z(14,8,"areas-of-focus-summary-component.tasks-subtitle")),T(2),ne(" ",Z(16,10,"areas-of-focus-summary-component.tasks-subtitle")," "),T(4),Gt(t.areasOfFocus)}}var P9=(()=>{class e{constructor(t,i,o,s,l,u,d,f){this.alertAreaService=t,this.eventService=i,this.placeCodeService=o,this.changeDetectorRef=s,this.popoverController=l,this.analyticsService=u,this.disasterTypeService=d,this.countryService=f,this.areasOfFocus=Z_,this.onCountryChange=p=>{this.country=p},this.onDisasterTypeChange=p=>{this.disasterType=p,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onAlertAreasChange=p=>{this.alertAreas=p,this.calculateEAPActionStatus(this.alertAreas)},this.onPlaceCodeChange=p=>{this.placeCode=p,this.calculateEAPActionStatus(this.alertAreas)},this.onEachEAPAction=p=>m=>{p.id===m.aof&&(p.count+=1,m.checked&&(p.countChecked+=1))},this.onEachAlertArea=p=>m=>{m.eapActions.forEach(this.onEachEAPAction(p))},this.onEventStateChange=p=>{this.eventState=p}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.eapActionSubscription=this.alertAreaService.getAlertAreas().subscribe(this.onAlertAreasChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe(),this.eapActionSubscription.unsubscribe(),this.placeCodeSubscription.unsubscribe(),this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription.unsubscribe()}calculateEAPActionStatus(t){this.placeCode&&(t=t.filter(o=>o.placeCode===this.placeCode?.placeCode));let i=o=>{o.count=0,o.countChecked=0,t.forEach(this.onEachAlertArea(o))};t[t.length-1]?.eapActions&&this.areasOfFocus.forEach(i),this.changeDetectorRef.detectChanges()}moreInfo(t){return dt(this,null,function*(){let{id:i,label:o,description:s}=t,l=yield this.popoverController.create({component:ju,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{layer:{label:o,description:s}}});this.analyticsService.logEvent(ft.aggregateInformation,{indicator:i,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),l.present()})}showAreasOfFocusSummary(){return!(!this.eventState?.events?.length||!this.countryDisasterSettings.enableEarlyActions)}static{this.\u0275fac=function(i){return new(i||e)(P(Ds),P(ze),P(Zt),P(po),P(at),P(ei),P(it),P($e))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-areas-of-focus-summary"]],standalone:!1,decls:1,vars:1,consts:[["color","ibf-secondary","data-test","action-title",1,"component-title"],["size-xl","6","size-lg","5","size-md","8","size-sm","9","size-xs","9",1,"ion-no-padding"],["lines","none","color","ibf-secondary",1,"component-title-item","ion-padding-left","ion-no-margin"],[1,"m-0"],[1,"mt-1","font-bold"],[1,"mb-1","text-xs"],["size-xl","4","size-lg","4","size-md","4","size-sm","2","size-xs","2",1,"ion-no-padding"],["lines","none","color","ibf-secondary",1,"component-title-item","ion-no-margin","ion-align-items-end"],[1,"m-0","text-right"],[1,"mb-1","text-xs",3,"title"],["size-xl","2","size-lg","3","size-md","0","size-sm","1","size-xs","1"],["lines","none","color","ibf-secondary",1,"component-title-item","ion-padding-left","ion-no-margin","ion-align-items-end"],["data-test","action-summary-types",1,"ion-no-padding",2,"margin-bottom","1px"],["size-xl","6","size-lg","5","size-md","8","size-sm","9","size-xs","9"],["lines","none","color","ibf-white",1,"areas-of-focus-item","ion-no-padding"],["slot","start",1,"areas-of-focus-item-thumbnail"],[1,"object-contain",3,"src"],[1,"areas-of-focus-item-label"],["size-xl","4","size-lg","4","size-md","4","size-sm","2","size-xs","2"],["lines","none",1,"areas-of-focus-item-value"],[1,"text-right"],[1,"actions-not-applicable"],["lines","none","data-test","icon-row","color","ibf-white",1,"areas-of-focus-item-information-icon","ion-no-padding",2,"--inner-padding-end","0px"],["fill","clear","shape","round","size","default",1,"m-auto",3,"click"],["color","fiveten-navy-900","icon","information-circle-outline","slot","icon-only"]],template:function(i,o){i&1&&se(0,aM,21,12),i&2&&re(o.showAreasOfFocusSummary()?0:-1)},dependencies:[Ke,fo,Ze,Qp,kt,ci,hr,nf,Oe],styles:[".component-title[_ngcontent-%COMP%]   .component-title-item[_ngcontent-%COMP%]{--inner-padding-end: 0;height:48px}.component-title[_ngcontent-%COMP%]   .component-title-item[_ngcontent-%COMP%]   .areas-of-focus--title[_ngcontent-%COMP%]{margin-top:4px}.component-title[_ngcontent-%COMP%]   .component-title-item[_ngcontent-%COMP%]   .areas-of-focus--subtitle[_ngcontent-%COMP%]{margin-bottom:0}.component-title[_ngcontent-%COMP%]   .component-title-item[_ngcontent-%COMP%]   .component-title-thumbnail[_ngcontent-%COMP%]{height:24px;width:24px}.areas-of-focus-item[_ngcontent-%COMP%], .areas-of-focus-item-value[_ngcontent-%COMP%], .areas-of-focus-item-information-icon[_ngcontent-%COMP%]{--min-height: 2.5rem;height:2.5rem}.areas-of-focus-item[_ngcontent-%COMP%]{--inner-padding-end: 0}.areas-of-focus-item[_ngcontent-%COMP%]   .areas-of-focus-item-thumbnail[_ngcontent-%COMP%]{background:var(--ion-color-fiveten-neutral-100);border:.2rem solid var(--ion-color-fiveten-neutral-100);width:2.5rem;height:2.5rem;align-self:start;margin:0!important;padding:4px}.areas-of-focus-item[_ngcontent-%COMP%]   .areas-of-focus-item-label[_ngcontent-%COMP%]{line-height:1.2;font-size:12px;margin:0!important;white-space:normal!important;padding:0 4px!important}.areas-of-focus-item-value[_ngcontent-%COMP%]{--background: var(--ion-color-fiveten-neutral-0)}.areas-of-focus-item-value[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0!important;font-size:12px;white-space:normal!important}.areas-of-focus-item-information-icon[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0 auto!important;padding-top:.2em;max-width:20px}.areas-of-focus-item-information-icon[_ngcontent-%COMP%]{--inner-padding-end: .2rem;cursor:pointer}.actions-not-applicable[_ngcontent-%COMP%]{color:var(--ion-color-ibf-grey)}"]})}}return e})();var sM=e=>({lastUploadDate:e}),lM=e=>({supportEmailAddress:e}),cM=()=>[],uM=(e,n,t)=>({adminAreaLabel:e,placeName:n,parentName:t}),dM=e=>({defaultAdminAreaLabel:e}),hM=e=>({adminAreaLabelPlural:e}),pM=(e,n)=>n.name,fM=(e,n)=>n.eventName;function mM(e,n){if(e&1&&(X(0,"span",3),Y(1,"translate")),e&2){let t=B();W("innerHTML",Je(1,1,"chat-component.common.warn-label.message",Lt(4,sM,t.lastUploadDate)),ot)}}function _M(e,n){if(e&1&&(X(0,"app-tooltip",4),Y(1,"translate")),e&2){let t=B();W("value",Je(1,1,"chat-component.common.warn-label.tooltip",Lt(4,lM,t.supportEmailAddress)))}}function vM(e,n){e&1&&(D(0,"ion-row")(1,"ion-col",7),X(2,"app-about-btn",8),Y(3,"translate"),x(),D(4,"ion-col",7),X(5,"app-activation-log-button",9),x(),D(6,"ion-col",7),X(7,"app-ibf-guide-button"),x(),D(8,"ion-col",7),X(9,"app-export-view"),x()()),e&2&&(T(2),W("btnLabel",Z(3,1,"chat-component.common.about-button-label")))}function gM(e,n){if(e&1&&X(0,"app-event-speech-bubble",5),e&2){let t=B();W("type","no-event")("event",null)("selectedEvent",t.eventState==null||t.eventState.event==null?null:t.eventState.event.eventName)("disasterType",t.disasterType)("countryCodeISO3",t.country==null?null:t.country.countryCodeISO3)("areas",wC(9,cM))("adminAreaLabelPlural",t.adminAreaLabelPlural)("mainExposureIndicatorLabel",t.mainExposureIndicatorLabel)("mainExposureIndicatorNumberFormat",t.mainExposureIndicatorNumberFormat)}}function yM(e,n){if(e&1&&X(0,"app-event-speech-bubble",10),e&2){let t=B().$implicit,i=B(2);W("type","active")("event",t)("selectedEvent",i.eventState==null||i.eventState.event==null?null:i.eventState.event.eventName)("disasterType",i.disasterType)("countryCodeISO3",i.country==null?null:i.country.countryCodeISO3)("areas",i.alertAreas)("adminAreaLabelPlural",i.adminAreaLabelPlural)("mainExposureIndicatorLabel",i.mainExposureIndicatorLabel)("mainExposureIndicatorNumberFormat",i.mainExposureIndicatorNumberFormat)("countryDisasterSettings",i.countryDisasterSettings)("cardColors",i.getCardColors(t))}}function SM(e,n){if(e&1&&se(0,yM,1,11,"app-event-speech-bubble",10),e&2){let t=B(2);re(t.filteredAreas.length===0?0:-1)}}function CM(e,n){if(e&1&&Vt(0,SM,1,1,null,null,fM),e&2){let t=B();Gt(t.eventState==null?null:t.eventState.events)}}function TM(e,n){if(e&1){let t=Ye();D(0,"ion-button",20),oe("click",function(){ge(t);let o=B(2);return ye(o.revertAreaSelection())}),D(1,"span",21),M(2),Y(3,"translate"),x(),X(4,"ion-icon",22),x()}e&2&&(T(2),be(Z(3,1,"chat-component.common.back")))}function EM(e,n){if(e&1&&(D(0,"ion-note",17),X(1,"span",23),Y(2,"translate"),M(3),Y(4,"compact"),x()),e&2){let t=B().$implicit,i=B();T(),W("innerHTML",Z(2,2,"chat-component."+i.disasterTypeName+".active-event.exposed"),ot),T(2),ne(" ",Je(4,4,t.mainExposureValue,i.mainExposureIndicatorNumberFormat)," ")}}function bM(e,n){e&1&&(D(0,"ion-note",18)(1,"span"),M(2),Y(3,"translate"),x()()),e&2&&(T(2),be(Z(3,1,"chat-component.common.no-info")))}function xM(e,n){if(e&1&&(D(0,"ion-item",19)(1,"ion-label",24),M(2),Y(3,"translate"),x()()),e&2){let t=B(2);T(2),ne(" ",Je(3,1,"chat-component.common.save-actions.no-actions-admin-level",Lt(4,dM,t.country.adminRegionLabels[t.countryDisasterSettings.defaultAdminLevel].singular)),"")}}function DM(e,n){if(e&1&&(D(0,"ion-item",19),X(1,"ion-label",25),Y(2,"translate"),x()),e&2){let t=B(2);T(),W("innerHTML",Je(2,1,"chat-component.common.save-actions.no-actions",Lt(4,hM,t.adminAreaLabelPlural)),ot)}}function NM(e,n){if(e&1&&(D(0,"span")(1,"strong"),M(2),x()()),e&2){let t=B().$implicit,i=B(2).$implicit,o=B();T(2),ne(" (",t.monthLong[o.getRegion(i.placeCode)],")")}}function wM(e,n){if(e&1){let t=Ye();D(0,"ion-item",31),oe("click",function(){let o=ge(t).$implicit,s=B(2).$implicit,l=B();return ye(l.changeAction(s.placeCode,o.action,!o.checked))}),D(1,"ion-checkbox",32),oe("ionChange",function(o){let s=ge(t).$implicit,l=B(2).$implicit,u=B();return ye(u.changeAction(l.placeCode,s.action,o.detail.checked))})("click",function(o){return ge(t),ye(o.stopPropagation())}),x(),D(2,"ion-label",33)(3,"strong"),M(4),x(),M(5),se(6,NM,3,1,"span"),x()()}if(e&2){let t=n.$implicit;T(),W("checked",t.checked),T(3),ne("",t.aofLabel,": "),T(),ne("",t.label," "),T(),re(t.month?6:-1)}}function IM(e,n){if(e&1){let t=Ye();D(0,"form",26),oe("submit",function(){ge(t);let o=B().$implicit,s=B();return ye(s.submitEapAction(o.placeCode))}),D(1,"ion-list",27),Vt(2,wM,7,4,"ion-item",28,ec),x(),D(4,"ion-row",29)(5,"ion-col")(6,"ion-button",30),M(7),Y(8,"translate"),x()()()()}if(e&2){let t=B().$implicit;T(2),Gt(t.eapActions),T(4),W("disabled",t.submitDisabled),T(),ne(" ",Z(8,2,"chat-component.common.save-actions.submit-button-label")," ")}}function PM(e,n){if(e&1&&(D(0,"app-dialogue-turn",6)(1,"ion-row")(2,"ion-col",11)(3,"div",12)(4,"span",13),X(5,"ion-icon",14)(6,"span",3),Y(7,"translate"),x()()(),D(8,"ion-col",15),se(9,TM,5,3,"ion-button",16),x()(),se(10,EM,5,7,"ion-note",17)(11,bM,4,3,"ion-note",18)(12,xM,4,6,"ion-item",19)(13,DM,3,6,"ion-item",19)(14,IM,9,4,"form"),x()),e&2){let t=n.$implicit,i=B();W("borderColor",i.getCardColors(i.eventState==null?null:i.eventState.event).borderColor)("isSelected",!0),T(5),ya("color",i.getCardColors(i.eventState==null?null:i.eventState.event).iconColor),T(),ya("color",i.getCardColors(i.eventState==null?null:i.eventState.event).headerTextColor),W("innerHTML",Je(7,10,"chat-component."+i.disasterTypeName+".active-event.place-name",PC(13,uM,i.adminAreaLabel,t.name,i.getAreaParentString(t))),ot),T(3),re(i.placeCode?9:-1),T(),re(t.mainExposureValue?10:11),T(2),re((i.eventState==null||i.eventState.event==null?null:i.eventState.event.alertLevel)==="trigger"&&i.countryDisasterSettings.enableEarlyActions&&i.adminLevel>i.countryDisasterSettings.defaultAdminLevel?12:!i.countryDisasterSettings.enableEarlyActions||!t.eapActions.length?13:t.eapActions.length?14:-1)}}var $D=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p,m,g,v,C,E){this.alertAreaService=t,this.authService=i,this.eventService=o,this.placeCodeService=s,this.disasterTypeService=l,this.timelineService=u,this.countryService=d,this.aggregatesService=f,this.changeDetectorRef=p,this.translateService=m,this.analyticsService=g,this.popoverController=v,this.adminLevelService=C,this.debugService=E,this.changedActions=[],this.submitDisabled=!0,this.lastUploadDateFormat="cccc, dd LLLL HH:mm",this.isLastUploadDateLate=!1,this.supportEmailAddress=xt.supportEmailAddress,this.onCountryChange=b=>{this.country=b},this.onDisasterTypeChange=b=>{this.disasterType=b,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onIndicatorChange=b=>{this.indicators=b,this.setupChatText()},this.onEventStateChange=b=>{this.eventState=b},this.onTimelineStateChange=b=>{this.timelineState=b,this.setupChatText()},this.onAlertAreasChange=b=>{this.alertAreas=b,this.alertAreas.forEach(S=>{this.disableSubmitButtonForArea(S)}),this.onPlaceCodeChange(this.placeCode)},this.onPlaceCodeChange=b=>{this.placeCode=b;let S=this.timelineState?.timeStepButtons.find(I=>I.value===this.timelineState?.activeLeadTime);if(b&&(!S||S.forecastAlert)){let I=z=>z.placeCode===b.placeCode;this.filteredAreas=this.alertAreas.filter(I)}else this.setDefaultFilteredAreas();this.changeDetectorRef.detectChanges()},this.setDefaultFilteredAreas=()=>{this.filteredAreas=[]},this.setupChatText=()=>{if(this.country&&this.disasterType&&this.indicators.length&&this.timelineState){this.adminLevel=this.placeCode?.adminLevel||this.countryDisasterSettings.defaultAdminLevel,this.adminAreaLabel=this.country.adminRegionLabels[this.adminLevel].singular,this.adminAreaLabelPlural=this.country.adminRegionLabels[this.adminLevel].plural.toLowerCase(),this.changeDetectorRef.detectChanges(),this.disasterTypeLabel=this.disasterType.label,this.disasterTypeName=this.disasterType.disasterType;let b=this.indicators.find(S=>S.name===this.disasterType.mainExposureIndicator);this.mainExposureIndicatorLabel=b?.label.toLowerCase(),this.mainExposureIndicatorNumberFormat=b?.numberFormatMap,this.updateSuccessMessage=this.translateService.instant("chat-component.common.save-actions.update-success"),this.updateFailureMessage=this.translateService.instant("chat-component.common.save-actions.update-failure"),this.setLastModelRunDate(this.disasterType),this.changeDetectorRef.detectChanges()}},this.setLastModelRunDate=b=>{let S=this.timelineState.today;this.lastUploadDate=S?S.toFormat(this.lastUploadDateFormat):"unknown",this.isLastUploadDateLate=this.eventService.isLastUploadDateLate(S.toJSDate(),b)},this.disableSubmitButtonForArea=b=>b.submitDisabled=!0,this.filterAreaByPlaceCode=b=>S=>S.placeCode===b,this.filterChangedEAPActionByChangedEAPAction=b=>S=>S.action!==b.action,this.filterEAPActionByEAPAction=b=>S=>S.action===b,this.filterEAPActionByPlaceCode=b=>S=>S.placeCode===b,this.checkEAPAction=b=>this.alertAreaService.checkEapAction(b.action,b.checked,b.placeCode,this.eventState?.event?.eventName),this.getRegion=b=>{if(this.countryDisasterSettings.droughtRegions){for(let S of Object.keys(this.countryDisasterSettings.droughtRegions))if(this.countryDisasterSettings.droughtRegions[S].includes(b))return S}else return"National"},this.debugService.logComponentInit("ChatComponent","Constructor called")}ngOnInit(){this.debugService.logComponentInit("ChatComponent","ngOnInit called"),this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.eapActionSubscription=this.alertAreaService.getAlertAreas().subscribe(this.onAlertAreasChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.timelineStateSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange),this.indicatorSubscription=this.aggregatesService.getIndicators().subscribe(this.onIndicatorChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.eapActionSubscription.unsubscribe(),this.placeCodeSubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe(),this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription.unsubscribe(),this.timelineStateSubscription.unsubscribe(),this.indicatorSubscription.unsubscribe()}changeAction(t,i,o){this.analyticsService.logEvent(ft.eapAction,{placeCode:t,eapAction:i,eapActionStatus:o,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name});let s=this.filterAreaByPlaceCode(t),u=this.alertAreas.find(s).eapActions.find(this.filterEAPActionByEAPAction(i));u.checked=o,this.changedActions.includes(u)?this.changedActions=this.changedActions.filter(this.filterChangedEAPActionByChangedEAPAction(u)):this.changedActions.push(u),this.alertAreas.find(s).submitDisabled=this.changedActions.length===0,this.changeDetectorRef.detectChanges()}submitEapAction(t){this.analyticsService.logEvent(ft.eapSubmit,{placeCode:t,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.alertAreas.find(this.filterAreaByPlaceCode(t)).submitDisabled=!0,hC(this.changedActions.filter(this.filterEAPActionByPlaceCode(t)).map(this.checkEAPAction)).subscribe({next:()=>this.actionResult(this.updateSuccessMessage),error:()=>{this.actionResult(this.updateFailureMessage),this.revertActionStatusIfFailed()}})}revertActionStatusIfFailed(){let t=this.alertAreas.find(i=>i.placeCode===this.changedActions[0].placeCode);for(let i of t.eapActions)this.changedActions.includes(i)&&(i.checked=!i.checked)}actionResult(t){return dt(this,null,function*(){let i=yield this.popoverController.create({component:Zu,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{message:t}});yield i.present(),i.onDidDismiss().then(()=>{this.placeCodeService.setPlaceCode(this.placeCode),this.changedActions=[]})})}revertAreaSelection(){this.adminLevelService.getAdminLevelType(this.placeCode)!==$i.deepest&&this.adminLevelService.zoomOutAdminLevel(),this.placeCode.placeCodeParent?this.placeCodeService.setPlaceCode(this.placeCode.placeCodeParent):this.placeCodeService.clearPlaceCode()}getAreaParentString(t){return t.nameParent?` (${t.nameParent})`:""}getCardColors(t){let i={iconColor:"var(--ion-color-ibf-black)",headerTextColor:"var(--ion-color-ibf-black)",borderColor:null};return t?t.disasterSpecificProperties?t.disasterSpecificProperties.eapAlertClass?{iconColor:`var(--ion-color-${t.disasterSpecificProperties.eapAlertClass.color})`,headerTextColor:`var(--ion-color-${t.disasterSpecificProperties.eapAlertClass.textColor||t.disasterSpecificProperties.eapAlertClass.color})`,borderColor:`var(--ion-color-${t.disasterSpecificProperties.eapAlertClass.color})`}:t.alertLevel!==Dn.TRIGGER?i:{iconColor:"var(--ion-color-fiveten-red-500)",headerTextColor:"var(--ion-color-fiveten-red-500)",borderColor:"var(--ion-color-fiveten-red-500)"}:t.alertLevel!==Dn.TRIGGER?i:{iconColor:"var(--ion-color-fiveten-red-500)",headerTextColor:"var(--ion-color-fiveten-red-500)",borderColor:"var(--ion-color-fiveten-red-500)"}:i}static{this.\u0275fac=function(i){return new(i||e)(P(Ds),P(Pn),P(ze),P(Zt),P(it),P(tn),P($e),P(J_),P(po),P(Jt),P(ei),P(at),P(Sn),P(qu))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-chat"]],standalone:!1,decls:12,vars:9,consts:[["scrollY","true",1,"ion-padding-bottom"],[3,"isLastUploadDateLate"],[2,"padding-right","20px"],[3,"innerHTML"],["color","danger",1,"absolute",3,"value"],[3,"type","event","selectedEvent","disasterType","countryCodeISO3","areas","adminAreaLabelPlural","mainExposureIndicatorLabel","mainExposureIndicatorNumberFormat"],[3,"borderColor","isSelected"],["size","6","size-md","12","size-lg","6"],[3,"btnLabel"],["data-testid","trigger-log-button"],[3,"type","event","selectedEvent","disasterType","countryCodeISO3","areas","adminAreaLabelPlural","mainExposureIndicatorLabel","mainExposureIndicatorNumberFormat","countryDisasterSettings","cardColors"],[1,"flex","flex-row","gap-2"],[1,"event-header"],[1,"event-header--icon-title"],["src","/assets/icons/Alert_Title.svg","slot","start",1,"alert-icon"],["size-lg","auto","size-md","auto","size-sm","auto"],["color","ibf-primary","size","small","shape","round"],["size","small","color","ibf-black"],["size","small"],["lines","none",1,"background-light"],["color","ibf-primary","size","small","shape","round",3,"click"],[1,"ion-hide-sm-down"],["name","arrow-back","slot","start"],["data-testid","main-exposure-indicator",1,"font-semibold",3,"innerHTML"],[1,"ion-text-wrap"],[1,"ion-text-wrap",3,"innerHTML"],[3,"submit"],[1,"background-light"],["lines","full",1,"p-0"],[1,"ion-nowrap","ion-align-items-center"],["color","ibf-primary","type","submit","expand","full","size","small","strong","true","shape","round",3,"disabled"],["lines","full",1,"p-0",3,"click"],["slot","start","color","ibf-primary","name","action.action",3,"ionChange","click","checked"],[1,"action-label","ion-text-wrap"]],template:function(i,o){i&1&&(D(0,"ion-content",0)(1,"app-dialogue-turn",1)(2,"p",2),X(3,"span",3),Y(4,"translate"),se(5,mM,2,6,"span",3)(6,_M,2,6,"app-tooltip",4),x(),se(7,vM,10,3,"ion-row"),x(),se(8,gM,1,10,"app-event-speech-bubble",5)(9,CM,2,0),Vt(10,PM,15,17,"app-dialogue-turn",6,pM),x()),i&2&&(T(),W("isLastUploadDateLate",o.isLastUploadDateLate),T(2),W("innerHTML",Je(4,6,"chat-component.common.warn-label.hello",o.authService),ot),T(2),re(o.lastUploadDate?5:-1),T(),re(o.isLastUploadDateLate?6:-1),T(),re(o.lastUploadDate?7:-1),T(),re(!(o.eventState==null||o.eventState.events==null)&&o.eventState.events.length?9:8),T(2),Gt(o.filteredAreas))},styles:["ion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:12px}ion-content[_ngcontent-%COMP%]   .background-light[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: none}ion-content[_ngcontent-%COMP%]   .chat-icon[_ngcontent-%COMP%]{width:1.5rem;padding:1px}ion-checkbox[_ngcontent-%COMP%]{margin-inline-end:8px!important}.event-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-weight:700;font-size:.875rem}.event-header[_ngcontent-%COMP%]   .event-header--icon-title[_ngcontent-%COMP%]{align-self:center;flex-grow:3}.alert-icon[_ngcontent-%COMP%]{float:left;margin-right:5px;margin-top:3px}"]})}}return e})();var qD=(()=>{class e{constructor(t){this.popoverController=t}ngOnChanges(t){}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-community-notification-photo-popup"]],inputs:{url:"url"},standalone:!1,features:[bt],decls:8,vars:4,consts:[[1,"popover-window-card"],["color","ibf-primary"],["name","close-circle","size","large",1,"popover-close-button",3,"click"],[1,"ion-padding-top","ion-text-center"],[3,"src"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title"),M(4),Y(5,"translate"),x()(),D(6,"ion-card-content",3),X(7,"img",4),x()()),i&2&&(T(4),be(Z(5,2,"map-popups.community-notification.photo-popup.title")),T(3),tc("src",o.url,Kl))},dependencies:[xi,Di,Zi,ji,Ze,Oe],encapsulation:2})}}return e})();var LM=e=>({formattedDate:e}),AM=e=>({type:e}),OM=e=>({nameVillage:e}),MM=e=>({description:e}),kM=e=>({nameVolunteer:e});function RM(e,n){if(e&1){let t=Ye();D(0,"ion-button",5),oe("click",function(){ge(t);let o=B();return ye(o.openPhotoPopup(o.markerProperties==null?null:o.markerProperties.photoUrl))}),M(1),Y(2,"translate"),X(3,"ion-icon",6),x()}if(e&2){let t=B();W("disabled",!(t.markerProperties!=null&&t.markerProperties.photoUrl)),T(),ne("",Z(2,2,"map-popups.community-notification.photo")," ")}}function FM(e,n){e&1&&(D(0,"div",3)(1,"strong"),M(2),Y(3,"translate"),x()()),e&2&&(T(2),be(Z(3,1,"map-popups.community-notification.no-photo")))}var XD=(()=>{class e{constructor(t,i,o,s){this.popoverController=t,this.alertController=i,this.apiService=o,this.translate=s,this.alertDismissRole={cancel:"cancel",confirm:"confirm"}}ngOnInit(){this.updateContent()}ngOnChanges(t){t.markerProperties&&this.updateContent()}updateContent(){this.markerProperties?.uploadTime&&(this.formattedDate=Fe.fromISO(this.markerProperties.uploadTime).toFormat("d LLLL y, HH:mm"))}openPhotoPopup(t){return dt(this,null,function*(){(yield this.popoverController.create({component:qD,animated:!0,cssClass:"ibf-popover ibf-popover-large",translucent:!0,showBackdrop:!0,componentProps:{url:t}})).present()})}dismissCommunityNotification(t){return dt(this,null,function*(){let i=yield this.alertController.create({header:this.translate.instant("map-popups.community-notification.delete"),message:this.translate.instant("map-popups.community-notification.delete-question"),buttons:[{text:this.translate.instant("map-popups.community-notification.delete-cancel"),role:this.alertDismissRole.cancel},{text:this.translate.instant("map-popups.community-notification.delete-confirm"),role:this.alertDismissRole.confirm}]});yield i.present();let{role:o}=yield i.onDidDismiss();!o||o!==this.alertDismissRole.confirm||this.apiService.dismissCommunityNotification(t).subscribe({next:()=>this.actionResult(this.translate.instant("map-popups.community-notification.delete-successs")),error:()=>this.actionResult(this.translate.instant("map-popups.community-notification.delete-fail"))})})}actionResult(t){return dt(this,null,function*(){let i=yield this.popoverController.create({component:Zu,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{message:t}});yield i.present(),i.onDidDismiss().then(()=>{window.location.reload()})})}static{this.\u0275fac=function(i){return new(i||e)(P(at),P(of),P(ui),P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-community-notification-popup"]],inputs:{markerProperties:"markerProperties"},standalone:!1,features:[bt],decls:19,vars:37,consts:[[1,"community-notification-title"],[1,"community-notification-info",3,"innerHTML"],["type","button","color","ibf-primary","shape","round","expand","full",3,"disabled"],[1,"community-notification-info"],["type","button","color","ibf-primary","shape","round","expand","full","fill","outline",3,"click"],["type","button","color","ibf-primary","shape","round","expand","full",3,"click","disabled"],["slot","start","name","image"]],template:function(i,o){i&1&&(D(0,"div",0)(1,"strong"),M(2),Y(3,"translate"),x()(),X(4,"div",1),Y(5,"translate"),X(6,"div",1),Y(7,"translate"),X(8,"div",1),Y(9,"translate"),X(10,"div",1),Y(11,"translate"),X(12,"div",1),Y(13,"translate"),se(14,RM,4,4,"ion-button",2)(15,FM,4,3,"div",3),D(16,"ion-button",4),oe("click",function(){return o.dismissCommunityNotification(o.markerProperties==null?null:o.markerProperties.pointDataId)}),M(17),Y(18,"translate"),x()),i&2&&(T(2),be(Z(3,8,"map-popups.community-notification.title")),T(2),W("innerHTML",Je(5,10,"map-popups.community-notification.date",Lt(27,LM,o.formattedDate||"")),ot),T(2),W("innerHTML",Je(7,13,"map-popups.community-notification.hazard-type",Lt(29,AM,(o.markerProperties==null?null:o.markerProperties.type)||"")),ot),T(2),W("innerHTML",Je(9,16,"map-popups.community-notification.village-name",Lt(31,OM,(o.markerProperties==null?null:o.markerProperties.nameVillage)||"")),ot),T(2),W("innerHTML",Je(11,19,"map-popups.community-notification.description",Lt(33,MM,(o.markerProperties==null?null:o.markerProperties.description)||"")),ot),T(2),W("innerHTML",Je(13,22,"map-popups.community-notification.volunteer",Lt(35,kM,(o.markerProperties==null?null:o.markerProperties.nameVolunteer)||"")),ot),T(2),re(o.markerProperties!=null&&o.markerProperties.photoUrl?14:15),T(3),be(Z(18,25,"map-popups.community-notification.delete")))},dependencies:[Ke,Ze,Oe],styles:[".community-notification-title[_ngcontent-%COMP%]{margin-bottom:5px;font-size:17px}.community-notification-info[_ngcontent-%COMP%]{margin-bottom:5px;font-size:14px;word-wrap:normal}"]})}}return e})();var YM=(e,n)=>n.countryCodeISO3;function BM(e,n){if(e&1&&(D(0,"ion-select-option",1),M(1),x()),e&2){let t=n.$implicit;tc("value",t.countryCodeISO3),T(),ne(" ",t.countryName," ")}}function UM(e,n){if(e&1){let t=Ye();D(0,"ion-item")(1,"ion-select",0),oe("ionChange",function(o){ge(t);let s=B();return ye(s.handleCountryChange(o))}),Vt(2,BM,2,2,"ion-select-option",1,YM),x()()}if(e&2){let t=B();T(),W("value",t.country?t.country.countryCodeISO3:null),T(),Gt(t.countryService.countries)}}var j9=(()=>{class e{constructor(t){this.countryService=t,this.onCountryChange=i=>{this.country=i}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange)}ngOnDestroy(){this.countrySubscription.unsubscribe()}handleCountryChange(t){this.countryService.selectCountry(t.detail.value)}static{this.\u0275fac=function(i){return new(i||e)(P($e))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-country-switcher"]],standalone:!1,decls:1,vars:1,consts:[["label","Country","placeholder","Select Country","data-testid","country-switcher-dropdown","interface","popover",3,"ionChange","value"],[3,"value"]],template:function(i,o){i&1&&se(0,UM,4,1,"ion-item"),i&2&&re(o.countryService.countries.length>1?0:-1)},dependencies:[kt,GC,WC,HC],encapsulation:2})}}return e})();function zM(e,n){if(e&1&&(D(0,"div")(1,"span",3),M(2),x(),X(3,"br"),x()),e&2){let t=B();T(2),be(t.firstLine)}}function HM(e,n){if(e&1&&(D(0,"div")(1,"span",4),M(2),x(),X(3,"br"),x()),e&2){let t=B();T(2),be(t.thirdLine)}}function VM(e,n){if(e&1&&X(0,"ion-icon",2),e&2){let t=B();W("src",t.trigger?"/assets/icons/Alert_Title_Purple.svg":"/assets/icons/Alert_Title_Purple_Clear.svg")}}var JD=(()=>{class e{constructor(t,i){this.disasterTypeService=t,this.timelineService=i,this.date=Fe.now(),this.dateFormat="",this.monthFormat="",this.hourFormat="HH:00",this.onTimelineStateChange=()=>{let o=this.disasterTypeService?.disasterType?.disasterType;this.dateFormat=z_[o]||z_.default,this.monthFormat=H_[o]||H_.default,o===Rt.floods&&(this.firstLine=this.date.toFormat(this.dateFormat)),this.secondLine=this.date?this.date.toFormat(this.monthFormat):"Undetermined",o===Rt.typhoon||o===Rt.flashFloods?this.forecastAlert&&(this.thirdLine=this.date?this.date.toFormat(this.hourFormat):o===Rt.typhoon?"Landfall":""):this.thirdLine=""}}ngOnInit(){this.timelineStateSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange)}ngOnChanges(t){(t.date||t.forecastAlert||t.trigger)&&this.onTimelineStateChange()}ngOnDestroy(){this.timelineStateSubscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)(P(it),P(tn))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-date-button"]],inputs:{date:"date",forecastAlert:"forecastAlert",trigger:"trigger"},standalone:!1,features:[bt],decls:6,vars:4,consts:[[1,"date-text"],[1,"second-line"],["slot","end",1,"warning-icon","ml-1",3,"src"],[1,"first-line"],[1,"third-line"]],template:function(i,o){i&1&&(D(0,"span",0),se(1,zM,4,1,"div"),D(2,"span",1),M(3),x(),se(4,HM,4,1,"div"),x(),se(5,VM,1,1,"ion-icon",2)),i&2&&(T(),re(o.firstLine?1:-1),T(2),be(o.secondLine),T(),re(o.thirdLine?4:-1),T(),re(o.forecastAlert?5:-1))},dependencies:[Ze],styles:[".first-line[_ngcontent-%COMP%]{font-size:14px}.second-line[_ngcontent-%COMP%]{font-size:10px;font-weight:700}.third-line[_ngcontent-%COMP%]{font-size:10px}.date-text[_ngcontent-%COMP%]{float:left}.alert-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-left:5px}"]})}}return e})();var WM=["*"];function ZM(e,n){e&1&&xC(0)}function jM(e,n){e&1&&EC(0)}function $M(e,n){if(e&1&&(D(0,"ion-text",6),M(1),x()),e&2){let t=B();T(),ne(" First issued: ",t.firstIssuedDate," ")}}var Q_=(()=>{class e{constructor(){this.isLastUploadDateLate=!1,this.isSelected=!1,this.borderColor=null,this.mouseOver=!1}ngOnChanges(t){t.isSelected&&!this.isSelected&&(this.mouseOver=!1)}onMouseOver(){this.mouseOver=!0}onMouseOut(){this.mouseOver=!1}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-dialogue-turn"]],inputs:{firstIssuedDate:"firstIssuedDate",isLastUploadDateLate:"isLastUploadDateLate",isSelected:"isSelected",borderColor:"borderColor"},standalone:!1,features:[bt],ngContentSelectors:WM,decls:8,vars:6,consts:[["contentTemplate",""],["data-test","chat",1,"dialogue-turn","ion-align-items-start"],[1,"dialogue-turn--content"],[3,"mouseover","focus","mouseout","blur"],["data-testid","dialogue-turn-content",1,"space-y-2"],[4,"ngTemplateOutlet"],[1,"float-right","text-[10px]"]],template:function(i,o){if(i&1){let s=Ye();bC(),se(0,ZM,1,0,"ng-template",null,0,LC),D(2,"div",1)(3,"div",2)(4,"ion-card",3),oe("mouseover",function(){return ge(s),ye(o.onMouseOver())})("focus",function(){return ge(s),ye(o.onMouseOver())})("mouseout",function(){return ge(s),ye(o.onMouseOut())})("blur",function(){return ge(s),ye(o.onMouseOut())}),D(5,"ion-card-content",4),se(6,jM,1,0,"ng-container",5)(7,$M,2,1,"ion-text",6),x()()()()}if(i&2){let s=ic(1);T(2),bi("is-late",o.isLastUploadDateLate),T(2),ya("border-color",o.mouseOver||o.isSelected?o.borderColor:null),T(2),W("ngTemplateOutlet",s),T(),re(o.firstIssuedDate?7:-1)}},dependencies:[MC,xi,Di,mo],styles:[".dialogue-turn[_ngcontent-%COMP%]{display:flex}.dialogue-turn[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{box-shadow:none;background-color:var(--ion-color-fiveten-neutral-100);color:var(--ion-color-ibf-black);border:.125rem solid var(--ion-color-fiveten-neutral-100)}.dialogue-turn--content[_ngcontent-%COMP%]{position:relative;order:2;transform-origin:top left;width:100%}.dialogue-turn--content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{margin-bottom:0}.dialogue-turn--content[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{-webkit-inline-start:8px!important;padding-inline-start:8px!important;-webkit-inline-end:8px!important;padding-inline-end:8px!important;padding-top:8px!important;padding-bottom:8px!important}.dialogue-turn.is-late[_ngcontent-%COMP%]   .dialogue-turn--content[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.dialogue-turn.is-late[_ngcontent-%COMP%]   .dialogue-turn--content[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:var(--ion-color-ibf-primary)}.dialogue-turn[_ngcontent-%COMP%]   .dialogue-turn--content[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_speak;animation-duration:.3s;animation-direction:forwards;animation-iteration-count:1}@keyframes _ngcontent-%COMP%_speak{0%{opacity:0}50%{opacity:.2}95%{transform:scale(1.06)}to{opacity:1;transform:scale(1)}}"]})}}return e})();var XM=(e,n)=>n.label;function JM(e,n){if(e&1){let t=Ye();D(0,"div")(1,"ion-icon",0),oe("click",function(){let o=ge(t).$implicit,s=B();return ye(s.switchDisasterType(o))}),x()()}if(e&2){let t=n.$implicit,i=B();T(),W("ngClass",t!=null&&t.alertLevel?"triggered":"")("src",i.getButtonSvg(t.disasterType,t.alertLevel)),Fp("data-testid","disaster-type-button-"+t.disasterType)("data-test-selected",i.isSelectedDisaster(t.disasterType)?"selected-disaster":"")}}var Q9=(()=>{class e{constructor(t,i,o,s,l){this.disasterTypeService=t,this.countryService=i,this.eventService=o,this.placeCodeService=s,this.authService=l,this.disasterTypesCounter=0,this.disasterTypes=[],this.onUserChange=u=>{this.user=u,this.user&&this.country&&this.setupDisasterTypes(this.user,this.country)},this.onCountryChange=u=>{this.country=u,this.user&&this.country&&this.setupDisasterTypes(this.user,this.country)},this.setupDisasterTypes=(u,d)=>{d&&(this.disasterTypesCounter=0,this.disasterTypes=d.disasterTypes.filter(f=>u.disasterTypes.includes(f.disasterType)),this.disasterTypes.sort((f,p)=>f.disasterType>p.disasterType?1:-1),this.disasterTypes.forEach(f=>{this.eventService.getTriggerByDisasterType(d.countryCodeISO3,f,this.onGetDisasterTypeActiveTrigger(this.disasterTypes))}))},this.onGetDisasterTypeActiveTrigger=u=>()=>{if(this.disasterTypesCounter++,this.disasterTypesCounter===u.length){let d=u.find(({alertLevel:p})=>p),f=d||this.disasterTypes[0];this.selectedDisasterType=f.disasterType,this.disasterTypeService.setDisasterType(f)}}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.authSubscription=this.authService.getAuthSubscription().subscribe(this.onUserChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.authSubscription.unsubscribe()}switchDisasterType(t){this.placeCodeService.clearPlaceCode(),this.placeCodeService.clearPlaceCodeHover(),this.disasterTypeService.setDisasterType(t),this.selectedDisasterType=t.disasterType}isSelectedDisaster(t){return this.selectedDisasterType===t}getButtonSvg(t,i){let o=`${this.isSelectedDisaster(t)?"selected":"nonSelected"}${i?"":"Non"}Triggered`;return fT[t][o]}static{this.\u0275fac=function(i){return new(i||e)(P(it),P($e),P(ze),P(Zt),P(Pn))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-disaster-type"]],standalone:!1,decls:3,vars:0,consts:[["slot","start",1,"disaster-type-button",3,"click","ngClass","src"]],template:function(i,o){i&1&&(D(0,"ion-row"),Vt(1,JM,2,4,"div",null,XM),x()),i&2&&(T(),Gt(o.disasterTypes))},dependencies:[Ca,Ze,hr],styles:[".disaster-type-button[_ngcontent-%COMP%]{cursor:pointer;display:block;margin:0 2px;height:32px;width:32px}.disaster-type-button[_ngcontent-%COMP%]:hover{opacity:.85;transition:.3s}"]})}}return e})();var KM=e=>({supportEmailAddress:e}),ev=e=>({adminAreaLabelPlural:e}),KD=(e,n,t,i,o,s)=>({setTriggerSource:e,forecastSourceLabel:n,forecastSourceUrl:t,eventName:i,adminAreaLabelPlural:o,eapLink:s}),QD=(e,n,t,i,o)=>({forecastSourceLabel:e,forecastSourceUrl:n,eventName:t,adminAreaLabelPlural:i,eapLink:o});function QM(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.no-access.header")," ")}function e2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.select-areas.header")," ")}function t2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.confirm.header")," ")}function i2(e,n){if(e&1&&(X(0,"span",9),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"set-trigger-component.select-areas.content",Fv(4,KD,t.forecastSource==null?null:t.forecastSource.setTriggerSource,(t.forecastSource==null?null:t.forecastSource.label)||"Unkown",(t.forecastSource==null?null:t.forecastSource.url)||"#",t.eventName,t.adminAreaLabelPlural,t.eapLink)),ot)}}function n2(e,n){if(e&1&&(X(0,"span",9),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"set-trigger-component.select-areas.content-no-source",Rv(4,QD,(t.forecastSource==null?null:t.forecastSource.label)||"Unkown",(t.forecastSource==null?null:t.forecastSource.url)||"#",t.eventName,t.adminAreaLabelPlural,t.eapLink)),ot)}}function r2(e,n){if(e&1&&(D(0,"ion-item",8),X(1,"span",9),Y(2,"translate"),x(),X(3,"br"),D(4,"ion-item",8),X(5,"span",9),Y(6,"translate"),x(),D(7,"ion-item",8),se(8,i2,2,11,"span",9)(9,n2,2,10,"span",9),x(),D(10,"ion-item",8),X(11,"span",9),Y(12,"translate"),x(),D(13,"ion-item",8),X(14,"span",10),Y(15,"translate"),x(),X(16,"br")),e&2){let t=B();T(),W("innerHTML",Je(2,5,"set-trigger-component.no-access.content",Lt(15,KM,t.supportEmailAddress)),ot),T(4),W("innerHTML",Z(6,8,"set-trigger-component.no-access.about"),ot),T(3),re(t.forecastSource!=null&&t.forecastSource.setTriggerSource?8:9),T(3),W("innerHTML",Z(12,10,"set-trigger-component.no-access.please-note"),ot),T(3),W("innerHTML",Je(15,12,"set-trigger-component.confirm.bullet-list",Lt(17,ev,t.adminAreaLabelPlural)),ot)}}function o2(e,n){if(e&1&&(X(0,"span",9),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"set-trigger-component.select-areas.content",Fv(4,KD,t.forecastSource==null?null:t.forecastSource.setTriggerSource,(t.forecastSource==null?null:t.forecastSource.label)||"Unkown",(t.forecastSource==null?null:t.forecastSource.url)||"#",t.eventName,t.adminAreaLabelPlural,t.eapLink)),ot)}}function a2(e,n){if(e&1&&(X(0,"span",9),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"set-trigger-component.select-areas.content-no-source",Rv(4,QD,(t.forecastSource==null?null:t.forecastSource.label)||"Unkown",(t.forecastSource==null?null:t.forecastSource.url)||"#",t.eventName,t.adminAreaLabelPlural,t.eapLink)),ot)}}function s2(e,n){if(e&1&&(M(0),D(1,"span"),M(2),Y(3,"compact"),x()),e&2){let t=B().$implicit,i=B(2);ne(" "," - "," "),T(2),be(Je(3,2,t.mainExposureValue,i.mainExposureIndicatorNumberFormat))}}function l2(e,n){if(e&1){let t=Ye();D(0,"ion-item",14),oe("click",function(){let o=ge(t).$implicit,s=B(2);return ye(s.selectedAreas[o.name]=!s.selectedAreas[o.name])}),D(1,"ion-checkbox",15),kv("ngModelChange",function(o){let s=ge(t).$implicit,l=B(2);return Mv(l.selectedAreas[s.name],o)||(l.selectedAreas[s.name]=o),ye(o)}),oe("click",function(o){return ge(t),ye(o.stopPropagation())}),x(),D(2,"ion-label",16),M(3),se(4,s2,4,5),x()()}if(e&2){let t=n.$implicit,i=B(2);T(),ho("name","selectedAreas[",t.name,"]"),Ov("ngModel",i.selectedAreas[t.name]),T(2),ne("",t.name," "),T(),re(t.mainExposureValue&&t.mainExposureValue>0?4:-1)}}function c2(e,n){if(e&1&&(D(0,"ion-item",8),se(1,o2,2,11,"span",9)(2,a2,2,10,"span",9),x(),D(3,"ion-item",8)(4,"ion-label",11),M(5),Y(6,"translate"),x()(),D(7,"ion-list",12),Vt(8,l2,5,5,"ion-item",13,ec),x()),e&2){let t=B();T(),re(t.forecastSource!=null&&t.forecastSource.setTriggerSource?1:2),T(4),ne(" ",Je(6,2,"set-trigger-component.select-areas.select-areas",Lt(5,ev,t.adminAreaLabelPlural))," "),T(3),Gt(t.areas)}}function u2(e,n){if(e&1){let t=Ye();X(0,"ion-item",17),Y(1,"translate"),X(2,"ion-item",18),Y(3,"translate"),D(4,"ion-item",19),oe("click",function(){ge(t);let o=B();return ye(o.understood=!o.understood)}),D(5,"ion-checkbox",20),kv("ngModelChange",function(o){ge(t);let s=B();return Mv(s.understood,o)||(s.understood=o),ye(o)}),oe("click",function(o){return ge(t),ye(o.stopPropagation())}),x(),D(6,"ion-label",21),M(7),Y(8,"translate"),x()()}if(e&2){let t=B();W("innerHTML",Z(1,4,"set-trigger-component.confirm.note"),ot),T(2),W("innerHTML",Je(3,6,"set-trigger-component.confirm.bullet-list",Lt(11,ev,t.adminAreaLabelPlural)),ot),T(3),Ov("ngModel",t.understood),T(2),ne("",Z(8,9,"set-trigger-component.confirm.understand")," ")}}function d2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.select-areas.back")," ")}function h2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.confirm.back")," ")}function p2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.select-areas.continue")," ")}function f2(e,n){e&1&&(M(0),Y(1,"translate")),e&2&&ne(" ",Z(1,1,"set-trigger-component.confirm.continue")," ")}function m2(e,n){if(e&1){let t=Ye();D(0,"ion-item",7)(1,"ion-label"),M(2),Y(3,"translate"),x(),D(4,"div",22)(5,"ion-button",23),oe("click",function(){ge(t);let o=B();return ye(o.popoverStep==="select-areas"?o.closePopover():o.backToSelectAreasStep())}),se(6,d2,2,3)(7,h2,2,3),x(),D(8,"ion-button",24),oe("click",function(){ge(t);let o=B();return ye(o.popoverStep==="select-areas"?o.continueToConfirmStep():o.submitSetTriggerAreas())}),se(9,p2,2,3)(10,f2,2,3),x()()()}if(e&2){let t=B();T(2),Sa(" ",t.getCheckedCount()," ",Je(3,5,"set-trigger-component.select-areas.checked-count",Lt(8,ev,t.adminAreaLabelPlural))," "),T(4),re(t.popoverStep==="select-areas"?6:t.popoverStep==="confirm"?7:-1),T(2),W("disabled",t.popoverStep==="select-areas"?t.isContinueDisabled():t.isSubmitDisabled()),T(),re(t.popoverStep==="select-areas"?9:t.popoverStep==="confirm"?10:-1)}}var eN=(()=>{class e{constructor(t,i,o,s,l){this.popoverController=t,this.apiService=i,this.translateService=o,this.analyticsService=s,this.eventService=l,this.popoverStep="select-areas",this.selectedAreas={},this.understood=!1,this.supportEmailAddress=xt.supportEmailAddress}ngOnChanges(t){t.areas&&(this.selectedAreas={})}getCheckedCount(){return Object.values(this.selectedAreas).filter(t=>t).length}closePopover(){this.popoverController.dismiss(null,"cancel")}isContinueDisabled(){return!Object.values(this.selectedAreas).some(t=>t)}isSubmitDisabled(){return!this.understood}continueToConfirmStep(){this.popoverStep="confirm"}backToSelectAreasStep(){this.popoverStep="select-areas"}submitSetTriggerAreas(){let i=this.areas.filter(s=>this.selectedAreas[s.name]).map(s=>s.eventPlaceCodeId);this.analyticsService.logEvent(ft.aboutTrigger,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.apiService.setTrigger(i,this.countryCodeISO3,this.disasterType,!1).subscribe({next:()=>{window.location.reload()},error:()=>this.actionResult(this.translateService.instant("set-trigger-component.confirm.error"))})}actionResult(t){return dt(this,null,function*(){let i=yield this.popoverController.create({component:Zu,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{message:t}});yield i.present(),i.onDidDismiss().then(()=>{window.location.reload()})})}static{this.\u0275fac=function(i){return new(i||e)(P(at),P(ui),P(Jt),P(ei),P(ze))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-set-trigger-popover"]],inputs:{eapLink:"eapLink",forecastSource:"forecastSource",adminAreaLabelPlural:"adminAreaLabelPlural",areas:"areas",mainExposureIndicatorNumberFormat:"mainExposureIndicatorNumberFormat",hasSetTriggerPermission:"hasSetTriggerPermission",countryCodeISO3:"countryCodeISO3",disasterType:"disasterType",eventName:"eventName"},standalone:!1,features:[bt],decls:14,vars:3,consts:[[1,"popover-window-card"],["color","ibf-primary"],["name","close-circle","size","large",1,"popover-close-button",3,"click"],[1,"font-[Montserrat]","font-semibold"],[1,"inline-block","align-middle"],["name","warning"],[1,"ion-padding-top","ion-text-center"],["lines","none",1,"ion-margin-top"],["lines","none"],[3,"innerHTML"],[1,"bullet-list",3,"innerHTML"],[1,"mb-0","font-[Montserrat]","font-semibold"],[1,"background-light","ion-no-padding"],["lines","none",1,"area-item"],["lines","none",1,"area-item",3,"click"],["slot","start","color","ibf-primary",1,"m-2",3,"ngModelChange","click","ngModel","name"],[1,"ion-text-wrap","m-0"],["lines","none",1,"font-[Montserrat]","font-semibold",3,"innerHTML"],["lines","none",1,"ion-margin-bottom","bullet-list",3,"innerHTML"],["lines","none",3,"click"],["slot","start","color","ibf-primary","name","understood",1,"mr-2",3,"ngModelChange","click","ngModel"],[1,"ion-text-wrap"],[1,"space-x-2"],["size","default","fill","clear","shape","round","color","dark",3,"click"],["size","default","fill","solid","shape","round","color","ibf-trigger-alert-primary",3,"click","disabled"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title",3)(4,"div",4),X(5,"ion-icon",5),x(),se(6,QM,2,3)(7,e2,2,3)(8,t2,2,3),x()(),D(9,"ion-card-content",6),se(10,r2,17,19)(11,c2,10,7)(12,u2,9,13)(13,m2,11,10,"ion-item",7),x()()),i&2&&(T(6),re(o.hasSetTriggerPermission?o.popoverStep==="select-areas"?7:8:6),T(4),re(o.hasSetTriggerPermission?o.popoverStep==="select-areas"?11:o.popoverStep==="confirm"?12:-1:10),T(3),re(o.hasSetTriggerPermission?13:-1))},dependencies:[nc,ac,Ke,xi,Di,Zi,ji,Xp,Ze,kt,ci,lc,$p,Oe,Ns],styles:[".bullet-list[_ngcontent-%COMP%]  ul{list-style-type:disc;padding-left:20px}.area-item[_ngcontent-%COMP%]{--min-height: 34px}"]})}}return e})();function _2(e,n){if(e&1&&(D(0,"div",0),M(1),Y(2,"translate"),x()),e&2){let t=B(2);T(),ne(" ",Z(2,1,"chat-component."+t.disasterTypeName+".event-switcher.current-event-message")," ")}}function v2(e,n){if(e&1){let t=Ye();D(0,"ion-button",3),oe("click",function(){ge(t);let o=B(2);return ye(o.switchEvent(o.event))}),M(1),Y(2,"translate"),X(3,"ion-icon",4),x()}if(e&2){let t=B(2);bi("font-bold",(t.event==null?null:t.event.eventName)===t.selectedEventName),T(),ne(" ",Je(2,3,"chat-component."+t.disasterTypeName+".event-switcher.current-event-message",t.event)," ")}}function g2(e,n){if(e&1){let t=Ye();D(0,"ion-button",5),oe("click",function(){ge(t);let o=B(2);return ye(o.switchEvent(o.event))}),M(1),Y(2,"translate"),X(3,"ion-icon",6),x()}if(e&2){let t=B(2);bi("font-bold",(t.event==null?null:t.event.eventName)===t.selectedEventName),T(),ne(" ",Z(2,3,"chat-component."+t.disasterTypeName+".event-switcher.switch-event-button")," ")}}function y2(e,n){if(e&1&&se(0,_2,3,3,"div",0)(1,v2,4,6,"ion-button",1)(2,g2,4,5,"ion-button",2),e&2){let t=B();re((t.event==null?null:t.event.eventName)===t.selectedEventName&&!t.showLessButton()?0:-1),T(),re((t.event==null?null:t.event.eventName)===t.selectedEventName&&t.showLessButton()?1:-1),T(),re((t.event==null?null:t.event.eventName)!==t.selectedEventName?2:-1)}}var tN=(()=>{class e{constructor(t,i,o){this.disasterTypeService=t,this.eventService=i,this.timelineService=o,this.onEventStateChange=s=>{this.eventState=s,this.selectedEventName=this.eventState?.event?.eventName},this.onDisasterTypeChange=s=>{this.disasterTypeName=s.disasterType},this.onTimelineStateChange=s=>{this.timelineState=s}}ngOnInit(){this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.timelineStateSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange)}ngOnDestroy(){this.disasterTypeSubscription.unsubscribe(),this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription.unsubscribe(),this.timelineStateSubscription.unsubscribe()}multipleActiveEvents(){return this.eventState?.events.length>1}showLessButton(){return!this.eventService.skipNationalView(this.disasterTypeName)}switchEvent(t){if(this.selectedEventName===t.eventName){this.eventService.resetEvents();return}this.selectedEventName=t.eventName,this.timelineState.timeStepButtons?.length&&(this.eventService.switchEvent(t.eventName),this.timelineService.setTimelineState(t.firstTriggerLeadTime||t.firstLeadTime,t.eventName))}static{this.\u0275fac=function(i){return new(i||e)(P(it),P(ze),P(tn))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-event-switcher"]],inputs:{event:"event"},standalone:!1,decls:1,vars:1,consts:[[1,"mt-2","text-center","italic"],["shape","round","slot","start","color","ibf-trigger-alert-primary","size","small","expand","full",1,"mt-2",3,"font-bold"],["data-testid","event-switch-button","shape","round","slot","start","color","ibf-trigger-alert-primary","size","small","strong","true","expand","full",1,"mt-2",3,"font-bold"],["shape","round","slot","start","color","ibf-trigger-alert-primary","size","small","expand","full",1,"mt-2",3,"click"],["name","arrow-back","slot","start"],["data-testid","event-switch-button","shape","round","slot","start","color","ibf-trigger-alert-primary","size","small","strong","true","expand","full",1,"mt-2",3,"click"],["name","arrow-forward","slot","end"]],template:function(i,o){i&1&&se(0,y2,3,3),i&2&&re(o.multipleActiveEvents()?0:-1)},dependencies:[Ke,Ze,Oe],encapsulation:2})}}return e})();var iN=(()=>{class e{constructor(t){this.sanitizer=t}get safeValue(){return this.sanitizer.bypassSecurityTrustHtml(this.value||"")}static{this.\u0275fac=function(i){return new(i||e)(P(Gp))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-tooltip-popover"]],inputs:{value:"value"},standalone:!1,decls:1,vars:1,consts:[[1,"ion-padding","tooltip--label",3,"innerHTML"]],template:function(i,o){i&1&&X(0,"ion-label",0),i&2&&W("innerHTML",o.safeValue,ot)},dependencies:[ci],styles:["[_nghost-%COMP%]{display:inline-block}ion-label[_ngcontent-%COMP%]{font-size:12px}"]})}}return e})();function T2(e,n){if(e&1){let t=Ye();D(0,"ion-button",1),oe("click",function(o){ge(t);let s=B();return ye(s.presentPopover(o))}),X(1,"ion-icon",2),x()}if(e&2){let t=B();T(),W("color",t.color)}}var ws=(()=>{class e{constructor(t){this.popoverController=t}ngOnChanges(t){}presentPopover(t){return dt(this,null,function*(){let i=yield this.popoverController.create({component:iN,componentProps:{value:this.value},cssClass:"tooltip--container leading-tight",event:t,showBackdrop:!1});yield i.present(),yield i.onDidDismiss()})}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-tooltip"]],inputs:{value:"value",color:"color"},standalone:!1,features:[bt],decls:1,vars:1,consts:[["fill","clear","shape","round","size","small",1,"tooltip--button","ion-no-padding","ion-no-margin"],["fill","clear","shape","round","size","small",1,"tooltip--button","ion-no-padding","ion-no-margin",3,"click"],["name","information-circle-outline","size","small","aria-hidden","true","slot","icon-only",3,"color"]],template:function(i,o){i&1&&se(0,T2,2,1,"ion-button",0),i&2&&re(o.value?0:-1)},dependencies:[Ke,Ze],styles:["ul{list-style-type:disc;padding-left:20px}"]})}}return e})();var E2=e=>({adminAreaLabelPlural:e}),b2=e=>({firstLeadTimeDate:e}),x2=e=>({date:e}),D2=(e,n)=>n.eventPlaceCodeId;function N2(e,n){if(e&1&&(X(0,"span",5),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"chat-component."+(t.disasterType==null?null:t.disasterType.disasterType)+".active-event.first-warning-date",Lt(4,b2,t.event.firstLeadTimeDate)),ot)}}function w2(e,n){if(e&1&&X(0,"span",5),e&2){let t=B(2);W("innerHTML",t.typhoonLandfallText,ot)}}function I2(e,n){if(e&1&&(D(0,"span"),M(1),Y(2,"translate"),x()),e&2){let t=B(2);T(),be(Je(2,1,"chat-component.common.alertLevel.expected",Lt(4,x2,t.event.firstTriggerLeadTimeDate||t.event.firstLeadTimeDate)))}}function P2(e,n){if(e&1&&(X(0,"p",5),Y(1,"translate")),e&2){let t=B(2);W("innerHTML",Je(1,1,"chat-component.common.alertLevel.set-by",t.event),ot)}}function L2(e,n){if(e&1&&(D(0,"p")(1,"span",6),M(2),Y(3,"translate"),x(),D(4,"a",8),M(5),x()()),e&2){let t=B(2);T(2),ne("",Z(3,3,"chat-component.common.alertLevel.source")," "),T(2),W("href",t.countryDisasterSettings==null?null:t.countryDisasterSettings.forecastSource.url,Kl),T(),be(t.countryDisasterSettings==null?null:t.countryDisasterSettings.forecastSource.label)}}function A2(e,n){if(e&1&&(D(0,"span"),M(1),Y(2,"titlecase"),Y(3,"compact"),x()),e&2){let t=B(2);T(),be("("+Z(2,1,t.mainExposureIndicatorLabel)+" "+Je(3,3,t.event.mainExposureValueSum,t.mainExposureIndicatorNumberFormat)+")")}}function O2(e,n){e&1&&(D(0,"span"),M(1),Y(2,"translate"),x()),e&2&&(T(),be("("+Z(2,1,"chat-component.common.alertLevel.no-data")+")"))}function M2(e,n){if(e&1&&(D(0,"span"),M(1),x()),e&2){let t=B().$implicit;T(),ne("(",t.nameParent,")")}}function k2(e,n){if(e&1&&(M(0),D(1,"span"),M(2),Y(3,"compact"),x()),e&2){let t=B().$implicit,i=B(3);ne(" "," - "," "),T(2),be(Je(3,2,t.mainExposureValue,i.mainExposureIndicatorNumberFormat))}}function R2(e,n){if(e&1){let t=Ye();D(0,"li",12),oe("click",function(){let o=ge(t).$implicit,s=B(3);return ye(s.selectArea(o))})("keydown.enter",function(){let o=ge(t).$implicit,s=B(3);return ye(s.selectArea(o))}),M(1),se(2,M2,2,1,"span")(3,k2,4,5),x()}if(e&2){let t=n.$implicit;T(),ne(" ",t.name," "),T(),re(t.nameParent?2:-1),T(),re(t.mainExposureValue&&t.mainExposureValue>0?3:-1)}}function F2(e,n){if(e&1){let t=Ye();D(0,"ion-button",13),oe("click",function(){ge(t);let o=B(3);return ye(o.openSetTriggerPopover())}),M(1),Y(2,"translate"),x()}e&2&&(T(),be(Z(2,1,"chat-component.common.set-trigger.btn-text")))}function Y2(e,n){if(e&1&&(D(0,"div")(1,"ul",9),Vt(2,R2,4,3,"li",10,D2),x()(),se(4,F2,3,3,"ion-button",11)),e&2){let t=B(2);T(2),Gt(t.areas),T(2),re(t.disasterType.enableSetWarningToTrigger&&t.event.alertLevel!=="trigger"?4:-1)}}function B2(e,n){if(e&1&&X(0,"app-event-switcher",7),e&2){let t=B(2);W("event",t.event)}}function U2(e,n){if(e&1&&(D(0,"app-dialogue-turn",0)(1,"div",1)(2,"span",2),X(3,"ion-icon",3),D(4,"span"),M(5),x()(),X(6,"app-tooltip",4),Y(7,"translate"),x(),D(8,"p"),se(9,N2,2,6,"span",5),x(),D(10,"p")(11,"span",6),M(12),x(),se(13,w2,1,1,"span",5)(14,I2,3,6,"span"),x(),se(15,P2,2,4,"p",5)(16,L2,6,5,"p"),D(17,"p")(18,"span",6),M(19),Y(20,"translate"),x(),M(21,"\xA0"),D(22,"span"),M(23),x(),se(24,A2,4,6,"span")(25,O2,3,3,"span"),x(),se(26,Y2,5,1)(27,B2,1,1,"app-event-switcher",7),x()),e&2){let t=B();W("isSelected",t.eventBubbleIsSelected(t.event.eventName))("borderColor",t.cardColors.borderColor)("firstIssuedDate",t.event.firstIssuedDate),T(3),ya("color",t.cardColors.iconColor),T(),ya("color",t.cardColors.headerTextColor),T(),be(t.event.header),T(),W("value",Z(7,18,"chat-component.common.event-tooltip")),T(3),re(t.showFirstWarningDate()?9:-1),T(3),ne("",t.event.disasterSpecificProperties.eapAlertClass.label,": "),T(),re(t.typhoonLandfallText?13:14),T(2),re(t.event.userTrigger?15:t.countryDisasterSettings!=null&&t.countryDisasterSettings.forecastSource?16:-1),T(4),be(Je(20,20,"chat-component.common.alertLevel.exposed-areas",Lt(23,E2,t.adminAreaLabelPlural))),T(4),be(t.event.nrAlertAreas+" "),T(),re(t.event.mainExposureValueSum?24:25),T(2),re(t.event.eventName===t.selectedEvent?26:-1),T(),re(t.event?27:-1)}}function z2(e,n){if(e&1&&(D(0,"app-dialogue-turn"),X(1,"p",5),Y(2,"translate"),x()),e&2){let t=B();T(),W("innerHTML",Z(2,1,"chat-component."+(t.disasterType==null?null:t.disasterType.disasterType)+".no-event.welcome"),ot)}}var nN=(()=>{class e{constructor(t,i,o,s,l,u){this.authService=t,this.placeCodeService=i,this.eventService=o,this.adminLevelService=s,this.translateService=l,this.popoverController=u,this.onPlaceCodeHoverChange=d=>{this.placeCodeHover=d},this.onUserChange=d=>{d&&(this.userRole=d.userRole)}}ngOnChanges(t){t.event&&this.event&&(this.typhoonLandfallText=this.showTyphoonLandfallText(this.event),this.event.header=this.getHeader(this.event),this.event.mainExposureValueSum=this.getEventMainExposureValue(this.event,this.mainExposureIndicatorNumberFormat))}ngAfterViewChecked(){this.placeCodeHoverSubscription=this.placeCodeService.getPlaceCodeHoverSubscription().subscribe(this.onPlaceCodeHoverChange),this.authService.getAuthSubscription().subscribe(this.onUserChange),this.typhoonLandfallText=this.showTyphoonLandfallText(this.event),this.event&&(this.event.header=this.getHeader(this.event),this.event.mainExposureValueSum=this.getEventMainExposureValue(this.event,this.mainExposureIndicatorNumberFormat))}ngOnDestroy(){this.placeCodeHoverSubscription.unsubscribe()}getEventMainExposureValue(t,i){let o=t.alertAreas?.reduce((s,l)=>s+l.mainExposureValue,0);return i===Gn.perc?o/t.alertAreas?.length||1:o}selectArea(t){this.adminLevelService.zoomInAdminLevel(),this.placeCodeService.setPlaceCode({countryCodeISO3:this.countryCodeISO3,placeCodeName:t.name,placeCode:t.placeCode,placeCodeParentName:t.nameParent,adminLevel:t.adminLevel,eventName:this.event?.eventName||null})}hasSetTriggerPermission(){return[Ea.Admin,Ea.LocalAdmin].includes(this.userRole)}eventBubbleIsSelected(t){return t===this.eventService.state?.event?.eventName||t===this.placeCodeHover?.eventName}getHeader(t){let i=`chat-component.${this.disasterType?.disasterType}.active-event.header`;return Ar[t.firstLeadTime]==="0"&&(i+="-ongoing"),t.alertLevel!==Dn.TRIGGER&&(i+="-below-trigger"),this.translateService.instant(i,{firstLeadTimeDate:t.firstLeadTimeDate,firstTriggerLeadTimeDate:t.firstTriggerLeadTimeDate,eventName:t.eventName?.split("_")[0]||this.disasterType?.label,disasterTypeLabel:this.disasterType?.label})}showTyphoonLandfallText(t){if(this.disasterType?.disasterType!==Rt.typhoon||!t)return;let i=t.firstLeadTime===Ui.hour0,o=t.disasterSpecificProperties?.typhoonLandfall,s=t.disasterSpecificProperties?.typhoonNoLandfallYet,l=t.alertLevel===Dn.TRIGGER?"":this.translateService.instant("chat-component.typhoon.active-event.warning");return`${this.translateService.instant(`chat-component.typhoon.active-event.${i?"ongoing-event":"upcoming-event"}.${s?"no-landfall-yet":o?"landfall":"no-landfall"}`,{firstLeadTimeDate:t.firstLeadTimeDate})} ${l}`}showFirstWarningDate(){return this.disasterType?.disasterType!==Rt.floods?!1:this.event.firstLeadTime!==this.event.firstTriggerLeadTime}openSetTriggerPopover(){return dt(this,null,function*(){yield(yield this.popoverController.create({component:eN,animated:!0,cssClass:"ibf-popover ibf-popover-large",translucent:!0,showBackdrop:!0,componentProps:{forecastSource:this.countryDisasterSettings?.forecastSource,eapLink:this.countryDisasterSettings?.eapLink,adminAreaLabelPlural:this.adminAreaLabelPlural,areas:this.areas,mainExposureIndicatorNumberFormat:this.mainExposureIndicatorNumberFormat,hasSetTriggerPermission:this.hasSetTriggerPermission(),countryCodeISO3:this.countryCodeISO3,disasterType:this.disasterType.disasterType,eventName:this.event?.eventName?.split("_")[0]}})).present()})}static{this.\u0275fac=function(i){return new(i||e)(P(Pn),P(Zt),P(ze),P(Sn),P(Jt),P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-event-speech-bubble"]],inputs:{type:"type",event:"event",selectedEvent:"selectedEvent",disasterType:"disasterType",countryDisasterSettings:"countryDisasterSettings",countryCodeISO3:"countryCodeISO3",areas:"areas",adminAreaLabelPlural:"adminAreaLabelPlural",mainExposureIndicatorLabel:"mainExposureIndicatorLabel",mainExposureIndicatorNumberFormat:"mainExposureIndicatorNumberFormat",cardColors:"cardColors"},standalone:!1,features:[bt],decls:2,vars:2,consts:[[3,"isSelected","borderColor","firstIssuedDate"],[1,"event-header"],[1,"event-header--icon-title"],["src","/assets/icons/Alert_Title.svg","slot","start",1,"alert-icon"],["data-testid","tooltip-button","color","ibf-no-alert-primary",1,"event-header--tooltip",3,"value"],[3,"innerHTML"],[1,"font-semibold"],[3,"event"],["target","_blank",3,"href"],[1,"list-inside","list-disc","text-xs"],["tabindex","0",1,"my-1","cursor-pointer","hover:underline"],["data-testid","set-trigger-button","shape","round","slot","start","size","small","strong","true","expand","full","fill","outline","color","fiveten-red-700",1,"set-trigger-button"],["tabindex","0",1,"my-1","cursor-pointer","hover:underline",3,"click","keydown.enter"],["data-testid","set-trigger-button","shape","round","slot","start","size","small","strong","true","expand","full","fill","outline","color","fiveten-red-700",1,"set-trigger-button",3,"click"]],template:function(i,o){i&1&&se(0,U2,28,25,"app-dialogue-turn",0)(1,z2,3,3,"app-dialogue-turn"),i&2&&(re(o.type==="active"?0:-1),T(),re(o.disasterType&&o.type==="no-event"?1:-1))},dependencies:[Ke,Ze,Q_,tN,ws,kC,Oe,Ns],styles:["app-dialogue-turn[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], app-dialogue-turn[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], app-dialogue-turn[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:12px}.action-label[_ngcontent-%COMP%]{font-size:small}ion-checkbox[_ngcontent-%COMP%]{margin-inline-end:8px!important}.event-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;font-weight:700;font-size:.875rem}.event-header[_ngcontent-%COMP%]   .event-header--icon-title[_ngcontent-%COMP%]{align-self:center;flex-grow:3}.event-header[_ngcontent-%COMP%]   .event-header--tooltip[_ngcontent-%COMP%]{align-self:start}.alert-icon[_ngcontent-%COMP%]{float:left;margin-right:5px;margin-top:3px}.set-trigger-button[_ngcontent-%COMP%]::part(native){background:var(--ion-color-ibf-white);border-color:var(--ion-color-fiveten-red-500)}"]})}}return e})();var rN=(()=>{class e{constructor(t){this.popoverController=t}closePopover(){this.popoverController.dismiss()}getOperatingSystem(){let t="Unknown";return navigator.appVersion.includes("Win")&&(t="Windows"),navigator.appVersion.includes("Mac")&&(t="MacOS"),navigator.appVersion.includes("Linux")&&(t="Linux"),t}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-export-view-popover"]],standalone:!1,decls:23,vars:24,consts:[["data-test","export-view-popover",1,"popover-window-card"],["color","ibf-primary"],["data-testid","export-view-close-button","name","close-circle","size","large",1,"popover-close-button",3,"click"],["data-testid","export-view-title"],[1,"ion-padding-top"],[1,"ion-margin-bottom"],["data-testid","export-view-windows-os"],["href","https://support.microsoft.com/en-us/windows/open-snipping-tool-and-take-a-screenshot-a35ac9ff-4a58-24c9-3253-f12bac9f9d44","target","_blank",1,"no-underline","hover:underline",3,"title"],["data-testid","export-view-mac-os"],["href","https://support.apple.com/en-us/HT201361","title","'export-view.instruction-mac' | translate","target","_blank",1,"no-underline","hover:underline"],["data-testid","export-view-linux-os"],["href","https://help.ubuntu.com/stable/ubuntu-help/screen-shot-record.html","title","'export-view.instruction-linux' | translate","target","_blank",1,"no-underline","hover:underline"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title",3),M(4),Y(5,"translate"),x()(),D(6,"ion-card-content",4)(7,"div",5),M(8),Y(9,"translate"),x(),D(10,"ion-text",6)(11,"a",7),Y(12,"translate"),M(13),Y(14,"translate"),x()(),D(15,"ion-text",8)(16,"a",9),M(17),Y(18,"translate"),x()(),D(19,"ion-text",10)(20,"a",11),M(21),Y(22,"translate"),x()()()()),i&2&&(T(4),ne(" ",Z(5,12,"export-view.title")," "),T(4),ne(" ",Z(9,14,"export-view.instruction")," "),T(2),bi("ion-hide",o.getOperatingSystem()!=="Windows"),T(),W("title",Z(12,16,"export-view.instruction-windows")),T(2),ne(" ",Z(14,18,"export-view.instruction-windows")," "),T(2),bi("ion-hide",o.getOperatingSystem()!=="MacOS"),T(2),ne(" ",Z(18,20,"export-view.instruction-mac")," "),T(2),bi("ion-hide",o.getOperatingSystem()!=="Linux"),T(2),ne(" ",Z(22,22,"export-view.instruction-linux")," "))},dependencies:[xi,Di,Zi,ji,Ze,mo,Oe],encapsulation:2})}}return e})();var oN=(()=>{class e{constructor(t,i,o){this.popoverController=t,this.analyticsService=i,this.eventService=o}presentPopover(){return dt(this,null,function*(){let t=yield this.popoverController.create({component:rN,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0});this.analyticsService.logEvent(ft.exportView,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),t.present()})}static{this.\u0275fac=function(i){return new(i||e)(P(at),P(ei),P(ze))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-export-view"]],standalone:!1,decls:3,vars:3,consts:[["data-testid","export-view-button","size","small","strong","true","expand","full","shape","round","fill","outline","color","fiveten-neutral-900",1,"export-view-button",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-button",0),oe("click",function(){return o.presentPopover()}),M(1),Y(2,"translate"),x()),i&2&&(T(),ne(" ",Z(2,1,"export-view.title"),`
`))},dependencies:[Ke,Oe],styles:[".export-view-button[_ngcontent-%COMP%]::part(native){background:var(--ion-color-fiveten-neutral-0);border-color:var(--ion-color-fiveten-navy-300)}"]})}}return e})();var aN=(()=>{class e{constructor(t){this.popoverController=t,this.emailAddress=xt.supportEmailAddress}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-forgot-password-popover"]],standalone:!1,decls:12,vars:4,consts:[[1,"popover-window-card"],["color","ibf-primary"],["name","close-circle","size","large",1,"popover-close-button",3,"click"],[1,"ion-padding-top","ion-text-center"],["lines","none"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title"),M(4,"Forgot password?"),x()(),D(5,"ion-card-content",3)(6,"ion-item",4)(7,"span"),M(8),Y(9,"translate"),D(10,"strong"),M(11),x()()()()()),i&2&&(T(8),ne(" ",Z(9,2,"login-page.forgot-password-message")," "),T(3),be(o.emailAddress))},dependencies:[xi,Di,Zi,ji,Ze,kt,Oe],encapsulation:2})}}return e})();var H2=(e,n)=>({videoInsert:e,pdfUrl:n}),V2=e=>({whatsNewUrl:e});function G2(e,n){if(e&1&&(X(0,"br"),D(1,"div"),X(2,"iframe",6),x()),e&2){let t=B();T(2),W("src",t.safeVideoUrl,gC)}}var sN=(()=>{class e{constructor(t,i,o){this.popoverController=t,this.domSanitizer=i,this.translateService=o,this.whatsNewUrl=xt.whatsNewUrl}ngOnInit(){this.safeVideoUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(this.videoUrl),this.videoInsert=this.videoUrl?this.translateService.instant("ibf-guide-component.video-insert"):""}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at),P(Gp),P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-ibf-guide-popover"]],standalone:!1,decls:13,vars:17,consts:[["data-test","ibf-guide-popover",1,"popover-window-card"],["color","ibf-primary"],["data-testid","ibf-guide-close-button","name","close-circle","size","large",1,"popover-close-button",3,"click"],["data-testid","ibf-guide-title"],["data-testid","ibf-guide-content",1,"ion-padding-top"],[3,"innerHTML"],["width","560","height","315","frameborder","0","allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",3,"src"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-icon",2),oe("click",function(){return o.closePopover()}),x(),D(3,"ion-card-title",3),M(4),Y(5,"translate"),x()(),D(6,"ion-card-content",4),X(7,"p",5),Y(8,"translate"),X(9,"br")(10,"p",5),Y(11,"translate"),se(12,G2,3,1),x()()),i&2&&(T(4),be(Z(5,4,"ibf-guide-component.title")),T(3),W("innerHTML",Je(8,6,"ibf-guide-component.video-pdf-description",IC(12,H2,o.videoInsert,o.pdfUrl)),ot),T(3),W("innerHTML",Je(11,9,"ibf-guide-component.whats-new-description",Lt(15,V2,o.whatsNewUrl)),ot),T(2),re(o.videoUrl?12:-1))},dependencies:[xi,Di,Zi,ji,Ze,Oe],encapsulation:2})}}return e})();var lN=(()=>{class e{constructor(t,i,o,s){this.countryService=t,this.popoverController=i,this.analyticsService=o,this.eventService=s,this.onCountryChange=l=>{l&&(this.pdfUrl=l.notificationInfo.linkPdf,this.videoUrl=l.notificationInfo.linkVideo)},this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange)}ngOnDestroy(){this.countrySubscription.unsubscribe()}presentPopover(){return dt(this,null,function*(){let t=yield this.popoverController.create({component:sN,componentProps:{videoUrl:this.videoUrl,pdfUrl:this.pdfUrl},animated:!0,cssClass:"ibf-popover ibf-popover-large",translucent:!0,showBackdrop:!0});this.analyticsService.logEvent(ft.watchIbfGuide,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),t.present()})}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(at),P(ei),P(ze))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-ibf-guide-button"]],standalone:!1,decls:3,vars:3,consts:[["data-testid","ibf-guide-button","size","small","strong","true","expand","full","shape","round","fill","outline","color","fiveten-neutral-900",1,"ibf-guide-button",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-button",0),oe("click",function(){return o.presentPopover()}),M(1),Y(2,"translate"),x()),i&2&&(T(),ne(" ",Z(2,1,"ibf-guide-component.title"),`
`))},dependencies:[Ke,Oe],styles:[".ibf-guide-button[_ngcontent-%COMP%]::part(native){background:var(--ion-color-fiveten-neutral-0);border-color:var(--ion-color-fiveten-navy-300)}"]})}}return e})();function W2(e,n){if(e&1&&M(0),e&2){let t=B();ne(" ",t.unit," ")}}function Z2(e,n){if(e&1&&M(0),e&2){let t=B();ne(" ",t.unit," ")}}var tv=(()=>{class e{constructor(){this.addComma=t=>Math.round(t).toLocaleString("en-US")}ngOnInit(){this.updateStyles()}ngOnChanges(t){this.updateStyles()}updateStyles(){!this.backgroundColor||!this.textColor||!this.thresholdDescription||!this.thresholdPosition||this.barWidth===null||this.barWidth===void 0||this.barValue===null||this.barValue===void 0||this.thresholdValue===null||this.thresholdValue===void 0||(this.barBackgroundStyle=this.getBarBackgroundStyle(),this.barThresholdStyle=this.getBarThresholdStyle(),this.barLevelStyle=this.getBarLevelStyle(),this.descriptionStyle=this.getDescriptionStyle(),this.valueStyle=this.getValueStyle())}getBarBackgroundStyle(){return`
      border-radius: 10px;
      height: 20px;
      background-color: #d4d3d2;
      width: 100%;
    `}getBarThresholdStyle(){return`
      border-radius:10px 0 0 10px;
      border-right: dashed;
      border-right-width: thin;
      height:20px;
      width: ${this.thresholdPosition}%
    `}getBarLevelStyle(){return`
      border-radius:10px;
      height:20px;
      line-height:20px;
      background-color:${this.backgroundColor};
      color:${this.textColor};
      text-align:center;
      white-space: nowrap;
      min-width: 20%;
      width:${this.barWidth}%
    `}getDescriptionStyle(){return`
      height:20px;
      background-color:none;
      border-right: dashed;
      border-right-width: thin;
      float: left; width: ${this.thresholdPosition}%;
      padding-top: 5px;
      margin-bottom:10px;
      text-align: right;
      padding-right: 2px`}getValueStyle(){return`
    height:20px;
    background-color:none;
    margin-left: ${this.thresholdPosition+1}%;
    text-align: left;
    width: 20%;
    padding-top: 5px
    `}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-threshold-bar"]],inputs:{backgroundColor:"backgroundColor",textColor:"textColor",barWidth:"barWidth",barValue:"barValue",thresholdDescription:"thresholdDescription",thresholdValue:"thresholdValue",unit:"unit",thresholdPosition:"thresholdPosition"},standalone:!1,features:[bt],decls:13,vars:15,template:function(i,o){i&1&&(D(0,"div")(1,"div")(2,"div")(3,"div")(4,"strong"),M(5),x(),se(6,W2,1,1),x()()()(),D(7,"div"),M(8),x(),D(9,"div")(10,"strong"),M(11),x(),se(12,Z2,1,1),x()),i&2&&(T(),Ql(o.barBackgroundStyle),T(),Ql(o.barThresholdStyle),T(),Ql(o.barLevelStyle),T(2),be(o.addComma(o.barValue)),T(),re(o.unit?6:-1),T(),Ql(o.descriptionStyle),T(),ne("",o.thresholdDescription,":"),T(),Ql(o.valueStyle),T(2),be(o.thresholdValue),T(),re(o.unit?12:-1))},encapsulation:2})}}return e})();function j2(e,n){if(e&1&&(D(0,"div",1)(1,"div")(2,"ion-label",2)(3,"span",3),M(4),x(),M(5),Y(6,"translate"),x(),D(7,"ion-label",4),X(8,"ion-icon",5),M(9),Y(10,"translate"),x()(),X(11,"app-tooltip",6),Y(12,"translate"),x(),D(13,"div",7)(14,"ion-label",8),M(15),Y(16,"translate"),x()(),X(17,"app-threshold-bar",9),Y(18,"translate"),Y(19,"translate")),e&2){let t=B();T(4),be(t.currentString),T(),ne(" ",Z(6,14,"map-popups.river-gauge.sea-level")," "),T(2),W("color",t.difference<=0?"success":"danger"),T(),W("name",t.difference<=0?"caret-down-outline":"caret-up-outline"),T(),Sa("",t.differenceAbsolute," ",Z(10,16,"map-popups.river-gauge.unit"),""),T(2),W("value",Z(12,18,"map-popups.river-gauge.tooltip")),T(4),be(Z(16,20,"map-popups.river-gauge.current")),T(2),W("barWidth",t.triggerWidth)("barValue",t.current)("thresholdDescription",Z(18,22,"map-popups.river-gauge.normal"))("thresholdValue",t.reference)("thresholdPosition",80)("unit",Z(19,24,"map-popups.river-gauge.unit"))}}function $2(e,n){e&1&&(D(0,"ion-label",0),M(1),Y(2,"translate"),x()),e&2&&(T(),ne(" ",Z(2,1,"map-popups.river-gauge.no-data")," "))}var uN=(()=>{class e{constructor(t){this.translate=t,this.current=0,this.currentString="",this.previous=0,this.reference=0,this.difference=0,this.differenceAbsolute=0,this.triggerWidth=0}ngOnInit(){this.updateContent()}ngOnChanges(t){t.data&&this.updateContent()}updateContent(){if(!this.data?.dynamicData)return;let t=this.data.dynamicData;this.current=this.roundTo(Number(t["water-level"]),2),this.currentString=isNaN(this.current)?"":String(this.current),this.previous=Number(t["water-level-previous"]),this.reference=this.roundTo(Number(t["water-level-reference"]),0),this.difference=this.roundTo(this.current-this.previous,2),this.differenceAbsolute=Math.abs(this.difference),this.triggerWidth=this.calculateTriggerWidth(this.current,this.reference)}roundTo(t,i){if(isNaN(t))return 0;let o=Math.pow(10,i);return Math.round(t*o)/o}calculateTriggerWidth(t,i){if(i===0)return 0;let o=Math.round(t/i*100);return Math.max(Math.min(o,115),0)}static{this.\u0275fac=function(i){return new(i||e)(P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-river-gauge-popup-content"]],inputs:{data:"data"},standalone:!1,features:[bt],decls:2,vars:1,consts:[[1,"pb-1","pr-2","text-gray-500"],[1,"mb-1","flex","justify-between"],[1,"pr-2"],[1,"text-lg","font-semibold"],[1,"mr-1",3,"color"],[3,"name"],["color","ibf-no-alert-primary",3,"value"],[1,"mb-1"],[1,"font-semibold"],["backgroundColor","var(--ion-color-ibf-no-alert-primary)","textColor","var(--ion-color-ibf-white)",3,"barWidth","barValue","thresholdDescription","thresholdValue","thresholdPosition","unit"]],template:function(i,o){i&1&&se(0,j2,20,26)(1,$2,3,3,"ion-label",0),i&2&&re(o.current?0:1)},dependencies:[Ze,ci,ws,tv,Oe],encapsulation:2})}}return e})();var dN=(()=>{class e{constructor(t){this.translate=t}ngOnInit(){this.updateContent()}ngOnChanges(t){t.data&&this.updateContent()}updateContent(){this.data&&(this.dateAndTime=this.getDateAndTime(),this.category=this.data.category)}getDateAndTime(){return Fe.fromISO(this.data.timestamp).toFormat("ccc, dd LLLL, HH:mm")}static{this.\u0275fac=function(i){return new(i||e)(P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-typhoon-trackpoint-popup-content"]],inputs:{data:"data"},standalone:!1,features:[bt],decls:14,vars:4,consts:[[2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"margin-bottom","8px"],["width","32","height","32","viewBox","0 0 32 32","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M26.8211 16.1286L26.8028 16.0965C26.6224 15.7859 26.3267 15.5591 25.98 15.4655C25.6334 15.372 25.2638 15.4192 24.9518 15.5969L22.8259 16.8254C23.0049 15.3864 22.7191 13.9279 22.0103 12.6631C21.9984 12.6347 21.9847 12.6071 21.9691 12.5806L21.9554 12.5622L17.9831 5.67707C17.894 5.52297 17.7755 5.38791 17.6343 5.27963C17.4931 5.17135 17.3319 5.09196 17.16 5.04598C16.9882 5.00001 16.8089 4.98836 16.6325 5.0117C16.4562 5.03504 16.2861 5.09291 16.1321 5.182L16.0954 5.20034C15.786 5.38181 15.5605 5.67798 15.4679 6.02465C15.3753 6.37131 15.423 6.74054 15.6006 7.05227L16.8239 9.17467C15.3552 8.99448 13.8677 9.29695 12.5859 10.0365L12.5355 10.064L5.67673 14.0291C5.5227 14.1182 5.38772 14.2368 5.27949 14.3781C5.17126 14.5194 5.09191 14.6806 5.04596 14.8526C5.00001 15.0245 4.98837 15.2039 5.01169 15.3803C5.03502 15.5568 5.09286 15.727 5.18191 15.8811L5.20023 15.9132C5.28928 16.0673 5.40779 16.2023 5.54901 16.3106C5.69022 16.4189 5.85137 16.4983 6.02325 16.5442C6.19513 16.5902 6.37438 16.6019 6.55076 16.5785C6.72714 16.5552 6.8972 16.4973 7.05122 16.4082L9.18169 15.1797C9.00449 16.6386 9.3017 18.1158 10.0293 19.3924C10.0319 19.4039 10.0366 19.4147 10.043 19.4245L10.0522 19.4383L14.0245 26.3234C14.2046 26.6344 14.5006 26.8612 14.8477 26.954C15.1947 27.0468 15.5643 26.9981 15.8755 26.8185L15.9122 26.8002C16.2224 26.6195 16.4486 26.3233 16.5413 25.9763C16.634 25.6293 16.5857 25.2597 16.407 24.9482L15.1837 22.8258C16.5925 23.0018 18.0208 22.7291 19.2659 22.0466C19.3212 22.0227 19.3748 21.9951 19.4263 21.964L19.44 21.9549L26.3263 17.9805C26.6357 17.7991 26.8611 17.5029 26.9538 17.1562C27.0464 16.8096 26.9987 16.4403 26.8211 16.1286ZM12.4347 18.0631C12.4301 18.0585 12.4301 18.0539 12.4255 18.0493C11.8868 17.1079 11.7406 15.9921 12.0185 14.9436C12.2963 13.8951 12.9759 12.9983 13.91 12.4476C13.9191 12.4431 13.9329 12.4339 13.942 12.4293C13.9512 12.4247 13.9558 12.4201 13.9649 12.4156C14.9062 11.8793 16.0204 11.7349 17.0671 12.0137C18.1138 12.2924 19.0089 12.9719 19.5591 13.9054C19.5637 13.9145 19.5729 13.9283 19.5775 13.9374C19.5821 13.9466 19.5866 13.9512 19.5912 13.9604C20.1288 14.9084 20.2701 16.0306 19.9843 17.0825C19.6985 18.1343 19.0088 19.0305 18.0655 19.5758C18.0609 19.5804 18.0564 19.5804 18.0518 19.5849C17.1047 20.1261 15.9819 20.2698 14.9291 19.9845C13.8764 19.6993 12.9794 19.0084 12.4347 18.0631Z","fill","var(--ion-color-ibf-primary)"]],template:function(i,o){i&1&&(D(0,"div",0)(1,"div")(2,"div",1),M(3," Date and time: "),D(4,"strong"),M(5),x()(),D(6,"div"),M(7," Category (ECWMF): "),D(8,"strong"),M(9),Y(10,"translate"),x()()(),D(11,"div"),mC(),D(12,"svg",2),X(13,"path",3),x()()()),i&2&&(T(5),be(o.dateAndTime),T(4),be(Z(10,2,"map-popups.PHL.typhoon.category."+o.category)))},dependencies:[Oe],encapsulation:2})}}return e})();var J2=e=>({leadTime:e}),K2=e=>({returnPeriod:e});function Q2(e,n){if(e&1&&(X(0,"br"),M(1),Y(2,"translate")),e&2){let t=B(2);T(),ne(" ",Je(2,1,"map-popups.glofas-station.forecast-return",Lt(4,K2,t.data==null||t.data.station==null||t.data.station.dynamicData==null?null:t.data.station.dynamicData.forecastReturnPeriod))," ")}}function ek(e,n){if(e&1&&(D(0,"div",1)(1,"strong"),M(2),Y(3,"translate"),D(4,"span",2),Y(5,"translate"),X(6,"ion-icon",3),x()(),se(7,Q2,3,6),x(),X(8,"app-threshold-bar",4),Y(9,"translate")),e&2){let t=B();T(2),ne("",Je(3,10,"map-popups.glofas-station.river-discharge",Lt(17,J2,t.getLeadTimeString()))," "),T(2),W("title",Z(5,13,"map-popups.glofas-station.river-discharge-explanation")),T(3),re((t.data==null||t.data.station==null||t.data.station.dynamicData==null?null:t.data.station.dynamicData.forecastReturnPeriod)>0?7:-1),T(),W("backgroundColor",t.barBackgroundColor)("textColor",t.barTextColor)("barWidth",t.triggerWidth)("barValue",t.barValue)("thresholdDescription",Z(9,15,"map-popups.glofas-station.threshold-description"))("thresholdValue",t.data==null||t.data.station==null||t.data.station.dynamicData==null?null:t.data.station.dynamicData.triggerLevel)("thresholdPosition",80)}}function tk(e,n){e&1&&(D(0,"div",0)(1,"div")(2,"ion-label",5),M(3),Y(4,"translate"),x()()()),e&2&&(T(3),ne(" ",Z(4,1,"map-popups.glofas-station.no-data")," "))}var hN=(()=>{class e{constructor(){this.defautEapAlertClass={label:"No action",color:"ibf-no-alert-primary",value:0}}ngOnInit(){this.updateContent()}ngOnChanges(t){t.data&&this.updateContent()}updateContent(){if(!this.data)return;let t=Number(this.data.station.dynamicData?.forecastLevel)-Number(this.data.station.dynamicData?.triggerLevel),i=.05,o=Number(this.data.station.dynamicData?.triggerLevel??0),s=Math.abs(t)/o<i,l=Number(this.data.station.dynamicData?.forecastLevel??0);t===0||!s?this.barValue=l:this.barValue=o+Math.sign(t)*o*i,this.triggerWidth=Math.max(Math.min(Math.round(this.barValue/Number(this.data.station.dynamicData?.triggerLevel)*100),115),0),this.eapAlertClass=this.data.eapAlertClasses[this.data.station.dynamicData?.eapAlertClass]||this.defautEapAlertClass,this.barBackgroundColor=`var(--ion-color-${this.eapAlertClass.color})`,this.barTextColor=`var(--ion-color-${this.eapAlertClass.textColor||"ibf-white"})`}getLeadTimeString(){if(!this.data?.leadTime)return"";let[t,i]=this.data.leadTime.split("-");return`${t} ${i}${Number(t)===1?"":"s"}`}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-glofas-station-popup-content"]],inputs:{data:"data"},standalone:!1,features:[bt],decls:2,vars:1,consts:[[2,"margin-bottom","4px","display","flex","justify-content","space-between"],[2,"margin-bottom","4px"],[2,"cursor","default",3,"title"],["name","information-circle-outline"],["unit","m3/s",3,"backgroundColor","textColor","barWidth","barValue","thresholdDescription","thresholdValue","thresholdPosition"],[2,"font-size","18px","padding-right","8px"]],template:function(i,o){i&1&&se(0,ek,10,19)(1,tk,5,3,"div",0),i&2&&re(!(o.data==null||o.data.station==null)&&o.data.station.dynamicData?0:1)},dependencies:[Ze,ci,tv,Oe],encapsulation:2})}}return e})();function nk(e,n){if(e&1&&X(0,"app-river-gauge-popup-content",2),e&2){let t=B();W("data",t.riverGauge)}}function rk(e,n){if(e&1&&X(0,"app-typhoon-trackpoint-popup-content",2),e&2){let t=B();W("data",t.typhoonData)}}function ok(e,n){if(e&1&&X(0,"app-glofas-station-popup-content",2),e&2){let t=B();W("data",t.glofasData)}}function ak(e,n){if(e&1&&(D(0,"div",0),M(1),x()),e&2){let t=B();W("ngClass",t.footerClass),T(),ne(" ",t.footerContent," ")}}var iv=(()=>{class e{constructor(t){this.translate=t,this.ibfLayerName=pe,this.defautEapAlertClass={label:"No action",color:"ibf-no-alert-primary",value:0},this.headerClass={"rounded-t-lg p-2 text-white":!0},this.footerClass={"rounded-b-lg border-t px-2 py-1 text-center font-semibold":!0},this.allowedLayers=[pe.gauges,pe.typhoonTrack,pe.glofasStations]}ngOnInit(){this.initializeComponent()}ngOnChanges(t){(t.layerName||t.riverGauge||t.typhoonTrackPoint||t.glofasData)&&this.initializeComponent()}initializeComponent(){!this.layerName||!this.allowedLayers.includes(this.layerName)||!this.riverGauge&&!this.typhoonTrackPoint&&!this.glofasData||(this.layerName===pe.typhoonTrack&&(this.typhoonData={timestamp:this.typhoonTrackPoint.timestamp,category:this.typhoonTrackPoint.category},this.headerClass["bg-ibf-primary"]=!0),this.layerName===pe.gauges&&(this.headerClass["bg-ibf-no-alert-primary"]=!0),this.layerName===pe.glofasStations&&this.glofasData.eapAlertClasses&&(this.eapAlertClass=this.glofasData.eapAlertClasses[this.glofasData.station.dynamicData?.eapAlertClass]??this.defautEapAlertClass,this.headerClass["bg-"+this.eapAlertClass.color]=!0,this.headerClass["text-"+this.eapAlertClass.textColor]=!!this.eapAlertClass.textColor,this.headerClass["text-ibf-white"]=!this.eapAlertClass.textColor,this.footerClass["text-"+this.eapAlertClass.textColor||this.eapAlertClass.color]=!0),this.title=this.getTitle(),this.footerContent=this.getFooterContent())}getTitle(){return this.layerName===pe.gauges?`${String(this.translate.instant("map-popups.river-gauge.header"))} ${this.riverGauge.fid} ${this.riverGauge.name}`:this.layerName===pe.typhoonTrack?`Typhoon track${this.typhoonTrackPoint.passed?" (passed)":""}`:this.layerName===pe.glofasStations?`${this.glofasData.station.stationCode} STATION: ${this.glofasData.station.stationName}`:""}getFooterContent(){if(this.layerName===pe.gauges){let t=this.riverGauge.dynamicData?.["water-level"],i=this.riverGauge.dynamicData?.["water-level-reference"];if(t==null)return"";let o=String(this.translate.instant("map-popups.river-gauge.below")),s=String(this.translate.instant("map-popups.river-gauge.above"));return t<=i?o:s}if(this.layerName===pe.typhoonTrack){let{lat:t,lng:i}=this.typhoonTrackPoint.markerLatLng,o=Math.abs(t).toFixed(4),s=Math.abs(i).toFixed(4),l=t>0?"N":"S",u=i>0?"E":"W";return`${o}\xB0 ${l}, ${s}\xB0 ${u}`}return this.layerName===pe.glofasStations?this.eapAlertClass.label:""}static{this.\u0275fac=function(i){return new(i||e)(P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-dynamic-point-popup"]],inputs:{layerName:"layerName",riverGauge:"riverGauge",typhoonTrackPoint:"typhoonTrackPoint",glofasData:"glofasData"},standalone:!1,features:[bt],decls:8,vars:6,consts:[[3,"ngClass"],[1,"p-2"],[3,"data"]],template:function(i,o){if(i&1&&(D(0,"div",0)(1,"strong"),M(2),x()(),D(3,"div",1),se(4,nk,1,1,"app-river-gauge-popup-content",2)(5,rk,1,1,"app-typhoon-trackpoint-popup-content",2)(6,ok,1,1,"app-glofas-station-popup-content",2),x(),se(7,ak,2,2,"div",0)),i&2){let s;W("ngClass",o.headerClass),T(2),be(o.title),T(),bi("rounded-b-lg",!o.footerContent),T(),re((s=o.layerName)===o.ibfLayerName.gauges?4:s===o.ibfLayerName.typhoonTrack?5:s===o.ibfLayerName.glofasStations?6:-1),T(3),re(o.footerContent?7:-1)}},dependencies:[Ca,uN,dN,hN],encapsulation:2})}}return e})();var sk=["loginForm"];function lk(e,n){e&1&&X(0,"ion-icon",8)}function ck(e,n){e&1&&X(0,"ion-icon",9)}var M8=(()=>{class e{constructor(t,i){this.authService=t,this.popoverController=i,this.model={email:"",password:""},this.inputType="password",this.labelShow="Show password",this.labelHide="Hide password"}onSubmit(){this.authService.login(this.model.email.toLowerCase(),this.model.password).add(()=>{this.loginForm.resetForm()})}presentPopover(){return dt(this,null,function*(){yield(yield this.popoverController.create({component:aN,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0})).present()})}isPassword(){return this.inputType==="password"}toggleInputType(){this.inputType=this.isPassword()?"text":"password"}static{this.\u0275fac=function(i){return new(i||e)(P(Pn),P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-login-form"]],viewQuery:function(i,o){if(i&1&&Up(sk,5),i&2){let s;zp(s=Hp())&&(o.loginForm=s.first)}},standalone:!1,decls:24,vars:20,consts:[["loginForm","ngForm"],[1,"login-form",3,"ngSubmit"],["type","submit","hidden","",3,"disabled"],["position","stacked"],["name","email","type","email","required","","inputmode","email","pattern",".+@.+\\.[a-z]+","autocomplete","email username","clearInput","true","data-test","input-user",3,"ngModelChange","ngModel"],[1,"ion-align-items-center",2,"display","flex","width","100%"],["name","password","required","","autocomplete","current-password","minlength","4","clearInput","true","clearOnEdit","false","data-test","input-password",3,"ngModelChange","ngModel","type"],["type","button","fill","clear","size","default",1,"eye-button",3,"click","title"],["slot","icon-only","name","eye","aria-hidden","true"],["slot","icon-only","name","eye-off","aria-hidden","true"],["type","submit","shape","round","color","fiveten-navy-900","expand","full","data-test","login-button",3,"disabled"],["tabindex","0",1,"ion-margin-vertical",3,"click","keydown.enter"],["color","ibf-no-alert-primary",2,"cursor","pointer","text-decoration","underline"]],template:function(i,o){if(i&1){let s=Ye();D(0,"form",1,0),oe("ngSubmit",function(){return ge(s),ye(o.onSubmit())}),X(2,"input",2),D(3,"ion-item")(4,"ion-label",3),M(5),Y(6,"translate"),x(),D(7,"ion-input",4),oe("ngModelChange",function(u){return ge(s),ye(o.model.email=u)}),x()(),D(8,"ion-item")(9,"ion-label",3),M(10),Y(11,"translate"),x(),D(12,"div",5)(13,"ion-input",6),oe("ngModelChange",function(u){return ge(s),ye(o.model.password=u)}),x(),D(14,"ion-button",7),oe("click",function(){return ge(s),ye(o.toggleInputType())}),se(15,lk,1,0,"ion-icon",8)(16,ck,1,0,"ion-icon",9),x()()(),D(17,"ion-button",10),M(18),Y(19,"translate"),x(),D(20,"div",11),oe("click",function(){return ge(s),ye(o.presentPopover())})("keydown.enter",function(){return ge(s),ye(o.presentPopover())}),D(21,"ion-text",12),M(22),Y(23,"translate"),x()()()}if(i&2){let s=ic(1);T(2),W("disabled",!s.form.valid),T(3),be(Z(6,12,"login-page.email")),T(2),W("ngModel",o.model.email),T(3),be(Z(11,14,"login-page.password")),T(3),W("ngModel",o.model.password)("type",o.inputType),T(),W("title",o.isPassword()?o.labelShow:o.labelHide),Fp("aria-label",o.isPassword()?o.labelShow:o.labelHide),T(),re(o.isPassword()?15:16),T(2),W("disabled",!s.form.valid),T(),be(Z(19,16,"login-page.title")),T(4),be(Z(23,18,"login-page.forgot-password"))}},dependencies:[sc,nc,rc,Zp,jp,UC,ac,oc,Ke,Ze,ef,kt,ci,mo,qp,Oe],styles:["ion-label[position=stacked][_ngcontent-%COMP%]{--color: var(--ion-color-ibf-no-alert-primary)}ion-input[_ngcontent-%COMP%]{border:none;background:transparent}ion-input[_ngcontent-%COMP%]     .native-input{box-shadow:none}.eye-button[_ngcontent-%COMP%]{--color: var(--ion-color-ibf-no-alert-primary)}"],changeDetection:0})}}return e})();var mi=Xl(Vu(),1);var jt=Xl(Vu(),1);var pN=(()=>{class e{constructor(t,i,o,s,l){this.eventService=t,this.analyticsService=i,this.injector=o,this.applicationRef=s,this.componentFactoryResolver=l,this.TYPHOON_TRACK_NORMAL_POINT_SIZE=15,this.TYPHOON_TRACK_LATEST_POINT_SIZE=26,this.onMapMarkerClick=u=>()=>{this.analyticsService.logEvent(u,{page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name})}}createMarkerCommunityNotification(t,i){if(t.dismissed)return;let o=t.nameVillage,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(dT),alt:"Community notifications"});return s.bindPopup(this.renderPopUpHTML(t),{minWidth:220}),s.on("click",this.onMapMarkerClick(ft.communityNotification)),s}renderPopUpHTML(t){let i=document.createElement("popup-component"),s=this.componentFactoryResolver.resolveComponentFactory(XD).create(this.injector,[],i);return this.applicationRef.attachView(s.hostView),s.instance.markerProperties=t,i}formatAsCoordinate(t){let i=`${Math.abs(t.lat).toFixed(4)}\xB0 ${t.lat>0?"N":"S"}`,o=`${Math.abs(t.lng).toFixed(4)}\xB0 ${t.lng>0?"E":"W"}`;return`${i}, ${o}`}createMarkerStation(t,i,o,s){let l=s.find(C=>C.eventName===t.stationCode||C.eventName===t.stationName),u=l?.firstTriggerLeadTime||l?.firstLeadTime,d=t.stationName,f=t.dynamicData?.eapAlertClass||"no",p=`glofas-station glofas-station-${f}`,m=Tt(me({},In),{iconUrl:`assets/markers/glofas-station-${f}-trigger.svg`,iconRetinaUrl:`assets/markers/glofas-station-${f}-trigger.svg`,className:p}),g=`trigger-popup-${f}`,v=(0,jt.marker)(i,{title:d,icon:m?(0,jt.icon)(m):(0,jt.divIcon)({className:p}),zIndexOffset:700});return v.bindPopup(this.createMarkerStationPopup(t,o,u),{minWidth:350,className:g}),v.on("click",this.onMapMarkerClick(ft.glofasStation)),v}createMarkerTyphoonTrack(t,i,o,s){let l=wu(t.timestampOfTrackpoint),u=wu(o),d=gx(l,s),f="ccc, dd LLLL, HH:mm",p="typhoon-track-icon";vx(u,l)?p+=" typhoon-track-icon-future":d?p+=" typhoon-track-icon-latest":p+=" typhoon-track-icon-past",(t.firstLandfall||t.closestToLand)&&(p+=" typhoon-track-icon-firstLandfall");let m=_x(l,f),g=(0,jt.marker)(i,{title:m,icon:(0,jt.divIcon)({className:p,iconSize:d?[this.TYPHOON_TRACK_LATEST_POINT_SIZE,this.TYPHOON_TRACK_LATEST_POINT_SIZE]:[this.TYPHOON_TRACK_NORMAL_POINT_SIZE,this.TYPHOON_TRACK_NORMAL_POINT_SIZE]}),zIndexOffset:700});return g.bindPopup(this.createMarkerTyphoonTrackPopup(t.timestampOfTrackpoint,t.category,i,!E_(l,u)),{minWidth:350,className:"typhoon-track-popup"}),g.on("click",this.onMapMarkerClick(ft.typhoonTrack)),g}createMarkerRedCrossBranch(t,i){let o=t.branchName,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(nT),alt:"Red Cross branches"});return s.bindPopup(this.createMarkerRedCrossPopup(t)),s.on("click",this.onMapMarkerClick(ft.redCrossBranch)),s}createMarkerDam(t,i){let o=t.damName,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(iT)});return s.bindPopup(this.createMarkerDamPopup(t)),s.on("click",this.onMapMarkerClick(ft.dam)),s}createMarkerHealthSite(t,i){let o=t.name,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(t.dynamicData?.exposure?oT:rT)});return s&&(s.bindPopup(this.createHealthSitePopup(t)),s.on("click",this.onMapMarkerClick(ft.healthSite))),s}createMarkerWaterpoint(t,i){let o=t.fid,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(t.dynamicData?.exposure?sT:aT)});return s.bindPopup(this.createMarkerWaterpointPopup(t,i)),s.on("click",this.onMapMarkerClick(ft.waterPoint)),s}createMarkerEvacuationCenter(t,i){let o=t.evacuationCenterName,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(lT)});return s.bindPopup(this.createMarkerEvacuationCenterPopup(t,i)),s.on("click",this.onMapMarkerClick(ft.evacuationCenter)),s}createMarkerSchool(t,i){let o=t.name,s=(0,jt.marker)(i,{title:o,icon:(0,jt.icon)(t.dynamicData?.exposure?uT:cT)});return s.bindPopup(this.createMarkerSchoolPopup(t,i)),s.on("click",this.onMapMarkerClick(ft.school)),s}createMarkerRiverGauges(t,i){let s=(0,jt.marker)(i,{title:t.name,icon:(0,jt.icon)(hT)});return s.bindPopup(this.createMarkerRiverGaugePopup(t),{minWidth:350,className:"river-gauge-popup"}),s.on("click",this.onMapMarkerClick(ft.riverGauge)),s}createThresholdPopup(t,i,o,s,l,u,d,f){let p=l-u,m=.05,g=Math.abs(p)/u<m,v=p===0||!g?l:u+Math.sign(p)*u*m,C=Math.max(Math.min(Math.round(v/u*100),115),0),E=j=>Math.round(j).toLocaleString("en-US"),b=`<strong>${i}</strong>`,S=this.createThresholdBar(o,t,C,E(l),f,E(u),80),I=`
    <div style="margin-bottom:5px">
      ${d}
    </div>
    ${S}
    `,z=`
      <div style="text-align: center">
        <strong>${s}</strong>
      </div>
    `;return this.createDynamicPointPopup(o,b,I,z)}createMarkerStationPopup(t,i,o){let s=Ui.day7,l=o||s,u=i?.eapAlertClasses||{},d=this.componentFactoryResolver.resolveComponentFactory(iv).create(this.injector);return d.instance.layerName=pe.glofasStations,d.instance.glofasData={station:t,leadTime:l,eapAlertClasses:u},d.changeDetectorRef.detectChanges(),d.location.nativeElement}createMarkerTyphoonTrackPopup(t,i,o,s){let l=this.componentFactoryResolver.resolveComponentFactory(iv).create(this.injector);return l.instance.layerName=pe.typhoonTrack,l.instance.typhoonTrackPoint={timestamp:t,category:i,markerLatLng:o,passed:s},l.changeDetectorRef.detectChanges(),l.location.nativeElement}createMarkerRedCrossPopup(t){let i="UNKNOWN";return`
      <div style="margin-bottom: 5px"><strong>Branch: ${t.branchName}</strong></div>
      <div style="margin-bottom: 5px">Nr. of volunteers: ${String(t.numberOfVolunteers??i)}</div>
      <div style="margin-bottom: 5px">Contact person: ${t.contactPerson??i}</div>
      <div style="margin-bottom: 5px">Contact address: ${t.contactAddress??i}</div>
      <div style="margin-bottom: 5px">Contact number: ${t.contactNumber??i}</div>
    `.trim()}createMarkerDamPopup(t){let i=t.damName??"",o=t.fullSupplyCapacity!=null?Math.round(t.fullSupplyCapacity).toLocaleString():"";return`
      <div style="margin-bottom: 5px">
        <strong>Dam: ${i}</strong>
      </div>
      <div style="margin-bottom: 5px">
        Full Supply Capacity: ${o} million m<sup>3</sup>
      </div>
    `.trim()}createMarkerEvacuationCenterPopup(t,i){return`<div style="margin-bottom: 5px"><strong>Evacuation center: ${t.evacuationCenterName}</strong></div><div style="margin-bottom: 5px">Coordinate: ${this.formatAsCoordinate(i)}
    </div>`}createMarkerSchoolPopup(t,i){return`<div style="margin-bottom: 5px"><strong>Name: ${t.name}</strong></div><div style="margin-bottom: 5px">Coordinate: ${this.formatAsCoordinate(i)}
    </div>`}createHealthSitePopup(t){let i=t.name??"",o=t.type??"";return`
      <div style="margin-bottom: 5px">
        <strong>Name: ${i}</strong>
      </div>
      <div style="margin-bottom: 5px">
        Type: ${o}
      </div>
    `.trim()}createMarkerWaterpointPopup(t,i){return`
      <div style="margin-bottom: 5px"><strong>Name: ${t.name}</strong></div>
      ${t.type?`<div style="margin-bottom: 5px">Type: ${t.type}</div>`:""}
      ${t.report_date?`<div style="margin-bottom: 5px">Report date: ${t.report_date}</div>`:""}
      <div style="margin-bottom: 5px">Coordinate: ${this.formatAsCoordinate(i)}</div>
    `}createMarkerDefault(t){let i=(0,jt.marker)(t,{icon:(0,jt.icon)(In)});return i.on("click",this.onMapMarkerClick(ft.mapMarker)),i}createMarkerRiverGaugePopup(t){let i=this.componentFactoryResolver.resolveComponentFactory(iv).create(this.injector);return i.instance.layerName=pe.gauges,i.instance.riverGauge=t,i.changeDetectorRef.detectChanges(),i.location.nativeElement}createDynamicPointPopup(t,i,o,s){let l="var(--ion-color-ibf-white)";return`
      <div style="background: ${t}; color: ${l}; padding: 8px; border-radius: 8px 8px 0 0">
        ${i}
      </div>
      <div style="padding: 8px;">
        ${o}
      </div>
      <div style="background: ${l}; color: ${t}; padding: 0 8px; border-radius: 0 0 8px 8px">
        <div style="border-top: 1px solid var(--ion-color-ibf-grey-light); padding: 8px 0">
          ${s}
        </div>
      </div>

    `}createThresholdBar(t,i,o,s,l,u,d){return`
    <div>
      <div style="border-radius:10px;height:20px;background-color:#d4d3d2; width: 100%">
        <div style="border-radius:10px 0 0 10px; border-right: dashed; border-right-width: thin;height:20px;width: ${d}%">
          <div style="
            border-radius:10px;
            height:20px;
            line-height:20px;
            background-color:${t};
            color:${i};
            text-align:center;
            white-space: nowrap;
            min-width: 20%;
            width:${o}%">${s}

          </div>
        </div>
      </div>
    </div>
    <div style="
      height:20px;
      background-color:none;
      border-right: dashed;
      border-right-width: thin;
      float: left; width: ${d}%;
      padding-top: 5px;
      margin-bottom:10px;
      text-align: right;
      padding-right: 2px">
      ${l}:
    </div>
    <div style="height:20px;background-color:none; margin-left: ${d+1}%; text-align: left; width: 20%; padding-top: 5px; margin-bottom:10px">
      <strong>${u}</strong>
    </div>
    `}static{this.\u0275fac=function(i){return new(i||e)(fe(ze),fe(ei),fe(_C),fe(TC),fe(SC))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ai=function(e){return e.fullSquare="full-square",e.fullSquareGradient="full-square-gradient",e.line="line",e.outlineSquare="outline-square",e.pin="pin",e}(Ai||{}),fN=(()=>{class e{constructor(t,i,o,s){this.mapService=t,this.eventService=i,this.countryService=o,this.disasterTypeService=s,this.legendDivTitle="<div><strong>Map Legend</strong></div>",this.layerIconURLPrefix="assets/markers/",this.layerIcon={[pe.glofasStations]:"glofas-station.svg",[pe.typhoonTrack]:"typhoon-track.png",[pe.redCrossBranches]:"red-cross-marker.svg",[pe.damSites]:"dam-marker.svg",[pe.waterpoints]:"water-point-marker.svg",[pe.healthSites]:"health-center-marker.svg",[pe.evacuationCenters]:"evacuation-center-marker.svg",[pe.schools]:"school-marker.svg",[pe.communityNotifications]:"community-notification-marker.svg",[pe.gauges]:"river-gauge-marker.svg"},this.getLabel=(l,u,d)=>f=>{let p=d?"  -  "+d[f]:"";if(u.colorBreaks){let m=u.colorBreaks?.[f+1]?.valueLow,g=u.colorBreaks?.[f+1]?.valueHigh;return m===g?this.numberFormat(g,u)+p+"<br/>":this.numberFormat(m,u)+"&ndash;"+this.numberFormat(g,u)+p+"<br/>"}else{let m=this.numberFormat(l[f],u),g=this.numberFormat(l[f+1],u);return m+(typeof l[f+1]<"u"?"&ndash;"+g:"+")+p+"<br/>"}},this.onEventStateChange=l=>{this.eventState=l},this.onCountryChange=l=>{this.country=l},this.onDisasterTypeChange=l=>{this.disasterType=l},this.singleRowLegend=(l,u,d)=>{let f=l===Ai.fullSquareGradient?'style="margin-bottom: 0px; margin-top: 0px; height: 14px;"':'style="margin-bottom: 8px; margin-top: 8px;"',p=l===Ai.pin?18:14,m=l===Ai.pin?`<img src="${u}" />`:"",g=`height: ${p}px; width: 14px; margin-right: 4px; `;switch(l){case Ai.fullSquare:case Ai.fullSquareGradient:g+=`background: ${u}`;break;case Ai.outlineSquare:g+=`border: 2px solid ${u}`;break;case Ai.line:g+=`background: ${u}; border-color: #fff; border-style: solid; border-width: 6px 0;`;break;default:break}let v=l===Ai.pin&&d!==bs.typhoonTrack?'style="padding-top: 2px;"':"";return`
    <ion-row class="ion-nowrap" ${f}>
      <div style="${g}">${m}</div>
      <ion-label class="ion-text-wrap" ${v}>${d}</ion-label>
    </ion-row>
    `},this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}getLegendTitle(){return this.legendDivTitle}getPointLegendString(t,i){let o=String(this.layerIcon[t.name]);if(!o)throw new Error(`Icon not found for layer: ${t.name}`);let s=i?"-exposed":"",l=this.layerIconURLPrefix+o.slice(0,-4)+s+o.slice(-4),u=i?`Exposed ${t.label}`:t.label;return this.singleRowLegend(Ai.pin,l,u)}getGlofasPointLegendString(t,i,o){let s=String(this.layerIcon[t.name]);if(!s)throw new Error(`Icon not found for layer: ${t.name}`);let l=this.layerIconURLPrefix+s.slice(0,-4)+i+s.slice(-4);return this.singleRowLegend(Ai.pin,l,`GloFAS ${o}`)}getShapeLegendString(t){if(t.name===pe.trigger)return this.singleRowLegend(Ai.outlineSquare,"red",t.label);if(!t.data)return"";let i=this.mapService.getColorThreshold(t.data,t.colorProperty,t.colorBreaks),o=Object.values(i),s;t.colorBreaks&&(s=Object.values(t.colorBreaks).map(m=>m.label));let l=this.eventState?.events?.length?this.mapService.state.colorGradientAlert:this.mapService.state.colorGradientNoAlert,u=this.getFeatureColorByColorsAndColorThresholds(l,i),d=this.getLabel(o,t,s),f="<div>";f+=this.layerTitle(t.label,t.unit);let p=t.data?.features.find(m=>m.properties?.indicators[t.name]===null);f+="<div style='margin-top: 8px'>",p&&(f+=this.singleRowLegend(Ai.fullSquareGradient,this.mapService.state.noDataColor,"No data"));for(let m=0;m<o.length;m++)o[m]!==null&&(m===0||o[m]>o[m-1])&&(f+=this.singleRowLegend(Ai.fullSquareGradient,u(o[m+1]),d(m)));return f+="</div></div>",f}getWmsLegendString(t){let i="<div>",o="type",s=t.legendColor[this.country.countryCodeISO3]?.[this.disasterType.disasterType]||t.legendColor[this.country.countryCodeISO3]||t.legendColor,l=s[o],d=s["value"];switch(l){case Bl.exposureLine:i+=this.layerTitle(t.label),i+=this.singleRowLegend(Ai.line,d[0],"Exposed "+t.label),i+=this.singleRowLegend(Ai.line,d[1],"Non-exposed "+t.label);break;case Bl.exposureSquare:i+=this.layerTitle(t.label),i+=this.singleRowLegend(Ai.fullSquare,d[0],"Exposed "+t.label),i+=this.singleRowLegend(Ai.fullSquare,d[1],"Non-exposed "+t.label);break;case Bl.gradient:i+=this.layerTitle(t.label,t.unit),i+="<ion-row>";for(let f of d)i+=`<div style="width: 14px; height: 14px; background:${f}"></div>`;i+="</ion-row>",i+=`<ion-row style="margin-top: 4px"><ion-label>Low</ion-label><ion-label style="margin-left: ${this.getWmsGradientCaptionMargin(d.length)}px;">High</ion-label></ion-row>`;break;case Bl.square:i+=this.singleRowLegend(Ai.fullSquare,d[0],t.label);break;case Bl.line:i+=this.singleRowLegend(Ai.line,d[0],t.label);break;default:break}return i+="</div>",i}getWmsGradientCaptionMargin(t){return t<=4?(t-2)*14:7+(t-4)*14}getFeatureColorByColorsAndColorThresholds(t,i){return o=>!i[Li.break1]||o<=i[Li.break1]?t[0]:!i[Li.break2]||o<=i[Li.break2]?t[1]:!i[Li.break3]||o<=i[Li.break3]?t[2]:!i[Li.break4]||o<=i[Li.break4]?t[3]:t[4]}numberFormat(t,i){return t===null?null:i.numberFormatMap===Gn.perc?Math.round(t*100).toLocaleString()+"%":i.numberFormatMap===Gn.decimal2?(Math.round(t*100)/100).toLocaleString():i.numberFormatMap===Gn.decimal0?t>1e7?Math.round(t/1e6).toLocaleString()+"M":t>1e6?(Math.round(t/1e5)/10).toLocaleString()+"M":t>1e4?Math.round(t/1e3).toLocaleString()+"k":t>1e3?(Math.round(t/100)/10).toLocaleString()+"k":Math.round(t).toLocaleString():Math.round(t).toLocaleString()}layerTitle(t,i){return`<ion-row style="margin-top: 8px; margin-bottom: 8px;">
      <ion-label><strong>${t}${i?" ("+i+")":""}</strong></ion-label>
    </ion-row>`}static{this.\u0275fac=function(i){return new(i||e)(fe(Oo),fe(ze),fe($e),fe(it))}}static{this.\u0275prov=Et({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var hk=(e,n)=>n.name;function pk(e,n){if(e&1&&X(0,"div",1),e&2){let t=B().$implicit;W("leafletLayer",t.leafletLayer)}}function fk(e,n){if(e&1&&(D(0,"div"),se(1,pk,1,1,"div",1),x()),e&2){let t=n.$implicit;T(),re(t.active&&t.show?1:-1)}}var ij=(()=>{class e{constructor(t,i,o,s,l,u,d,f,p,m,g){this.countryService=t,this.disasterTypeService=i,this.timelineService=o,this.mapService=s,this.placeCodeService=l,this.eventService=u,this.analyticsService=d,this.pointMarkerService=f,this.mapLegendService=p,this.adminLevelService=m,this.debugService=g,this.layers=[],this.osmTileLayer=(0,mi.tileLayer)(eT,{attribution:tT}),this.leafletOptions=Tt(me({},pT),{layers:[this.osmTileLayer]}),this.leafletLayersControl={baseLayers:{},overlays:{}},this.onLayerChange=v=>{v?(v=v.data||v.type===si.wms?this.createLayer(v):v,v.viewCenter&&this.zoomToArea()):this.layers=[],this.addToLayersControl(),this.triggerWindowResize(),this.updateLegend()},this.onCountryChange=v=>{this.country=v,this.map&&this.country&&this.setInitialMapView()},this.onDisasterTypeChange=v=>{this.disasterType=v,this.countryDisasterSettings=this.disasterTypeService.getCountryDisasterTypeSettings(this.country,this.disasterType)},this.onTimelineStateChange=v=>{this.timelineState=v,this.lastUploadDate=this.timelineState?.today.toUTC().toString()},this.onEventStateChange=v=>{this.eventState=v},this.onPlaceCodeChange=v=>{this.placeCode=v,this.layers.forEach(C=>{C.leafletLayer&&"resetStyle"in C.leafletLayer&&C.leafletLayer.resetStyle()}),this.zoomToArea(),!this.placeCode&&this.map&&this.map.eachLayer(C=>{C.closePopup()})},this.triggerWindowResize=()=>{window.setTimeout(()=>window.dispatchEvent(new UIEvent("resize")),200)},this.getPointToLayerByLayer=v=>(C,E)=>{switch(v){case pe.glofasStations:return this.pointMarkerService.createMarkerStation(C.properties,E,this.countryDisasterSettings,this.eventState?.events);case pe.redCrossBranches:return this.pointMarkerService.createMarkerRedCrossBranch(C.properties,E);case pe.typhoonTrack:return this.pointMarkerService.createMarkerTyphoonTrack(C.properties,E,this.lastUploadDate,this.closestPointToTyphoon);case pe.damSites:return this.pointMarkerService.createMarkerDam(C.properties,E);case pe.waterpoints:return this.pointMarkerService.createMarkerWaterpoint(C.properties,E);case pe.healthSites:return this.pointMarkerService.createMarkerHealthSite(C.properties,E);case pe.evacuationCenters:return this.pointMarkerService.createMarkerEvacuationCenter(C.properties,E);case pe.schools:return this.pointMarkerService.createMarkerSchool(C.properties,E);case pe.communityNotifications:return this.pointMarkerService.createMarkerCommunityNotification(C.properties,E);case pe.gauges:return this.pointMarkerService.createMarkerRiverGauges(C.properties,E);default:return this.pointMarkerService.createMarkerDefault(E)}},this.getIconCreateFunction=v=>{let C=v.getChildCount(),E=v.getAllChildMarkers().some(I=>I.feature.properties.dynamicData?.exposure)?" exposed":"",b,S;switch(!0){case C<=10:b=30,S=`waterpoint-cluster-10${E}`;break;case C<100:b=40,S=`waterpoint-cluster-100${E}`;break;case C<1e3:b=60,S=`waterpoint-cluster-1000${E}`;break;default:b=80,S=`waterpoint-cluster-10000${E}`;break}return(0,mi.divIcon)({html:"<b>"+String(C)+"</b>",className:S,iconSize:(0,mi.point)(b,b)})},this.onAdminRegionMouseOver=v=>C=>{C.target.setStyle(this.mapService.setAdminRegionMouseOverStyle(v.properties.placeCode,v.properties.placeCodeParent)),this.placeCodeService.setPlaceCodeHover({countryCodeISO3:v.properties.countryCodeISO3,placeCode:v.properties.placeCode,placeCodeName:v.properties.name,placeCodeParentName:v.properties.nameParent,eventName:v.properties.eventName,adminLevel:v.properties.adminLevel})},this.onAdminRegionClickByLayerAndFeatureAndElement=v=>()=>{let C=v.properties.adminLevel,E=v.properties.placeCode;if(this.analyticsService.logEvent(ft.mapPlaceSelect,{placeCode:E,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.eventState.event){if(this.eventState.event&&E!==this.placeCode?.placeCode){let b=C>(Number(this.placeCode?.adminLevel)||0);b&&this.adminLevelService.zoomInAdminLevel(),this.placeCodeService.setPlaceCode({placeCode:E,countryCodeISO3:v.properties.countryCodeISO3,placeCodeName:v.properties.name,placeCodeParent:b?this.placeCode:this.placeCode?.placeCodeParent,placeCodeParentName:v.properties.nameParent,adminLevel:C,eventName:v.properties.eventName})}}else if(v.properties.eventName){let b=this.eventState?.events?.find(S=>S.eventName===v.properties.eventName);this.eventService.switchEvent(v.properties.eventName),this.timelineService.setTimelineState(b?.firstTriggerLeadTime||b?.firstLeadTime,b?.eventName)}},this.debugService.logComponentInit("MapComponent","Constructor called"),this.layerSubscription=this.mapService.getLayerSubscription().subscribe(this.onLayerChange),this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange),this.placeCodeSubscription=this.placeCodeService.getPlaceCodeSubscription().subscribe(this.onPlaceCodeChange),this.initialEventStateSubscription=this.eventService.getInitialEventStateSubscription().subscribe(this.onEventStateChange),this.manualEventStateSubscription=this.eventService.getManualEventStateSubscription().subscribe(this.onEventStateChange),this.timelineStateSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange)}ngAfterViewInit(){this.debugService.logComponentAfterViewInit("MapComponent",{mapExists:!!this.map,leafletOptions:this.leafletOptions}),this.map&&this.initLegend(),setTimeout(()=>{this.debugService.logElementVisibility("MapComponent",".leaflet--map"),this.debugService.logElementVisibility("MapComponent",'[data-testid="dashboard-map-componenet"]'),this.debugService.logCSSStyles("MapComponent",".leaflet--map")},100)}ngOnDestroy(){this.layerSubscription.unsubscribe(),this.countrySubscription.unsubscribe(),this.placeCodeSubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe(),this.initialEventStateSubscription.unsubscribe(),this.manualEventStateSubscription.unsubscribe(),this.timelineStateSubscription.unsubscribe()}zoomToArea(){if(this.mapService.adminLevel){let t=this.layers.find(i=>i.name===`${pt.adminRegions}${this.mapService.adminLevel}`);if(t){let i=JSON.parse(JSON.stringify(t.data));if(this.placeCode?i.features=t.data?.features.filter(o=>{let s=o?.properties?.placeCode===this.placeCode.placeCode,l=o?.properties?.placeCodeParent===this.placeCode.placeCodeParent;return s||l}):i.features=t.data?.features,i.features.length){let o=V_(i),s=o[2]-o[0],l=o[3]-o[1],u=.1;this.mapService.state.bounds=mp(o)?[[o[1]-u*l,o[0]-u*s],[o[3]+u*l,o[2]+u*s]]:this.mapService.state.bounds,this.map.fitBounds(this.mapService.state.bounds)}}}}initLegend(){this.legend=new mi.Control,this.legend.setPosition("bottomleft"),this.legend.onAdd=()=>(this.legendDiv=mi.DomUtil.create("div","info legend invisible"),this.legendDiv.innerHTML+=this.mapLegendService.getLegendTitle(),this.legendDiv),this.legend.addTo(this.map)}updateLegend(){if(!this.legendDiv)return;this.map.options.zoomControl||(this.map.options.zoomControl=!0,this.map.addControl(new mi.Control.Zoom),this.legendDiv.classList.remove("invisible"));let t=this.layers.filter(s=>s.active&&s.group!==pt.adminRegions).filter((s,l,u)=>l===u.findIndex(d=>d.name===s.name)),i=`<details data-testid="map-legend" open><summary><div data-testid="map-legend-header" class="legend-header">${this.mapLegendService.getLegendTitle()}
    <ion-icon class="icon-down" name="chevron-down-outline"></ion-icon>
    <ion-icon class="icon-up" name="chevron-up-outline"></ion-icon></div>
    </summary>`,o=t.sort((s,l)=>s.order-l.order);for(let s of o){let l=[];switch(s.type){case si.point:if(this.isMultiLinePointLayer(s.name))for(let u of[!1,!0]){let d=this.mapLegendService.getPointLegendString(s,u);l.push(d)}else if(s.name===pe.glofasStations)for(let u of this.getGlofasStationStates()){let d=this.mapLegendService.getGlofasPointLegendString(s,`-${u.key}-trigger`,u.label);l.push(d)}else{let u=this.mapLegendService.getPointLegendString(s,!1);l.push(u)}break;case si.shape:l.push(this.mapLegendService.getShapeLegendString(s));break;case si.wms:l.push(this.mapLegendService.getWmsLegendString(s));break;default:l.push(`<p id='legend-${s.name}'>${s.label}</p>`);break}for(let u of l)i+=u}i+="</details>",this.legendDiv.innerHTML=i}isMultiLinePointLayer(t){return[pe.healthSites,pe.schools,pe.waterpoints].includes(t)&&this.disasterType.disasterType===Rt.flashFloods&&this.eventState.events?.length>0}getGlofasStationStates(){let t=[];for(let[i,o]of Object.entries(this.countryDisasterSettings?.eapAlertClasses))t.push({key:i,label:o.label,value:o.value});return t.sort((i,o)=>o.value-i.value),t}onMapReady(t){this.debugService.logData("MapComponent","onMapReady called",{mapReceived:!!t,mapSize:t?t.getSize():null}),this.map=t,this.map.createPane(Lr.wmsPane),this.map.createPane(Lr.adminBoundaryPane),this.map.createPane(Lr.outline),this.map.createPane(Lr.aggregatePane),this.triggerWindowResize(),this.ensureMapViewIsSet(),this.debugService.logData("MapComponent","Map panes created and window resized",{mapContainer:this.map.getContainer(),mapSize:this.map.getSize(),countryAvailable:!!this.country})}setInitialMapView(){if(!this.map||!this.country)return;let t=this.getCountryCoordinates(),i=this.getCountryDefaultZoom();t&&(this.map.setView([t.lat,t.lng],i),this.debugService.logData("MapComponent","Initial map view set",{country:this.country.countryCodeISO3,coordinates:t,zoom:i}))}ensureMapViewIsSet(){if(!this.map)return;let t=this.map.getCenter(),i=this.map.getZoom();if(!t||i===void 0||i===null){let o=[9,40],s=5;this.map.setView(o,s),this.debugService.logData("MapComponent","Fallback map view set",{center:o,zoom:s,reason:"Map had no valid center/zoom"})}else this.country&&this.setInitialMapView()}getCountryCoordinates(){return this.country&&{ETH:{lat:9.145,lng:40.4897},UGA:{lat:1.3733,lng:32.2903},KEN:{lat:-.0236,lng:37.9062},ZMB:{lat:-13.1339,lng:27.8493},MWI:{lat:-13.2543,lng:34.3015},PHL:{lat:12.8797,lng:121.774},BGD:{lat:23.685,lng:90.3563}}[this.country.countryCodeISO3]||null}getCountryDefaultZoom(){return this.country?{ETH:6,UGA:7,KEN:6,ZMB:6,MWI:7,PHL:6,BGD:7}[this.country.countryCodeISO3]||6:5}createLayer(t){if(this.layers=this.layers.filter(i=>i.name!==t.name),t.type===si.point){let i=this.createPointLayer(t);for(let o of i){let s=Object.assign({},t);s.leafletLayer=o,this.layers.push(s)}}return t.type===si.shape&&(t.leafletLayer=this.createAdminRegionsLayer(t),this.layers.push(t)),t.type===si.wms&&(t.leafletLayer=this.createWmsLayer(t),this.layers.push(t)),t}addToLayersControl(){this.layers.forEach(t=>{this.leafletLayersControl.overlays[t.name]=t.leafletLayer})}createPointLayer(t){if(!t.data)return;t.name===pe.typhoonTrack&&this.calculateClosestPointToTyphoon(t);let i=(0,mi.geoJSON)(t.data,{pointToLayer:this.getPointToLayerByLayer(t.name)});if(t.name===pe.waterpoints){let o=(0,mi.markerClusterGroup)({iconCreateFunction:this.getIconCreateFunction,maxClusterRadius:50}),s=JSON.parse(JSON.stringify(t.data));s.features=s.features.filter(p=>p.properties.dynamicData?.exposure);let l=(0,mi.geoJSON)(s,{pointToLayer:this.getPointToLayerByLayer(t.name)});o.addLayer(l);let u=(0,mi.markerClusterGroup)({iconCreateFunction:this.getIconCreateFunction,maxClusterRadius:50}),d=JSON.parse(JSON.stringify(t.data));d.features=d.features.filter(p=>!p.properties.dynamicData?.exposure);let f=(0,mi.geoJSON)(d,{pointToLayer:this.getPointToLayerByLayer(t.name)});return u.addLayer(f),[o,u]}if(t.name===pe.healthSites&&t.data.features.length>1e3){let o=(0,mi.markerClusterGroup)({iconCreateFunction:this.getIconCreateFunction,maxClusterRadius:10});return o.addLayer(i),[o]}return[i]}getAdminRegionLayerPane(t){let i=Lr.overlayPane;switch(t.group){case pt.aggregates:i=Lr.aggregatePane;break;case pt.adminRegions:i=Lr.adminBoundaryPane;break;default:i=Lr.overlayPane;break}return i}createThresHoldPopupAdminRegions(t,i,o,s){let u=i["properties"][t.colorProperty],d=u>o,f=d?"var(--ion-color-ibf-trigger-alert-primary-contrast)":"var(--ion-color-ibf-no-alert-primary-contrast)",p=i.properties.name,g=s[s.length-1].split("-")[1],v=`${t.label} for current ${g} selected`,C=d?"var(--ion-color-ibf-trigger-alert-primary)":"var(--ion-color-ibf-no-alert-primary)",E=d?"ACTIVATE EARLY ACTIONS":"No action";return this.pointMarkerService.createThresholdPopup(f,p,C,E,u,o,v,"Alert threshold")}createAdminRegionsLayer(t){if(!t.data)return;let i;return t.group===pt.outline?i=(0,mi.geoJSON)(t.data,{pane:Lr.outline,style:this.mapService.setOutlineLayerStyle(t),interactive:!1}):i=(0,mi.geoJSON)(t.data,{pane:this.getAdminRegionLayerPane(t),style:this.mapService.setAdminRegionStyle(t),onEachFeature:(o,s)=>{s.on("mouseover",this.onAdminRegionMouseOver(o)),s.on("mouseout",()=>{i.resetStyle(),this.placeCodeService.clearPlaceCodeHover()}),s.on("click",this.onAdminRegionClickByLayerAndFeatureAndElement(o))}}),i}createWmsLayer(t){if(!t.wms)return;let i=[],o=this.eventState.event?[this.eventState.event]:this.eventState.events.length>0?this.eventState.events:[new q_];for(let l of o){let u=this.getWmsLayerName(t,l);i.includes(u)||i.push(u)}let s={pane:Lr.wmsPane,layers:i.join(","),format:t.wms.format,version:t.wms.version,attribution:t.wms.attribution,crs:t.wms.crs,transparent:t.wms.transparent,viewparams:t.wms.viewparams};return mi.tileLayer.wms(t.wms.url,s)}getWmsLayerName(t,i){let o;t.wms.leadTimeDependent&&(!this.eventState.event&&i.firstLeadTime?o=i.firstLeadTime:o=this.timelineState.activeLeadTime);let s=o?`_${o}`:"",l=LD.includes(t.name)?"":`_${this.country.countryCodeISO3}`;return`ibf-system:${t.name}${s}${l}`}calculateClosestPointToTyphoon(t){if(!t.data?.features?.length){this.closestPointToTyphoon=void 0;return}let i=wu(this.lastUploadDate),o=t.data.features.map(({properties:l})=>wu(String(l.timestampOfTrackpoint))).filter(l=>!E_(l,i));if(o.length===0){this.closestPointToTyphoon=void 0;return}let s=Bb(o);this.closestPointToTyphoon=s}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(it),P(tn),P(Oo),P(Zt),P(ze),P(ei),P(pN),P(fN),P(Sn),P(qu))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-map"]],standalone:!1,decls:3,vars:1,consts:[["leaflet","","data-test","leaflet-map",1,"leaflet--map",3,"leafletMapReady","leafletOptions"],[3,"leafletLayer"]],template:function(i,o){i&1&&(D(0,"div",0),oe("leafletMapReady",function(l){return o.onMapReady(l)}),Vt(1,fk,2,1,"div",null,hk),x()),i&2&&(W("leafletOptions",o.leafletOptions),T(),Gt(o.layers))},dependencies:[sS,FD],styles:[".leaflet--map[_ngcontent-%COMP%]{width:100%;height:100%}"]})}}return e})();var oj=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=ce({type:e,selectors:[["app-map-controls"]],standalone:!1,decls:1,vars:0,template:function(i,o){i&1&&X(0,"app-admin-level")},dependencies:[kD],styles:["app-admin-level[_ngcontent-%COMP%]{position:absolute;top:-10px;left:45px;z-index:500}"]})}}return e})();var mk=e=>({height:e}),_k=(e,n)=>n.name;function vk(e,n){if(e&1){let t=Ye();D(0,"ion-icon",12),oe("click",function(){ge(t);let o=B().$implicit,s=B(3);return ye(s.toggleLayer(o))}),x()}if(e&2){let t=B().$implicit;W("name",t.active?"checkbox":"square-outline")}}function gk(e,n){if(e&1){let t=Ye();D(0,"ion-icon",13),oe("click",function(){ge(t);let o=B().$implicit,s=B(3);return ye(s.toggleLayer(o))}),x()}if(e&2){let t=B().$implicit;W("name",t.active?"radio-button-on-outline":"radio-button-off-outline")}}function yk(e,n){if(e&1){let t=Ye();D(0,"ion-row",5)(1,"ion-item",6),se(2,vk,1,1,"ion-icon",7)(3,gk,1,1,"ion-icon",8),D(4,"ion-label",9),M(5),x(),D(6,"ion-button",10),Y(7,"translate"),oe("click",function(o){let s=ge(t).$implicit,l=B(3);return ye(l.presentPopover(o,s))}),X(8,"ion-icon",11),x()()()}if(e&2){let t=n.$implicit,i=B(3);T(),ho("className","matrix-layer ",t.name,""),T(),re(i.isCheckBox(t.group)?2:-1),T(),re(i.isRadioButton(t.group)?3:-1),T(),W("title",t.label),T(),ne(" ",t.label," "),T(),W("title",Z(7,7,"aggregates-component.more-information"))}}function Sk(e,n){if(e&1&&(D(0,"div",3)(1,"ion-list",4),Vt(2,yk,9,9,"ion-row",5,_k),x()()),e&2){let t=B(2);T(2),Gt(t.getLayersInOrder())}}function Ck(e,n){if(e&1){let t=Ye();D(0,"div",0)(1,"ion-button",1),oe("click",function(){ge(t);let o=B();return ye(o.toggleLayerMenu())}),D(2,"div")(3,"ion-text"),M(4),Y(5,"translate"),x(),X(6,"ion-icon",2),x()(),se(7,Sk,4,0,"div",3),x()}if(e&2){let t=B();W("ngStyle",Lt(6,mk,t.getLayerMenuContainerHeightInRem()+"rem")),T(4),ne(" ",Z(5,4,"layers-menu.menu-toggle-label"),""),T(2),W("name",t.isLayerMenuOpen?"chevron-down-outline":"chevron-up-outline"),T(),re(t.isLayerMenuOpen?7:-1)}}var uj=(()=>{class e{constructor(t,i,o,s,l){this.analyticsService=t,this.eventService=i,this.mapService=o,this.popoverController=s,this.menuController=l,this.layers=[],this.IbfLayerType=si,this.IbfLayerName=pe,this.IbfLayerGroup=pt,this.hideLayerControlToggleButton=!1,this.BUTTON_HEIGHT=2.26,this.LINE_HEIGHT=1.5,this.isLayerMenuOpen=!1,this.onLayerChange=u=>{if(!(u&&u.name===pe.trigger))if(u){let d=this.layers.findIndex(f=>f.name===u.name);d>=0?this.layers.splice(d,1,u):(this.isLayerMenuOpen=!1,u.group!==pt.adminRegions&&this.layers.push(u))}else this.layers=[]},this.sortLayers=(u,d)=>u.order>d.order?1:u.order===d.order?0:-1,this.getLayerMenuContainerHeightInRem=()=>this.isLayerMenuOpen?(this.getLayersInOrder().length+1)*this.LINE_HEIGHT+this.BUTTON_HEIGHT:this.BUTTON_HEIGHT,this.layerSubscription=this.mapService.getLayerSubscription().subscribe(this.onLayerChange)}ngOnDestroy(){this.layerSubscription.unsubscribe()}presentPopover(t,i){return dt(this,null,function*(){t.stopPropagation();let o=yield this.popoverController.create({component:ju,animated:!0,cssClass:"ibf-popover ibf-popover-normal",translucent:!0,showBackdrop:!0,componentProps:{layer:i}});this.analyticsService.logEvent(ft.mapLayerInformation,{mapLayerName:i.name,mapLayerStatus:i.active,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),o.present()})}toggleLayer(t){this.analyticsService.logEvent(ft.mapLayer,{mapLayerName:t.name,mapLayerStatus:!t.active,page:Bt.dashboard,isActiveTrigger:this.eventService.state.events?.length>0,component:this.constructor.name}),this.mapService.toggleLayer(t)}isLayerControlMenuOpen(){return dt(this,null,function*(){this.hideLayerControlToggleButton=yield this.menuController.isOpen("layer-control")})}getLayersInOrder(){return this.layers.filter(t=>t.order>=0).sort(this.sortLayers)}isCheckBox(t){return[pt.point,pt.wms].includes(t)}isRadioButton(t){return[pt.aggregates,pt.outline].includes(t)}toggleLayerMenu(){this.isLayerMenuOpen=!this.isLayerMenuOpen}static{this.\u0275fac=function(i){return new(i||e)(P(ei),P(ze),P(Oo),P(at),P($C))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-matrix"]],standalone:!1,decls:1,vars:1,consts:[["id","layer-menu-container",3,"ngStyle"],["color","ibf-no-alert-primary ","data-testid","layer-menu-toggle-button","id","layer-menu-toggle-button",1,"ion-no-margin","ion-justify-content-between",3,"click"],[3,"name"],["data-testid","layer-menu","id","layer-menu"],[1,"ion-no-padding"],[1,"ion-justify-content-between","ion-nowrap"],["lines","none",3,"className"],["data-testid","matrix-checkbox",1,"single-layer-toggler",3,"name"],["data-testid","matrix-radio-button",1,"single-layer-toggler",3,"name"],[1,"ion-text-wrap","ion-no-margin",2,"margin-left","8px",3,"title"],["slot","end","fill","clear",1,"ion-no-margin","info-button",3,"click","title"],["color","ibf-no-alert-primary","name","information-circle-outline","data-test","matrix-icon",1,"info-icon"],["data-testid","matrix-checkbox",1,"single-layer-toggler",3,"click","name"],["data-testid","matrix-radio-button",1,"single-layer-toggler",3,"click","name"]],template:function(i,o){i&1&&se(0,Ck,8,8,"div",0),i&2&&re(o.layers.length?0:-1)},dependencies:[OC,Ke,Ze,kt,ci,lc,hr,mo,Oe],styles:["#layer-menu-container[_ngcontent-%COMP%]{position:fixed;z-index:900;bottom:1.5rem;right:0;width:13vw;height:1.5rem;display:flex;flex-direction:column;max-height:17.26rem}@media (max-width: 1280px){#layer-menu-container[_ngcontent-%COMP%]{width:16vw}}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu-toggle-button[_ngcontent-%COMP%]{width:100%;height:2.26rem;min-height:2.26rem;--border-radius: .25rem 0 0 0}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu-toggle-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu-toggle-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]{bottom:0;overflow-y:auto}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{min-height:1.5rem;border:1px solid var(--ion-color-ibf-no-alert-primary);border-top:none}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:98%;--min-height: $line-height;--padding-bottom: 0;--padding-top: 0;--padding-start: .25rem;--padding-end: .25rem;--inner-padding-start: 0;--inner-padding-end: 0}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:1rem;height:1rem}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .single-layer-toggler[_ngcontent-%COMP%]{font-size:1.3rem;cursor:pointer;color:var(--ion-color-ibf-no-alert-primary)}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{width:80%;font-size:.75rem}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-button[_ngcontent-%COMP%]{--background-hover: #fff;--ripple-color: #fff}#layer-menu-container[_ngcontent-%COMP%]   #layer-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:1.3rem;cursor:pointer}"]})}}return e})();var pj=(()=>{class e{constructor(t){this.popoverController=t}closePopover(){this.popoverController.dismiss()}static{this.\u0275fac=function(i){return new(i||e)(P(at))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-screen-orientation-popover"]],inputs:{device:"device"},standalone:!1,decls:20,vars:12,consts:[[1,"popover-window-card"],["color","ibf-primary"],[1,"ion-padding-top","ion-text-center"],["lines","none"],[1,"ion-margin-bottom","ion-text-wrap"],[1,"ion-text-wrap"],["lines","none",2,"width","100%"],[1,"ion-text-end",2,"width","100%"],["fill","clear",2,"text-transform","uppercase",3,"click"]],template:function(i,o){i&1&&(D(0,"ion-card",0)(1,"ion-card-header",1)(2,"ion-card-title"),M(3),Y(4,"translate"),x()(),D(5,"ion-card-content",2)(6,"ion-item",3)(7,"ion-col")(8,"ion-label",4)(9,"strong"),M(10),Y(11,"translate"),x()(),D(12,"ion-label",5),M(13),Y(14,"translate"),x()()(),D(15,"ion-item",6)(16,"div",7)(17,"ion-button",8),oe("click",function(){return o.closePopover()}),M(18),Y(19,"translate"),x()()()()()),i&2&&(T(3),be(Z(4,4,"dashboard-page.screen-orientation."+o.device+".title")),T(7),be(Z(11,6,"dashboard-page.screen-orientation."+o.device+".warning-message")),T(3),ne(" ",Z(14,8,"dashboard-page.screen-orientation."+o.device+".instructions-message")," "),T(5),ne(" ",Z(19,10,"chat-component.common.save-actions.prompt-button-label")," "))},dependencies:[Ke,xi,Di,Zi,ji,fo,kt,ci,Oe],encapsulation:2})}}return e})();var Tk=(e,n)=>n.value;function Ek(e,n){e&1&&X(0,"ion-progress-bar",1)}function bk(e,n){if(e&1&&(D(0,"ion-button",4),X(1,"app-date-button",5),x()),e&2){let t=n.$implicit;bi("active",t.active)("forecast-alert",t.forecastAlert),tc("color",t.forecastAlert?"ibf-trigger-alert-tertiary":"ibf-no-alert-tertiary"),T(),W("date",t.date)("forecastAlert",t.forecastAlert)("trigger",t.trigger)}}function xk(e,n){e&1&&(X(0,"app-tooltip",3),Y(1,"translate")),e&2&&W("value",Z(1,1,"timeline-component.tooltip"))}function Dk(e,n){if(e&1&&(Vt(0,bk,2,8,"ion-button",2,Tk),se(2,xk,2,3,"app-tooltip",3)),e&2){let t=B();Gt(t.timelineState.timeStepButtons),T(2),re(t.timelineState.timeStepButtons.length>0?2:-1)}}var mj=(()=>{class e{constructor(t,i,o,s){this.timelineService=t,this.eventService=i,this.placeCodeService=o,this.changeDetectorRef=s,this.onTimelineStateChange=l=>{this.timelineState=l,this.changeDetectorRef.detectChanges()},this.onPlaceCodeHoverChange=l=>{if(!this.eventService.state.event){if(this.placeCodeHover=l,this.placeCodeHover){let u=this.timelineState?.timeStepButtons?.filter(d=>d.eventNames.includes(l.eventName));for(let d of u)d.active=!0;this.changeDetectorRef.detectChanges()}else if(this.timelineState?.timeStepButtons){for(let u of this.timelineState.timeStepButtons)u.active=!1;this.changeDetectorRef.detectChanges()}}}}ngOnInit(){this.timelineStateSubscription=this.timelineService.getTimelineStateSubscription().subscribe(this.onTimelineStateChange),this.placeCodeHoverSubscription=this.placeCodeService.getPlaceCodeHoverSubscription().subscribe(this.onPlaceCodeHoverChange)}ngOnDestroy(){this.timelineStateSubscription.unsubscribe(),this.placeCodeHoverSubscription.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)(P(tn),P(ze),P(Zt),P(po))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-timeline"]],standalone:!1,decls:4,vars:3,consts:[["lines","none",1,"ion-no-padding"],["type","indeterminate","color","ibf-grey",1,"ion-margin"],["expand","full","fill","solid","data-testid","timeline-button",1,"pointer-events-none","first:ml-0",3,"color","active","forecast-alert"],["data-testid","tooltip-button","color","ibf-no-alert-primary",1,"event-header--tooltip",3,"value"],["expand","full","fill","solid","data-testid","timeline-button",1,"pointer-events-none","first:ml-0",3,"color"],[3,"date","forecastAlert","trigger"]],template:function(i,o){i&1&&(D(0,"ion-item",0),se(1,Ek,1,0,"ion-progress-bar",1),Y(2,"async"),se(3,Dk,3,1),x()),i&2&&(T(),re(Z(2,1,o.timelineService.isLoading)?1:3))},dependencies:[Ke,kt,VC,JD,ws,Ta,Oe],styles:["ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--height: 40px;--min-height: 40px}ion-button[_ngcontent-%COMP%]{height:100%!important;text-align:left;--border-style: solid;--border-color: transparent}ion-button[_ngcontent-%COMP%]::part(native){border-width:.1rem}ion-button.active[_ngcontent-%COMP%]{--border-color: var(--ion-color-ibf-trigger-alert-primary);--ion-color-contrast: var(--ion-color-ibf-trigger-alert-primary)}ion-button.forecast-alert[_ngcontent-%COMP%]{--border-color: var(--ion-color-ibf-trigger-alert-tertiary);--ion-color-contrast: var(--ion-color-ibf-trigger-alert-primary)}ion-button.forecast-alert.active[_ngcontent-%COMP%]{--border-color: var(--ion-color-ibf-trigger-alert-primary);--ion-color-contrast: var(--ion-color-ibf-trigger-alert-primary)}"]})}}return e})();var vj=(()=>{class e{constructor(t,i,o,s,l,u){this.countryService=t,this.apiService=i,this.alertController=o,this.toastController=s,this.disasterTypeService=l,this.translateService=u,this.backendMockScenarioComponentTranslateNode="dashboard-page.dev-menu.mock-scenario",this.alertHeaderLabelNode="alert-header",this.alertSubHeaderLabelNode="alert-sub-header",this.alertMessageNode="alert-message",this.alertButtonCancelLabelNode="alert-button-cancel",this.alertButtonNoTriggerLabelNode="alert-button-no-trigger",this.alertButtonTriggerLabelNode="alert-button-trigger",this.alertErrorApiErrorNode="alert-error-api-error",this.onCountryChange=d=>{this.country=d},this.onDisasterTypeChange=d=>{this.disasterType=d},this.onTranslate=d=>{this.alertHeaderLabel=d[this.alertHeaderLabelNode],this.alertSubHeaderLabel=d[this.alertSubHeaderLabelNode],this.alertMessage=this.translateService.instant(`${this.backendMockScenarioComponentTranslateNode}.${this.alertMessageNode}`,{countryName:this.country.countryName,disasterTypeLabel:this.disasterType.disasterType}),this.alertButtonCancelLabel=d[this.alertButtonCancelLabelNode],this.alertButtonNoTriggerLabel=d[this.alertButtonNoTriggerLabelNode],this.alertButtonTriggerLabel=d[this.alertButtonTriggerLabelNode],this.alertErrorApiError=d[this.alertErrorApiErrorNode],this.handleBackendMockScenarioChange()},this.onClickBackendMockScenarioChange=()=>{this.translateService.get(this.backendMockScenarioComponentTranslateNode).subscribe(this.onTranslate)}}ngOnInit(){this.countrySubscription=this.countryService.getCountrySubscription().subscribe(this.onCountryChange),this.disasterTypeSubscription=this.disasterTypeService.getDisasterTypeSubscription().subscribe(this.onDisasterTypeChange)}ngOnDestroy(){this.countrySubscription.unsubscribe(),this.disasterTypeSubscription.unsubscribe()}presentToast(t){return dt(this,null,function*(){(yield this.toastController.create({message:t,duration:2e3})).present()})}handleBackendMockScenarioChange(){return dt(this,null,function*(){let t=yield this.alertController.create({cssClass:"mock-scenario-alert",header:this.alertHeaderLabel,subHeader:this.alertSubHeaderLabel,message:this.alertMessage,buttons:[{text:this.alertButtonCancelLabel,role:"cancel"},{text:this.alertButtonNoTriggerLabel,cssClass:"no-trigger-scenario-button",handler:()=>(this.mockApiRefresh(!1,!0,t),!1)},{text:this.alertButtonTriggerLabel,cssClass:"trigger-scenario-button",handler:()=>(this.mockApiRefresh(!0,!0,t),!1)}]});t.present()})}mockApiRefresh(t,i,o){this.apiService.mock(this.country,t,i,this.disasterType).subscribe({next:()=>{this.processMockSuccess(o)},error:s=>{s.status===202?this.processMockSuccess(o):this.presentToast(this.alertErrorApiError)}})}processMockSuccess(t){this.countryService.selectCountry(this.country.countryCodeISO3),t.dismiss(!0)}static{this.\u0275fac=function(i){return new(i||e)(P($e),P(ui),P(of),P(af),P(it),P(Jt))}}static{this.\u0275cmp=ce({type:e,selectors:[["app-backend-mock-scenario"]],standalone:!1,decls:2,vars:1,consts:[["button","true",3,"click","translate"]],template:function(i,o){i&1&&(Yp(0),D(1,"ion-item",0),oe("click",function(){return o.onClickBackendMockScenarioChange()}),x(),Bp()),i&2&&(T(),W("translate","dashboard-page.dev-menu.mock-scenario.button-label"))},dependencies:[kt,YC],encapsulation:2})}}return e})();var q7=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=ga({type:e})}static{this.\u0275inj=va({imports:[HD,Vp,zC,qC,zD,YD,Yv,Yv]})}}return e})();NC($D,[sc,rc,oc,Ke,Xp,fo,Jp,Ze,kt,ci,lc,tf,hr,$p,VD,GD,Q_,nN,oN,lN,ws],[Oe,Ns]);export{Bt as a,ft as b,Ea as c,fT as d,ui as e,Pn as f,$e as g,ei as h,it as i,Fe as j,pj as k,qu as l,_x as m,wu as n,Dn as o,ze as p,b9 as q,P9 as r,vj as s,$D as t,j9 as u,Q9 as v,wk as w,ij as x,oj as y,uj as z,mj as A,zZ as B,sN as C,M8 as D,q7 as E};
/*! Bundled license information:

leaflet/dist/leaflet-src.js:
  (* @preserve
   * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
   * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
   *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.11
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)
*/
